<!DOCTYPE html><html><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><meta name="format-detection" content="telephone=no"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black"><link rel="icon" href="/images/icons/favicon-16x16.png?v=2.6.2" type="image/png" sizes="16x16"><link rel="icon" href="/images/icons/favicon-32x32.png?v=2.6.2" type="image/png" sizes="32x32"><meta name="description" content="呜呜呜T_T 记录一下蒟蒻在各大比赛挨打的过程。">
<meta property="og:type" content="article">
<meta property="og:title" content="蒟蒻的挨打之路">
<meta property="og:url" content="https://tsuppari404.github.io/2021/08/02/%E8%92%9F%E8%92%BB%E7%9A%84%E6%8C%A8%E6%89%93%E4%B9%8B%E8%B7%AF/index.html">
<meta property="og:site_name" content="蒟蒻的入土史">
<meta property="og:description" content="呜呜呜T_T 记录一下蒟蒻在各大比赛挨打的过程。">
<meta property="og:locale">
<meta property="og:image" content="https://tsuppari404.github.io/images/2021110613.png">
<meta property="og:image" content="https://tsuppari404.github.io/images/2021110614.png">
<meta property="og:image" content="https://tsuppari404.github.io/images/2021083101.jpg">
<meta property="og:image" content="https://tsuppari404.github.io/images/2021083102.jpg">
<meta property="og:image" content="https://tsuppari404.github.io/images/2021082301.png">
<meta property="og:image" content="https://tsuppari404.github.io/images/2021051601.png">
<meta property="og:image" content="https://tsuppari404.github.io/images/2021051602.png">
<meta property="og:image" content="https://tsuppari404.github.io/images/2021051202.png">
<meta property="og:image" content="https://tsuppari404.github.io/images/2021051201.png">
<meta property="og:image" content="https://tsuppari404.github.io/images/2021051203.png">
<meta property="og:image" content="https://tsuppari404.github.io/images/2021051204.png">
<meta property="og:image" content="https://tsuppari404.github.io/images/2021051401.png">
<meta property="og:image" content="https://tsuppari404.github.io/images/2021051402.png">
<meta property="article:published_time" content="2021-08-02T00:39:55.000Z">
<meta property="article:modified_time" content="2021-11-10T10:42:39.723Z">
<meta property="article:author" content="tsuppari">
<meta property="article:tag" content="学习">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://tsuppari404.github.io/images/2021110613.png"><title>蒟蒻的挨打之路 | 蒟蒻的入土史</title><link ref="canonical" href="https://tsuppari404.github.io/2021/08/02/%E8%92%9F%E8%92%BB%E7%9A%84%E6%8C%A8%E6%89%93%E4%B9%8B%E8%B7%AF/"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.12.1/css/all.min.css" type="text/css"><link rel="stylesheet" href="/css/index.css?v=2.6.2"><script>var Stun = window.Stun || {};
var CONFIG = {
  root: '/',
  algolia: undefined,
  assistSearch: undefined,
  fontIcon: {"prompt":{"success":"fas fa-check-circle","info":"fas fa-arrow-circle-right","warning":"fas fa-exclamation-circle","error":"fas fa-times-circle"},"copyBtn":"fas fa-copy"},
  sidebar: {"offsetTop":"20px","tocMaxDepth":6},
  header: {"enable":true,"showOnPost":true,"scrollDownIcon":false},
  postWidget: {"endText":true},
  nightMode: {"enable":true},
  back2top: {"enable":true},
  codeblock: {"style":"default","highlight":"light","wordWrap":true},
  reward: true,
  fancybox: false,
  zoomImage: {"gapAside":"20px"},
  galleryWaterfall: undefined,
  lazyload: false,
  pjax: undefined,
  externalLink: {"icon":{"enable":true,"name":"fas fa-external-link-alt"}},
  shortcuts: undefined,
  prompt: {"copyButton":"Copiar","copySuccess":"Éxito en copia","copyError":"Error en copia"},
  sourcePath: {"js":"js","css":"css","images":"images"},
};

window.CONFIG = CONFIG;</script><meta name="generator" content="Hexo 6.0.0"></head><body><div class="container" id="container"><header class="header" id="header"><div class="header-inner"><nav class="header-nav header-nav--fixed"><div class="header-nav-inner"><div class="header-nav-menubtn"><i class="fas fa-bars"></i></div><div class="header-nav-menu"><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="/"><span class="header-nav-menu-item__icon"><i class="fas fa-home"></i></span><span class="header-nav-menu-item__text">Inicio</span></a></div><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="/archives/"><span class="header-nav-menu-item__icon"><i class="fas fa-folder-open"></i></span><span class="header-nav-menu-item__text">Archivos</span></a></div></div><div class="header-nav-mode"><div class="mode"><div class="mode-track"><span class="mode-track-moon"></span><span class="mode-track-sun"></span></div><div class="mode-thumb"></div></div></div></div></nav><div class="header-banner"><div class="header-banner-info"><div class="header-banner-info__title">蒟蒻的入土史</div><div class="header-banner-info__subtitle"></div></div></div></div></header><main class="main" id="main"><div class="main-inner"><div class="content-wrap" id="content-wrap"><div class="content" id="content"><!-- Just used to judge whether it is an article page--><div id="is-post"></div><div class="post"><header class="post-header"><h1 class="post-title">蒟蒻的挨打之路</h1><div class="post-meta"><span class="post-meta-item post-meta-item--createtime"><span class="post-meta-item__icon"><i class="far fa-calendar-plus"></i></span><span class="post-meta-item__info">Creado</span><span class="post-meta-item__value">2021-08-02</span></span><span class="post-meta-item post-meta-item--updatetime"><span class="post-meta-item__icon"><i class="far fa-calendar-check"></i></span><span class="post-meta-item__info">Actualizado</span><span class="post-meta-item__value">2021-11-10</span></span></div></header><div class="post-body"><p>呜呜呜T_T</p>
<p>记录一下蒟蒻在各大比赛挨打的过程。</p>
<span id="more"></span>

        <h3 id="20211022-省赛复现"   >
          <a href="#20211022-省赛复现" class="heading-link"><i class="fas fa-link"></i></a><a class="markdownIt-Anchor" href="#20211022-省赛复现"></a> 2021.10.22 省赛（复现）</h3>
      

        <h4 id="misc"   >
          <a href="#misc" class="heading-link"><i class="fas fa-link"></i></a><a class="markdownIt-Anchor" href="#misc"></a> misc</h4>
      
<p>附件就一张图片，binwalk没发现啥玩意，最后到处试lsb隐写给试出了一个rar</p>
<img src="/images/2021110613.png" width="50%" height="50%"/>
<p>拔下来的rar发现是损坏的，考虑伪加密，把加密位改回去</p>
<img src="/images/2021110614.png" width="50%" height="50%"/>
<p>这里的0改成4，原本以为没啥问题了，结果这里踩坑了。这里要用官方给的lsb隐写脚本跑出来的rar才是正确的rar。</p>
<p>后面的步骤都很简单了，爆破出加密的rar密码为123321，得到一张图片直接用stegsolve看flag。</p>

        <h3 id="2021830-dasctf复现"   >
          <a href="#2021830-dasctf复现" class="heading-link"><i class="fas fa-link"></i></a><a class="markdownIt-Anchor" href="#2021830-dasctf复现"></a> 2021.8.30 DASCTF（复现）</h3>
      
<p>有俩密码学的题</p>

        <h4 id="crypto"   >
          <a href="#crypto" class="heading-link"><i class="fas fa-link"></i></a><a class="markdownIt-Anchor" href="#crypto"></a> Crypto</h4>
      

        <h5 id="lets-play-with-rsa~"   >
          <a href="#lets-play-with-rsa~" class="heading-link"><i class="fas fa-link"></i></a><a class="markdownIt-Anchor" href="#lets-play-with-rsa~"></a> let’s play with rsa~</h5>
      
<p>附件长这样：</p>
<figure class="highlight python"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sympy <span class="keyword">import</span> isprime,nextprime</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getPrime <span class="keyword">as</span> getprime ,long_to_bytes,bytes_to_long,inverse</span><br><span class="line">flag=<span class="string">&#x27;flag&#123;***************&#125;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">play</span>():</span><br><span class="line">    p=getprime(<span class="number">1024</span>)</span><br><span class="line">    q=getprime(<span class="number">1024</span>)</span><br><span class="line"></span><br><span class="line">    n=p*q</span><br><span class="line">    e=<span class="number">65537</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span> <span class="string">&quot;Hello,let&#x27;s play rsa~\n&quot;</span></span><br><span class="line">    <span class="built_in">print</span> <span class="string">&#x27;Now,I make some numbers,wait a second\n&#x27;</span></span><br><span class="line">    n1=getprime(<span class="number">200</span>)</span><br><span class="line">    n2=getprime(<span class="number">200</span>)</span><br><span class="line">    number=n1*n2</span><br><span class="line">    <span class="built_in">print</span> <span class="string">&quot;Ok,i will send two numbers to you,one of them was encoded.\n&quot;</span></span><br><span class="line">    <span class="built_in">print</span> <span class="string">&quot;Encode n1:%d,\n&quot;</span>%(<span class="built_in">pow</span>(n1,e,n))</span><br><span class="line">    <span class="built_in">print</span> <span class="string">&quot;And n2:%d.\n&quot;</span>%n2</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span> <span class="string">&quot;Information that can now be made public:the public key (n,e):(%d,%d)\n&quot;</span>%(n,e)</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            c=<span class="built_in">int</span>(raw_input(<span class="string">&quot;ok,now,tell me the value of the number (encode it for safe):&quot;</span>))</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="built_in">print</span> <span class="string">&quot;Sorry,the input is illeagal, and the integer is accept~&quot;</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    d=inverse(e,(p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">    m=<span class="built_in">pow</span>(c,d,n)</span><br><span class="line">    <span class="keyword">if</span> m==number:</span><br><span class="line">        <span class="built_in">print</span> <span class="string">&quot;It&#x27;s easy and interesting,didn&#x27;t it?\n&quot;</span></span><br><span class="line">        <span class="built_in">print</span> <span class="string">&quot;This is the gift for you :&quot;</span>+flag</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span> <span class="string">&quot;Emmmmm,there is something wrong, bye~\n&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    play()</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>
<p>数学原理很简单：</p>
<img src="/images/2021083101.jpg" width="80%" height="80%"/>
<p>exp如下：</p>
<figure class="highlight python"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">en_n1 = <span class="number">1309721910589292483737401896023705647211812731131580022207997317781086527420162694426783098998244562068230335429061546502019166975754786167341689047014873958107404120012933517153896824577108373020327789333970129263835075665364474808938834288415903375301139260812397188033692847643071939844953726931774517258280654227664887556336036095280951203307978647462380596353268816595074090830724134701722961596409878278764247168746397167847040206659595961690456943906329271303804282136442317185552336464229518976466931265098174562935244202362365634788701457135344490298509297318209626645153514784129383468209964398541421466276</span></span><br><span class="line">n = <span class="number">12837770558555314064794558480082731445733882018381629916163024669576913542314586587530283320606488797929692460622707042752475883949512350557684519969053352832577190628394534732768969813760882691828041106105916556730296206192621778367752135858508793676525121086890158474077244689335284589013548347756711712889737164840475886374605781536567359597200412748537326979090940986741854313956791578704511827287026891681707519188758403649811968478863567711653557073172575381628473942814925653831626597042079483642684004219931450549540680966665970171852575497645457016481998448325634229033075903634430806140076432661903094828593</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">n2 = <span class="number">1362359474479550927452891208121227746732073198634558158536609</span></span><br><span class="line">c = en_n1 * <span class="built_in">pow</span>(n2,e,n)</span><br><span class="line"><span class="built_in">print</span>(c)</span><br></pre></td></tr></table></div></figure>

        <h5 id="ezrsa"   >
          <a href="#ezrsa" class="heading-link"><i class="fas fa-link"></i></a><a class="markdownIt-Anchor" href="#ezrsa"></a> ezRSA</h5>
      
<p>这题原理和上题类似，附件如下：</p>
<figure class="highlight python"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> getrandbits</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">EzRsa</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        self.E = <span class="number">0x10001</span></span><br><span class="line">        self.P = getPrime(<span class="number">1024</span>)</span><br><span class="line">        self.Q = getPrime(<span class="number">1024</span>)</span><br><span class="line">        <span class="keyword">while</span> GCD((self.P-<span class="number">1</span>)*(self.Q-<span class="number">1</span>), self.E) != <span class="number">1</span>:</span><br><span class="line">            self.Q = getPrime(<span class="number">1024</span>)</span><br><span class="line">        self.N = self.P*self.Q</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">self</span>):</span><br><span class="line">        f = getrandbits(<span class="number">32</span>)</span><br><span class="line">        c = <span class="built_in">pow</span>(f, self.E, self.N)</span><br><span class="line">        <span class="keyword">return</span> (f, c)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">encrypt_flag</span>(<span class="params">self, flag</span>):</span><br><span class="line">        f = bytes_to_long(flag)</span><br><span class="line">        c = <span class="built_in">pow</span>(f, self.E, self.N)</span><br><span class="line">        <span class="keyword">return</span> c</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">proof</span>():</span><br><span class="line">    seed = getrandbits(<span class="number">32</span>)</span><br><span class="line">    <span class="built_in">print</span>(seed)</span><br><span class="line">    sha = sha256(<span class="built_in">str</span>(seed).encode()).hexdigest()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;sha256(<span class="subst">&#123;seed&gt;&gt;<span class="number">18</span>&#125;</span>...).hexdigest() = <span class="subst">&#123;sha&#125;</span>&quot;</span>)</span><br><span class="line">    sha_i = <span class="built_in">input</span>(<span class="string">&quot;plz enter seed: &quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> sha256(sha_i.encode()).hexdigest() != sha:</span><br><span class="line">        exit(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    proof()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;welcome to EzRsa&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    1. Get flag</span></span><br><span class="line"><span class="string">    2. Encrypt</span></span><br><span class="line"><span class="string">    3. Insert</span></span><br><span class="line"><span class="string">    4. Exit</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span>)</span><br><span class="line">    A = EzRsa()</span><br><span class="line">    coin = <span class="number">5</span></span><br><span class="line">    <span class="keyword">while</span> coin &gt; <span class="number">0</span>:</span><br><span class="line">        choose = <span class="built_in">input</span>(<span class="string">&quot;&gt; &quot;</span>)</span><br><span class="line">        <span class="keyword">if</span> choose == <span class="string">&quot;1&quot;</span>:</span><br><span class="line">            <span class="built_in">print</span>(</span><br><span class="line">                <span class="string">f&quot;pow(flag,e,n) = <span class="subst">&#123;A.encrypt_flag(flag)&#125;</span>\ne = 0x10001&quot;</span>)</span><br><span class="line">            exit(<span class="number">0</span>)</span><br><span class="line">        <span class="keyword">elif</span> choose == <span class="string">&quot;2&quot;</span>:</span><br><span class="line">            f, c = A.encrypt()</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;plain = <span class="subst">&#123;f&#125;</span>\ncipher = <span class="subst">&#123;c&#125;</span>&quot;</span>)</span><br><span class="line">            coin -= <span class="number">1</span></span><br><span class="line">        <span class="keyword">elif</span> choose == <span class="string">&quot;3&quot;</span>:</span><br><span class="line">            q = getrandbits(<span class="number">1024</span>)</span><br><span class="line">            n = A.P*q</span><br><span class="line">            f = getrandbits(<span class="number">32</span>)</span><br><span class="line">            c = <span class="built_in">pow</span>(f, <span class="number">0x10001</span>, n)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;plain = <span class="subst">&#123;f&#125;</span>\ncipher = <span class="subst">&#123;c&#125;</span>&quot;</span>)</span><br><span class="line">            coin -= <span class="number">1</span></span><br><span class="line">        <span class="keyword">elif</span> choose == <span class="string">&quot;4&quot;</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;bye~&quot;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;wrong input&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Now you get the flag right?&quot;</span>)</span><br></pre></td></tr></table></div></figure>
<p>给了5次机会(coin)，2和3选项分别能得到n和p，数学原理如下：</p>
<img src="/images/2021083102.jpg" width="80%" height="80%"/>
<p>exp如下：</p>
<p>选项2和3各选两次拿数据，最后一次拿flag的数据</p>
<figure class="highlight python"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> *</span><br><span class="line"><span class="comment">#from math import *</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line">f1 = <span class="number">3991424584</span></span><br><span class="line">c1 = <span class="number">23299859078129861414913771548219349721900206664014819386195794916044845964332637389648259329302749550436346202286946048713385410408064459859081918493047190943298495292861013654519793379809752456534138428868643899609668723735710829524825269361397275459708970559074552900236486895513774078684184834805376606088247533387016219365170743668987289463976754247014480713302197196568222170824912241303970513628344421242260649810302948949131617868038594231101232079019013330304215113673368314368833706712612127152921982153341480322701194423727871123662394240685540736238634699368430418964615398086626177026843559305313991443227</span></span><br><span class="line">f2 = <span class="number">3302952139</span></span><br><span class="line">c2 = <span class="number">16135167708023658331902606113227526506624892717052237702988935145355289623080800253295795703695347360875254861269833966623609514382014163433041295324806175024336762186717776686444629275737425480610600987793377115715370987547355442485973887920207336811930557011003908778677685189445607074026451925553282013998440786813828560563175818728704616901557779531236686737383795809573571053296171873412845580984730014998699951618614567444985737702781759475230163602992352950497827705875149910442039431153623052044891404971539003392860077134760784914141313151742913299690411764314019909465761008921434322476865096137861232855781</span></span><br><span class="line">n = gmpy2.gcd(<span class="built_in">pow</span>(f1,e) - c1,<span class="built_in">pow</span>(f2,e) - c2)</span><br><span class="line"><span class="built_in">print</span>(n)</span><br><span class="line">c3 = <span class="number">290608034256274369700862715363350323486028744781731905934249350715041586859408919647347827785586727942092508209115402506051655157392015883300023889210219576419324704609311096050860136030302584481540004322444602941867627050991572899014259628993547816246063508914512684313837142913444152620481715232869398984200565254080136273801468740882064342549655664616243374405422083085368533066537431942688830581503260516034879177548907813082280973258211700086334417911908732693940787281869354657664111312741521516275861135779300654363453173656735944975815042979883029464520576788180760677023541130131734670871708628401566092056</span></span><br><span class="line">c4 = <span class="number">19477721821886525117440143496319431500495385071913979141466226040526802160059201844862618364367741954042703804931248758421694329933382467780307210147901496300326789151918308642829330627052858106511054852272266315174702986664133983456742201333616464739367956812505831108567707073824178369443747106670498181714026256534321719627886311877207237167881226028217405406516689294193625979523781236934797180792371554750209628867494205548515578343356570418434460849979994288195296861844688172042575939423362750874494740696017989524225414610737548788064086913880409416592656292914866756979555717165005851927596841150843763549837</span></span><br><span class="line">f3 = <span class="number">790182690</span></span><br><span class="line">f4 = <span class="number">2129564814</span></span><br><span class="line">p = gmpy2.gcd(<span class="built_in">pow</span>(f3,e) - c3,<span class="built_in">pow</span>(f4,e) - c4)</span><br><span class="line">q = n // p</span><br><span class="line">c = <span class="number">24952279514997224947101022682449626128048315926803834959283021867551136554920048640317181593937537055086263973539743885388583210115706780021523202021772462316835425921121320529162432793833128629912344112656578819828486682363773819631694824476713219629652576476637315910977274832345854578059628785051135439346323100743046829886707064789413910491823509991850949661231750479103393176692414195918532925181456936717164879556950696080788364971454803842425311834060331270850687515410797773548975263226563726398807177996001159332682433166744595590323697981578101554722234248005684614174799841980158652033235878038837817713173</span></span><br><span class="line">phi = (p - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line">d = gmpy2.invert(e,phi)</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></div></figure>

        <h3 id="2021823-祥云杯"   >
          <a href="#2021823-祥云杯" class="heading-link"><i class="fas fa-link"></i></a><a class="markdownIt-Anchor" href="#2021823-祥云杯"></a> 2021.8.23 祥云杯</h3>
      
<p>做了两个题，分最低的俩，呜呜呜,提取密码都是GAME</p>

        <h4 id="misc-2"   >
          <a href="#misc-2" class="heading-link"><i class="fas fa-link"></i></a><a class="markdownIt-Anchor" href="#misc-2"></a> Misc</h4>
      

        <h5 id="鸣雏恋-a-hrefhttpspanbaiducoms1grmatfkilnyuc0s4xbq7aw-target_blank附件下载a"   >
          <a href="#鸣雏恋-a-hrefhttpspanbaiducoms1grmatfkilnyuc0s4xbq7aw-target_blank附件下载a" class="heading-link"><i class="fas fa-link"></i></a><a class="markdownIt-Anchor" href="#鸣雏恋-a-hrefhttpspanbaiducoms1grmatfkilnyuc0s4xbq7aw-target_blank附件下载a"></a> 鸣雏恋 <span class="exturl"><a class="exturl__link"   href="https://pan.baidu.com/s/1grMATfKILnyUc0s4Xbq7Aw"  target="_blank">附件下载</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></h5>
      
<p>下载下来一个60多M的docx，改后缀zip翻到了_rels里面的key.txt和love.zip，key.txt是零宽隐写，<span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="http://330k.github.io/misc_tools/unicode_steganography.html" >解密网站</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span>，直接全部复制进去出来的就是love.zip的密码。</p>
<img src="/images/2021082301.png" width="80%" height="80%"/>
<p>love.zip里面只有两种图片，盲猜是二进制之后转ascii，图片太多写脚本跑。</p>
<figure class="highlight python"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line">ans = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">129488</span>):</span><br><span class="line">    filename = <span class="built_in">str</span>(i) + <span class="string">&#x27;.png&#x27;</span></span><br><span class="line">    fsize = os.path.getsize(filename)</span><br><span class="line">    <span class="keyword">if</span> fsize &gt; <span class="number">300</span>:</span><br><span class="line">        ans += <span class="string">&#x27;1&#x27;</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        ans += <span class="string">&#x27;0&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(ans)</span><br></pre></td></tr></table></div></figure>
<p>一种262字节一种435字节，用300为界限划分，出来的二进制码转ascii，发现是base64的图片编码，拿去解码就得到了flag</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;57dd74fb21bb1aee50f19421bf836f23&#125;</span><br></pre></td></tr></table></div></figure>

        <h4 id="crypto-2"   >
          <a href="#crypto-2" class="heading-link"><i class="fas fa-link"></i></a><a class="markdownIt-Anchor" href="#crypto-2"></a> Crypto</h4>
      

        <h5 id="random_rsa-a-hrefhttpspanbaiducoms1g0bbro0eq_p5jgbyjew2yq-target_blank附件下载a"   >
          <a href="#random_rsa-a-hrefhttpspanbaiducoms1g0bbro0eq_p5jgbyjew2yq-target_blank附件下载a" class="heading-link"><i class="fas fa-link"></i></a><a class="markdownIt-Anchor" href="#random_rsa-a-hrefhttpspanbaiducoms1g0bbro0eq_p5jgbyjew2yq-target_blank附件下载a"></a> Random_RSA <span class="exturl"><a class="exturl__link"   href="https://pan.baidu.com/s/1G0BbRo0Eq_p5jgByJEw2yQ"  target="_blank">附件下载</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></h5>
      
<p>第一次在大比赛里面做出rsa的题,这题加密算法不难理解,题目贴一下反正不大,print的数据都给了.</p>
<figure class="highlight python"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">flag=<span class="string">r&#x27;flag&#123;&#125;&#x27;</span></span><br><span class="line"></span><br><span class="line">p=getPrime(<span class="number">512</span>)</span><br><span class="line">q=getPrime(<span class="number">512</span>)</span><br><span class="line">e=<span class="number">0x10001</span></span><br><span class="line">n=p*q</span><br><span class="line">ct=<span class="built_in">pow</span>(flag,e,n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;n=&quot;</span>+ n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;ct=&quot;</span>+ ct)</span><br><span class="line"></span><br><span class="line">dp=<span class="string">r&#x27;&#x27;</span></span><br><span class="line">seeds = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(dp)):</span><br><span class="line">    seeds.append(random.randint(<span class="number">0</span>,<span class="number">10000</span>))</span><br><span class="line"></span><br><span class="line">res = [] </span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(dp)):</span><br><span class="line">    random.seed(seeds[i])</span><br><span class="line">    rands = []</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">4</span>):</span><br><span class="line">        rands.append(random.randint(<span class="number">0</span>,<span class="number">255</span>))</span><br><span class="line"></span><br><span class="line">    res.append(<span class="built_in">ord</span>(dp[i]) ^ rands[i%<span class="number">4</span>])</span><br><span class="line">    <span class="keyword">del</span> rands[i%<span class="number">4</span>]</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">str</span>(rands))</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(res) </span><br><span class="line"><span class="built_in">print</span>(seeds)</span><br></pre></td></tr></table></div></figure>
<p>没有给dp,应该是要我们求.告诉了dp是多少位的,和seeds是一样的154位,程序是把dp的每一位,异或加密了,生成的seeds是随机的题目也给了,根据这个seeds去生成随机数来对dp的每一位进行异或加密,一开始<strong>用python3跑出来的rands是错的</strong>,<strong>特地装了个python2</strong>去跑了个随机数.</p>
<p>得到正确的rands之后拿去解密dp,脚本如下</p>
<figure class="highlight python"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">dp = []</span><br><span class="line">ans = [<span class="number">2</span>, <span class="number">54</span>, <span class="number">128</span>, <span class="number">242</span>, <span class="number">87</span>, <span class="number">16</span>, <span class="number">228</span>, <span class="number">64</span>, <span class="number">84</span>, <span class="number">78</span>, <span class="number">71</span>, <span class="number">0</span>, <span class="number">73</span>, <span class="number">160</span>, <span class="number">128</span>, <span class="number">200</span>, <span class="number">124</span>, <span class="number">165</span>, <span class="number">114</span>, <span class="number">2</span>, <span class="number">241</span>, <span class="number">124</span>, <span class="number">118</span>, <span class="number">52</span>, <span class="number">127</span>, <span class="number">193</span>, <span class="number">142</span>, <span class="number">35</span>, <span class="number">230</span>, <span class="number">138</span>, <span class="number">5</span>, <span class="number">135</span>, <span class="number">40</span>, <span class="number">188</span>, <span class="number">28</span>, <span class="number">108</span>, <span class="number">167</span>, <span class="number">207</span>, <span class="number">166</span>, <span class="number">181</span>, <span class="number">127</span>, <span class="number">51</span>, <span class="number">168</span>, <span class="number">146</span>, <span class="number">168</span>, <span class="number">204</span>, <span class="number">62</span>, <span class="number">134</span>, <span class="number">37</span>, <span class="number">219</span>, <span class="number">234</span>, <span class="number">255</span>, <span class="number">50</span>, <span class="number">117</span>, <span class="number">194</span>, <span class="number">243</span>, <span class="number">124</span>, <span class="number">137</span>, <span class="number">221</span>, <span class="number">88</span>, <span class="number">188</span>, <span class="number">191</span>, <span class="number">143</span>, <span class="number">122</span>, <span class="number">49</span>, <span class="number">64</span>, <span class="number">143</span>, <span class="number">8</span>, <span class="number">190</span>, <span class="number">184</span>, <span class="number">85</span>, <span class="number">102</span>, <span class="number">236</span>, <span class="number">196</span>, <span class="number">34</span>, <span class="number">183</span>, <span class="number">207</span>, <span class="number">157</span>, <span class="number">160</span>, <span class="number">79</span>, <span class="number">153</span>, <span class="number">202</span>, <span class="number">184</span>, <span class="number">244</span>, <span class="number">157</span>, <span class="number">48</span>, <span class="number">211</span>, <span class="number">255</span>, <span class="number">113</span>, <span class="number">58</span>, <span class="number">117</span>, <span class="number">131</span>, <span class="number">33</span>, <span class="number">36</span>, <span class="number">246</span>, <span class="number">250</span>, <span class="number">85</span>, <span class="number">41</span>, <span class="number">203</span>, <span class="number">101</span>, <span class="number">189</span>, <span class="number">50</span>, <span class="number">81</span>, <span class="number">127</span>, <span class="number">233</span>, <span class="number">114</span>, <span class="number">233</span>, <span class="number">251</span>, <span class="number">118</span>, <span class="number">137</span>, <span class="number">76</span>, <span class="number">61</span>, <span class="number">158</span>, <span class="number">144</span>, <span class="number">233</span>, <span class="number">80</span>, <span class="number">169</span>, <span class="number">174</span>, <span class="number">1</span>, <span class="number">172</span>, <span class="number">4</span>, <span class="number">176</span>, <span class="number">137</span>, <span class="number">255</span>, <span class="number">186</span>, <span class="number">244</span>, <span class="number">28</span>, <span class="number">17</span>, <span class="number">12</span>, <span class="number">55</span>, <span class="number">246</span>, <span class="number">235</span>, <span class="number">127</span>, <span class="number">167</span>, <span class="number">114</span>, <span class="number">154</span>, <span class="number">151</span>, <span class="number">235</span>, <span class="number">155</span>, <span class="number">39</span>, <span class="number">252</span>, <span class="number">83</span>, <span class="number">87</span>, <span class="number">97</span>, <span class="number">255</span>, <span class="number">47</span>, <span class="number">14</span>, <span class="number">143</span>, <span class="number">28</span>, <span class="number">176</span>, <span class="number">164</span>, <span class="number">235</span>, <span class="number">35</span>, <span class="number">102</span>]</span><br><span class="line">res = [<span class="number">55</span>, <span class="number">5</span>, <span class="number">183</span>, <span class="number">192</span>, <span class="number">103</span>, <span class="number">32</span>, <span class="number">211</span>, <span class="number">116</span>, <span class="number">102</span>, <span class="number">120</span>, <span class="number">118</span>, <span class="number">54</span>, <span class="number">120</span>, <span class="number">145</span>, <span class="number">185</span>, <span class="number">254</span>, <span class="number">77</span>, <span class="number">144</span>, <span class="number">70</span>, <span class="number">54</span>, <span class="number">193</span>, <span class="number">73</span>, <span class="number">64</span>, <span class="number">0</span>, <span class="number">79</span>, <span class="number">244</span>, <span class="number">190</span>, <span class="number">23</span>, <span class="number">215</span>, <span class="number">187</span>, <span class="number">53</span>, <span class="number">176</span>, <span class="number">27</span>, <span class="number">138</span>, <span class="number">42</span>, <span class="number">89</span>, <span class="number">158</span>, <span class="number">254</span>, <span class="number">159</span>, <span class="number">133</span>, <span class="number">78</span>, <span class="number">11</span>, <span class="number">155</span>, <span class="number">163</span>, <span class="number">145</span>, <span class="number">248</span>, <span class="number">14</span>, <span class="number">179</span>, <span class="number">23</span>, <span class="number">226</span>, <span class="number">220</span>, <span class="number">201</span>, <span class="number">5</span>, <span class="number">71</span>, <span class="number">241</span>, <span class="number">195</span>, <span class="number">75</span>, <span class="number">191</span>, <span class="number">237</span>, <span class="number">108</span>, <span class="number">141</span>, <span class="number">141</span>, <span class="number">185</span>, <span class="number">76</span>, <span class="number">7</span>, <span class="number">113</span>, <span class="number">191</span>, <span class="number">48</span>, <span class="number">135</span>, <span class="number">139</span>, <span class="number">100</span>, <span class="number">83</span>, <span class="number">212</span>, <span class="number">242</span>, <span class="number">21</span>, <span class="number">143</span>, <span class="number">255</span>, <span class="number">164</span>, <span class="number">146</span>, <span class="number">119</span>, <span class="number">173</span>, <span class="number">255</span>, <span class="number">140</span>, <span class="number">193</span>, <span class="number">173</span>, <span class="number">2</span>, <span class="number">224</span>, <span class="number">205</span>, <span class="number">68</span>, <span class="number">10</span>, <span class="number">77</span>, <span class="number">180</span>, <span class="number">24</span>, <span class="number">23</span>, <span class="number">196</span>, <span class="number">205</span>, <span class="number">108</span>, <span class="number">28</span>, <span class="number">243</span>, <span class="number">80</span>, <span class="number">140</span>, <span class="number">4</span>, <span class="number">98</span>, <span class="number">76</span>, <span class="number">217</span>, <span class="number">70</span>, <span class="number">208</span>, <span class="number">202</span>, <span class="number">78</span>, <span class="number">177</span>, <span class="number">124</span>, <span class="number">10</span>, <span class="number">168</span>, <span class="number">165</span>, <span class="number">223</span>, <span class="number">105</span>, <span class="number">157</span>, <span class="number">152</span>, <span class="number">48</span>, <span class="number">152</span>, <span class="number">51</span>, <span class="number">133</span>, <span class="number">190</span>, <span class="number">202</span>, <span class="number">136</span>, <span class="number">204</span>, <span class="number">44</span>, <span class="number">33</span>, <span class="number">58</span>, <span class="number">4</span>, <span class="number">196</span>, <span class="number">219</span>, <span class="number">71</span>, <span class="number">150</span>, <span class="number">68</span>, <span class="number">162</span>, <span class="number">175</span>, <span class="number">218</span>, <span class="number">173</span>, <span class="number">19</span>, <span class="number">201</span>, <span class="number">100</span>, <span class="number">100</span>, <span class="number">85</span>, <span class="number">201</span>, <span class="number">24</span>, <span class="number">59</span>, <span class="number">186</span>, <span class="number">46</span>, <span class="number">130</span>, <span class="number">147</span>, <span class="number">219</span>, <span class="number">22</span>, <span class="number">81</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(res)):</span><br><span class="line">    dp.append(<span class="built_in">chr</span>(res[i] ^ ans[i]))</span><br><span class="line">dp = <span class="string">&#x27;&#x27;</span>.join(dp)</span><br><span class="line"><span class="built_in">print</span>(dp)</span><br></pre></td></tr></table></div></figure>
<p>得到dp之后,就是一个简单的dp泄露题了,拿模板去套.(模板是la佬的 磕头)</p>
<figure class="highlight python"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2 <span class="keyword">as</span> gp</span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line">n = <span class="number">81196282992606113591233615204680597645208562279327854026981376917977843644855180528227037752692498558370026353244981467900057157997462760732019372185955846507977456657760125682125104309241802108853618468491463326268016450119817181368743376919334016359137566652069490881871670703767378496685419790016705210391</span></span><br><span class="line">dp = <span class="number">5372007426161196154405640504110736659190183194052966723076041266610893158678092845450232508793279585163304918807656946147575280063208168816457346755227057</span></span><br><span class="line">c = <span class="number">61505256223993349534474550877787675500827332878941621261477860880689799960938202020614342208518869582019307850789493701589309453566095881294166336673487909221860641809622524813959284722285069755310890972255545436989082654705098907006694780949725756312169019688455553997031840488852954588581160550377081811151</span></span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, e):</span><br><span class="line">	<span class="keyword">if</span>(e*dp%x==<span class="number">1</span>):</span><br><span class="line">		p=(e*dp-<span class="number">1</span>)//x+<span class="number">1</span></span><br><span class="line">		<span class="keyword">if</span>(n%p!=<span class="number">0</span>):</span><br><span class="line">			<span class="keyword">continue</span></span><br><span class="line">		q=n//p</span><br><span class="line">		phin=(p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">		d=gp.invert(e, phin)</span><br><span class="line">		m=gp.powmod(c, d, n)</span><br><span class="line">		<span class="keyword">if</span>(<span class="built_in">len</span>(<span class="built_in">hex</span>(m)[<span class="number">2</span>:])%<span class="number">2</span>==<span class="number">1</span>):</span><br><span class="line">			<span class="keyword">continue</span></span><br><span class="line">		<span class="built_in">print</span>(<span class="string">&#x27;--------------&#x27;</span>)</span><br><span class="line">		<span class="built_in">print</span>(m)</span><br><span class="line">		<span class="built_in">print</span>(<span class="built_in">hex</span>(m)[<span class="number">2</span>:])</span><br><span class="line">		<span class="built_in">print</span>(<span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(m)[<span class="number">2</span>:]))</span><br></pre></td></tr></table></div></figure>

        <h3 id="2021731-dasctf"   >
          <a href="#2021731-dasctf" class="heading-link"><i class="fas fa-link"></i></a><a class="markdownIt-Anchor" href="#2021731-dasctf"></a> 2021.7.31 DASCTF</h3>
      
<p>菜鸡想吐槽：肝了半天的题目都成200分了，果然我是最菜的。</p>

        <h4 id="misc-3"   >
          <a href="#misc-3" class="heading-link"><i class="fas fa-link"></i></a><a class="markdownIt-Anchor" href="#misc-3"></a> Misc</h4>
      

        <h5 id="red_vs_blue-传送门"   >
          <a href="#red_vs_blue-传送门" class="heading-link"><i class="fas fa-link"></i></a><a class="markdownIt-Anchor" href="#red_vs_blue-传送门"></a> red_vs_blue <span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://buuoj.cn/plugins/ctfd-matches/matches/15/challenges#red_vs_blue" >传送门</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></h5>
      
<p>题目要nc连接，思路很简单，就是nc连上之后，有66个结果随机选择哪一个队，选择错了就退回到第一关，要连续选择正确66个结果。</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">root@tsuppari:/home/tsuppari# nc node4.buuoj.cn 27935</span><br><span class="line">Here are 66 AWD Games will begin!</span><br><span class="line">The winner is between Red Team and Blue Team</span><br><span class="line">To get the flag if you predict the results of all games successfully!</span><br><span class="line">Game 1</span><br><span class="line">choose one [r] Red Team,[b] Blue Team:</span><br><span class="line">r</span><br><span class="line">Your choice Red Team</span><br><span class="line">The result Blue Team</span><br><span class="line">Sorry!You are wrong!</span><br><span class="line">Play again? (y/n): y</span><br></pre></td></tr></table></div></figure>
<p>每次nc进入，66个结果都是一样的，所以直接写脚本跑。19行代码蒟蒻改来改去写了一个钟头。还是太fw了。就是一个不断试错暴力破解的过程。</p>
<figure class="highlight python"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">r = remote(<span class="string">&#x27;node4.buuoj.cn&#x27;</span>,<span class="number">27935</span>)</span><br><span class="line">context.log_level=<span class="string">&#x27;debug&#x27;</span></span><br><span class="line">ans = []</span><br><span class="line">r.recvuntil(<span class="string">b&#x27;To get the flag if you predict the results of all games successfully!\n&#x27;</span>)</span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    r.recvuntil(<span class="string">b&#x27;choose one [r] Red Team,[b] Blue Team:\n&#x27;</span>)</span><br><span class="line">    r.sendline(<span class="string">b&#x27;r&#x27;</span>)</span><br><span class="line">    r.recvline()</span><br><span class="line">    result = r.recvline()<span class="comment">#接受第二行的结果</span></span><br><span class="line">    <span class="keyword">if</span> <span class="string">b&#x27;Blue&#x27;</span> <span class="keyword">in</span> result:</span><br><span class="line">        ans.append(<span class="string">b&#x27;b&#x27;</span>)</span><br><span class="line">        r.recv()</span><br><span class="line">        r.sendline(<span class="string">b&#x27;y&#x27;</span>)</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> ans:</span><br><span class="line">            r.recvuntil(<span class="string">b&#x27;choose one [r] Red Team,[b] Blue Team:\n&#x27;</span>)</span><br><span class="line">            r.sendline(i)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        ans.append(<span class="string">b&#x27;r&#x27;</span>)</span><br></pre></td></tr></table></div></figure>

        <h5 id="funny_maze-传送门"   >
          <a href="#funny_maze-传送门" class="heading-link"><i class="fas fa-link"></i></a><a class="markdownIt-Anchor" href="#funny_maze-传送门"></a> funny_maze <span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://buuoj.cn/plugins/ctfd-matches/matches/15/challenges#funny_maze" >传送门</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></h5>
      
<p>题目也是nc连接，连上去有3个选择，2没啥用，3介绍游戏规则，就是在10s之内计算出从起点走到终点的路径，超过了10s就会出timeout。如果是最短路径下面的脚本就得改一改，反正思路是一样的都是dfs(深搜)，oier的必修之路。</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">root@tsuppari:/home/tsuppari# nc node4.buuoj.cn 27619                                            </span><br><span class="line">                                                                                                 </span><br><span class="line">Hello! Welcome to my maze, You can choose 1, 2 or 3.                                             </span><br><span class="line">1.Start, and You only have three seconds to complete the level.</span><br><span class="line">2.Hint! I need Hint!</span><br><span class="line">3.Introduction to this game</span><br><span class="line">1</span><br><span class="line">###########</span><br><span class="line"># # #   # E</span><br><span class="line"># # # ### #</span><br><span class="line">#         #</span><br><span class="line"># # # #####</span><br><span class="line"># # # #   #</span><br><span class="line"># # # ### #</span><br><span class="line"># # #   # #</span><br><span class="line"># ##### # #</span><br><span class="line">S #       #</span><br><span class="line">###########</span><br><span class="line">Please enter your answer:</span><br><span class="line"></span><br><span class="line">time out!!!root@tsuppari:/home/tsuppari#</span><br></pre></td></tr></table></div></figure>
<p>一个简单的dfs脚本，60多行代码改了2个钟头，写脚本能力太弱了。</p>
<figure class="highlight python"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">r = remote(<span class="string">&#x27;node4.buuoj.cn&#x27;</span>,<span class="number">27619</span>)</span><br><span class="line">context.log_level=<span class="string">&#x27;debug&#x27;</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">dfs</span>(<span class="params">start_x,start_y</span>):</span><br><span class="line">    x1 = start_x</span><br><span class="line">    y1 = start_y - <span class="number">1</span></span><br><span class="line">    x2 = start_x + <span class="number">1</span></span><br><span class="line">    y2 = start_y</span><br><span class="line">    x3 = start_x</span><br><span class="line">    y3 = start_y + <span class="number">1</span></span><br><span class="line">    x4 = start_x - <span class="number">1</span></span><br><span class="line">    y4 = start_y</span><br><span class="line">    <span class="keyword">if</span> x1 &gt;= <span class="number">0</span> <span class="keyword">and</span> x1 &lt;= height:<span class="comment">#越界处理</span></span><br><span class="line">        <span class="keyword">if</span> y1 &gt;= <span class="number">0</span> <span class="keyword">and</span> y1 &lt;= width-<span class="number">1</span>:</span><br><span class="line">            <span class="keyword">if</span> maze[x1][y1] == <span class="number">0</span> :</span><br><span class="line">                maze[x1][y1] += maze[start_x][start_y] + <span class="number">1</span></span><br><span class="line">                dfs(x1,y1)</span><br><span class="line">    <span class="keyword">if</span> x2 &gt;= <span class="number">0</span> <span class="keyword">and</span> x2 &lt;= height-<span class="number">1</span>:</span><br><span class="line">        <span class="keyword">if</span> y2 &gt;= <span class="number">0</span> <span class="keyword">and</span> y2 &lt;= width-<span class="number">1</span>:</span><br><span class="line">            <span class="keyword">if</span> maze[x2][y2] == <span class="number">0</span> :</span><br><span class="line">                maze[x2][y2] += maze[start_x][start_y] + <span class="number">1</span></span><br><span class="line">                dfs(x2,y2)</span><br><span class="line">    <span class="keyword">if</span> x3 &gt;= <span class="number">0</span> <span class="keyword">and</span> x3 &lt;= height-<span class="number">1</span>:</span><br><span class="line">        <span class="keyword">if</span> y3 &gt;= <span class="number">0</span> <span class="keyword">and</span> y3 &lt;= width-<span class="number">1</span>:</span><br><span class="line">            <span class="keyword">if</span> maze[x3][y3] == <span class="number">0</span> :</span><br><span class="line">                maze[x3][y3] += maze[start_x][start_y] + <span class="number">1</span></span><br><span class="line">                dfs(x3,y3)</span><br><span class="line">    <span class="keyword">if</span> x4 &gt;= <span class="number">0</span> <span class="keyword">and</span> x4 &lt;= height-<span class="number">1</span>:</span><br><span class="line">        <span class="keyword">if</span> y4 &gt;= <span class="number">0</span> <span class="keyword">and</span> y4 &lt;= width-<span class="number">1</span>:</span><br><span class="line">            <span class="keyword">if</span> maze[x4][y4] == <span class="number">0</span> :</span><br><span class="line">                maze[x4][y4] += maze[start_x][start_y] + <span class="number">1</span></span><br><span class="line">                dfs(x4,y4)</span><br><span class="line">r.recv()</span><br><span class="line">r.sendline(<span class="string">b&#x27;1&#x27;</span>)</span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    maze = r.recvuntil(<span class="string">b&#x27;Please enter your answer:\n&#x27;</span>).splitlines()[:-<span class="number">1</span>]</span><br><span class="line">    height = <span class="built_in">len</span>(maze)</span><br><span class="line">    width = <span class="built_in">len</span>(maze[<span class="number">0</span>])</span><br><span class="line">    start_x = <span class="number">0</span></span><br><span class="line">    start_y = <span class="number">0</span></span><br><span class="line">    end_x = <span class="number">0</span></span><br><span class="line">    end_y = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(height):</span><br><span class="line">        maze[i] = <span class="built_in">list</span>(maze[i])</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(width):</span><br><span class="line">            <span class="keyword">if</span> maze[i][j] == <span class="number">32</span>:</span><br><span class="line">                maze[i][j] = <span class="number">0</span><span class="comment">#空地设置成0</span></span><br><span class="line">            <span class="keyword">if</span> maze[i][j] == <span class="number">35</span>:</span><br><span class="line">                maze[i][j] = -<span class="number">1</span><span class="comment">#障碍物设置成-1</span></span><br><span class="line">            <span class="keyword">if</span> maze[i][j] == <span class="number">69</span>:</span><br><span class="line">                maze[i][j] = <span class="number">0</span><span class="comment">#标记为终点位置</span></span><br><span class="line">                end_x = i</span><br><span class="line">                end_y = j</span><br><span class="line">            <span class="keyword">if</span> maze[i][j] == <span class="number">83</span>:</span><br><span class="line">                maze[i][j] = <span class="number">1</span><span class="comment">#标记起点的位置</span></span><br><span class="line">                start_x = i</span><br><span class="line">                start_y = j</span><br><span class="line"></span><br><span class="line">    dfs(start_x,start_y)</span><br><span class="line">    ans = maze[end_x][end_y]</span><br><span class="line">    ans = <span class="built_in">str</span>(ans)</span><br><span class="line">    r.sendline(ans.encode())</span><br><span class="line">    r.recv()</span><br></pre></td></tr></table></div></figure>
<p>DASCTF的比赛自己做出来的就2个题😔，后面会复现一下pwn。</p>

        <h3 id="2021515-ciscn"   >
          <a href="#2021515-ciscn" class="heading-link"><i class="fas fa-link"></i></a><a class="markdownIt-Anchor" href="#2021515-ciscn"></a> 2021.5.15 ciscn</h3>
      

        <h4 id="misc-4"   >
          <a href="#misc-4" class="heading-link"><i class="fas fa-link"></i></a><a class="markdownIt-Anchor" href="#misc-4"></a> Misc</h4>
      

        <h5 id="隔空传话"   >
          <a href="#隔空传话" class="heading-link"><i class="fas fa-link"></i></a><a class="markdownIt-Anchor" href="#隔空传话"></a> 隔空传话</h5>
      
<p>下载下来一个data.txt，一堆数字与字符，查找后发现这是<span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="http://www.sendsms.cn/pdu/" >PDU短信的编码</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span>，前面四句话与后面几句话不一样，前四句话翻译如下。</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">hello,bob!what is the flag?</span><br><span class="line"></span><br><span class="line">the first part of the flag is the first 8 digits of your phone number</span><br><span class="line"></span><br><span class="line">那其他部分呢</span><br><span class="line"></span><br><span class="line">看看你能从这些数据里发现什么？w465</span><br><span class="line"></span><br><span class="line">Receipient:+861503044200</span><br></pre></td></tr></table></div></figure>
<p>flag前8位为15030442，后面的PDU翻译过来都是16进制字符串，且发送的时间都不相同。于是写脚本进网站翻译。</p>
<figure class="highlight python"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;data.txt&#x27;</span>,<span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f:<span class="comment">#data.txt为下载下来的文件，删去了前4行</span></span><br><span class="line">    data = f.read()</span><br><span class="line">data = data.splitlines()</span><br><span class="line">browser = webdriver.Chrome(<span class="string">&#x27;C:\Program Files\Google\Chrome\Application\chromedriver.exe&#x27;</span>)</span><br><span class="line">url = <span class="string">&quot;http://www.sendsms.cn/pdu/&quot;</span></span><br><span class="line">browser.get(url)</span><br><span class="line">output = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> data:</span><br><span class="line">    browser.find_element_by_name(<span class="string">&quot;smsText2&quot;</span>).clear()</span><br><span class="line">    browser.find_element_by_name(<span class="string">&quot;smsText2&quot;</span>).send_keys(i)</span><br><span class="line">    browser.find_element_by_xpath(<span class="string">&quot;//input[@name=&#x27;checkButton&#x27;]&quot;</span>).click()</span><br><span class="line">    recv = browser.find_element_by_name(<span class="string">&quot;smsOut&quot;</span>).get_attribute(<span class="string">&#x27;value&#x27;</span>)</span><br><span class="line">    recv = recv.split()</span><br><span class="line">    n = <span class="number">0</span></span><br><span class="line">    txt = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> recv:<span class="comment">#循环之后的 txt 为 短信时间+16进制码</span></span><br><span class="line">        <span class="keyword">if</span> n == <span class="number">3</span>:</span><br><span class="line">            txt += j</span><br><span class="line">        <span class="keyword">if</span> n == <span class="number">13</span>:</span><br><span class="line">            txt += j</span><br><span class="line">            txt += <span class="string">&#x27;\n&#x27;</span></span><br><span class="line">        n += <span class="number">1</span></span><br><span class="line">    output += txt</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;out.txt&#x27;</span>,<span class="string">&#x27;w&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f.write(output)</span><br><span class="line">browser.quit()</span><br></pre></td></tr></table></div></figure>
<p>小破脚本跑了很久，最后得到的out.txt如下：</p>
<img src="/images/2021051601.png" width="40%" height="40%"/>
<p>按照时间排序，用脚本排序，脚本如下：</p>
<figure class="highlight python"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;out.txt&#x27;</span>,<span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    data = f.read()</span><br><span class="line">data = data.splitlines()</span><br><span class="line">n1 = []</span><br><span class="line">n2 = []</span><br><span class="line">output = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> data:</span><br><span class="line">    time = i[:<span class="number">8</span>]</span><br><span class="line">    txt = i[<span class="number">8</span>:]</span><br><span class="line">    minute = <span class="built_in">int</span>(time[<span class="number">3</span>:<span class="number">5</span>])</span><br><span class="line">    sec = <span class="built_in">int</span>(time[<span class="number">6</span>:<span class="number">8</span>])</span><br><span class="line">    num = minute*<span class="number">60</span>+sec</span><br><span class="line">    n1.append(num)</span><br><span class="line">    n2.append(txt)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">5000</span>):<span class="comment">#排序输出</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(data)):</span><br><span class="line">        <span class="keyword">if</span> i == n1[j]:</span><br><span class="line">            output += n2[j]</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;output.txt&#x27;</span>,<span class="string">&#x27;w&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f.write(output)</span><br></pre></td></tr></table></div></figure>
<p>发现文件output.txt的开头89504e47是png文件头，但是宽被修改过，联系前面的信息：w465，可猜测宽为465，于是得到图片</p>
<img src="/images/2021051602.png" width="40%" height="40%"/>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CISCN&#123;15030442_b586_4c9e_b436_26def12293e4&#125;</span><br></pre></td></tr></table></div></figure>

        <h3 id="202159-redhat"   >
          <a href="#202159-redhat" class="heading-link"><i class="fas fa-link"></i></a><a class="markdownIt-Anchor" href="#202159-redhat"></a> 2021.5.9 <span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://race.ichunqiu.com/2021redhat" >redhat</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></h3>
      

        <h4 id="misc-5"   >
          <a href="#misc-5" class="heading-link"><i class="fas fa-link"></i></a><a class="markdownIt-Anchor" href="#misc-5"></a> Misc</h4>
      

        <h5 id="签到"   >
          <a href="#签到" class="heading-link"><i class="fas fa-link"></i></a><a class="markdownIt-Anchor" href="#签到"></a> 签到</h5>
      
<p>下载下来一个EBCDIC.txt，作为一个合格的萌新，直接把EBCDIC拿去Google</p>
<img src="/images/2021051202.png" width="40%" height="40%"/>
<img src="/images/2021051201.png" width="40%" height="40%"/>
<p>当时打比赛的时候我是对着这张表一个一个手动翻译，时间也不长2分钟就好了。后面看了别的大佬的blog发现可以用Linux自带的dd命令解出，或者是用010。</p>
<img src="/images/2021051203.png" width="40%" height="40%"/>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;we1c0me_t0_redhat2021&#125;</span><br></pre></td></tr></table></div></figure>

        <h5 id="colorful_code"   >
          <a href="#colorful_code" class="heading-link"><i class="fas fa-link"></i></a><a class="markdownIt-Anchor" href="#colorful_code"></a> colorful_code</h5>
      
<p>下载下来两个文件data1，data2。</p>
<p><strong>思路：仔细观察data1，文件大小有15kb，data2只有1kb.查看data2，其中后面大部分数据，从14开始后面是每3位数据都相同，观察前面的数据，共有20组（0-19）每组3个数据，联系题目colorful这题应该跟画图有关，每三位代表RGB的三个数据。</strong></p>
<img src="/images/2021051204.png" width="40%" height="40%"/>
<p><strong>而data1中是由0-19整数组成，推测data1中每一个整数代表一个序号，序号对应data2中的色块序号。</strong></p>
<p>思路清晰，开始写脚本跑</p>
<figure class="highlight python"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> binascii <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;data2&#x27;</span>,<span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f = hexlify(f.read()).decode()</span><br><span class="line">    color_list = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(f),<span class="number">2</span>):</span><br><span class="line">        num = f[i:i+<span class="number">2</span>]</span><br><span class="line">        color_list.append(<span class="built_in">int</span>(num,<span class="number">16</span>))</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(color_list),<span class="number">3</span>):</span><br><span class="line">    <span class="built_in">print</span>(color_list[i],color_list[i+<span class="number">1</span>],color_list[i+<span class="number">2</span>])</span><br></pre></td></tr></table></div></figure>
<p>这个输出的前20组数据就是我们要的数据，复制出去作为output，写下一个绘图脚本</p>
<figure class="highlight python"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> binascii <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;data1&#x27;</span>,<span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f = f.read()</span><br><span class="line">    data = f.split()</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;output.txt&#x27;</span>,<span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f = f.read()</span><br><span class="line">    num_list = f.split()</span><br><span class="line">    <span class="built_in">print</span>(num_list)</span><br><span class="line"><span class="built_in">print</span>(data)</span><br><span class="line">width,height = <span class="number">37</span>,<span class="number">191</span></span><br><span class="line">pic = Image.new(<span class="string">&quot;RGB&quot;</span>,(width,height))</span><br><span class="line">n = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(width):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(height):</span><br><span class="line">        m = <span class="built_in">int</span>(data[n])</span><br><span class="line">        j1,j2,j3 = <span class="built_in">int</span>(num_list[m*<span class="number">3</span>]),<span class="built_in">int</span>(num_list[m*<span class="number">3</span>+<span class="number">1</span>]),<span class="built_in">int</span>(num_list[m*<span class="number">3</span>+<span class="number">2</span>])</span><br><span class="line">        pic.putpixel([i,j],(j1,j2,j3))</span><br><span class="line">        n += <span class="number">1</span></span><br><span class="line">pic.show()</span><br><span class="line">pic.save(<span class="string">&#x27;flag.png&#x27;</span>)</span><br></pre></td></tr></table></div></figure>
<p>data1共由7067个数据，7067=37*191，不知道哪个是高哪个是底，都试一遍。而且一开始我不知道它是一行一行写还是一列一列写，所以都试试。试出来的结果就是</p>
<img src="/images/2021051401.png" width="50%" height="50%">
<p>然后就涉及到我的知识盲区了。后面知道是一种叫做npiet的隐写术，有<span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://www.bertnase.de/npiet/npiet-execute.php" >在线解码</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span>脚本。</p>
<img src="/images/2021051402.png" width="50%" height="50%">
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;88842f20-fb8c-45c9-ae8f-36135b6a0f11&#125;</span><br></pre></td></tr></table></div></figure>
</div><footer class="post-footer"><div class="post-ending ending"><div class="ending__text">------ FIN ------</div></div><div class="post-copyright copyright"><div class="copyright-author"><span class="copyright-author__name">Autor: </span><span class="copyright-author__value"><a href="https://tsuppari404.github.io">tsuppari</a></span></div><div class="copyright-link"><span class="copyright-link__name">Enlace: </span><span class="copyright-link__value"><a href="https://tsuppari404.github.io/2021/08/02/%E8%92%9F%E8%92%BB%E7%9A%84%E6%8C%A8%E6%89%93%E4%B9%8B%E8%B7%AF/">https://tsuppari404.github.io/2021/08/02/%E8%92%9F%E8%92%BB%E7%9A%84%E6%8C%A8%E6%89%93%E4%B9%8B%E8%B7%AF/</a></span></div><div class="copyright-notice"><span class="copyright-notice__name">Copyright: </span><span class="copyright-notice__value">Todos los artículos de este blog están bajo licencia  de <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh-cn" rel="external nofollow" target="_blank">BY-NC-SA</a> a menos que se indique lo contrario</span></div></div><div class="post-tags"><span class="post-tags-item"><span class="post-tags-item__icon"><i class="fas fa-tag"></i></span><a class="post-tags-item__link" href="https://tsuppari404.github.io/tags/%E5%AD%A6%E4%B9%A0/">学习</a></span></div><div class="post-reward reward"><div class="reward-button">Cómprame un café</div><div class="reward-qrcode"><span class="reward-qrcode-alipay"><img class="reward-qrcode-alipay__img" src="/images/Alipay.jpg"><div class="reward-qrcode-alipay__text">Alipay</div></span><span class="reward-qrcode-wechat"><img class="reward-qrcode-wechat__img" src="/images/WeChatpay.jpg"><div class="reward-qrcode-wechat__text">Wechat</div></span></div></div><nav class="post-paginator paginator"><div class="paginator-prev"><a class="paginator-prev__link" href="/2021/08/17/docker%E6%98%AF%E4%B8%AA%E8%82%BE%E4%B9%88%E7%8E%A9%E6%84%8F/"><span class="paginator-prev__icon"><i class="fas fa-angle-left"></i></span><span class="paginator-prev__text">docker是个肾么玩意</span></a></div><div class="paginator-next"><a class="paginator-next__link" href="/2021/07/14/%E8%92%9F%E8%92%BB%E7%9A%84pwn%E4%B9%8B%E8%B7%AF/"><span class="paginator-prev__text">蒟蒻的pwn之路</span><span class="paginator-next__icon"><i class="fas fa-angle-right"></i></span></a></div></nav></footer></div></div><div class="comments" id="comments"><div id="valine-container"></div></div></div><div class="sidebar-wrap" id="sidebar-wrap"><aside class="sidebar" id="sidebar"><div class="sidebar-nav"><span class="sidebar-nav-toc current">Contenido</span><span class="sidebar-nav-ov">Reseña</span></div><section class="sidebar-toc"><ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#20211022-%E7%9C%81%E8%B5%9B%E5%A4%8D%E7%8E%B0"><span class="toc-number">1.</span> <span class="toc-text">
           2021.10.22 省赛（复现）</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#misc"><span class="toc-number">1.1.</span> <span class="toc-text">
           misc</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2021830-dasctf%E5%A4%8D%E7%8E%B0"><span class="toc-number">2.</span> <span class="toc-text">
           2021.8.30 DASCTF（复现）</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#crypto"><span class="toc-number">2.1.</span> <span class="toc-text">
           Crypto</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#lets-play-with-rsa~"><span class="toc-number">2.1.1.</span> <span class="toc-text">
           let’s play with rsa~</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#ezrsa"><span class="toc-number">2.1.2.</span> <span class="toc-text">
           ezRSA</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2021823-%E7%A5%A5%E4%BA%91%E6%9D%AF"><span class="toc-number">3.</span> <span class="toc-text">
           2021.8.23 祥云杯</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#misc-2"><span class="toc-number">3.1.</span> <span class="toc-text">
           Misc</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E9%B8%A3%E9%9B%8F%E6%81%8B-a-hrefhttpspanbaiducoms1grmatfkilnyuc0s4xbq7aw-target_blank%E9%99%84%E4%BB%B6%E4%B8%8B%E8%BD%BDa"><span class="toc-number">3.1.1.</span> <span class="toc-text">
           鸣雏恋 附件下载</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#crypto-2"><span class="toc-number">3.2.</span> <span class="toc-text">
           Crypto</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#random_rsa-a-hrefhttpspanbaiducoms1g0bbro0eq_p5jgbyjew2yq-target_blank%E9%99%84%E4%BB%B6%E4%B8%8B%E8%BD%BDa"><span class="toc-number">3.2.1.</span> <span class="toc-text">
           Random_RSA 附件下载</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2021731-dasctf"><span class="toc-number">4.</span> <span class="toc-text">
           2021.7.31 DASCTF</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#misc-3"><span class="toc-number">4.1.</span> <span class="toc-text">
           Misc</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#red_vs_blue-%E4%BC%A0%E9%80%81%E9%97%A8"><span class="toc-number">4.1.1.</span> <span class="toc-text">
           red_vs_blue 传送门</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#funny_maze-%E4%BC%A0%E9%80%81%E9%97%A8"><span class="toc-number">4.1.2.</span> <span class="toc-text">
           funny_maze 传送门</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2021515-ciscn"><span class="toc-number">5.</span> <span class="toc-text">
           2021.5.15 ciscn</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#misc-4"><span class="toc-number">5.1.</span> <span class="toc-text">
           Misc</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E9%9A%94%E7%A9%BA%E4%BC%A0%E8%AF%9D"><span class="toc-number">5.1.1.</span> <span class="toc-text">
           隔空传话</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#202159-redhat"><span class="toc-number">6.</span> <span class="toc-text">
           2021.5.9 redhat</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#misc-5"><span class="toc-number">6.1.</span> <span class="toc-text">
           Misc</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%AD%BE%E5%88%B0"><span class="toc-number">6.1.1.</span> <span class="toc-text">
           签到</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#colorful_code"><span class="toc-number">6.1.2.</span> <span class="toc-text">
           colorful_code</span></a></li></ol></li></ol></li></ol></section><!-- ov = overview--><section class="sidebar-ov hide"><div class="sidebar-ov-author"><div class="sidebar-ov-author__avatar"><img class="sidebar-ov-author__avatar_img" src="/images/head.jpg" alt="avatar"></div><p class="sidebar-ov-author__text">t5uppari</p></div><div class="sidebar-ov-social"><a class="sidebar-ov-social-item" href="https://github.com/" target="_blank" rel="noopener" data-popover="Github" data-popover-pos="up"><span class="sidebar-ov-social-item__icon"><i class="fab fa-github"></i></span></a><a class="sidebar-ov-social-item" href="https://plus.google.com/" target="_blank" rel="noopener" data-popover="Google" data-popover-pos="up"><span class="sidebar-ov-social-item__icon"><i class="fab fa-google"></i></span></a><a class="sidebar-ov-social-item" href="https://twitter.com/" target="_blank" rel="noopener" data-popover="Twitter" data-popover-pos="up"><span class="sidebar-ov-social-item__icon"><i class="fab fa-twitter"></i></span></a><a class="sidebar-ov-social-item" href="https://youtube.com/" target="_blank" rel="noopener" data-popover="Youtube" data-popover-pos="up"><span class="sidebar-ov-social-item__icon"><i class="fab fa-youtube"></i></span></a></div><div class="sidebar-ov-state"><a class="sidebar-ov-state-item sidebar-ov-state-item--posts" href="/archives/"><div class="sidebar-ov-state-item__count">20</div><div class="sidebar-ov-state-item__name">Archivo</div></a></div><div class="sidebar-ov-cc"><a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh-cn" target="_blank" rel="noopener" data-popover="Creative Commons" data-popover-pos="up"><img src="/images/cc-by-nc-sa.svg"></a></div></section><div class="sidebar-reading"><div class="sidebar-reading-info"><span class="sidebar-reading-info__text">Has leído </span><span class="sidebar-reading-info__num">0</span><span class="sidebar-reading-info__perc">%</span></div><div class="sidebar-reading-line"></div></div></aside></div><div class="clearfix"></div></div></main><footer class="footer" id="footer"><div class="footer-inner"><div><span>Copyright © 2022</span><span class="footer__icon"><i class="fas fa-heart"></i></span><span>tsuppari</span></div><div><span>Potenciado por <a href="http://hexo.io/" title="Hexo" target="_blank" rel="noopener">Hexo</a></span><span> v6.0.0</span><span class="footer__devider">|</span><span>Tema - <a href="https://github.com/liuyib/hexo-theme-stun/" title="Stun" target="_blank" rel="noopener">Stun</a></span><span> v2.6.2</span></div></div></footer><div class="loading-bar" id="loading-bar"><div class="loading-bar__progress"></div></div><div class="back2top" id="back2top"><span class="back2top__icon"><i class="fas fa-rocket"></i></span></div></div><script src="https://cdn.jsdelivr.net/npm/jquery@v3.4.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@1.5.2/velocity.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@1.5.2/velocity.ui.min.js"></script><script type="text/x-mathjax-config">var mathjaxMhchem = '';
var mathJaxTex = {
  equationNumbers: {
    autoNumber: 'AMS'
  }
};

if (false) {
  mathjaxMhchem = 'https://cdn.jsdelivr.net/npm/mathjax-mhchem@3.3.2/mhchem.min.js';
  MathJax.Ajax.config.path['mhchem'] = mathjaxMhchem;

  mathJaxTex.extensions = [mathjaxMhchem];
} else {
  mathJaxTex.extensions = ['AMSmath.js','AMSsymbols.js'];
}

MathJax.Hub.Config({
  menuSettings: {
    zoom: 'None'
  },
  showMathMenu: false,
  jax: ['input/TeX','output/CommonHTML'],
  extensions: ['tex2jax.js'],
  TeX: mathJaxTex,
  tex2jax: {
    inlineMath: [['$', '$'], ['\\(', '\\)']],
    displayMath: [['\\[', '\\]']],
    processEscapes: true,
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
  }
});

MathJax.Hub.Register.StartupHook('TeX Jax Ready', function() {
  MathJax.InputJax.TeX.prefilterHooks.Add(function(data) {
    if (data.display) {
      var next = data.script.nextSibling;
      while (next && next.nodeName.toLowerCase() === '#text') { next = next.nextSibling; }
      if (next && next.nodeName.toLowerCase() === 'br') { next.parentNode.removeChild(next); }
    }
  });
});

MathJax.Hub.Queue(function() {
  var all = MathJax.Hub.getAllJax(), i;
  for (i = 0; i < all.length; i++) {
    document.getElementById(all[i].inputID + '-Frame').parentNode.className += ' has-jax';
  }
});
</script><script src="https://cdn.jsdelivr.net/npm/mathjax/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><script src="//cdn.jsdelivr.net/npm/leancloud-storage@latest/dist/av-min.js"></script><script src="//cdn.jsdelivr.net/npm/valine@latest/dist/Valine.min.js"></script><script>function loadValine () {
  var GUEST_INFO = ['nick', 'mail', 'link'];
  var guest_info = 'nick,mail,link';

  guest_info = guest_info.split(',').filter(function(item) {
    return GUEST_INFO.indexOf(item) > -1;
  });
  new Valine({
    el: '#valine-container',
    appId: 'auxoO552Y8zcOjCWs9ah4vLt-MdYXbMMI',
    appKey: 'Kph2la86NdDftwCH6EwmqM7o',
    notify: true,
    verify: true,
    placeholder: 'Just go go',
    avatar: 'mp',
    meta: guest_info,
    pageSize: '10' || 10,
    visitor: false,
    recordIP: false,
    lang: 'zh-CN' || 'zh-cn',
    path: window.location.pathname
  });
}

if (false) {
  loadValine();
} else {
  window.addEventListener('DOMContentLoaded', loadValine, false);
}</script><script src="/js/utils.js?v=2.6.2"></script><script src="/js/stun-boot.js?v=2.6.2"></script><script src="/js/scroll.js?v=2.6.2"></script><script src="/js/header.js?v=2.6.2"></script><script src="/js/sidebar.js?v=2.6.2"></script></body></html>