<!-- build time:Sun Dec 25 2022 16:41:29 GMT+0800 (中国标准时间) --><!DOCTYPE html><html><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#FFF"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png"><link rel="icon" type="image/ico" sizes="32x32" href="/images/favicon.ico"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="alternate" type="application/rss+xml" title="蒟蒻的入土史" href="https://tsuppari404.github.io/rss.xml"><link rel="alternate" type="application/atom+xml" title="蒟蒻的入土史" href="https://tsuppari404.github.io/atom.xml"><link rel="alternate" type="application/json" title="蒟蒻的入土史" href="https://tsuppari404.github.io/feed.json"><link rel="stylesheet" href="//fonts.googleapis.com/css?family=Mulish:300,300italic,400,400italic,700,700italic%7CFredericka%20the%20Great:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20JP:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20SC:300,300italic,400,400italic,700,700italic%7CInconsolata:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext"><link rel="stylesheet" href="/css/app.css?v=0.2.5"><meta name="keywords" content="学习"><link rel="canonical" href="https://tsuppari404.github.io/2021/08/02/%E8%92%9F%E8%92%BB%E7%9A%84%E6%8C%A8%E6%89%93%E4%B9%8B%E8%B7%AF/"><title>蒟蒻的挨打之路 | T5uppari = 蒟蒻的入土史</title><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css"><meta name="generator" content="Hexo 6.0.0"></head><body itemscope itemtype="http://schema.org/WebPage"><div id="loading"><div class="cat"><div class="body"></div><div class="head"><div class="face"></div></div><div class="foot"><div class="tummy-end"></div><div class="bottom"></div><div class="legs left"></div><div class="legs right"></div></div><div class="paw"><div class="hands left"></div><div class="hands right"></div></div></div></div><div id="container"><header id="header" itemscope itemtype="http://schema.org/WPHeader"><div class="inner"><div id="brand"><div class="pjax"><h1 itemprop="name headline">蒟蒻的挨打之路</h1><div class="meta"><span class="item" title="Created: 2021-08-02 08:39:55"><span class="icon"><i class="ic i-calendar"></i> </span><span class="text">Posted on</span> <time itemprop="dateCreated datePublished" datetime="2021-08-02T08:39:55+08:00">2021-08-02</time></span></div></div></div><nav id="nav"><div class="inner"><div class="toggle"><div class="lines" aria-label="Toggle navigation bar"><span class="line"></span> <span class="line"></span> <span class="line"></span></div></div><ul class="menu"><li class="item title"><a href="/" rel="start">T5uppari</a></li></ul><ul class="right"><li class="item theme"><i class="ic i-sun"></i></li><li class="item search"><i class="ic i-search"></i></li></ul></div></nav></div><div id="imgs" class="pjax"><ul><li class="item" data-background-image="https://tva4.sinaimg.cn/large/6833939bly1giph4fomxoj20zk0m8axp.jpg"></li><li class="item" data-background-image="https://tva4.sinaimg.cn/large/6833939bly1gicm07ih54j20zk0m84qp.jpg"></li><li class="item" data-background-image="https://tva4.sinaimg.cn/large/6833939bly1gipevgoki5j20zk0m84qp.jpg"></li><li class="item" data-background-image="https://tva4.sinaimg.cn/large/6833939bly1gipesng5oej20zk0m87d4.jpg"></li><li class="item" data-background-image="https://tva4.sinaimg.cn/large/6833939bly1gicmnywqgpj20zk0m8dwx.jpg"></li><li class="item" data-background-image="https://tva4.sinaimg.cn/large/6833939bly1gicljgocqbj20zk0m8e81.jpg"></li></ul></div></header><div id="waves"><svg class="waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z"/></defs><g class="parallax"><use xlink:href="#gentle-wave" x="48" y="0"/><use xlink:href="#gentle-wave" x="48" y="3"/><use xlink:href="#gentle-wave" x="48" y="5"/><use xlink:href="#gentle-wave" x="48" y="7"/></g></svg></div><main><div class="inner"><div id="main" class="pjax"><div class="article wrap"><div class="breadcrumb" itemscope itemtype="https://schema.org/BreadcrumbList"><i class="ic i-home"></i> <span><a href="/">Home</a></span></div><article itemscope itemtype="http://schema.org/Article" class="post block" lang="default"><link itemprop="mainEntityOfPage" href="https://tsuppari404.github.io/2021/08/02/%E8%92%9F%E8%92%BB%E7%9A%84%E6%8C%A8%E6%89%93%E4%B9%8B%E8%B7%AF/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/head.jpg"><meta itemprop="name" content="tsuppari"><meta itemprop="description" content=", "></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="蒟蒻的入土史"></span><div class="body md" itemprop="articleBody"><p>呜呜呜 T_T</p><p>记录一下蒟蒻在各大比赛挨打的过程。</p><span id="more"></span><h3 id="20211022-省赛复现"><a class="anchor" href="#20211022-省赛复现">#</a> 2021.10.22 省赛（复现）</h3><h4 id="misc"><a class="anchor" href="#misc">#</a> misc</h4><p>附件就一张图片，binwalk 没发现啥玩意，最后到处试 lsb 隐写给试出了一个 rar</p><img data-src="/images/2021110613.png" width="50%" height="50%"><p>拔下来的 rar 发现是损坏的，考虑伪加密，把加密位改回去</p><img data-src="/images/2021110614.png" width="50%" height="50%"><p>这里的 0 改成 4，原本以为没啥问题了，结果这里踩坑了。这里要用官方给的 lsb 隐写脚本跑出来的 rar 才是正确的 rar。</p><p>后面的步骤都很简单了，爆破出加密的 rar 密码为 123321，得到一张图片直接用 stegsolve 看 flag。</p><h3 id="2021830-dasctf复现"><a class="anchor" href="#2021830-dasctf复现">#</a> 2021.8.30 DASCTF（复现）</h3><p>有俩密码学的题</p><h4 id="crypto"><a class="anchor" href="#crypto">#</a> Crypto</h4><h5 id="lets-play-with-rsa~"><a class="anchor" href="#lets-play-with-rsa~">#</a> let's play with rsa~</h5><p>附件长这样：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sympy <span class="keyword">import</span> isprime,nextprime</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getPrime <span class="keyword">as</span> getprime ,long_to_bytes,bytes_to_long,inverse</span><br><span class="line">flag=<span class="string">&#x27;flag&#123;***************&#125;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">play</span>():</span><br><span class="line">    p=getprime(<span class="number">1024</span>)</span><br><span class="line">    q=getprime(<span class="number">1024</span>)</span><br><span class="line"></span><br><span class="line">    n=p*q</span><br><span class="line">    e=<span class="number">65537</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span> <span class="string">&quot;Hello,let&#x27;s play rsa~\n&quot;</span></span><br><span class="line">    <span class="built_in">print</span> <span class="string">&#x27;Now,I make some numbers,wait a second\n&#x27;</span></span><br><span class="line">    n1=getprime(<span class="number">200</span>)</span><br><span class="line">    n2=getprime(<span class="number">200</span>)</span><br><span class="line">    number=n1*n2</span><br><span class="line">    <span class="built_in">print</span> <span class="string">&quot;Ok,i will send two numbers to you,one of them was encoded.\n&quot;</span></span><br><span class="line">    <span class="built_in">print</span> <span class="string">&quot;Encode n1:%d,\n&quot;</span>%(<span class="built_in">pow</span>(n1,e,n))</span><br><span class="line">    <span class="built_in">print</span> <span class="string">&quot;And n2:%d.\n&quot;</span>%n2</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span> <span class="string">&quot;Information that can now be made public:the public key (n,e):(%d,%d)\n&quot;</span>%(n,e)</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            c=<span class="built_in">int</span>(raw_input(<span class="string">&quot;ok,now,tell me the value of the number (encode it for safe):&quot;</span>))</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="built_in">print</span> <span class="string">&quot;Sorry,the input is illeagal, and the integer is accept~&quot;</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    d=inverse(e,(p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">    m=<span class="built_in">pow</span>(c,d,n)</span><br><span class="line">    <span class="keyword">if</span> m==number:</span><br><span class="line">        <span class="built_in">print</span> <span class="string">&quot;It&#x27;s easy and interesting,didn&#x27;t it?\n&quot;</span></span><br><span class="line">        <span class="built_in">print</span> <span class="string">&quot;This is the gift for you :&quot;</span>+flag</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span> <span class="string">&quot;Emmmmm,there is something wrong, bye~\n&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    play()</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>数学原理很简单：</p><img data-src="/images/2021083101.jpg" width="80%" height="80%"><p>exp 如下：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">en_n1 = <span class="number">1309721910589292483737401896023705647211812731131580022207997317781086527420162694426783098998244562068230335429061546502019166975754786167341689047014873958107404120012933517153896824577108373020327789333970129263835075665364474808938834288415903375301139260812397188033692847643071939844953726931774517258280654227664887556336036095280951203307978647462380596353268816595074090830724134701722961596409878278764247168746397167847040206659595961690456943906329271303804282136442317185552336464229518976466931265098174562935244202362365634788701457135344490298509297318209626645153514784129383468209964398541421466276</span></span><br><span class="line">n = <span class="number">12837770558555314064794558480082731445733882018381629916163024669576913542314586587530283320606488797929692460622707042752475883949512350557684519969053352832577190628394534732768969813760882691828041106105916556730296206192621778367752135858508793676525121086890158474077244689335284589013548347756711712889737164840475886374605781536567359597200412748537326979090940986741854313956791578704511827287026891681707519188758403649811968478863567711653557073172575381628473942814925653831626597042079483642684004219931450549540680966665970171852575497645457016481998448325634229033075903634430806140076432661903094828593</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">n2 = <span class="number">1362359474479550927452891208121227746732073198634558158536609</span></span><br><span class="line">c = en_n1 * <span class="built_in">pow</span>(n2,e,n)</span><br><span class="line"><span class="built_in">print</span>(c)</span><br></pre></td></tr></table></figure><h5 id="ezrsa"><a class="anchor" href="#ezrsa">#</a> ezRSA</h5><p>这题原理和上题类似，附件如下：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> getrandbits</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">EzRsa</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        self.E = <span class="number">0x10001</span></span><br><span class="line">        self.P = getPrime(<span class="number">1024</span>)</span><br><span class="line">        self.Q = getPrime(<span class="number">1024</span>)</span><br><span class="line">        <span class="keyword">while</span> GCD((self.P-<span class="number">1</span>)*(self.Q-<span class="number">1</span>), self.E) != <span class="number">1</span>:</span><br><span class="line">            self.Q = getPrime(<span class="number">1024</span>)</span><br><span class="line">        self.N = self.P*self.Q</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">self</span>):</span><br><span class="line">        f = getrandbits(<span class="number">32</span>)</span><br><span class="line">        c = <span class="built_in">pow</span>(f, self.E, self.N)</span><br><span class="line">        <span class="keyword">return</span> (f, c)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">encrypt_flag</span>(<span class="params">self, flag</span>):</span><br><span class="line">        f = bytes_to_long(flag)</span><br><span class="line">        c = <span class="built_in">pow</span>(f, self.E, self.N)</span><br><span class="line">        <span class="keyword">return</span> c</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">proof</span>():</span><br><span class="line">    seed = getrandbits(<span class="number">32</span>)</span><br><span class="line">    <span class="built_in">print</span>(seed)</span><br><span class="line">    sha = sha256(<span class="built_in">str</span>(seed).encode()).hexdigest()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;sha256(<span class="subst">&#123;seed&gt;&gt;<span class="number">18</span>&#125;</span>...).hexdigest() = <span class="subst">&#123;sha&#125;</span>&quot;</span>)</span><br><span class="line">    sha_i = <span class="built_in">input</span>(<span class="string">&quot;plz enter seed: &quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> sha256(sha_i.encode()).hexdigest() != sha:</span><br><span class="line">        exit(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    proof()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;welcome to EzRsa&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    1. Get flag</span></span><br><span class="line"><span class="string">    2. Encrypt</span></span><br><span class="line"><span class="string">    3. Insert</span></span><br><span class="line"><span class="string">    4. Exit</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span>)</span><br><span class="line">    A = EzRsa()</span><br><span class="line">    coin = <span class="number">5</span></span><br><span class="line">    <span class="keyword">while</span> coin &gt; <span class="number">0</span>:</span><br><span class="line">        choose = <span class="built_in">input</span>(<span class="string">&quot;&gt; &quot;</span>)</span><br><span class="line">        <span class="keyword">if</span> choose == <span class="string">&quot;1&quot;</span>:</span><br><span class="line">            <span class="built_in">print</span>(</span><br><span class="line">                <span class="string">f&quot;pow(flag,e,n) = <span class="subst">&#123;A.encrypt_flag(flag)&#125;</span>\ne = 0x10001&quot;</span>)</span><br><span class="line">            exit(<span class="number">0</span>)</span><br><span class="line">        <span class="keyword">elif</span> choose == <span class="string">&quot;2&quot;</span>:</span><br><span class="line">            f, c = A.encrypt()</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;plain = <span class="subst">&#123;f&#125;</span>\ncipher = <span class="subst">&#123;c&#125;</span>&quot;</span>)</span><br><span class="line">            coin -= <span class="number">1</span></span><br><span class="line">        <span class="keyword">elif</span> choose == <span class="string">&quot;3&quot;</span>:</span><br><span class="line">            q = getrandbits(<span class="number">1024</span>)</span><br><span class="line">            n = A.P*q</span><br><span class="line">            f = getrandbits(<span class="number">32</span>)</span><br><span class="line">            c = <span class="built_in">pow</span>(f, <span class="number">0x10001</span>, n)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;plain = <span class="subst">&#123;f&#125;</span>\ncipher = <span class="subst">&#123;c&#125;</span>&quot;</span>)</span><br><span class="line">            coin -= <span class="number">1</span></span><br><span class="line">        <span class="keyword">elif</span> choose == <span class="string">&quot;4&quot;</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;bye~&quot;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;wrong input&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Now you get the flag right?&quot;</span>)</span><br></pre></td></tr></table></figure><p>给了 5 次机会 (coin)，2 和 3 选项分别能得到 n 和 p，数学原理如下：</p><img data-src="/images/2021083102.jpg" width="80%" height="80%"><p>exp 如下：</p><p>选项 2 和 3 各选两次拿数据，最后一次拿 flag 的数据</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> *</span><br><span class="line"><span class="comment">#from math import *</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line">f1 = <span class="number">3991424584</span></span><br><span class="line">c1 = <span class="number">23299859078129861414913771548219349721900206664014819386195794916044845964332637389648259329302749550436346202286946048713385410408064459859081918493047190943298495292861013654519793379809752456534138428868643899609668723735710829524825269361397275459708970559074552900236486895513774078684184834805376606088247533387016219365170743668987289463976754247014480713302197196568222170824912241303970513628344421242260649810302948949131617868038594231101232079019013330304215113673368314368833706712612127152921982153341480322701194423727871123662394240685540736238634699368430418964615398086626177026843559305313991443227</span></span><br><span class="line">f2 = <span class="number">3302952139</span></span><br><span class="line">c2 = <span class="number">16135167708023658331902606113227526506624892717052237702988935145355289623080800253295795703695347360875254861269833966623609514382014163433041295324806175024336762186717776686444629275737425480610600987793377115715370987547355442485973887920207336811930557011003908778677685189445607074026451925553282013998440786813828560563175818728704616901557779531236686737383795809573571053296171873412845580984730014998699951618614567444985737702781759475230163602992352950497827705875149910442039431153623052044891404971539003392860077134760784914141313151742913299690411764314019909465761008921434322476865096137861232855781</span></span><br><span class="line">n = gmpy2.gcd(<span class="built_in">pow</span>(f1,e) - c1,<span class="built_in">pow</span>(f2,e) - c2)</span><br><span class="line"><span class="built_in">print</span>(n)</span><br><span class="line">c3 = <span class="number">290608034256274369700862715363350323486028744781731905934249350715041586859408919647347827785586727942092508209115402506051655157392015883300023889210219576419324704609311096050860136030302584481540004322444602941867627050991572899014259628993547816246063508914512684313837142913444152620481715232869398984200565254080136273801468740882064342549655664616243374405422083085368533066537431942688830581503260516034879177548907813082280973258211700086334417911908732693940787281869354657664111312741521516275861135779300654363453173656735944975815042979883029464520576788180760677023541130131734670871708628401566092056</span></span><br><span class="line">c4 = <span class="number">19477721821886525117440143496319431500495385071913979141466226040526802160059201844862618364367741954042703804931248758421694329933382467780307210147901496300326789151918308642829330627052858106511054852272266315174702986664133983456742201333616464739367956812505831108567707073824178369443747106670498181714026256534321719627886311877207237167881226028217405406516689294193625979523781236934797180792371554750209628867494205548515578343356570418434460849979994288195296861844688172042575939423362750874494740696017989524225414610737548788064086913880409416592656292914866756979555717165005851927596841150843763549837</span></span><br><span class="line">f3 = <span class="number">790182690</span></span><br><span class="line">f4 = <span class="number">2129564814</span></span><br><span class="line">p = gmpy2.gcd(<span class="built_in">pow</span>(f3,e) - c3,<span class="built_in">pow</span>(f4,e) - c4)</span><br><span class="line">q = n // p</span><br><span class="line">c = <span class="number">24952279514997224947101022682449626128048315926803834959283021867551136554920048640317181593937537055086263973539743885388583210115706780021523202021772462316835425921121320529162432793833128629912344112656578819828486682363773819631694824476713219629652576476637315910977274832345854578059628785051135439346323100743046829886707064789413910491823509991850949661231750479103393176692414195918532925181456936717164879556950696080788364971454803842425311834060331270850687515410797773548975263226563726398807177996001159332682433166744595590323697981578101554722234248005684614174799841980158652033235878038837817713173</span></span><br><span class="line">phi = (p - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line">d = gmpy2.invert(e,phi)</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure><h3 id="2021823-祥云杯"><a class="anchor" href="#2021823-祥云杯">#</a> 2021.8.23 祥云杯</h3><p>做了两个题，分最低的俩，呜呜呜，提取密码都是 GAME</p><h4 id="misc-2"><a class="anchor" href="#misc-2">#</a> Misc</h4><h5 id="鸣雏恋-a-hrefhttpspanbaiducoms1grmatfkilnyuc0s4xbq7aw-target_blank附件下载a"><a class="anchor" href="#鸣雏恋-a-hrefhttpspanbaiducoms1grmatfkilnyuc0s4xbq7aw-target_blank附件下载a">#</a> 鸣雏恋 <span class="exturl" data-url="aHR0cHM6Ly9wYW4uYmFpZHUuY29tL3MvMWdyTUFUZktJTG55VWMwczRYYnE3QXc=">附件下载</span></h5><p>下载下来一个 60 多 M 的 docx，改后缀 zip 翻到了_rels 里面的 key.txt 和 love.zip，key.txt 是零宽隐写，<span class="exturl" data-url="aHR0cDovLzMzMGsuZ2l0aHViLmlvL21pc2NfdG9vbHMvdW5pY29kZV9zdGVnYW5vZ3JhcGh5Lmh0bWw=">解密网站</span>，直接全部复制进去出来的就是 love.zip 的密码。</p><img data-src="/images/2021082301.png" width="80%" height="80%"><p>love.zip 里面只有两种图片，盲猜是二进制之后转 ascii，图片太多写脚本跑。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line">ans = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">129488</span>):</span><br><span class="line">    filename = <span class="built_in">str</span>(i) + <span class="string">&#x27;.png&#x27;</span></span><br><span class="line">    fsize = os.path.getsize(filename)</span><br><span class="line">    <span class="keyword">if</span> fsize &gt; <span class="number">300</span>:</span><br><span class="line">        ans += <span class="string">&#x27;1&#x27;</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        ans += <span class="string">&#x27;0&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(ans)</span><br></pre></td></tr></table></figure><p>一种 262 字节一种 435 字节，用 300 为界限划分，出来的二进制码转 ascii，发现是 base64 的图片编码，拿去解码就得到了 flag</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;57dd74fb21bb1aee50f19421bf836f23&#125;</span><br></pre></td></tr></table></figure><h4 id="crypto-2"><a class="anchor" href="#crypto-2">#</a> Crypto</h4><h5 id="random_rsa-a-hrefhttpspanbaiducoms1g0bbro0eq_p5jgbyjew2yq-target_blank附件下载a"><a class="anchor" href="#random_rsa-a-hrefhttpspanbaiducoms1g0bbro0eq_p5jgbyjew2yq-target_blank附件下载a">#</a> Random_RSA <span class="exturl" data-url="aHR0cHM6Ly9wYW4uYmFpZHUuY29tL3MvMUcwQmJSbzBFcV9wNWpnQnlKRXcyeVE=">附件下载</span></h5><p>第一次在大比赛里面做出 rsa 的题，这题加密算法不难理解，题目贴一下反正不大，print 的数据都给了.</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">flag=<span class="string">r&#x27;flag&#123;&#125;&#x27;</span></span><br><span class="line"></span><br><span class="line">p=getPrime(<span class="number">512</span>)</span><br><span class="line">q=getPrime(<span class="number">512</span>)</span><br><span class="line">e=<span class="number">0x10001</span></span><br><span class="line">n=p*q</span><br><span class="line">ct=<span class="built_in">pow</span>(flag,e,n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;n=&quot;</span>+ n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;ct=&quot;</span>+ ct)</span><br><span class="line"></span><br><span class="line">dp=<span class="string">r&#x27;&#x27;</span></span><br><span class="line">seeds = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(dp)):</span><br><span class="line">    seeds.append(random.randint(<span class="number">0</span>,<span class="number">10000</span>))</span><br><span class="line"></span><br><span class="line">res = [] </span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(dp)):</span><br><span class="line">    random.seed(seeds[i])</span><br><span class="line">    rands = []</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">4</span>):</span><br><span class="line">        rands.append(random.randint(<span class="number">0</span>,<span class="number">255</span>))</span><br><span class="line"></span><br><span class="line">    res.append(<span class="built_in">ord</span>(dp[i]) ^ rands[i%<span class="number">4</span>])</span><br><span class="line">    <span class="keyword">del</span> rands[i%<span class="number">4</span>]</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">str</span>(rands))</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(res) </span><br><span class="line"><span class="built_in">print</span>(seeds)</span><br></pre></td></tr></table></figure><p>没有给 dp, 应该是要我们求。告诉了 dp 是多少位的，和 seeds 是一样的 154 位，程序是把 dp 的每一位，异或加密了，生成的 seeds 是随机的题目也给了，根据这个 seeds 去生成随机数来对 dp 的每一位进行异或加密，一开始<strong>用 python3 跑出来的 rands 是错的</strong>，<strong> 特地装了个 python2</strong> 去跑了个随机数.</p><p>得到正确的 rands 之后拿去解密 dp, 脚本如下</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">dp = []</span><br><span class="line">ans = [<span class="number">2</span>, <span class="number">54</span>, <span class="number">128</span>, <span class="number">242</span>, <span class="number">87</span>, <span class="number">16</span>, <span class="number">228</span>, <span class="number">64</span>, <span class="number">84</span>, <span class="number">78</span>, <span class="number">71</span>, <span class="number">0</span>, <span class="number">73</span>, <span class="number">160</span>, <span class="number">128</span>, <span class="number">200</span>, <span class="number">124</span>, <span class="number">165</span>, <span class="number">114</span>, <span class="number">2</span>, <span class="number">241</span>, <span class="number">124</span>, <span class="number">118</span>, <span class="number">52</span>, <span class="number">127</span>, <span class="number">193</span>, <span class="number">142</span>, <span class="number">35</span>, <span class="number">230</span>, <span class="number">138</span>, <span class="number">5</span>, <span class="number">135</span>, <span class="number">40</span>, <span class="number">188</span>, <span class="number">28</span>, <span class="number">108</span>, <span class="number">167</span>, <span class="number">207</span>, <span class="number">166</span>, <span class="number">181</span>, <span class="number">127</span>, <span class="number">51</span>, <span class="number">168</span>, <span class="number">146</span>, <span class="number">168</span>, <span class="number">204</span>, <span class="number">62</span>, <span class="number">134</span>, <span class="number">37</span>, <span class="number">219</span>, <span class="number">234</span>, <span class="number">255</span>, <span class="number">50</span>, <span class="number">117</span>, <span class="number">194</span>, <span class="number">243</span>, <span class="number">124</span>, <span class="number">137</span>, <span class="number">221</span>, <span class="number">88</span>, <span class="number">188</span>, <span class="number">191</span>, <span class="number">143</span>, <span class="number">122</span>, <span class="number">49</span>, <span class="number">64</span>, <span class="number">143</span>, <span class="number">8</span>, <span class="number">190</span>, <span class="number">184</span>, <span class="number">85</span>, <span class="number">102</span>, <span class="number">236</span>, <span class="number">196</span>, <span class="number">34</span>, <span class="number">183</span>, <span class="number">207</span>, <span class="number">157</span>, <span class="number">160</span>, <span class="number">79</span>, <span class="number">153</span>, <span class="number">202</span>, <span class="number">184</span>, <span class="number">244</span>, <span class="number">157</span>, <span class="number">48</span>, <span class="number">211</span>, <span class="number">255</span>, <span class="number">113</span>, <span class="number">58</span>, <span class="number">117</span>, <span class="number">131</span>, <span class="number">33</span>, <span class="number">36</span>, <span class="number">246</span>, <span class="number">250</span>, <span class="number">85</span>, <span class="number">41</span>, <span class="number">203</span>, <span class="number">101</span>, <span class="number">189</span>, <span class="number">50</span>, <span class="number">81</span>, <span class="number">127</span>, <span class="number">233</span>, <span class="number">114</span>, <span class="number">233</span>, <span class="number">251</span>, <span class="number">118</span>, <span class="number">137</span>, <span class="number">76</span>, <span class="number">61</span>, <span class="number">158</span>, <span class="number">144</span>, <span class="number">233</span>, <span class="number">80</span>, <span class="number">169</span>, <span class="number">174</span>, <span class="number">1</span>, <span class="number">172</span>, <span class="number">4</span>, <span class="number">176</span>, <span class="number">137</span>, <span class="number">255</span>, <span class="number">186</span>, <span class="number">244</span>, <span class="number">28</span>, <span class="number">17</span>, <span class="number">12</span>, <span class="number">55</span>, <span class="number">246</span>, <span class="number">235</span>, <span class="number">127</span>, <span class="number">167</span>, <span class="number">114</span>, <span class="number">154</span>, <span class="number">151</span>, <span class="number">235</span>, <span class="number">155</span>, <span class="number">39</span>, <span class="number">252</span>, <span class="number">83</span>, <span class="number">87</span>, <span class="number">97</span>, <span class="number">255</span>, <span class="number">47</span>, <span class="number">14</span>, <span class="number">143</span>, <span class="number">28</span>, <span class="number">176</span>, <span class="number">164</span>, <span class="number">235</span>, <span class="number">35</span>, <span class="number">102</span>]</span><br><span class="line">res = [<span class="number">55</span>, <span class="number">5</span>, <span class="number">183</span>, <span class="number">192</span>, <span class="number">103</span>, <span class="number">32</span>, <span class="number">211</span>, <span class="number">116</span>, <span class="number">102</span>, <span class="number">120</span>, <span class="number">118</span>, <span class="number">54</span>, <span class="number">120</span>, <span class="number">145</span>, <span class="number">185</span>, <span class="number">254</span>, <span class="number">77</span>, <span class="number">144</span>, <span class="number">70</span>, <span class="number">54</span>, <span class="number">193</span>, <span class="number">73</span>, <span class="number">64</span>, <span class="number">0</span>, <span class="number">79</span>, <span class="number">244</span>, <span class="number">190</span>, <span class="number">23</span>, <span class="number">215</span>, <span class="number">187</span>, <span class="number">53</span>, <span class="number">176</span>, <span class="number">27</span>, <span class="number">138</span>, <span class="number">42</span>, <span class="number">89</span>, <span class="number">158</span>, <span class="number">254</span>, <span class="number">159</span>, <span class="number">133</span>, <span class="number">78</span>, <span class="number">11</span>, <span class="number">155</span>, <span class="number">163</span>, <span class="number">145</span>, <span class="number">248</span>, <span class="number">14</span>, <span class="number">179</span>, <span class="number">23</span>, <span class="number">226</span>, <span class="number">220</span>, <span class="number">201</span>, <span class="number">5</span>, <span class="number">71</span>, <span class="number">241</span>, <span class="number">195</span>, <span class="number">75</span>, <span class="number">191</span>, <span class="number">237</span>, <span class="number">108</span>, <span class="number">141</span>, <span class="number">141</span>, <span class="number">185</span>, <span class="number">76</span>, <span class="number">7</span>, <span class="number">113</span>, <span class="number">191</span>, <span class="number">48</span>, <span class="number">135</span>, <span class="number">139</span>, <span class="number">100</span>, <span class="number">83</span>, <span class="number">212</span>, <span class="number">242</span>, <span class="number">21</span>, <span class="number">143</span>, <span class="number">255</span>, <span class="number">164</span>, <span class="number">146</span>, <span class="number">119</span>, <span class="number">173</span>, <span class="number">255</span>, <span class="number">140</span>, <span class="number">193</span>, <span class="number">173</span>, <span class="number">2</span>, <span class="number">224</span>, <span class="number">205</span>, <span class="number">68</span>, <span class="number">10</span>, <span class="number">77</span>, <span class="number">180</span>, <span class="number">24</span>, <span class="number">23</span>, <span class="number">196</span>, <span class="number">205</span>, <span class="number">108</span>, <span class="number">28</span>, <span class="number">243</span>, <span class="number">80</span>, <span class="number">140</span>, <span class="number">4</span>, <span class="number">98</span>, <span class="number">76</span>, <span class="number">217</span>, <span class="number">70</span>, <span class="number">208</span>, <span class="number">202</span>, <span class="number">78</span>, <span class="number">177</span>, <span class="number">124</span>, <span class="number">10</span>, <span class="number">168</span>, <span class="number">165</span>, <span class="number">223</span>, <span class="number">105</span>, <span class="number">157</span>, <span class="number">152</span>, <span class="number">48</span>, <span class="number">152</span>, <span class="number">51</span>, <span class="number">133</span>, <span class="number">190</span>, <span class="number">202</span>, <span class="number">136</span>, <span class="number">204</span>, <span class="number">44</span>, <span class="number">33</span>, <span class="number">58</span>, <span class="number">4</span>, <span class="number">196</span>, <span class="number">219</span>, <span class="number">71</span>, <span class="number">150</span>, <span class="number">68</span>, <span class="number">162</span>, <span class="number">175</span>, <span class="number">218</span>, <span class="number">173</span>, <span class="number">19</span>, <span class="number">201</span>, <span class="number">100</span>, <span class="number">100</span>, <span class="number">85</span>, <span class="number">201</span>, <span class="number">24</span>, <span class="number">59</span>, <span class="number">186</span>, <span class="number">46</span>, <span class="number">130</span>, <span class="number">147</span>, <span class="number">219</span>, <span class="number">22</span>, <span class="number">81</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(res)):</span><br><span class="line">    dp.append(<span class="built_in">chr</span>(res[i] ^ ans[i]))</span><br><span class="line">dp = <span class="string">&#x27;&#x27;</span>.join(dp)</span><br><span class="line"><span class="built_in">print</span>(dp)</span><br></pre></td></tr></table></figure><p>得到 dp 之后，就是一个简单的 dp 泄露题了，拿模板去套.(模板是 la 佬的 磕头)</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2 <span class="keyword">as</span> gp</span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line">n = <span class="number">81196282992606113591233615204680597645208562279327854026981376917977843644855180528227037752692498558370026353244981467900057157997462760732019372185955846507977456657760125682125104309241802108853618468491463326268016450119817181368743376919334016359137566652069490881871670703767378496685419790016705210391</span></span><br><span class="line">dp = <span class="number">5372007426161196154405640504110736659190183194052966723076041266610893158678092845450232508793279585163304918807656946147575280063208168816457346755227057</span></span><br><span class="line">c = <span class="number">61505256223993349534474550877787675500827332878941621261477860880689799960938202020614342208518869582019307850789493701589309453566095881294166336673487909221860641809622524813959284722285069755310890972255545436989082654705098907006694780949725756312169019688455553997031840488852954588581160550377081811151</span></span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, e):</span><br><span class="line">	<span class="keyword">if</span>(e*dp%x==<span class="number">1</span>):</span><br><span class="line">		p=(e*dp-<span class="number">1</span>)//x+<span class="number">1</span></span><br><span class="line">		<span class="keyword">if</span>(n%p!=<span class="number">0</span>):</span><br><span class="line">			<span class="keyword">continue</span></span><br><span class="line">		q=n//p</span><br><span class="line">		phin=(p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">		d=gp.invert(e, phin)</span><br><span class="line">		m=gp.powmod(c, d, n)</span><br><span class="line">		<span class="keyword">if</span>(<span class="built_in">len</span>(<span class="built_in">hex</span>(m)[<span class="number">2</span>:])%<span class="number">2</span>==<span class="number">1</span>):</span><br><span class="line">			<span class="keyword">continue</span></span><br><span class="line">		<span class="built_in">print</span>(<span class="string">&#x27;--------------&#x27;</span>)</span><br><span class="line">		<span class="built_in">print</span>(m)</span><br><span class="line">		<span class="built_in">print</span>(<span class="built_in">hex</span>(m)[<span class="number">2</span>:])</span><br><span class="line">		<span class="built_in">print</span>(<span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(m)[<span class="number">2</span>:]))</span><br></pre></td></tr></table></figure><h3 id="2021731-dasctf"><a class="anchor" href="#2021731-dasctf">#</a> 2021.7.31 DASCTF</h3><p>菜鸡想吐槽：肝了半天的题目都成 200 分了，果然我是最菜的。</p><h4 id="misc-3"><a class="anchor" href="#misc-3">#</a> Misc</h4><h5 id="red_vs_blue-传送门"><a class="anchor" href="#red_vs_blue-传送门">#</a> red_vs_blue <span class="exturl" data-url="aHR0cHM6Ly9idXVvai5jbi9wbHVnaW5zL2N0ZmQtbWF0Y2hlcy9tYXRjaGVzLzE1L2NoYWxsZW5nZXMjcmVkX3ZzX2JsdWU=">传送门</span></h5><p>题目要 nc 连接，思路很简单，就是 nc 连上之后，有 66 个结果随机选择哪一个队，选择错了就退回到第一关，要连续选择正确 66 个结果。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">root@tsuppari:/home/tsuppari# nc node4.buuoj.cn 27935</span><br><span class="line">Here are 66 AWD Games will begin!</span><br><span class="line">The winner is between Red Team and Blue Team</span><br><span class="line">To get the flag if you predict the results of all games successfully!</span><br><span class="line">Game 1</span><br><span class="line">choose one [r] Red Team,[b] Blue Team:</span><br><span class="line">r</span><br><span class="line">Your choice Red Team</span><br><span class="line">The result Blue Team</span><br><span class="line">Sorry!You are wrong!</span><br><span class="line">Play again? (y/n): y</span><br></pre></td></tr></table></figure><p>每次 nc 进入，66 个结果都是一样的，所以直接写脚本跑。19 行代码蒟蒻改来改去写了一个钟头。还是太 fw 了。就是一个不断试错暴力破解的过程。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">r = remote(<span class="string">&#x27;node4.buuoj.cn&#x27;</span>,<span class="number">27935</span>)</span><br><span class="line">context.log_level=<span class="string">&#x27;debug&#x27;</span></span><br><span class="line">ans = []</span><br><span class="line">r.recvuntil(<span class="string">b&#x27;To get the flag if you predict the results of all games successfully!\n&#x27;</span>)</span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    r.recvuntil(<span class="string">b&#x27;choose one [r] Red Team,[b] Blue Team:\n&#x27;</span>)</span><br><span class="line">    r.sendline(<span class="string">b&#x27;r&#x27;</span>)</span><br><span class="line">    r.recvline()</span><br><span class="line">    result = r.recvline()<span class="comment">#接受第二行的结果</span></span><br><span class="line">    <span class="keyword">if</span> <span class="string">b&#x27;Blue&#x27;</span> <span class="keyword">in</span> result:</span><br><span class="line">        ans.append(<span class="string">b&#x27;b&#x27;</span>)</span><br><span class="line">        r.recv()</span><br><span class="line">        r.sendline(<span class="string">b&#x27;y&#x27;</span>)</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> ans:</span><br><span class="line">            r.recvuntil(<span class="string">b&#x27;choose one [r] Red Team,[b] Blue Team:\n&#x27;</span>)</span><br><span class="line">            r.sendline(i)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        ans.append(<span class="string">b&#x27;r&#x27;</span>)</span><br></pre></td></tr></table></figure><h5 id="funny_maze-传送门"><a class="anchor" href="#funny_maze-传送门">#</a> funny_maze <span class="exturl" data-url="aHR0cHM6Ly9idXVvai5jbi9wbHVnaW5zL2N0ZmQtbWF0Y2hlcy9tYXRjaGVzLzE1L2NoYWxsZW5nZXMjZnVubnlfbWF6ZQ==">传送门</span></h5><p>题目也是 nc 连接，连上去有 3 个选择，2 没啥用，3 介绍游戏规则，就是在 10s 之内计算出从起点走到终点的路径，超过了 10s 就会出 timeout。如果是最短路径下面的脚本就得改一改，反正思路是一样的都是 dfs (深搜)，oier 的必修之路。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">root@tsuppari:/home/tsuppari# nc node4.buuoj.cn 27619                                            </span><br><span class="line">                                                                                                 </span><br><span class="line">Hello! Welcome to my maze, You can choose 1, 2 or 3.                                             </span><br><span class="line">1.Start, and You only have three seconds to complete the level.</span><br><span class="line">2.Hint! I need Hint!</span><br><span class="line">3.Introduction to this game</span><br><span class="line">1</span><br><span class="line">###########</span><br><span class="line"># # #   # E</span><br><span class="line"># # # ### #</span><br><span class="line">#         #</span><br><span class="line"># # # #####</span><br><span class="line"># # # #   #</span><br><span class="line"># # # ### #</span><br><span class="line"># # #   # #</span><br><span class="line"># ##### # #</span><br><span class="line">S #       #</span><br><span class="line">###########</span><br><span class="line">Please enter your answer:</span><br><span class="line"></span><br><span class="line">time out!!!root@tsuppari:/home/tsuppari#</span><br></pre></td></tr></table></figure><p>一个简单的 dfs 脚本，60 多行代码改了 2 个钟头，写脚本能力太弱了。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">r = remote(<span class="string">&#x27;node4.buuoj.cn&#x27;</span>,<span class="number">27619</span>)</span><br><span class="line">context.log_level=<span class="string">&#x27;debug&#x27;</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">dfs</span>(<span class="params">start_x,start_y</span>):</span><br><span class="line">    x1 = start_x</span><br><span class="line">    y1 = start_y - <span class="number">1</span></span><br><span class="line">    x2 = start_x + <span class="number">1</span></span><br><span class="line">    y2 = start_y</span><br><span class="line">    x3 = start_x</span><br><span class="line">    y3 = start_y + <span class="number">1</span></span><br><span class="line">    x4 = start_x - <span class="number">1</span></span><br><span class="line">    y4 = start_y</span><br><span class="line">    <span class="keyword">if</span> x1 &gt;= <span class="number">0</span> <span class="keyword">and</span> x1 &lt;= height:<span class="comment">#越界处理</span></span><br><span class="line">        <span class="keyword">if</span> y1 &gt;= <span class="number">0</span> <span class="keyword">and</span> y1 &lt;= width-<span class="number">1</span>:</span><br><span class="line">            <span class="keyword">if</span> maze[x1][y1] == <span class="number">0</span> :</span><br><span class="line">                maze[x1][y1] += maze[start_x][start_y] + <span class="number">1</span></span><br><span class="line">                dfs(x1,y1)</span><br><span class="line">    <span class="keyword">if</span> x2 &gt;= <span class="number">0</span> <span class="keyword">and</span> x2 &lt;= height-<span class="number">1</span>:</span><br><span class="line">        <span class="keyword">if</span> y2 &gt;= <span class="number">0</span> <span class="keyword">and</span> y2 &lt;= width-<span class="number">1</span>:</span><br><span class="line">            <span class="keyword">if</span> maze[x2][y2] == <span class="number">0</span> :</span><br><span class="line">                maze[x2][y2] += maze[start_x][start_y] + <span class="number">1</span></span><br><span class="line">                dfs(x2,y2)</span><br><span class="line">    <span class="keyword">if</span> x3 &gt;= <span class="number">0</span> <span class="keyword">and</span> x3 &lt;= height-<span class="number">1</span>:</span><br><span class="line">        <span class="keyword">if</span> y3 &gt;= <span class="number">0</span> <span class="keyword">and</span> y3 &lt;= width-<span class="number">1</span>:</span><br><span class="line">            <span class="keyword">if</span> maze[x3][y3] == <span class="number">0</span> :</span><br><span class="line">                maze[x3][y3] += maze[start_x][start_y] + <span class="number">1</span></span><br><span class="line">                dfs(x3,y3)</span><br><span class="line">    <span class="keyword">if</span> x4 &gt;= <span class="number">0</span> <span class="keyword">and</span> x4 &lt;= height-<span class="number">1</span>:</span><br><span class="line">        <span class="keyword">if</span> y4 &gt;= <span class="number">0</span> <span class="keyword">and</span> y4 &lt;= width-<span class="number">1</span>:</span><br><span class="line">            <span class="keyword">if</span> maze[x4][y4] == <span class="number">0</span> :</span><br><span class="line">                maze[x4][y4] += maze[start_x][start_y] + <span class="number">1</span></span><br><span class="line">                dfs(x4,y4)</span><br><span class="line">r.recv()</span><br><span class="line">r.sendline(<span class="string">b&#x27;1&#x27;</span>)</span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    maze = r.recvuntil(<span class="string">b&#x27;Please enter your answer:\n&#x27;</span>).splitlines()[:-<span class="number">1</span>]</span><br><span class="line">    height = <span class="built_in">len</span>(maze)</span><br><span class="line">    width = <span class="built_in">len</span>(maze[<span class="number">0</span>])</span><br><span class="line">    start_x = <span class="number">0</span></span><br><span class="line">    start_y = <span class="number">0</span></span><br><span class="line">    end_x = <span class="number">0</span></span><br><span class="line">    end_y = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(height):</span><br><span class="line">        maze[i] = <span class="built_in">list</span>(maze[i])</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(width):</span><br><span class="line">            <span class="keyword">if</span> maze[i][j] == <span class="number">32</span>:</span><br><span class="line">                maze[i][j] = <span class="number">0</span><span class="comment">#空地设置成0</span></span><br><span class="line">            <span class="keyword">if</span> maze[i][j] == <span class="number">35</span>:</span><br><span class="line">                maze[i][j] = -<span class="number">1</span><span class="comment">#障碍物设置成-1</span></span><br><span class="line">            <span class="keyword">if</span> maze[i][j] == <span class="number">69</span>:</span><br><span class="line">                maze[i][j] = <span class="number">0</span><span class="comment">#标记为终点位置</span></span><br><span class="line">                end_x = i</span><br><span class="line">                end_y = j</span><br><span class="line">            <span class="keyword">if</span> maze[i][j] == <span class="number">83</span>:</span><br><span class="line">                maze[i][j] = <span class="number">1</span><span class="comment">#标记起点的位置</span></span><br><span class="line">                start_x = i</span><br><span class="line">                start_y = j</span><br><span class="line"></span><br><span class="line">    dfs(start_x,start_y)</span><br><span class="line">    ans = maze[end_x][end_y]</span><br><span class="line">    ans = <span class="built_in">str</span>(ans)</span><br><span class="line">    r.sendline(ans.encode())</span><br><span class="line">    r.recv()</span><br></pre></td></tr></table></figure><p>DASCTF 的比赛自己做出来的就 2 个题😔，后面会复现一下 pwn。</p><h3 id="2021515-ciscn"><a class="anchor" href="#2021515-ciscn">#</a> 2021.5.15 ciscn</h3><h4 id="misc-4"><a class="anchor" href="#misc-4">#</a> Misc</h4><h5 id="隔空传话"><a class="anchor" href="#隔空传话">#</a> 隔空传话</h5><p>下载下来一个 data.txt，一堆数字与字符，查找后发现这是<span class="exturl" data-url="aHR0cDovL3d3dy5zZW5kc21zLmNuL3BkdS8="> PDU 短信的编码</span>，前面四句话与后面几句话不一样，前四句话翻译如下。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">hello,bob!what is the flag?</span><br><span class="line"></span><br><span class="line">the first part of the flag is the first 8 digits of your phone number</span><br><span class="line"></span><br><span class="line">那其他部分呢</span><br><span class="line"></span><br><span class="line">看看你能从这些数据里发现什么？w465</span><br><span class="line"></span><br><span class="line">Receipient:+861503044200</span><br></pre></td></tr></table></figure><p>flag 前 8 位为 15030442，后面的 PDU 翻译过来都是 16 进制字符串，且发送的时间都不相同。于是写脚本进网站翻译。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;data.txt&#x27;</span>,<span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f:<span class="comment">#data.txt为下载下来的文件，删去了前4行</span></span><br><span class="line">    data = f.read()</span><br><span class="line">data = data.splitlines()</span><br><span class="line">browser = webdriver.Chrome(<span class="string">&#x27;C:\Program Files\Google\Chrome\Application\chromedriver.exe&#x27;</span>)</span><br><span class="line">url = <span class="string">&quot;http://www.sendsms.cn/pdu/&quot;</span></span><br><span class="line">browser.get(url)</span><br><span class="line">output = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> data:</span><br><span class="line">    browser.find_element_by_name(<span class="string">&quot;smsText2&quot;</span>).clear()</span><br><span class="line">    browser.find_element_by_name(<span class="string">&quot;smsText2&quot;</span>).send_keys(i)</span><br><span class="line">    browser.find_element_by_xpath(<span class="string">&quot;//input[@name=&#x27;checkButton&#x27;]&quot;</span>).click()</span><br><span class="line">    recv = browser.find_element_by_name(<span class="string">&quot;smsOut&quot;</span>).get_attribute(<span class="string">&#x27;value&#x27;</span>)</span><br><span class="line">    recv = recv.split()</span><br><span class="line">    n = <span class="number">0</span></span><br><span class="line">    txt = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> recv:<span class="comment">#循环之后的 txt 为 短信时间+16进制码</span></span><br><span class="line">        <span class="keyword">if</span> n == <span class="number">3</span>:</span><br><span class="line">            txt += j</span><br><span class="line">        <span class="keyword">if</span> n == <span class="number">13</span>:</span><br><span class="line">            txt += j</span><br><span class="line">            txt += <span class="string">&#x27;\n&#x27;</span></span><br><span class="line">        n += <span class="number">1</span></span><br><span class="line">    output += txt</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;out.txt&#x27;</span>,<span class="string">&#x27;w&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f.write(output)</span><br><span class="line">browser.quit()</span><br></pre></td></tr></table></figure><p>小破脚本跑了很久，最后得到的 out.txt 如下：</p><img data-src="/images/2021051601.png" width="40%" height="40%"><p>按照时间排序，用脚本排序，脚本如下：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;out.txt&#x27;</span>,<span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    data = f.read()</span><br><span class="line">data = data.splitlines()</span><br><span class="line">n1 = []</span><br><span class="line">n2 = []</span><br><span class="line">output = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> data:</span><br><span class="line">    time = i[:<span class="number">8</span>]</span><br><span class="line">    txt = i[<span class="number">8</span>:]</span><br><span class="line">    minute = <span class="built_in">int</span>(time[<span class="number">3</span>:<span class="number">5</span>])</span><br><span class="line">    sec = <span class="built_in">int</span>(time[<span class="number">6</span>:<span class="number">8</span>])</span><br><span class="line">    num = minute*<span class="number">60</span>+sec</span><br><span class="line">    n1.append(num)</span><br><span class="line">    n2.append(txt)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">5000</span>):<span class="comment">#排序输出</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(data)):</span><br><span class="line">        <span class="keyword">if</span> i == n1[j]:</span><br><span class="line">            output += n2[j]</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;output.txt&#x27;</span>,<span class="string">&#x27;w&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f.write(output)</span><br></pre></td></tr></table></figure><p>发现文件 output.txt 的开头 89504e47 是 png 文件头，但是宽被修改过，联系前面的信息：w465，可猜测宽为 465，于是得到图片</p><img data-src="/images/2021051602.png" width="40%" height="40%"><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CISCN&#123;15030442_b586_4c9e_b436_26def12293e4&#125;</span><br></pre></td></tr></table></figure><h3 id="202159-redhat"><a class="anchor" href="#202159-redhat">#</a> 2021.5.9 <span class="exturl" data-url="aHR0cHM6Ly9yYWNlLmljaHVucWl1LmNvbS8yMDIxcmVkaGF0">redhat</span></h3><h4 id="misc-5"><a class="anchor" href="#misc-5">#</a> Misc</h4><h5 id="签到"><a class="anchor" href="#签到">#</a> 签到</h5><p>下载下来一个 EBCDIC.txt，作为一个合格的萌新，直接把 EBCDIC 拿去 Google</p><img data-src="/images/2021051202.png" width="40%" height="40%"> <img data-src="/images/2021051201.png" width="40%" height="40%"><p>当时打比赛的时候我是对着这张表一个一个手动翻译，时间也不长 2 分钟就好了。后面看了别的大佬的 blog 发现可以用 Linux 自带的 dd 命令解出，或者是用 010。</p><img data-src="/images/2021051203.png" width="40%" height="40%"><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;we1c0me_t0_redhat2021&#125;</span><br></pre></td></tr></table></figure><h5 id="colorful_code"><a class="anchor" href="#colorful_code">#</a> colorful_code</h5><p>下载下来两个文件 data1，data2。</p><p><strong>思路：仔细观察 data1，文件大小有 15kb，data2 只有 1kb. 查看 data2，其中后面大部分数据，从 14 开始后面是每 3 位数据都相同，观察前面的数据，共有 20 组（0-19）每组 3 个数据，联系题目 colorful 这题应该跟画图有关，每三位代表 RGB 的三个数据。</strong></p><img data-src="/images/2021051204.png" width="40%" height="40%"><p><strong>而 data1 中是由 0-19 整数组成，推测 data1 中每一个整数代表一个序号，序号对应 data2 中的色块序号。</strong></p><p>思路清晰，开始写脚本跑</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> binascii <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;data2&#x27;</span>,<span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f = hexlify(f.read()).decode()</span><br><span class="line">    color_list = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(f),<span class="number">2</span>):</span><br><span class="line">        num = f[i:i+<span class="number">2</span>]</span><br><span class="line">        color_list.append(<span class="built_in">int</span>(num,<span class="number">16</span>))</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(color_list),<span class="number">3</span>):</span><br><span class="line">    <span class="built_in">print</span>(color_list[i],color_list[i+<span class="number">1</span>],color_list[i+<span class="number">2</span>])</span><br></pre></td></tr></table></figure><p>这个输出的前 20 组数据就是我们要的数据，复制出去作为 output，写下一个绘图脚本</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> binascii <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;data1&#x27;</span>,<span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f = f.read()</span><br><span class="line">    data = f.split()</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;output.txt&#x27;</span>,<span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f = f.read()</span><br><span class="line">    num_list = f.split()</span><br><span class="line">    <span class="built_in">print</span>(num_list)</span><br><span class="line"><span class="built_in">print</span>(data)</span><br><span class="line">width,height = <span class="number">37</span>,<span class="number">191</span></span><br><span class="line">pic = Image.new(<span class="string">&quot;RGB&quot;</span>,(width,height))</span><br><span class="line">n = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(width):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(height):</span><br><span class="line">        m = <span class="built_in">int</span>(data[n])</span><br><span class="line">        j1,j2,j3 = <span class="built_in">int</span>(num_list[m*<span class="number">3</span>]),<span class="built_in">int</span>(num_list[m*<span class="number">3</span>+<span class="number">1</span>]),<span class="built_in">int</span>(num_list[m*<span class="number">3</span>+<span class="number">2</span>])</span><br><span class="line">        pic.putpixel([i,j],(j1,j2,j3))</span><br><span class="line">        n += <span class="number">1</span></span><br><span class="line">pic.show()</span><br><span class="line">pic.save(<span class="string">&#x27;flag.png&#x27;</span>)</span><br></pre></td></tr></table></figure><p>data1 共由 7067 个数据，7067=37*191，不知道哪个是高哪个是底，都试一遍。而且一开始我不知道它是一行一行写还是一列一列写，所以都试试。试出来的结果就是</p><img data-src="/images/2021051401.png" width="50%" height="50%"><p>然后就涉及到我的知识盲区了。后面知道是一种叫做 npiet 的隐写术，有<span class="exturl" data-url="aHR0cHM6Ly93d3cuYmVydG5hc2UuZGUvbnBpZXQvbnBpZXQtZXhlY3V0ZS5waHA=">在线解码</span>脚本。</p><img data-src="/images/2021051402.png" width="50%" height="50%"><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;88842f20-fb8c-45c9-ae8f-36135b6a0f11&#125;</span><br></pre></td></tr></table></figure><div class="tags"><a href="/tags/%E5%AD%A6%E4%B9%A0/" rel="tag"><i class="ic i-tag"></i> 学习</a></div></div><footer><div class="meta"><span class="item"><span class="icon"><i class="ic i-calendar-check"></i> </span><span class="text">Edited on</span> <time title="Modified: 2021-11-10 18:42:39" itemprop="dateModified" datetime="2021-11-10T18:42:39+08:00">2021-11-10</time></span></div><div class="reward"><button><i class="ic i-heartbeat"></i> Donate</button><p>Give me a cup of [coffee]~(￣▽￣)~*</p><div id="qr"><div><img data-src="/images/Alipay.jpg" alt="tsuppari Alipay"><p>Alipay</p></div><div><img data-src="/images/WeChatpay.jpg" alt="tsuppari PayPal"><p>PayPal</p></div></div></div><div id="copyright"><ul><li class="author"><strong>Post author: </strong>tsuppari <i class="ic i-at"><em>@</em></i>蒟蒻的入土史</li><li class="link"><strong>Post link: </strong><a href="https://tsuppari404.github.io/2021/08/02/%E8%92%9F%E8%92%BB%E7%9A%84%E6%8C%A8%E6%89%93%E4%B9%8B%E8%B7%AF/" title="蒟蒻的挨打之路">https://tsuppari404.github.io/2021/08/02/蒟蒻的挨打之路/</a></li><li class="license"><strong>Copyright Notice: </strong>All articles in this blog are licensed under <span class="exturl" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9kZWVkLnpoLUNOLnltbA=="><i class="ic i-creative-commons"><em>(CC)</em></i>BY-NC-SA</span> unless stating additionally.</li></ul></div></footer></article></div><div class="post-nav"><div class="item left"><a href="/2021/07/14/%E8%92%9F%E8%92%BB%E7%9A%84pwn%E4%B9%8B%E8%B7%AF/" itemprop="url" rel="prev" data-background-image="https:&#x2F;&#x2F;tva4.sinaimg.cn&#x2F;mw690&#x2F;6833939bly1gipeu1usa7j20zk0m8b29.jpg" title="蒟蒻的pwn之路"><span class="type">Previous Post</span> <span class="category"><i class="ic i-flag"></i></span><h3>蒟蒻的pwn之路</h3></a></div><div class="item right"><a href="/2021/11/06/%E5%BF%99%E7%A2%8C%E7%9A%8410%E6%9C%88/" itemprop="url" rel="next" data-background-image="https:&#x2F;&#x2F;tva4.sinaimg.cn&#x2F;mw690&#x2F;6833939bly1gipewkhf1zj20zk0m81kx.jpg" title="忙碌的10月"><span class="type">Next Post</span> <span class="category"><i class="ic i-flag"></i></span><h3>忙碌的10月</h3></a></div></div><div class="wrap" id="comments"></div></div><div id="sidebar"><div class="inner"><div class="panels"><div class="inner"><div class="contents panel pjax" data-title="Contents"><ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#20211022-%E7%9C%81%E8%B5%9B%E5%A4%8D%E7%8E%B0"><span class="toc-number">1.</span> <span class="toc-text">2021.10.22 省赛（复现）</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#misc"><span class="toc-number">1.1.</span> <span class="toc-text">misc</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2021830-dasctf%E5%A4%8D%E7%8E%B0"><span class="toc-number">2.</span> <span class="toc-text">2021.8.30 DASCTF（复现）</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#crypto"><span class="toc-number">2.1.</span> <span class="toc-text">Crypto</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#lets-play-with-rsa~"><span class="toc-number">2.1.1.</span> <span class="toc-text">let&#39;s play with rsa~</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#ezrsa"><span class="toc-number">2.1.2.</span> <span class="toc-text">ezRSA</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2021823-%E7%A5%A5%E4%BA%91%E6%9D%AF"><span class="toc-number">3.</span> <span class="toc-text">2021.8.23 祥云杯</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#misc-2"><span class="toc-number">3.1.</span> <span class="toc-text">Misc</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E9%B8%A3%E9%9B%8F%E6%81%8B-a-hrefhttpspanbaiducoms1grmatfkilnyuc0s4xbq7aw-target_blank%E9%99%84%E4%BB%B6%E4%B8%8B%E8%BD%BDa"><span class="toc-number">3.1.1.</span> <span class="toc-text">鸣雏恋 附件下载</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#crypto-2"><span class="toc-number">3.2.</span> <span class="toc-text">Crypto</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#random_rsa-a-hrefhttpspanbaiducoms1g0bbro0eq_p5jgbyjew2yq-target_blank%E9%99%84%E4%BB%B6%E4%B8%8B%E8%BD%BDa"><span class="toc-number">3.2.1.</span> <span class="toc-text">Random_RSA 附件下载</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2021731-dasctf"><span class="toc-number">4.</span> <span class="toc-text">2021.7.31 DASCTF</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#misc-3"><span class="toc-number">4.1.</span> <span class="toc-text">Misc</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#red_vs_blue-%E4%BC%A0%E9%80%81%E9%97%A8"><span class="toc-number">4.1.1.</span> <span class="toc-text">red_vs_blue 传送门</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#funny_maze-%E4%BC%A0%E9%80%81%E9%97%A8"><span class="toc-number">4.1.2.</span> <span class="toc-text">funny_maze 传送门</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2021515-ciscn"><span class="toc-number">5.</span> <span class="toc-text">2021.5.15 ciscn</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#misc-4"><span class="toc-number">5.1.</span> <span class="toc-text">Misc</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E9%9A%94%E7%A9%BA%E4%BC%A0%E8%AF%9D"><span class="toc-number">5.1.1.</span> <span class="toc-text">隔空传话</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#202159-redhat"><span class="toc-number">6.</span> <span class="toc-text">2021.5.9 redhat</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#misc-5"><span class="toc-number">6.1.</span> <span class="toc-text">Misc</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%AD%BE%E5%88%B0"><span class="toc-number">6.1.1.</span> <span class="toc-text">签到</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#colorful_code"><span class="toc-number">6.1.2.</span> <span class="toc-text">colorful_code</span></a></li></ol></li></ol></li></ol></div><div class="related panel pjax" data-title="Related"></div><div class="overview panel" data-title="Overview"><div class="author" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="image" itemprop="image" alt="tsuppari" data-src="/images/head.jpg"><p class="name" itemprop="name">tsuppari</p><div class="description" itemprop="description"></div></div><nav class="state"><div class="item posts"><a href="/archives/"><span class="count">23</span> <span class="name">posts</span></a></div><div class="item tags"><a href="/tags/"><span class="count">8</span> <span class="name">tags</span></a></div></nav><div class="social"><span class="exturl item email" data-url="bWFpbHRvOjE2MjcxMDA3NDEwQHFxLmNvbQ==" title="mailto:16271007410@qq.com"><i class="ic i-envelope"></i></span> <span class="exturl item QQ" data-url="dGVuY2VudDovL01lc3NhZ2UvP1Vpbj0xNjI3MTAwNDEwJndlYnNpdGVOYW1lPXEtem9uZS5xcS5jb20mTWVudT15ZXM=" title="tencent:&#x2F;&#x2F;Message&#x2F;?Uin&#x3D;1627100410&amp;websiteName&#x3D;q-zone.qq.com&amp;Menu&#x3D;yes"><i class="ic i-qq"></i></span></div><ul class="menu"><li class="item"><a href="/" rel="section"><i class="ic i-home"></i>Home</a></li><li class="item"><a href="/about/" rel="section"><i class="ic i-user"></i>About</a></li><li class="item"><a href="/friends/" rel="section"><i class="ic i-heart"></i>friends</a></li></ul></div></div></div><ul id="quick"><li class="prev pjax"><a href="/2021/07/14/%E8%92%9F%E8%92%BB%E7%9A%84pwn%E4%B9%8B%E8%B7%AF/" rel="prev" title="Previous Post"><i class="ic i-chevron-left"></i></a></li><li class="up"><i class="ic i-arrow-up"></i></li><li class="down"><i class="ic i-arrow-down"></i></li><li class="next pjax"><a href="/2021/11/06/%E5%BF%99%E7%A2%8C%E7%9A%8410%E6%9C%88/" rel="next" title="Next Post"><i class="ic i-chevron-right"></i></a></li><li class="percent"></li></ul></div></div><div class="dimmer"></div></div></main><footer id="footer"><div class="inner"><div class="widgets"><div class="rpost pjax"><h2>Random Posts</h2><ul><li class="item"><div class="breadcrumb"></div><span><a href="/2022/02/28/Gauss/" title="Gauss">Gauss</a></span></li><li class="item"><div class="breadcrumb"></div><span><a href="/2021/02/20/%E8%92%9F%E8%92%BB%E7%9A%84C%E7%AC%94%E8%AE%B0/" title="蒟蒻的C笔记">蒟蒻的C笔记</a></span></li><li class="item"><div class="breadcrumb"></div><span><a href="/2022/01/30/%E6%B5%85%E6%9E%90CRT/" title="浅析CRT">浅析CRT</a></span></li><li class="item"><div class="breadcrumb"></div><span><a href="/2020/11/02/%E6%AD%A5%E5%85%A5CTF%E7%9A%84%E7%AC%AC%E4%B8%80%E5%A4%A9/" title="步入CTF的第一天">步入CTF的第一天</a></span></li><li class="item"><div class="breadcrumb"></div><span><a href="/2020/11/01/%E7%AC%AC%E4%B8%80%E7%AF%87%E5%8D%9A%E5%AE%A2/" title="第一篇博客">第一篇博客</a></span></li><li class="item"><div class="breadcrumb"></div><span><a href="/2022/03/16/%E9%92%88%E5%AF%B9CTFer%E7%9A%84e%E4%B8%8Ephi%E4%B8%8D%E4%BA%92%E7%B4%A0%E7%9A%84%E9%97%AE%E9%A2%98/" title="针对CTFer的e与phi不互素的问题">针对CTFer的e与phi不互素的问题</a></span></li><li class="item"><div class="breadcrumb"></div><span><a href="/2022/11/28/2022%E5%AE%89%E6%B4%B5%E6%9D%AFcrypto%E6%96%B9%E5%90%91writeup/" title="2022安洵杯crypto方向writeup">2022安洵杯crypto方向writeup</a></span></li><li class="item"><div class="breadcrumb"></div><span><a href="/2021/06/08/%E6%9D%82_%E9%9D%9E%E5%B8%B8%E6%9D%82/" title="杂_非常杂">杂_非常杂</a></span></li><li class="item"><div class="breadcrumb"></div><span><a href="/2199/04/13/crypto%E7%9A%84%E6%8C%A8%E6%89%93%E4%B9%8B%E8%B7%AF(%E4%BA%8C)/" title="crypto的挨打之路（二）">crypto的挨打之路（二）</a></span></li><li class="item"><div class="breadcrumb"></div><span><a href="/2021/01/25/%E8%92%9F%E8%92%BB%E7%9A%84python%E7%AC%94%E8%AE%B0/" title="蒟蒻的python笔记（随缘更新版）">蒟蒻的python笔记（随缘更新版）</a></span></li></ul></div><div><h2>Recent Comments</h2><ul class="leancloud-recent-comment"></ul></div></div><div class="status"><div class="copyright">&copy; 2020 – <span itemprop="copyrightYear">2022</span> <span class="with-love"><i class="ic i-sakura rotate"></i> </span><span class="author" itemprop="copyrightHolder">tsuppari @ T5uppari</span></div><div class="powered-by">Powered by <span class="exturl" data-url="aHR0cHM6Ly9oZXhvLmlv">Hexo</span> & Theme.<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2FtZWhpbWUvaGV4by10aGVtZS1zaG9rYQ==">Shoka</span></div></div></div></footer></div><script data-config type="text/javascript">var LOCAL={path:"2021/08/02/蒟蒻的挨打之路/",favicon:{show:"（●´3｀●）Goooood",hide:"(´Д｀)Booooom"},search:{placeholder:"Search for Posts",empty:"We didn't find any results for the search: ${query}",stats:"${hits} results found in ${time} ms"},valine:!0,fancybox:!0,copyright:'Copied to clipboard successfully! <br> All articles in this blog are licensed under <i class="ic i-creative-commons"></i>BY-NC-SA.',ignores:[function(e){return e.includes("#")},function(e){return new RegExp(LOCAL.path+"$").test(e)}]}</script><script src="https://cdn.polyfill.io/v2/polyfill.js"></script><script src="//cdn.jsdelivr.net/combine/npm/pace-js@1.0.2/pace.min.js,npm/pjax@0.2.8/pjax.min.js,npm/whatwg-fetch@3.4.0/dist/fetch.umd.min.js,npm/animejs@3.2.0/lib/anime.min.js,npm/algoliasearch@4/dist/algoliasearch-lite.umd.js,npm/instantsearch.js@4/dist/instantsearch.production.min.js,npm/lozad@1/dist/lozad.min.js,npm/quicklink@2/dist/quicklink.umd.js"></script><script src="/js/app.js?v=0.2.5"></script></body></html><!-- rebuild by hrmmi -->