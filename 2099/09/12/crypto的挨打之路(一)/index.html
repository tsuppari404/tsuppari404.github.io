<!-- build time:Sat Nov 26 2022 14:28:29 GMT+0800 (ä¸­å›½æ ‡å‡†æ—¶é—´) --><!DOCTYPE html><html><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#FFF"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png"><link rel="icon" type="image/ico" sizes="32x32" href="/images/favicon.ico"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="alternate" type="application/rss+xml" title="è’Ÿè’»çš„å…¥åœŸå²" href="https://tsuppari404.github.io/rss.xml"><link rel="alternate" type="application/atom+xml" title="è’Ÿè’»çš„å…¥åœŸå²" href="https://tsuppari404.github.io/atom.xml"><link rel="alternate" type="application/json" title="è’Ÿè’»çš„å…¥åœŸå²" href="https://tsuppari404.github.io/feed.json"><link rel="stylesheet" href="//fonts.googleapis.com/css?family=Mulish:300,300italic,400,400italic,700,700italic%7CFredericka%20the%20Great:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20JP:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20SC:300,300italic,400,400italic,700,700italic%7CInconsolata:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext"><link rel="stylesheet" href="/css/app.css?v=0.2.5"><meta name="keywords" content="å­¦ä¹ ,crypto"><link rel="canonical" href="https://tsuppari404.github.io/2099/09/12/crypto%E7%9A%84%E6%8C%A8%E6%89%93%E4%B9%8B%E8%B7%AF(%E4%B8%80)/"><title>cryptoçš„æŒ¨æ‰“ä¹‹è·¯ï¼ˆä¸€ï¼‰ | T5uppari = è’Ÿè’»çš„å…¥åœŸå²</title><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css"><meta name="generator" content="Hexo 6.0.0"></head><body itemscope itemtype="http://schema.org/WebPage"><div id="loading"><div class="cat"><div class="body"></div><div class="head"><div class="face"></div></div><div class="foot"><div class="tummy-end"></div><div class="bottom"></div><div class="legs left"></div><div class="legs right"></div></div><div class="paw"><div class="hands left"></div><div class="hands right"></div></div></div></div><div id="container"><header id="header" itemscope itemtype="http://schema.org/WPHeader"><div class="inner"><div id="brand"><div class="pjax"><h1 itemprop="name headline">cryptoçš„æŒ¨æ‰“ä¹‹è·¯ï¼ˆä¸€ï¼‰</h1><div class="meta"><span class="item" title="Created: 2099-09-12 10:48:26"><span class="icon"><i class="ic i-calendar"></i> </span><span class="text">Posted on</span> <time itemprop="dateCreated datePublished" datetime="2099-09-12T10:48:26+08:00">2099-09-12</time></span></div></div></div><nav id="nav"><div class="inner"><div class="toggle"><div class="lines" aria-label="Toggle navigation bar"><span class="line"></span> <span class="line"></span> <span class="line"></span></div></div><ul class="menu"><li class="item title"><a href="/" rel="start">T5uppari</a></li></ul><ul class="right"><li class="item theme"><i class="ic i-sun"></i></li><li class="item search"><i class="ic i-search"></i></li></ul></div></nav></div><div id="imgs" class="pjax"><ul><li class="item" data-background-image="https://tva4.sinaimg.cn/large/6833939bly1giclj9410cj20zk0m8h12.jpg"></li><li class="item" data-background-image="https://tva4.sinaimg.cn/large/6833939bly1gipexe4oykj20zk0m87ji.jpg"></li><li class="item" data-background-image="https://tva4.sinaimg.cn/large/6833939bly1gipeu1usa7j20zk0m8b29.jpg"></li><li class="item" data-background-image="https://tva4.sinaimg.cn/large/6833939bly1gicliwyw55j20zk0m8hdt.jpg"></li><li class="item" data-background-image="https://tva4.sinaimg.cn/large/6833939bly1gipev1x5e4j20zk0m8b29.jpg"></li><li class="item" data-background-image="https://tva4.sinaimg.cn/large/6833939bly1giciuv0socj20zk0m8qes.jpg"></li></ul></div></header><div id="waves"><svg class="waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z"/></defs><g class="parallax"><use xlink:href="#gentle-wave" x="48" y="0"/><use xlink:href="#gentle-wave" x="48" y="3"/><use xlink:href="#gentle-wave" x="48" y="5"/><use xlink:href="#gentle-wave" x="48" y="7"/></g></svg></div><main><div class="inner"><div id="main" class="pjax"><div class="article wrap"><div class="breadcrumb" itemscope itemtype="https://schema.org/BreadcrumbList"><i class="ic i-home"></i> <span><a href="/">Home</a></span></div><article itemscope itemtype="http://schema.org/Article" class="post block" lang="default"><link itemprop="mainEntityOfPage" href="https://tsuppari404.github.io/2099/09/12/crypto%E7%9A%84%E6%8C%A8%E6%89%93%E4%B9%8B%E8%B7%AF(%E4%B8%80)/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/head.jpg"><meta itemprop="name" content="tsuppari"><meta itemprop="description" content=", "></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="è’Ÿè’»çš„å…¥åœŸå²"></span><div class="body md" itemprop="articleBody"><p>å­¦ pwn æœ‰ç‚¹å­¦ä¸æ˜ç™½äº†ï¼Œå…ˆæ¥ crypto æ”¾æ¾ä¸€ä¸‹ã€‚</p><p>2022.3.9 ä¸€ä¸å°å¿ƒæ”¾æ¾æˆä¸»æ–¹å‘äº†ï¼Œæ¯ 20 é¢˜æ¢ä¸€ç¯‡å†™</p><p>ä¸€äº›æ”¶è—ï¼š<br><span class="exturl" data-url="aHR0cHM6Ly9nY2hxLmdpdGh1Yi5pby9DeWJlckNoZWYv">CyberChef</span> è§£å†³å¤šé‡åŠ å¯†çš„<br><span class="exturl" data-url="aHR0cHM6Ly9ndWJhbGxhLmRlL3ZpZ2VuZXJlLXNvbHZlcg==">ç»´å‰å°¼äºšå¯†ç çˆ†ç ´</span>ç»´å‰å°¼äºšå¯†ç çˆ†ç ´å¯†é’¥<br><span class="exturl" data-url="aHR0cHM6Ly9xdWlwcWl1cC5jb20v">quipqiup</span> å¿«é€Ÿè‡ªåŠ¨å¯†ç è§£ç®—å™¨</p><p><s>å› ä¸ºä¸ä¼šç½®é¡¶åªæœ‰æ”¹æ—¶é—´çš„å±‘ 4.11</s></p><span id="more"></span><h4 id="0x14-2022securinets-ctf-quals-2022-aes-2-411"><a class="anchor" href="#0x14-2022securinets-ctf-quals-2022-aes-2-411">#</a> 0x14 2022Securinets CTF Quals 2022 AES-2 4.11</h4><p>è¯¥å‘çš„æœ€åä¸€é¢˜ï¼ˆ21.9.12-22.4.11ï¼‰</p><p>è¿™é¢˜ç€å®æ˜¯è®©äººçœ¼å‰ä¸€äº®ï¼Œé™„ä»¶</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.Padding <span class="keyword">import</span> pad</span><br><span class="line"><span class="keyword">import</span> os, sys, hashlib, random</span><br><span class="line"></span><br><span class="line">FLAG = <span class="string">b&quot;Securinets&#123;REDACTED&#125;&quot;</span></span><br><span class="line"></span><br><span class="line">key, iv1, iv2 = [os.urandom(<span class="number">16</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>)]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">xor</span>(<span class="params">a, b</span>):</span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">bytes</span>(i ^ j <span class="keyword">for</span> i, j <span class="keyword">in</span> <span class="built_in">zip</span>(a, b))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_token</span>(<span class="params">msg, iv1, iv2</span>):</span><br><span class="line">	<span class="keyword">if</span> <span class="built_in">len</span>(msg) % <span class="number">16</span> != <span class="number">0</span>:</span><br><span class="line">		msg = pad(msg, <span class="number">16</span>)</span><br><span class="line">	aes = AES.new(key, AES.MODE_ECB)</span><br><span class="line">	blocks = [msg[i:i+<span class="number">16</span>] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(msg), <span class="number">16</span>)]</span><br><span class="line">	enc = <span class="string">b&quot;&quot;</span></span><br><span class="line">	tmp1 = iv1</span><br><span class="line">	tmp2 = iv2</span><br><span class="line">	<span class="keyword">for</span> block <span class="keyword">in</span> blocks:</span><br><span class="line">		tmp = aes.encrypt(xor(block, tmp1))</span><br><span class="line">		_tmp = aes.encrypt(xor(tmp, tmp2))</span><br><span class="line">		enc += _tmp</span><br><span class="line">		tmp1 = _tmp</span><br><span class="line">		tmp2 = tmp</span><br><span class="line">	<span class="keyword">return</span> enc</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">proof</span>(<span class="params">msg</span>):</span><br><span class="line">	res = <span class="string">b&quot;\x00&quot;</span>*<span class="number">16</span></span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(msg), <span class="number">16</span>):</span><br><span class="line">		res = xor(res, msg[i:i+<span class="number">16</span>])</span><br><span class="line">	<span class="keyword">return</span> hashlib.sha256(res).digest()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">	alice_username = os.urandom(<span class="number">32</span>)</span><br><span class="line">	alice_token = get_token(alice_username, iv1, iv2)</span><br><span class="line">	<span class="built_in">print</span>(<span class="string">f&quot;Alice&#x27;s creds : <span class="subst">&#123;alice_username.<span class="built_in">hex</span>()&#125;</span> -&gt; <span class="subst">&#123;alice_token.<span class="built_in">hex</span>()&#125;</span>\n&quot;</span>)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">		<span class="keyword">try</span>:</span><br><span class="line">			username = <span class="built_in">bytes</span>.fromhex(<span class="built_in">input</span>(<span class="string">&quot;Username : &quot;</span>))</span><br><span class="line">			token = get_token(username, iv1, iv2)</span><br><span class="line">			<span class="built_in">print</span>(<span class="string">f&quot;Your creds : <span class="subst">&#123;username.<span class="built_in">hex</span>()&#125;</span> -&gt; <span class="subst">&#123;token.<span class="built_in">hex</span>()&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">			<span class="keyword">if</span> proof(token) == proof(alice_token):</span><br><span class="line">				<span class="keyword">if</span> token == alice_token:</span><br><span class="line">					<span class="built_in">print</span>(<span class="string">f&quot;You are not Alice!&quot;</span>)</span><br><span class="line">					sys.exit()</span><br><span class="line">				<span class="keyword">else</span>:</span><br><span class="line">					<span class="built_in">print</span>(<span class="string">f&quot;Hey Alice! Here is your flag <span class="subst">&#123;FLAG&#125;</span>&quot;</span>)</span><br><span class="line">					sys.exit()	</span><br><span class="line">			<span class="keyword">else</span>:</span><br><span class="line">				<span class="built_in">print</span>(<span class="string">&quot;Try again!\n&quot;</span>)</span><br><span class="line">		<span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">			<span class="built_in">print</span>(e)</span><br><span class="line">			<span class="built_in">print</span>(<span class="string">&quot;Invalid input.\n&quot;</span>)</span><br></pre></td></tr></table></figure><p>ä½œå›¾æè¿°ä¸€ä¸‹è¿™ä¸ªè¿‡ç¨‹</p><img data-src="/images/2022041102.png" style="zoom:80%"><p>msg æ˜¯ usernameï¼Œenc æ˜¯ get_token ä¹‹åçš„ç»“æœã€‚msg ç”±è‡ªå·±æ§åˆ¶ï¼Œå¾—åˆ°çš„ enc ä¼šç»™å‡ºã€‚ç›®çš„æ˜¯éœ€è¦æ„é€ ä¸€ä¸ª msg ä½¿ä¸¤æ¬¡ AES åŠ å¯†ä¹‹åå¾—åˆ°çš„ enc èƒ½æ»¡è¶³ proof ä¹‹åæ˜¯ä¸€æ ·çš„ã€‚è€Œ proof è¯»æºç ä¸€çœ‹å°±èƒ½ç†è§£å°±æ˜¯æ‰€æœ‰ enc åˆ†å—å†å¼‚æˆ–ã€‚å¦‚æœç›´æ¥è¾“å…¥åŸæœ‰ Alice çš„ msgï¼Œå¾—åˆ°çš„ token æ˜¯å’Œ alice_token ä¸€æ ·æ— æ³•æ»¡è¶³æ¡ä»¶ï¼Œç›®çš„æ˜¯ proof ä¹‹åä¸€æ ·ä½†æ˜¯æœ¬èº«ä¸ç­‰äºã€‚</p><p>ç›¸å½“äºå°±æ˜¯æ„é€ ä¸€ä¸ªå‡çš„ token èƒ½è¿‡ proofã€‚<span class="exturl" data-url="aHR0cHM6Ly9kMzNiNHQwLmNvbS8=">deebato</span>ğŸ‘´å¤ªå¼ºäº†ï¼Œæ€è·¯æ˜¯ dbtğŸ‘´çš„ï¼Œå› ä¸ºæ¯æ¬¡è¯•é”™ä¼šç»™å›æ˜¾ï¼Œå†ä¸€ä¸ªå°±æ˜¯ï¼Œå¦‚æœèƒ½æ§åˆ¶å¾—åˆ° enc3 å’Œ enc4 æ»¡è¶³ enc3^enc4=0ï¼Œä¹Ÿèƒ½è¿‡ proofã€‚æ‰€ä»¥é—®é¢˜å°±åœ¨å¦‚ä½•æ„é€  msg3 å’Œ msg4ã€‚å…ˆæŠŠå˜é‡å†™è¿›å›¾ä¸­</p><img data-src="/images/2022041103.png" style="zoom:80%"><p>ç”±äº AES çš„ key å’Œ iv1ã€iv2 æ˜¯æœªçŸ¥çš„ä¸å¯æ§ï¼Œmsg æ˜¯è‡ªä¸ªè¾“å…¥çš„ï¼Œè¦æ§åˆ¶è®© enc3 å’Œ enc4 ç›¸ç­‰ï¼Œå°±æ˜¯æœ‰</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mo stretchy="false">(</mo><mi>m</mi><mi>s</mi><mi>g</mi><mn>2</mn><mo>âŠ•</mo><mi>e</mi><mi>n</mi><mi>c</mi><mn>1</mn><msup><mo stretchy="false">)</mo><mrow><mi>A</mi><mi>E</mi><mi>S</mi></mrow></msup><mo>âŠ•</mo><mo stretchy="false">(</mo><mi>m</mi><mi>s</mi><mi>g</mi><mn>3</mn><mo>âŠ•</mo><mi>e</mi><mi>n</mi><mi>c</mi><mn>2</mn><msup><mo stretchy="false">)</mo><mrow><mi>A</mi><mi>E</mi><mi>S</mi></mrow></msup><mo>=</mo><mo>=</mo><mo stretchy="false">(</mo><mi>m</mi><mi>s</mi><mi>g</mi><mn>3</mn><mo>âŠ•</mo><mi>e</mi><mi>n</mi><mi>c</mi><mn>2</mn><msup><mo stretchy="false">)</mo><mrow><mi>A</mi><mi>E</mi><mi>S</mi></mrow></msup><mo>âŠ•</mo><mo stretchy="false">(</mo><mi>m</mi><mi>s</mi><mi>g</mi><mn>4</mn><mo>âŠ•</mo><mi>e</mi><mi>n</mi><mi>c</mi><mn>3</mn><msup><mo stretchy="false">)</mo><mrow><mi>A</mi><mi>E</mi><mi>S</mi></mrow></msup></mrow><annotation encoding="application/x-tex">(msg2\oplus enc1)^{AES}\oplus (msg3\oplus enc2)^{AES} == (msg3\oplus enc2)^{AES} \oplus (msg4 \oplus enc3)^{AES}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mord mathnormal">s</span><span class="mord mathnormal" style="margin-right:.03588em">g</span><span class="mord">2</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">âŠ•</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.1413309999999999em;vertical-align:-.25em"></span><span class="mord mathnormal">e</span><span class="mord mathnormal">n</span><span class="mord mathnormal">c</span><span class="mord">1</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8913309999999999em"><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">A</span><span class="mord mathnormal mtight" style="margin-right:.05764em">E</span><span class="mord mathnormal mtight" style="margin-right:.05764em">S</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">âŠ•</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mord mathnormal">s</span><span class="mord mathnormal" style="margin-right:.03588em">g</span><span class="mord">3</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">âŠ•</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.1413309999999999em;vertical-align:-.25em"></span><span class="mord mathnormal">e</span><span class="mord mathnormal">n</span><span class="mord mathnormal">c</span><span class="mord">2</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8913309999999999em"><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">A</span><span class="mord mathnormal mtight" style="margin-right:.05764em">E</span><span class="mord mathnormal mtight" style="margin-right:.05764em">S</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span></span><span class="base"><span class="strut" style="height:.36687em;vertical-align:0"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mord mathnormal">s</span><span class="mord mathnormal" style="margin-right:.03588em">g</span><span class="mord">3</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">âŠ•</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.1413309999999999em;vertical-align:-.25em"></span><span class="mord mathnormal">e</span><span class="mord mathnormal">n</span><span class="mord mathnormal">c</span><span class="mord">2</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8913309999999999em"><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">A</span><span class="mord mathnormal mtight" style="margin-right:.05764em">E</span><span class="mord mathnormal mtight" style="margin-right:.05764em">S</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">âŠ•</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mord mathnormal">s</span><span class="mord mathnormal" style="margin-right:.03588em">g</span><span class="mord">4</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">âŠ•</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.1413309999999999em;vertical-align:-.25em"></span><span class="mord mathnormal">e</span><span class="mord mathnormal">n</span><span class="mord mathnormal">c</span><span class="mord">3</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8913309999999999em"><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">A</span><span class="mord mathnormal mtight" style="margin-right:.05764em">E</span><span class="mord mathnormal mtight" style="margin-right:.05764em">S</span></span></span></span></span></span></span></span></span></span></span></span></span></p><p>å…¶ä¸­ msg3 å’Œ msg4 æ˜¯å¯æ§çš„ï¼Œmsg1ã€msg2ã€enc1ã€enc2 å·²çŸ¥ã€‚</p><p>æ˜¾è€Œæ˜“è§åªè¦æ»¡è¶³<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mi>s</mi><mi>g</mi><mn>4</mn><mo>=</mo><mi>e</mi><mi>n</mi><mi>c</mi><mn>1</mn><mo>âŠ•</mo><mi>e</mi><mi>n</mi><mi>c</mi><mn>3</mn><mo>âŠ•</mo><mi>m</mi><mi>s</mi><mi>g</mi><mn>2</mn></mrow><annotation encoding="application/x-tex">msg4=enc1\oplus enc3\oplus msg2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8388800000000001em;vertical-align:-.19444em"></span><span class="mord mathnormal">m</span><span class="mord mathnormal">s</span><span class="mord mathnormal" style="margin-right:.03588em">g</span><span class="mord">4</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.72777em;vertical-align:-.08333em"></span><span class="mord mathnormal">e</span><span class="mord mathnormal">n</span><span class="mord mathnormal">c</span><span class="mord">1</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">âŠ•</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.72777em;vertical-align:-.08333em"></span><span class="mord mathnormal">e</span><span class="mord mathnormal">n</span><span class="mord mathnormal">c</span><span class="mord">3</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">âŠ•</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.8388800000000001em;vertical-align:-.19444em"></span><span class="mord mathnormal">m</span><span class="mord mathnormal">s</span><span class="mord mathnormal" style="margin-right:.03588em">g</span><span class="mord">2</span></span></span></span> ç­‰å¼å³å¯æˆç«‹ï¼Œexp å¦‚ä¸‹ (å…¶ä¸­æˆ‘ä»¤<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mi>s</mi><mi>g</mi><mn>3</mn><mo>=</mo><mi>e</mi><mi>n</mi><mi>c</mi><mn>2</mn><mo>âŠ•</mo><mi>e</mi><mi>n</mi><mi>c</mi><mn>1</mn><mo>âŠ•</mo><mi>m</mi><mi>s</mi><mi>g</mi><mn>2</mn></mrow><annotation encoding="application/x-tex">msg3=enc2 \oplus enc1\oplus msg2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8388800000000001em;vertical-align:-.19444em"></span><span class="mord mathnormal">m</span><span class="mord mathnormal">s</span><span class="mord mathnormal" style="margin-right:.03588em">g</span><span class="mord">3</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.72777em;vertical-align:-.08333em"></span><span class="mord mathnormal">e</span><span class="mord mathnormal">n</span><span class="mord mathnormal">c</span><span class="mord">2</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">âŠ•</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.72777em;vertical-align:-.08333em"></span><span class="mord mathnormal">e</span><span class="mord mathnormal">n</span><span class="mord mathnormal">c</span><span class="mord">1</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">âŠ•</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.8388800000000001em;vertical-align:-.19444em"></span><span class="mord mathnormal">m</span><span class="mord mathnormal">s</span><span class="mord mathnormal" style="margin-right:.03588em">g</span><span class="mord">2</span></span></span></span>ï¼Œå…¶å®å¤§å¯ä¸å¿…)</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.Padding <span class="keyword">import</span> pad</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">from</span> functools <span class="keyword">import</span> reduce</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">hex_xor</span>(<span class="params">s1,s2</span>):</span><br><span class="line">    bytes_s1 = <span class="built_in">bytes</span>.fromhex(s1)</span><br><span class="line">    bytes_s2 = <span class="built_in">bytes</span>.fromhex(s2)</span><br><span class="line">    <span class="keyword">return</span> xor(bytes_s1,bytes_s2).<span class="built_in">hex</span>()</span><br><span class="line"><span class="comment"># context(log_level = &#x27;debug&#x27;)</span></span><br><span class="line">r = remote(<span class="string">&#x27;20.233.7.174&#x27;</span>,<span class="number">4870</span>)</span><br><span class="line">r.recvuntil(<span class="string">b&#x27;Alice\&#x27;s creds : &#x27;</span>)</span><br><span class="line">line = r.recvline()[:-<span class="number">1</span>].decode()</span><br><span class="line">msg = [line[:<span class="number">32</span>],line[<span class="number">32</span>:<span class="number">64</span>]]</span><br><span class="line">enc = [line[-<span class="number">64</span>:-<span class="number">32</span>],line[-<span class="number">32</span>:]]</span><br><span class="line">alice_user = line[:<span class="number">64</span>]</span><br><span class="line"><span class="built_in">print</span>(line)</span><br><span class="line"><span class="built_in">print</span>(msg)</span><br><span class="line"><span class="built_in">print</span>(enc)</span><br><span class="line">tmp = reduce(hex_xor,[msg[<span class="number">1</span>],enc[<span class="number">0</span>],enc[<span class="number">1</span>]])</span><br><span class="line">alice_user += tmp</span><br><span class="line">r.recvuntil(<span class="string">b&#x27;Username :&#x27;</span>)</span><br><span class="line">r.sendline(alice_user.encode())</span><br><span class="line">r.recvuntil(<span class="string">b&#x27;Your creds : &#x27;</span>)</span><br><span class="line">line = r.recvline()[:-<span class="number">1</span>].decode()</span><br><span class="line">msg.append(line[<span class="number">64</span>:<span class="number">96</span>])</span><br><span class="line">enc.append(line[-<span class="number">32</span>:])</span><br><span class="line">tmp = reduce(hex_xor,[enc[<span class="number">0</span>],enc[<span class="number">2</span>],msg[<span class="number">1</span>]])</span><br><span class="line">alice_user += tmp</span><br><span class="line">r.recvuntil(<span class="string">b&#x27;Username :&#x27;</span>)</span><br><span class="line">r.sendline(alice_user.encode())</span><br><span class="line">r.recvuntil(<span class="string">b&#x27;Hey Alice!&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(r.recvline())</span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure><h4 id="0x13-2022securinets-ctf-quals-2022-escrime-411"><a class="anchor" href="#0x13-2022securinets-ctf-quals-2022-escrime-411">#</a> 0x13 2022Securinets CTF Quals 2022 escrime 4.11</h4><p>å’•å’•äº†å¥½ä¹…äº†ï¼Œé™„ä»¶</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getStrongPrime, getPrime, isPrime, bytes_to_long</span><br><span class="line"></span><br><span class="line">FLAG = <span class="string">b&quot;Securinets&#123;REDACTED&#125;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">genPrime</span>(<span class="params">prime</span>):</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        a = getPrime(<span class="number">256</span>)</span><br><span class="line">        p = <span class="number">2</span>*prime*a + <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> isPrime(p):</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        b = getPrime(<span class="number">256</span>)</span><br><span class="line">        q = <span class="number">2</span>*prime*b + <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> isPrime(q):</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">return</span> p, q</span><br><span class="line"></span><br><span class="line">prime = getStrongPrime(<span class="number">512</span>)</span><br><span class="line">p1, q1 = genPrime(prime)</span><br><span class="line">p2, q2 = genPrime(prime)</span><br><span class="line"><span class="keyword">assert</span> p1 != p2 != q1 != q2</span><br><span class="line"></span><br><span class="line">n1 = p1*q1</span><br><span class="line">n2 = p2*q2</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line">m1 = bytes_to_long(FLAG[:<span class="built_in">len</span>(FLAG)//<span class="number">2</span>])</span><br><span class="line">m2 = bytes_to_long(FLAG[<span class="built_in">len</span>(FLAG)//<span class="number">2</span>:])</span><br><span class="line"></span><br><span class="line">c1 = <span class="built_in">pow</span>(m1, e, n1)</span><br><span class="line">c2 = <span class="built_in">pow</span>(m2, e, n2)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;n1 = <span class="subst">&#123;n1&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;n2 = <span class="subst">&#123;n2&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;e = <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;c1 = <span class="subst">&#123;c1&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;c2 = <span class="subst">&#123;c2&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure><p>æœ€å¼€å§‹ä»¥ä¸ºæ˜¯ rho ç”Ÿæˆçš„ï¼Œåé¢å‘ç°ä¸æ˜¯ï¼Œååº”è¿‡æ¥ä¹‹åè¿™é¢˜å·²ç»è¢«åˆ«äººäº¤äº†å‘œå‘œå‘œï¼Œæˆ‘åªé…åšå¤§ä½¬ä»¬å‡ºè¿‡çš„é¢˜ã€‚</p><p>ä»£ç å¾ˆç®€çŸ­å¾ˆå®¹æ˜“çœ‹æ‡‚ï¼Œå…¬é’¥ç”Ÿæˆçš„åŸç†å¦‚ä¸‹</p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>=</mo><mn>2</mn><mo>Ã—</mo><mi>p</mi><mi>r</mi><mi>i</mi><mi>m</mi><mi>e</mi><mo>Ã—</mo><mi>a</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">p=2 \times prime \times a + 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.625em;vertical-align:-.19444em"></span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.72777em;vertical-align:-.08333em"></span><span class="mord">2</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.85396em;vertical-align:-.19444em"></span><span class="mord mathnormal">p</span><span class="mord mathnormal" style="margin-right:.02778em">r</span><span class="mord mathnormal">i</span><span class="mord mathnormal">m</span><span class="mord mathnormal">e</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.66666em;vertical-align:-.08333em"></span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">1</span></span></span></span></p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>q</mi><mo>=</mo><mn>2</mn><mo>Ã—</mo><mi>p</mi><mi>r</mi><mi>i</mi><mi>m</mi><mi>e</mi><mo>Ã—</mo><mi>b</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">q = 2 \times prime \times b + 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.625em;vertical-align:-.19444em"></span><span class="mord mathnormal" style="margin-right:.03588em">q</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.72777em;vertical-align:-.08333em"></span><span class="mord">2</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.85396em;vertical-align:-.19444em"></span><span class="mord mathnormal">p</span><span class="mord mathnormal" style="margin-right:.02778em">r</span><span class="mord mathnormal">i</span><span class="mord mathnormal">m</span><span class="mord mathnormal">e</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.77777em;vertical-align:-.08333em"></span><span class="mord mathnormal">b</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">1</span></span></span></span></p><p>å…¶ä¸­ prime ä¸º 512 ä½çš„å¼ºç´ æ•°ï¼Œab å‡ä¸º 256 ä½ç´ æ•°ã€‚è¿™é¢˜è€ƒå¯Ÿæ•°è®ºå˜æ¢ï¼Œä¸»è¦è¦æ³¨æ„ä¸åŒæ•°æ®çš„å¤§å°ã€‚æˆ‘å¼€å§‹åœ¨æƒ³ä»–ä¸ºä»€ä¹ˆä¸€å®šè¦æŠŠ flag åˆ†æˆä¸¤éƒ¨åˆ†ï¼Œåé¢å‘ç°æ˜¯<strong>éåˆ†æˆä¸¤æ®µ</strong>ä¸å¯ï¼Œå› ä¸ºä»–å¾—ç»™ä¸¤ç»„ n æ‰èƒ½å‡ºç»“æœã€‚</p><p>æ•°å­¦å˜æ¢å¼å¦‚ä¸‹ï¼š</p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>=</mo><mi>p</mi><mo>Ã—</mo><mi>q</mi><mo>=</mo><mo stretchy="false">(</mo><mn>2</mn><mo>Ã—</mo><mi>p</mi><mi>r</mi><mi>i</mi><mi>m</mi><mi>e</mi><mo>Ã—</mo><mi>a</mi><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo><mo stretchy="false">(</mo><mn>2</mn><mo>Ã—</mo><mi>p</mi><mi>r</mi><mi>i</mi><mi>m</mi><mi>e</mi><mo>Ã—</mo><mi>b</mi><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">n = p \times q = (2 \times prime \times a + 1)(2 \times prime \times b + 1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.7777700000000001em;vertical-align:-.19444em"></span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.625em;vertical-align:-.19444em"></span><span class="mord mathnormal" style="margin-right:.03588em">q</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord">2</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.85396em;vertical-align:-.19444em"></span><span class="mord mathnormal">p</span><span class="mord mathnormal" style="margin-right:.02778em">r</span><span class="mord mathnormal">i</span><span class="mord mathnormal">m</span><span class="mord mathnormal">e</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.66666em;vertical-align:-.08333em"></span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord">1</span><span class="mclose">)</span><span class="mopen">(</span><span class="mord">2</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.85396em;vertical-align:-.19444em"></span><span class="mord mathnormal">p</span><span class="mord mathnormal" style="margin-right:.02778em">r</span><span class="mord mathnormal">i</span><span class="mord mathnormal">m</span><span class="mord mathnormal">e</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.77777em;vertical-align:-.08333em"></span><span class="mord mathnormal">b</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span></p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>=</mo><mn>4</mn><mo>Ã—</mo><mi>p</mi><mi>r</mi><mi>i</mi><mi>m</mi><msup><mi>e</mi><mn>2</mn></msup><mo>Ã—</mo><mi>a</mi><mi>b</mi><mo>+</mo><mn>2</mn><mo>Ã—</mo><mi>p</mi><mi>r</mi><mi>i</mi><mi>m</mi><mi>e</mi><mo>Ã—</mo><mo stretchy="false">(</mo><mi>a</mi><mo>+</mo><mi>b</mi><mo stretchy="false">)</mo><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">n = 4 \times prime^{2} \times ab + 2\times prime \times (a + b) + 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.72777em;vertical-align:-.08333em"></span><span class="mord">4</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.008548em;vertical-align:-.19444em"></span><span class="mord mathnormal">p</span><span class="mord mathnormal" style="margin-right:.02778em">r</span><span class="mord mathnormal">i</span><span class="mord mathnormal">m</span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.77777em;vertical-align:-.08333em"></span><span class="mord mathnormal">a</span><span class="mord mathnormal">b</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.72777em;vertical-align:-.08333em"></span><span class="mord">2</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.85396em;vertical-align:-.19444em"></span><span class="mord mathnormal">p</span><span class="mord mathnormal" style="margin-right:.02778em">r</span><span class="mord mathnormal">i</span><span class="mord mathnormal">m</span><span class="mord mathnormal">e</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal">b</span><span class="mclose">)</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">1</span></span></span></span></p><p>æ‰€ä»¥å¯ä»¥ç²—ç•¥åœ°å¾—å‡º</p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>âˆ’</mo><mn>1</mn><mo>=</mo><mn>2</mn><mo>Ã—</mo><mi>p</mi><mi>r</mi><mi>i</mi><mi>m</mi><mi>e</mi><mo>Ã—</mo><mo stretchy="false">(</mo><mi>p</mi><mi>r</mi><mi>i</mi><mi>m</mi><mi>e</mi><mo>Ã—</mo><mi>a</mi><mi>b</mi><mo>+</mo><mi>a</mi><mo>+</mo><mi>b</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">n-1=2 \times prime \times(prime \times ab + a + b)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.66666em;vertical-align:-.08333em"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">1</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.72777em;vertical-align:-.08333em"></span><span class="mord">2</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.85396em;vertical-align:-.19444em"></span><span class="mord mathnormal">p</span><span class="mord mathnormal" style="margin-right:.02778em">r</span><span class="mord mathnormal">i</span><span class="mord mathnormal">m</span><span class="mord mathnormal">e</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord mathnormal">p</span><span class="mord mathnormal" style="margin-right:.02778em">r</span><span class="mord mathnormal">i</span><span class="mord mathnormal">m</span><span class="mord mathnormal">e</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.77777em;vertical-align:-.08333em"></span><span class="mord mathnormal">a</span><span class="mord mathnormal">b</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.66666em;vertical-align:-.08333em"></span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal">b</span><span class="mclose">)</span></span></span></span></p><p>ä½†æ˜¯æ³¨æ„ï¼Œç›´æ¥ gmpy2.gcd (n1-1,n2-1) å¾—åˆ°çš„ä¸æ˜¯ 2*primeï¼Œå› ä¸ºå¦ä¸€ä¸ªå› æ•°ä¸­é—´æœ‰åŠ å·ï¼Œå¯èƒ½å­˜åœ¨ä¸€äº›å°å› å­ï¼Œå°† gcd å¾—åˆ°çš„ç»“æœæ‹¿å» yafu åˆ†è§£ï¼Œå¾—åˆ°çš„ 512 ä½çš„ç´ æ•°æ‰æ˜¯æˆ‘ä»¬è¦æ±‚çš„ primeã€‚</p><img data-src="/images/2022041101.png" style="zoom:80%"><p>å¾—åˆ° prime ä¹‹åå†å›è¿‡å¤´æ¥çœ‹ nï¼Œæˆ‘ä»¬åˆ†è§£ n çš„ç›®çš„å…¶å®å°±æ˜¯ä¸ºäº†æ±‚ n çš„æ¬§æ‹‰å‡½æ•°<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Ï•</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\phi(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal">Ï•</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span> è¿›è€Œæ±‚åˆ°ç§é’¥ï¼Œæ‰€ä»¥æ±‚å‡º p å’Œ q çš„å€¼ä¸æ˜¯ç›®çš„ï¼Œç›®çš„æ˜¯æ±‚å‡º<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Ï•</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\phi(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal">Ï•</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span>ã€‚ç„¶åæ¥åº·åº·<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Ï•</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\phi(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal">Ï•</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span> çš„è¡¨è¾¾å¼</p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Ï•</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo>=</mo><mo stretchy="false">(</mo><mi>p</mi><mo>âˆ’</mo><mn>1</mn><mo stretchy="false">)</mo><mo>Ã—</mo><mo stretchy="false">(</mo><mi>q</mi><mo>âˆ’</mo><mn>1</mn><mo stretchy="false">)</mo><mo>=</mo><mn>4</mn><mo>Ã—</mo><mi>p</mi><mi>r</mi><mi>i</mi><mi>m</mi><msup><mi>e</mi><mn>2</mn></msup><mo>Ã—</mo><mi>a</mi><mi>b</mi></mrow><annotation encoding="application/x-tex">\phi(n)=(p-1)\times(q-1)=4\times prime^{2}\times ab</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal">Ï•</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:.03588em">q</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.72777em;vertical-align:-.08333em"></span><span class="mord">4</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.008548em;vertical-align:-.19444em"></span><span class="mord mathnormal">p</span><span class="mord mathnormal" style="margin-right:.02778em">r</span><span class="mord mathnormal">i</span><span class="mord mathnormal">m</span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.69444em;vertical-align:0"></span><span class="mord mathnormal">a</span><span class="mord mathnormal">b</span></span></span></span></p><p>æ‰€ä»¥è¦æ±‚å‡º<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mo>Ã—</mo><mi>b</mi></mrow><annotation encoding="application/x-tex">a\times b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.66666em;vertical-align:-.08333em"></span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.69444em;vertical-align:0"></span><span class="mord mathnormal">b</span></span></span></span> æ‰èƒ½æ±‚å¾—<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Ï•</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\phi(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal">Ï•</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span>ï¼Œå†å›è¿‡å¤´å»çœ‹çœ‹ n çš„ç”Ÿæˆè§„å¾‹èƒ½ä¸èƒ½å¾—åˆ°æ–°çš„æ€è·¯ã€‚</p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>âˆ’</mo><mn>1</mn><mo>=</mo><mo stretchy="false">(</mo><mn>4</mn><mo>Ã—</mo><mi>p</mi><mi>r</mi><mi>i</mi><mi>m</mi><msup><mi>e</mi><mn>2</mn></msup><mo>Ã—</mo><mi>a</mi><mi>b</mi><mo stretchy="false">)</mo><mo>+</mo><mn>2</mn><mo>Ã—</mo><mi>p</mi><mi>r</mi><mi>i</mi><mi>m</mi><mi>e</mi><mo>Ã—</mo><mo stretchy="false">(</mo><mi>a</mi><mo>+</mo><mi>b</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">n-1=(4 \times prime^{2} \times ab) + 2\times prime \times (a + b)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.66666em;vertical-align:-.08333em"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">1</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord">4</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.008548em;vertical-align:-.19444em"></span><span class="mord mathnormal">p</span><span class="mord mathnormal" style="margin-right:.02778em">r</span><span class="mord mathnormal">i</span><span class="mord mathnormal">m</span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal">a</span><span class="mord mathnormal">b</span><span class="mclose">)</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.72777em;vertical-align:-.08333em"></span><span class="mord">2</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.85396em;vertical-align:-.19444em"></span><span class="mord mathnormal">p</span><span class="mord mathnormal" style="margin-right:.02778em">r</span><span class="mord mathnormal">i</span><span class="mord mathnormal">m</span><span class="mord mathnormal">e</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal">b</span><span class="mclose">)</span></span></span></span></p><p>å…¶ä¸­ç¬¬ä¸€é¡¹<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>4</mn><mo>Ã—</mo><mi>p</mi><mi>r</mi><mi>i</mi><mi>m</mi><mi>e</mi><msup><mi>s</mi><mn>2</mn></msup><mo>Ã—</mo><mi>a</mi><mi>b</mi></mrow><annotation encoding="application/x-tex">4\times primes^{2} \times ab</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.72777em;vertical-align:-.08333em"></span><span class="mord">4</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.008548em;vertical-align:-.19444em"></span><span class="mord mathnormal">p</span><span class="mord mathnormal" style="margin-right:.02778em">r</span><span class="mord mathnormal">i</span><span class="mord mathnormal">m</span><span class="mord mathnormal">e</span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.69444em;vertical-align:0"></span><span class="mord mathnormal">a</span><span class="mord mathnormal">b</span></span></span></span> ä¸º 1536 ä½ï¼Œç¬¬äºŒé¡¹<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><mo>Ã—</mo><mi>p</mi><mi>r</mi><mi>i</mi><mi>m</mi><mi>e</mi><mo>Ã—</mo><mo stretchy="false">(</mo><mi>a</mi><mo>+</mo><mi>b</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">2 \times prime \times (a+b)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.72777em;vertical-align:-.08333em"></span><span class="mord">2</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.85396em;vertical-align:-.19444em"></span><span class="mord mathnormal">p</span><span class="mord mathnormal" style="margin-right:.02778em">r</span><span class="mord mathnormal">i</span><span class="mord mathnormal">m</span><span class="mord mathnormal">e</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal">b</span><span class="mclose">)</span></span></span></span> ä¸º 768 ä½ï¼Œå…¶ä¸­<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mi>r</mi><mi>i</mi><mi>m</mi><msup><mi>e</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">prime^{2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.008548em;vertical-align:-.19444em"></span><span class="mord mathnormal">p</span><span class="mord mathnormal" style="margin-right:.02778em">r</span><span class="mord mathnormal">i</span><span class="mord mathnormal">m</span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span> ä¸º 1024 ä½</p><p>å¯ä»¥çœ‹å‡ºå‰ä¸€é¡¹æ˜¯æ¯”åä¸€é¡¹å¤§å¾ˆå¤šçš„ï¼Œç”±æ­¤å¯ä»¥å¾—å‡ºæˆ‘ä»¬æ•´é™¤<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mi>r</mi><mi>i</mi><mi>m</mi><msup><mi>e</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">prime^{2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.008548em;vertical-align:-.19444em"></span><span class="mord mathnormal">p</span><span class="mord mathnormal" style="margin-right:.02778em">r</span><span class="mord mathnormal">i</span><span class="mord mathnormal">m</span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span> ä¹‹åï¼Œç¬¬äºŒé¡¹å°±è¢«æ¶ˆå»äº†ï¼Œä¹‹åæˆ‘ä»¬å†ä¹˜å›<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mi>r</mi><mi>i</mi><mi>m</mi><msup><mi>e</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">prime^{2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.008548em;vertical-align:-.19444em"></span><span class="mord mathnormal">p</span><span class="mord mathnormal" style="margin-right:.02778em">r</span><span class="mord mathnormal">i</span><span class="mord mathnormal">m</span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span> å¾—åˆ°çš„å°±æ˜¯<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Ï•</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\phi(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal">Ï•</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">phi = (n - <span class="number">1</span>) // prime // prime * <span class="built_in">pow</span>(prime,<span class="number">2</span>)</span><br></pre></td></tr></table></figure><p>æ±‚å‡ºç§é’¥äº†è¿™é¢˜ä¹Ÿå°±ç»“æŸäº†ï¼Œæ‰€ä»¥å¯¹æ•°æ®çš„å¤§å°è¦æœ‰ä¸€å®šçš„æ•æ„Ÿåº¦</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">n1 = <span class="number">5285941989924581490741575774796326221790301948671605967204654261159288826022690654909746856601734294076351436205238123432817696904524845143908229601315593896823359605609172777227518764838488130850768836467030938547486936412484230693105639039311878853055295612388722273133638524917106191321503530749409311343663516633298043891444321772817485480644504762143353706512690041092791539952154332856635651319630479019844011333570438615137628705917690349203588170944935681</span></span><br><span class="line">n2 = <span class="number">5512656145670579765357132887430527554149315293720001536465226567777071834432904027590899542293511871806792894769506962601330354553170015126601443256295513753986998761021594415121386822360537570074896704547101502955980189351257681515387379761554807684880212096397524725819607628411147885452294832392886405475830663300445429053365129797792206619514994944481130684176571005780217091773969415001961227566026934419626425934895777818074251010427154279687683891897394401</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">c1 = <span class="number">3792561290017712418676552700903779226679678307521013229152018077539055935181708693237786486418411190513573593312739874489485768872374239333562352570689090751306553033406629945001093355613620844532659507519582518955178617942044813600181673015763469247380587771641089223066734168709065596269187564842646397647564064090886856491267151338586218098150720579275673440512159074650632829004798635425409766385176472514086448897744502264325566940224093583630788193949908215</span></span><br><span class="line">c2 = <span class="number">3222093169881176821995152873609430742364413196826316856495679228145853706169389758246323802005549827444022148276365869623395771621464376723299960525487777645386674088866891887984766934440527885549168365996216682223515034398685244541695223412679979637178695229351272286453267599205874775267533781360269542834699741976380260822746797186755978820611721151719635986648586937891954519919600047846994285652165076540057377973800029963140392459328016771048953153246246886</span></span><br><span class="line">prime = gmpy2.gcd(n1 - <span class="number">1</span>,n2 - <span class="number">1</span>)</span><br><span class="line"><span class="built_in">print</span>(prime)</span><br><span class="line"><span class="comment"># print(getPrime(512))</span></span><br><span class="line">prime = <span class="number">12397002878565866184412236037259205021945058505472864688501145731895119789392433217522880454989374040698621943547773164450323280239641723319936790061247301</span></span><br><span class="line">phi1 = (n1 - <span class="number">1</span>) // prime // prime * <span class="built_in">pow</span>(prime,<span class="number">2</span>)</span><br><span class="line">phi2 = (n2 - <span class="number">1</span>) // prime // prime * <span class="built_in">pow</span>(prime,<span class="number">2</span>)</span><br><span class="line">d1 = gmpy2.invert(e,phi1)</span><br><span class="line">d2 = gmpy2.invert(e,phi2)</span><br><span class="line">m1 = <span class="built_in">pow</span>(c1,d1,n1)</span><br><span class="line">m2 = <span class="built_in">pow</span>(c2,d2,n2)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m1) + long_to_bytes(m2))</span><br><span class="line"><span class="comment">#Securinets&#123;G3n3r4t1ng_pr1m3s_1n_4_sp3c1f1c_f0rm_4lm0st_4lw4ys_3nds_b4dly&#125;</span></span><br></pre></td></tr></table></figure><p>è¿™é¢˜éš¾åº¦ä¸ç®—å¤§ï¼Œä½†æ˜¯å“¥å“¥ä»¬äº¤å¤ªå¿«äº†å‘œå‘œ</p><h4 id="0x12-2022hgame-week2-the-password-plus-pro-max-ultra-210"><a class="anchor" href="#0x12-2022hgame-week2-the-password-plus-pro-max-ultra-210">#</a> 0x12 2022hgame week2 The Password Plus Pro Max Ultra 2.10</h4><p>é™„ä»¶</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> functools <span class="keyword">import</span> reduce</span><br><span class="line"><span class="keyword">from</span> operator <span class="keyword">import</span> xor</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> sample</span><br><span class="line"><span class="keyword">from</span> re <span class="keyword">import</span> findall</span><br><span class="line"><span class="keyword">from</span> libnum <span class="keyword">import</span> s2n</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">from</span> solve <span class="keyword">import</span> decrypt</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">move</span>(<span class="params">n, k</span>):</span><br><span class="line">    s = <span class="built_in">bin</span>(n)[<span class="number">2</span>:].zfill(<span class="number">64</span>)</span><br><span class="line">    k &amp;= <span class="number">63</span></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">int</span>(s[k:] + s[:k], <span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">x, ks</span>):</span><br><span class="line">    <span class="keyword">return</span> xor(x, reduce(xor, <span class="built_in">map</span>(<span class="keyword">lambda</span> k: move(x, k), ks)))</span><br><span class="line"></span><br><span class="line">xs = <span class="built_in">list</span>(<span class="built_in">map</span>(s2n, findall(<span class="string">r&quot;.&#123;1,8&#125;&quot;</span>, flag)))</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(xs)):</span><br><span class="line">    ks = sample(<span class="built_in">range</span>(<span class="number">1</span>, <span class="number">64</span>), (i + <span class="number">1</span>) * <span class="number">2</span>)</span><br><span class="line">    y = encrypt(xs[i], ks)</span><br><span class="line">    <span class="keyword">assert</span> xs[i] == decrypt(y, ks)</span><br><span class="line">    <span class="built_in">print</span>(y, <span class="built_in">sorted</span>(ks))</span><br></pre></td></tr></table></figure><p>åˆšæ‹¿åˆ°æ‰‹ä¸Šå¯»æ€æ˜¯ç®—æ³•é¢˜ï¼Œä½†æ˜¯æ³¨æ„è¿™é‡Œçš„ move å‡½æ•°å…¶å®å°±æ˜¯ &lt;&lt;&lt;ï¼Œå¾ªç¯å·¦ç§»ï¼Œå¹¶ä¸”å®šäº†ä¸€ä¸ªç•Œå°±æ˜¯äºŒè¿›åˆ¶çš„å 64 ä½ã€‚è¿™é¢˜æ²¡å‡ºï¼Œèƒ½å¤Ÿåšå‡ºæ¥çš„æ€è·¯æœ‰å¾ˆå¤šï¼Œå¯ä»¥æŠŠä»–å½“ä½œ 64 ä¸ªæœªçŸ¥æ•°å½“æ–¹ç¨‹è¿ç®—ã€‚ä½†æ˜¯é¢˜è§£çš„æ€è·¯æ›´ä¸ºå·§å¦™ï¼Œå‚è€ƒé¢˜è§£å†™å‡ºäº†æˆ‘çš„ç†è§£ã€‚</p><p>é¦–å…ˆå¯ä»¥å°†ä¸€æ¬¡åŠ å¯†è¿™æ ·ç†è§£ï¼š</p><p>y ä¸ºå¯†æ–‡ï¼Œx ä¸ºæ˜æ–‡ï¼Œp å’Œ q æ˜¯ç§»åŠ¨çš„ä½æ•° (å‡è®¾åªæœ‰ä¸¤æ¬¡)ï¼Œä»–ä»¬ä¹‹é—´æ»¡è¶³å¦‚ä¸‹å…³ç³»ï¼š</p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi><mo>=</mo><mi>x</mi><mo>âŠ•</mo><mo stretchy="false">(</mo><mi>x</mi><mo>&gt;</mo><mo>&gt;</mo><mo>&gt;</mo><mi>p</mi><mo stretchy="false">)</mo><mo>âŠ•</mo><mo stretchy="false">(</mo><mi>x</mi><mo>&gt;</mo><mo>&gt;</mo><mo>&gt;</mo><mi>q</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">y=x\oplus(x&gt;&gt;&gt;p)\oplus(x&gt;&gt;&gt;q)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.625em;vertical-align:-.19444em"></span><span class="mord mathnormal" style="margin-right:.03588em">y</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.66666em;vertical-align:-.08333em"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">âŠ•</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">&gt;</span></span><span class="base"><span class="strut" style="height:.5782em;vertical-align:-.0391em"></span><span class="mrel">&gt;</span></span><span class="base"><span class="strut" style="height:.5782em;vertical-align:-.0391em"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal">p</span><span class="mclose">)</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">âŠ•</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">&gt;</span></span><span class="base"><span class="strut" style="height:.5782em;vertical-align:-.0391em"></span><span class="mrel">&gt;</span></span><span class="base"><span class="strut" style="height:.5782em;vertical-align:-.0391em"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal" style="margin-right:.03588em">q</span><span class="mclose">)</span></span></span></span></p><p>ç„¶ååšä¸¤æ¬¡å˜å½¢å¾—åˆ°ï¼š</p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi><mo>&gt;</mo><mo>&gt;</mo><mo>&gt;</mo><mi>p</mi><mo>=</mo><mo stretchy="false">(</mo><mi>x</mi><mo>&gt;</mo><mo>&gt;</mo><mo>&gt;</mo><mi>p</mi><mo stretchy="false">)</mo><mo>âŠ•</mo><mo stretchy="false">(</mo><mi>x</mi><mo>&gt;</mo><mo>&gt;</mo><mo>&gt;</mo><mn>2</mn><mi>p</mi><mo stretchy="false">)</mo><mo>âŠ•</mo><mo stretchy="false">(</mo><mi>x</mi><mo>&gt;</mo><mo>&gt;</mo><mo>&gt;</mo><mo stretchy="false">(</mo><mi>p</mi><mo>+</mo><mi>q</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">y&gt;&gt;&gt;p=(x&gt;&gt;&gt;p)\oplus(x&gt;&gt;&gt;2p)\oplus(x&gt;&gt;&gt;(p+q))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.7335400000000001em;vertical-align:-.19444em"></span><span class="mord mathnormal" style="margin-right:.03588em">y</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">&gt;</span></span><span class="base"><span class="strut" style="height:.5782em;vertical-align:-.0391em"></span><span class="mrel">&gt;</span></span><span class="base"><span class="strut" style="height:.5782em;vertical-align:-.0391em"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.625em;vertical-align:-.19444em"></span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">&gt;</span></span><span class="base"><span class="strut" style="height:.5782em;vertical-align:-.0391em"></span><span class="mrel">&gt;</span></span><span class="base"><span class="strut" style="height:.5782em;vertical-align:-.0391em"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal">p</span><span class="mclose">)</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">âŠ•</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">&gt;</span></span><span class="base"><span class="strut" style="height:.5782em;vertical-align:-.0391em"></span><span class="mrel">&gt;</span></span><span class="base"><span class="strut" style="height:.5782em;vertical-align:-.0391em"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord">2</span><span class="mord mathnormal">p</span><span class="mclose">)</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">âŠ•</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">&gt;</span></span><span class="base"><span class="strut" style="height:.5782em;vertical-align:-.0391em"></span><span class="mrel">&gt;</span></span><span class="base"><span class="strut" style="height:.5782em;vertical-align:-.0391em"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal" style="margin-right:.03588em">q</span><span class="mclose">)</span><span class="mclose">)</span></span></span></span></p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi><mo>&gt;</mo><mo>&gt;</mo><mo>&gt;</mo><mi>q</mi><mo>=</mo><mo stretchy="false">(</mo><mi>x</mi><mo>&gt;</mo><mo>&gt;</mo><mo>&gt;</mo><mi>q</mi><mo stretchy="false">)</mo><mo>âŠ•</mo><mo stretchy="false">(</mo><mi>x</mi><mo>&gt;</mo><mo>&gt;</mo><mo>&gt;</mo><mo stretchy="false">(</mo><mi>p</mi><mo>+</mo><mi>q</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo>âŠ•</mo><mo stretchy="false">(</mo><mi>x</mi><mo>&gt;</mo><mo>&gt;</mo><mo>&gt;</mo><mn>2</mn><mi>q</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">y&gt;&gt;&gt;q=(x&gt;&gt;&gt;q)\oplus(x&gt;&gt;&gt;(p+q))\oplus(x&gt;&gt;&gt;2q)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.7335400000000001em;vertical-align:-.19444em"></span><span class="mord mathnormal" style="margin-right:.03588em">y</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">&gt;</span></span><span class="base"><span class="strut" style="height:.5782em;vertical-align:-.0391em"></span><span class="mrel">&gt;</span></span><span class="base"><span class="strut" style="height:.5782em;vertical-align:-.0391em"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.625em;vertical-align:-.19444em"></span><span class="mord mathnormal" style="margin-right:.03588em">q</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">&gt;</span></span><span class="base"><span class="strut" style="height:.5782em;vertical-align:-.0391em"></span><span class="mrel">&gt;</span></span><span class="base"><span class="strut" style="height:.5782em;vertical-align:-.0391em"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal" style="margin-right:.03588em">q</span><span class="mclose">)</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">âŠ•</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">&gt;</span></span><span class="base"><span class="strut" style="height:.5782em;vertical-align:-.0391em"></span><span class="mrel">&gt;</span></span><span class="base"><span class="strut" style="height:.5782em;vertical-align:-.0391em"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal" style="margin-right:.03588em">q</span><span class="mclose">)</span><span class="mclose">)</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">âŠ•</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">&gt;</span></span><span class="base"><span class="strut" style="height:.5782em;vertical-align:-.0391em"></span><span class="mrel">&gt;</span></span><span class="base"><span class="strut" style="height:.5782em;vertical-align:-.0391em"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord">2</span><span class="mord mathnormal" style="margin-right:.03588em">q</span><span class="mclose">)</span></span></span></span></p><p>ä¸‰å¼å¼‚æˆ–å¾—åˆ°ï¼š</p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi><mo>âŠ•</mo><mo stretchy="false">(</mo><mi>y</mi><mo>&gt;</mo><mo>&gt;</mo><mo>&gt;</mo><mi>p</mi><mo stretchy="false">)</mo><mo>âŠ•</mo><mo stretchy="false">(</mo><mi>y</mi><mo>&gt;</mo><mo>&gt;</mo><mo>&gt;</mo><mi>q</mi><mo stretchy="false">)</mo><mo>=</mo><mi>x</mi><mo>âŠ•</mo><mo stretchy="false">(</mo><mi>x</mi><mo>&gt;</mo><mo>&gt;</mo><mo>&gt;</mo><mn>2</mn><mi>p</mi><mo stretchy="false">)</mo><mo>âŠ•</mo><mo stretchy="false">(</mo><mi>x</mi><mo>&gt;</mo><mo>&gt;</mo><mo>&gt;</mo><mn>2</mn><mi>q</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">y\oplus(y&gt;&gt;&gt;p)\oplus(y&gt;&gt;&gt;q)=x\oplus(x&gt;&gt;&gt;2p)\oplus(x&gt;&gt;&gt;2q)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.7777700000000001em;vertical-align:-.19444em"></span><span class="mord mathnormal" style="margin-right:.03588em">y</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">âŠ•</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:.03588em">y</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">&gt;</span></span><span class="base"><span class="strut" style="height:.5782em;vertical-align:-.0391em"></span><span class="mrel">&gt;</span></span><span class="base"><span class="strut" style="height:.5782em;vertical-align:-.0391em"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal">p</span><span class="mclose">)</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">âŠ•</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:.03588em">y</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">&gt;</span></span><span class="base"><span class="strut" style="height:.5782em;vertical-align:-.0391em"></span><span class="mrel">&gt;</span></span><span class="base"><span class="strut" style="height:.5782em;vertical-align:-.0391em"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal" style="margin-right:.03588em">q</span><span class="mclose">)</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.66666em;vertical-align:-.08333em"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">âŠ•</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">&gt;</span></span><span class="base"><span class="strut" style="height:.5782em;vertical-align:-.0391em"></span><span class="mrel">&gt;</span></span><span class="base"><span class="strut" style="height:.5782em;vertical-align:-.0391em"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord">2</span><span class="mord mathnormal">p</span><span class="mclose">)</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">âŠ•</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">&gt;</span></span><span class="base"><span class="strut" style="height:.5782em;vertical-align:-.0391em"></span><span class="mrel">&gt;</span></span><span class="base"><span class="strut" style="height:.5782em;vertical-align:-.0391em"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord">2</span><span class="mord mathnormal" style="margin-right:.03588em">q</span><span class="mclose">)</span></span></span></span></p><p>å¦‚æœå°†å³è¾¹çš„å¼å­å†åšå˜å½¢å†å¼‚æˆ–å¯ä»¥å¾—åˆ°ï¼š</p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi><mo>âŠ•</mo><mo stretchy="false">(</mo><mi>y</mi><mo>&gt;</mo><mo>&gt;</mo><mo>&gt;</mo><mn>2</mn><mi>p</mi><mo stretchy="false">)</mo><mo>âŠ•</mo><mo stretchy="false">(</mo><mi>y</mi><mo>&gt;</mo><mo>&gt;</mo><mo>&gt;</mo><mn>2</mn><mi>q</mi><mo stretchy="false">)</mo><mo>=</mo><mi>x</mi><mo>âŠ•</mo><mo stretchy="false">(</mo><mi>x</mi><mo>&gt;</mo><mo>&gt;</mo><mo>&gt;</mo><mn>3</mn><mi>p</mi><mo stretchy="false">)</mo><mo>âŠ•</mo><mo stretchy="false">(</mo><mi>x</mi><mo>&gt;</mo><mo>&gt;</mo><mo>&gt;</mo><mn>3</mn><mi>q</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">y\oplus(y&gt;&gt;&gt;2p)\oplus(y&gt;&gt;&gt;2q)=x\oplus(x&gt;&gt;&gt;3p)\oplus(x&gt;&gt;&gt;3q)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.7777700000000001em;vertical-align:-.19444em"></span><span class="mord mathnormal" style="margin-right:.03588em">y</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">âŠ•</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:.03588em">y</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">&gt;</span></span><span class="base"><span class="strut" style="height:.5782em;vertical-align:-.0391em"></span><span class="mrel">&gt;</span></span><span class="base"><span class="strut" style="height:.5782em;vertical-align:-.0391em"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord">2</span><span class="mord mathnormal">p</span><span class="mclose">)</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">âŠ•</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:.03588em">y</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">&gt;</span></span><span class="base"><span class="strut" style="height:.5782em;vertical-align:-.0391em"></span><span class="mrel">&gt;</span></span><span class="base"><span class="strut" style="height:.5782em;vertical-align:-.0391em"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord">2</span><span class="mord mathnormal" style="margin-right:.03588em">q</span><span class="mclose">)</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.66666em;vertical-align:-.08333em"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">âŠ•</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">&gt;</span></span><span class="base"><span class="strut" style="height:.5782em;vertical-align:-.0391em"></span><span class="mrel">&gt;</span></span><span class="base"><span class="strut" style="height:.5782em;vertical-align:-.0391em"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord">3</span><span class="mord mathnormal">p</span><span class="mclose">)</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">âŠ•</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">&gt;</span></span><span class="base"><span class="strut" style="height:.5782em;vertical-align:-.0391em"></span><span class="mrel">&gt;</span></span><span class="base"><span class="strut" style="height:.5782em;vertical-align:-.0391em"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord">3</span><span class="mord mathnormal" style="margin-right:.03588em">q</span><span class="mclose">)</span></span></span></span></p><p>æ•…å¾—åˆ°åŠ å¯†çš„æœ¬è´¨å…¶å®æ˜¯ï¼š</p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>â†’</mo><mi>x</mi><mo>âŠ•</mo><mo stretchy="false">(</mo><mi>x</mi><mo>&gt;</mo><mo>&gt;</mo><mo>&gt;</mo><mi>k</mi><mi>p</mi><mo stretchy="false">)</mo><mo>âŠ•</mo><mo stretchy="false">(</mo><mo>â‹¯</mo><mtext></mtext><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">x \to x\oplus(x&gt;&gt;&gt;kp)\oplus(\cdots)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">â†’</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.66666em;vertical-align:-.08333em"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">âŠ•</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">&gt;</span></span><span class="base"><span class="strut" style="height:.5782em;vertical-align:-.0391em"></span><span class="mrel">&gt;</span></span><span class="base"><span class="strut" style="height:.5782em;vertical-align:-.0391em"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal" style="margin-right:.03148em">k</span><span class="mord mathnormal">p</span><span class="mclose">)</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">âŠ•</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="minner">â‹¯</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mclose">)</span></span></span></span></p><p>å› ä¸º move å®šäº†ä¸€ä¸ªç•Œï¼Œæ‰€ä»¥æ˜æ–‡åªè¦åŠ å¯† 64k æ¬¡å°±è¿˜æ˜¯æ˜æ–‡ã€‚å¾—åˆ°çš„ y æ˜¯å·²ç»ç»è¿‡ä¸€æ¬¡åŠ å¯†ä¹‹åçš„å¯†æ–‡ï¼Œåªè¦å†åŠ å¯† 63 æ¬¡å°±å¯ä»¥å¾—åˆ°æ˜æ–‡ã€‚</p><p>expï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> operator <span class="keyword">import</span> xor</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> functools <span class="keyword">import</span> reduce</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">x, ks</span>):</span><br><span class="line">    <span class="keyword">return</span> xor(x, reduce(xor, <span class="built_in">map</span>(<span class="keyword">lambda</span> k: move(x, k), ks)))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">move</span>(<span class="params">n, k</span>):</span><br><span class="line">    s = <span class="built_in">bin</span>(n)[<span class="number">2</span>:].zfill(<span class="number">64</span>)</span><br><span class="line">    k &amp;= <span class="number">63</span><span class="comment">#å–äºŒè¿›åˆ¶çš„å8ä½</span></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">int</span>(s[k:] + s[:k], <span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">y,ks</span>):</span><br><span class="line">    tmp = y</span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">63</span>):</span><br><span class="line">        tmp = encrypt(tmp,ks)</span><br><span class="line">    <span class="keyword">return</span> long_to_bytes(tmp)</span><br><span class="line"></span><br><span class="line">y = [<span class="number">2656224875120172108</span>,<span class="number">1261711348908201279</span>, <span class="number">18219282869614004824</span>,<span class="number">15279054981769814589</span>,<span class="number">7966355346882200701</span>,<span class="number">5641592208539483808</span>,<span class="number">1502927090219059154</span>,<span class="number">3996223120734273799</span>,<span class="number">18295033054788808618</span>,<span class="number">18126228466291248047</span>,<span class="number">9413762634844369954</span>,<span class="number">8964324149921197550</span>,<span class="number">6962485320551449848</span>]</span><br><span class="line">ks = [[<span class="number">8</span>, <span class="number">35</span>],[<span class="number">19</span>, <span class="number">29</span>, <span class="number">30</span>, <span class="number">45</span>], [<span class="number">6</span>, <span class="number">16</span>, <span class="number">18</span>, <span class="number">21</span>, <span class="number">44</span>, <span class="number">55</span>], [<span class="number">10</span>, <span class="number">26</span>, <span class="number">30</span>, <span class="number">46</span>, <span class="number">51</span>, <span class="number">54</span>, <span class="number">58</span>, <span class="number">63</span>],[<span class="number">5</span>, <span class="number">13</span>, <span class="number">25</span>, <span class="number">29</span>, <span class="number">37</span>, <span class="number">39</span>, <span class="number">43</span>, <span class="number">52</span>, <span class="number">53</span>, <span class="number">59</span>],[<span class="number">1</span>, <span class="number">26</span>, <span class="number">31</span>, <span class="number">39</span>, <span class="number">40</span>, <span class="number">41</span>, <span class="number">43</span>, <span class="number">45</span>, <span class="number">49</span>, <span class="number">52</span>, <span class="number">54</span>, <span class="number">62</span>],[<span class="number">8</span>, <span class="number">12</span>, <span class="number">19</span>, <span class="number">20</span>, <span class="number">30</span>, <span class="number">32</span>, <span class="number">34</span>, <span class="number">40</span>, <span class="number">41</span>, <span class="number">45</span>, <span class="number">46</span>, <span class="number">49</span>, <span class="number">55</span>, <span class="number">58</span>],[<span class="number">2</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">8</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">19</span>, <span class="number">26</span>, <span class="number">27</span>, <span class="number">33</span>, <span class="number">40</span>, <span class="number">42</span>, <span class="number">47</span>, <span class="number">52</span>, <span class="number">61</span>], [<span class="number">1</span>, <span class="number">16</span>, <span class="number">17</span>, <span class="number">27</span>, <span class="number">28</span>, <span class="number">30</span>, <span class="number">32</span>, <span class="number">36</span>, <span class="number">37</span>, <span class="number">38</span>, <span class="number">39</span>, <span class="number">48</span>, <span class="number">49</span>, <span class="number">51</span>, <span class="number">55</span>, <span class="number">57</span>, <span class="number">59</span>, <span class="number">62</span>], [<span class="number">5</span>, <span class="number">11</span>, <span class="number">12</span>, <span class="number">20</span>, <span class="number">22</span>, <span class="number">23</span>, <span class="number">25</span>, <span class="number">27</span>, <span class="number">31</span>, <span class="number">32</span>, <span class="number">33</span>, <span class="number">37</span>, <span class="number">44</span>, <span class="number">45</span>, <span class="number">49</span>, <span class="number">52</span>, <span class="number">53</span>, <span class="number">59</span>, <span class="number">61</span>, <span class="number">62</span>],[<span class="number">2</span>, <span class="number">7</span>, <span class="number">10</span>, <span class="number">12</span>, <span class="number">18</span>, <span class="number">19</span>, <span class="number">20</span>, <span class="number">22</span>, <span class="number">26</span>, <span class="number">29</span>, <span class="number">33</span>, <span class="number">34</span>, <span class="number">38</span>, <span class="number">40</span>, <span class="number">41</span>, <span class="number">45</span>, <span class="number">46</span>, <span class="number">51</span>, <span class="number">54</span>, <span class="number">56</span>, <span class="number">57</span>, <span class="number">60</span>],[<span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">9</span>, <span class="number">12</span>, <span class="number">13</span>, <span class="number">18</span>, <span class="number">19</span>, <span class="number">21</span>, <span class="number">23</span>, <span class="number">24</span>, <span class="number">25</span>, <span class="number">30</span>, <span class="number">33</span>, <span class="number">34</span>, <span class="number">35</span>, <span class="number">37</span>, <span class="number">39</span>, <span class="number">43</span>, <span class="number">44</span>, <span class="number">46</span>, <span class="number">49</span>, <span class="number">50</span>, <span class="number">53</span>],[<span class="number">1</span>, <span class="number">3</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">10</span>, <span class="number">11</span>, <span class="number">13</span>, <span class="number">14</span>, <span class="number">23</span>, <span class="number">27</span>, <span class="number">32</span>, <span class="number">33</span>, <span class="number">35</span>, <span class="number">37</span>, <span class="number">39</span>, <span class="number">41</span>, <span class="number">46</span>, <span class="number">48</span>, <span class="number">49</span>, <span class="number">50</span>, <span class="number">51</span>, <span class="number">53</span>, <span class="number">54</span>, <span class="number">56</span>, <span class="number">58</span>, <span class="number">62</span>]]</span><br><span class="line">flag = <span class="string">b&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(y)):</span><br><span class="line">    flag += decrypt(y[i],ks[i])</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="comment">#hgame&#123;XOr|RoR&amp;rOl|Is+vERY#coMmon*BiTwisE$OPeraTiOn*IT@is%oFten,ENCOUntErED*in.syMMeTRic?encryPtION&#125;</span></span><br></pre></td></tr></table></figure><p>è¢«é¢˜ç›®æš´æ‰“äº†å‘œå‘œå‘œï¼Œæƒ³å­¦ä¸€ä¸‹å½“ä½œ 64 ä½æœªçŸ¥æ•°çš„è§£æ³•ã€‚</p><h4 id="0x11-2020ç¾ŠåŸæ¯-invitations-117"><a class="anchor" href="#0x11-2020ç¾ŠåŸæ¯-invitations-117">#</a> 0x11 2020 ç¾ŠåŸæ¯ Invitations 1.17</h4><p>é™„ä»¶</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getPrime, bytes_to_long</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">pad</span>(<span class="params">s,i</span>):</span><br><span class="line">    <span class="keyword">return</span> i * <span class="built_in">pow</span>(<span class="number">3</span>,s.bit_length()) + s**<span class="number">2</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gen_N</span>():</span><br><span class="line">    <span class="keyword">return</span> getPrime(<span class="number">512</span>) * getPrime(<span class="number">512</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">len</span>(flag) == <span class="number">54</span></span><br><span class="line">invite = bytes_to_long(flag)</span><br><span class="line"></span><br><span class="line">e_list = [random.choice([<span class="number">3</span>,<span class="number">5</span>,<span class="number">7</span>]) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">14</span>)]</span><br><span class="line">N_list = [gen_N() <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">14</span>)]</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;./invitations&#x27;</span>,<span class="string">&#x27;w&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">14</span>):</span><br><span class="line">        invis = <span class="built_in">pow</span>(pad(invite,i+<span class="number">1</span>),e_list[i],N_list[i])</span><br><span class="line">        f.write(<span class="string">&#x27;Invitation%d: %d \n&#x27;</span>%(i+<span class="number">1</span>,invis))</span><br><span class="line"></span><br><span class="line">    f.write(<span class="string">&#x27;Wait a minute! \n&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">14</span>):</span><br><span class="line">        f.write(<span class="string">&#x27;[e%d,N%d]: [%d,%d]\n&#x27;</span>%(i+<span class="number">1</span>,i+<span class="number">1</span>,e_list[i],N_list[i]))</span><br></pre></td></tr></table></figure><p>æ˜“æ±‚å¾—ï¼šs.bit_length ()=431</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>i</mi><mi>n</mi><mi>v</mi><mi>i</mi><mi>s</mi><mo>=</mo><mo stretchy="false">(</mo><mi>i</mi><mo>Ã—</mo><msup><mn>3</mn><mn>431</mn></msup><mo>+</mo><mi>f</mi><mi>l</mi><mi>a</mi><msup><mi>g</mi><mn>2</mn></msup><msup><mo stretchy="false">)</mo><mi>e</mi></msup><mspace></mspace><mspace width="1em"><mo stretchy="false">(</mo><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mspace width="0.3333333333333333em"><mi>N</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">invis = (i \times 3^{431} + flag^{2})^{e} \pmod N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.65952em;vertical-align:0"></span><span class="mord mathnormal">i</span><span class="mord mathnormal">n</span><span class="mord mathnormal" style="margin-right:.03588em">v</span><span class="mord mathnormal">i</span><span class="mord mathnormal">s</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.9474379999999999em;vertical-align:-.08333em"></span><span class="mord"><span class="mord">3</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8641079999999999em"><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">4</span><span class="mord mtight">3</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.1141079999999999em;vertical-align:-.25em"></span><span class="mord mathnormal" style="margin-right:.10764em">f</span><span class="mord mathnormal" style="margin-right:.01968em">l</span><span class="mord mathnormal">a</span><span class="mord"><span class="mord mathnormal" style="margin-right:.03588em">g</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8641079999999999em"><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.7143919999999999em"><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">e</span></span></span></span></span></span></span></span></span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:1em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:.3333333333333333em"></span><span class="mord mathnormal" style="margin-right:.10903em">N</span><span class="mclose">)</span></span></span></span></span></p><p>å…¶ä¸­åªæœ‰ flag æ˜¯æœªçŸ¥é‡ï¼Œé¢˜ç›®ç»™äº†å¾ˆå¤šç»„è§£ã€‚é€‰å– e=3 çš„å‡ ç»„è§£</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>c</mi><mi>s</mi><mo>=</mo><mo stretchy="false">(</mo><mi>B</mi><mi>s</mi><mo>+</mo><mi>f</mi><mi>l</mi><mi>a</mi><mi>g</mi><msup><mo stretchy="false">)</mo><mn>3</mn></msup><mspace></mspace><mspace width="1em"><mo stretchy="false">(</mo><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mspace width="0.3333333333333333em"><mi>N</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">cs=(Bs + flag)^{3} \pmod N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord mathnormal">c</span><span class="mord mathnormal">s</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:.05017em">B</span><span class="mord mathnormal">s</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.1141079999999999em;vertical-align:-.25em"></span><span class="mord mathnormal" style="margin-right:.10764em">f</span><span class="mord mathnormal" style="margin-right:.01968em">l</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:.03588em">g</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8641079999999999em"><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span></span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:1em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:.3333333333333333em"></span><span class="mord mathnormal" style="margin-right:.10903em">N</span><span class="mclose">)</span></span></span></span></span></p><p>å…¶ä¸­ï¼ŒBs=<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo>Ã—</mo><msup><mn>3</mn><mn>431</mn></msup></mrow><annotation encoding="application/x-tex">i \times 3^{431}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.74285em;vertical-align:-.08333em"></span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.8141079999999999em;vertical-align:0"></span><span class="mord"><span class="mord">3</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">4</span><span class="mord mtight">3</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span>ï¼Œcs=invisã€‚</p><p>exp æ¥è‡ª striving ä½¬çš„åšå®¢ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">cs = [<span class="number">129274519334082165644106292383763271862424981496822335330342328217347928093592453953990448827969549377883054831490973006383371688359344675312001881631556371220779971357039899721241880304156884612458373310254854821837978876725801047977081900824202659636258168216028784656056334358157381820784576207338479493823</span>, <span class="number">8140023566779187828652447593867705813386781164538611122714708931585587727699213769519135028841126072130625547328311301696554048174772606261707345115571968105138543476580875347239912760797035694220505996377127309341770427102697008350472060971360460756799310951343070384766137332401117333917901167639276168214</span>, <span class="number">25434511525127530194830986592289179576070740435049947678930286998924519588985583799757299734846614343604661534391991096353170465467791358514448923161460366596251448937540153262731348684727026598527904328268639060306102090278287818149679940661579357649191023269947102746200467430583428889484549034314463114080</span>, <span class="number">9435583236354598287661880148272717764447540972316605192855157484524753847806158586224733743434644389385148450722945845355791145016665856388503878165725148745517696840251674049929524448078129458846254866804153080766917319923905682824180976106679633180818527967145571143203594244851742143986040226240019541346</span>]</span><br><span class="line">Ns = [<span class="number">146694460234280339612721415368435987068740712812770728817136582256341063038147863645902264969297892447333024201649306207442798919845916187823646745721109151386096190207317810424580842120750075213595282979568495342617919336417068886973047979116994072272482630372638964064972815256237040541007947708358680368391</span>, <span class="number">65031485534704406281490718325237831433086480239135617407356760819741796565231283220528137697949585150709734732370203390254643835828984376427852793969716489016520923272675090536677771074867975287284694860155903327351119710765174437247599498342292671117884858621418276613385329637307269711179183430246951756029</span>, <span class="number">126172075578367446151297289668746433680600889845504078949758568698284471307000358407453139846282095477016675769468273204536898117467559575203458221600341760844973676129445394999861380625435418853474246813202182316736885441120197888145039130477114127079444939102267586634051045795627433724810346460217871661901</span>, <span class="number">75691424835079457343374072990750986689075078863640186724151061449621926239051140991748483370587430224317778303489124525034113533087612981452189061743589227565099659070008017454957304620495920813121234552401715857719372861565651204968408267740732475458128601061676264465241188491988485848198323410127587280471</span>]</span><br><span class="line">B = [<span class="number">130732040222851824313696449987153029924371122238848027365037357297776778759867316566762151412818918312428287717025992710824535681461390797938699373612526042317415057049122693829277442013233093340157044859841</span>, <span class="number">348618773927604864836523866632408079798322992636928072973432952794071410026312844178032403767517115499808767245402647228865428483897042127836531662966736112846440152130993850211406512035288248907085452959576</span>, <span class="number">435773467409506081045654833290510099747903740796160091216791190992589262532891055222540504709396394374760959056753309036081785604871302659795664578708420141058050190163742312764258140044110311133856816199470</span>, <span class="number">479350814150456689150220316619561109722694114875776100338470310091848188786180160744794555180336033812237054962428639939689964165358432925775231036579262155163855209180116544040683954048521342247242497819417</span>]</span><br><span class="line">e = <span class="number">3</span></span><br><span class="line">PR.&lt;x&gt; = PolynomialRing(ZZ)</span><br><span class="line">Fs = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(cs)):</span><br><span class="line">    f =  (x + B[i])**e - cs[i]</span><br><span class="line"><span class="comment">#     ff = f.change_ring(Zmod(Ns[i]))</span></span><br><span class="line"><span class="comment">#     ff = ff.monic()</span></span><br><span class="line">    </span><br><span class="line">    Fs.append(f)</span><br><span class="line"><span class="built_in">print</span>(Fs)</span><br><span class="line">F = crt(Fs, Ns)<span class="comment">#éœ€åœ¨ZZç¯ä¸­è¿è¡Œ</span></span><br><span class="line"><span class="built_in">print</span>(F)</span><br><span class="line">M = reduce( <span class="keyword">lambda</span> x, y: x * y, Ns )</span><br><span class="line"></span><br><span class="line">FF = F.change_ring(Zmod(M))</span><br><span class="line"></span><br><span class="line">m = FF.small_roots(X=<span class="number">2</span>^<span class="number">862</span>,beta=<span class="number">1</span>)[<span class="number">0</span>]</span><br><span class="line"><span class="built_in">print</span>(m)</span><br></pre></td></tr></table></figure><p>å¾—åˆ°çš„ m å¼€ä¸ªäºŒæ¬¡æ–¹å† long_to_bytes å°±æ˜¯ flag äº†ã€‚</p><h4 id="0x10-ctfshowæ‘†çƒ‚æ¯-easypeasy-110"><a class="anchor" href="#0x10-ctfshowæ‘†çƒ‚æ¯-easypeasy-110">#</a> 0x10 ctfshow æ‘†çƒ‚æ¯ easypeasy 1.10</h4><p>é™„ä»¶</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">1024</span>)</span><br><span class="line">q = getPrime(<span class="number">1024</span>)</span><br><span class="line">n = p * q</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;n = <span class="subst">&#123;n&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line">l = <span class="built_in">len</span>(flag)</span><br><span class="line"><span class="keyword">assert</span>(l == <span class="number">86</span>)</span><br><span class="line">m = bytes_to_long(<span class="string">b&#x27;\x00&#x27;</span> * (l - <span class="number">1</span>) + flag + <span class="string">b&#x27;\x00&#x27;</span> * (l - <span class="number">2</span>))</span><br><span class="line">e = <span class="number">3</span></span><br><span class="line">c = <span class="built_in">pow</span>(m, e, n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;c = <span class="subst">&#123;c&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># n = 23570098360097260908266914080954003513706885568390448463720576188146956287111601604870247233822682630020002051748117520481402155749832096007629686239669192722978473890311246293580246256300691145653885805730865515297134808702766299205253761028235483781919393575836334910012714628455073300114978717047912395404034141622115001451888302617428376998024080880564792294546406688814397757714979980790018933407614160131827023349206138480523080173634617167828920519758917549492886733519381497665596997617399404664611446202014908853898043742964782757859701755202188366852773164911994663079171498909577012208742001609095258401847</span></span><br><span class="line"><span class="comment"># c = 7802816471025387606454709075933309958303134972861203739854774032383575355964299097074709350633475519273512630813578801152996777689686451397201513854823239337669091889776200179028891111154423623765139235199507280104544068425347533121731521700106757148551520759776111224072064131087547685154285120156917449926992033491342535410929828988598182819897435365878832122138552492908774845437576910276499625679469289655841639181182040186931130789588869657335253479416209378458303531995734157105918063227453396477282662136225029972745246845372963076381252679409317314514131852117346576265346926741908194011319430767975281696400</span></span><br></pre></td></tr></table></figure><p>ç»™äº† nã€cã€eï¼Œè€Œä¸” e=3ï¼Œä¹ä¸€çœ‹æ˜¯ä¸€ä¸ªå•çº¯çš„ä½æŒ‡æ•°åŠ å¯†çˆ†ç ´ï¼Œä½†æ˜¯æ³¨æ„ä¸€ä¸‹ flag è½¬æˆå¤§æ•°ä¹‹åçš„ m è¢«æ‰©å¤§äº†å¾ˆå¤šï¼Œå‰åéƒ½è¢«åŠ äº†å¾ˆå¤šçš„ \x00ï¼Œå‰é¢çš„ \x00 å¯¹å¤§æ•°ä¸é€ æˆä»€ä¹ˆå½±å“ï¼Œé‡ç‚¹æ˜¯ç ”ç©¶åé¢çš„ 84 ä¸ª \x00ã€‚ç”¨ python å®éªŒå†åŠ ä¸Šè‡ªå·±çš„ç†è§£å¾—å‡ºç»“è®ºï¼š<strong>flag åé¢æ¯åŠ ä¸€ä¸ª \x00 éƒ½æ˜¯ç»™å¤§æ•°å¢å¤§ 256 å€</strong>ã€‚<br>æ‰€ä»¥å¯ä»¥å¾—åˆ°<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mo>=</mo><mi>f</mi><mi>l</mi><mi>a</mi><mi>g</mi><mo>Ã—</mo><mn>25</mn><msup><mn>6</mn><mn>84</mn></msup></mrow><annotation encoding="application/x-tex">m = flag \times 256^{84}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.8888799999999999em;vertical-align:-.19444em"></span><span class="mord mathnormal" style="margin-right:.10764em">f</span><span class="mord mathnormal" style="margin-right:.01968em">l</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:.03588em">g</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.8141079999999999em;vertical-align:0"></span><span class="mord">2</span><span class="mord">5</span><span class="mord"><span class="mord">6</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">8</span><span class="mord mtight">4</span></span></span></span></span></span></span></span></span></span></span></span><br>ç»“åˆæ­£å¸¸çš„ RSA æµç¨‹å¯å¾—åˆ°ï¼š<br><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mo>=</mo><mi>f</mi><mi>l</mi><mi>a</mi><msup><mi>g</mi><mi>e</mi></msup><mo>Ã—</mo><mn>25</mn><msup><mn>6</mn><mn>252</mn></msup><mspace></mspace><mspace width="0.4444444444444444em"><mo stretchy="false">(</mo><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mspace width="0.3333333333333333em"><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">c=flag^{e} \times 256^{252} \pmod n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord mathnormal">c</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.8888799999999999em;vertical-align:-.19444em"></span><span class="mord mathnormal" style="margin-right:.10764em">f</span><span class="mord mathnormal" style="margin-right:.01968em">l</span><span class="mord mathnormal">a</span><span class="mord"><span class="mord mathnormal" style="margin-right:.03588em">g</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.664392em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">e</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.8141079999999999em;vertical-align:0"></span><span class="mord">2</span><span class="mord">5</span><span class="mord"><span class="mord">6</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">5</span><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:.4444444444444444em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:.3333333333333333em"></span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span><br>ä¹‹å‰è¿™é‡Œå¡äº†åŠå¤©ï¼Œåœ¨å®‹å¸ˆçˆ¶çš„æŒ‡ç‚¹ä¸‹ï¼Œä¸€ä¸ªç®€å•çš„æ•°è®ºé—®é¢˜<br><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mo>Ã—</mo><mo stretchy="false">(</mo><mn>25</mn><msup><mn>6</mn><mn>252</mn></msup><msup><mo stretchy="false">)</mo><mrow><mo>âˆ’</mo><mn>1</mn></mrow></msup><mo>â‰¡</mo><mi>f</mi><mi>l</mi><mi>a</mi><msup><mi>g</mi><mi>e</mi></msup><mspace></mspace><mspace width="0.4444444444444444em"><mo stretchy="false">(</mo><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mspace width="0.3333333333333333em"><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">c \times (256^{252})^{-1} \equiv flag^{e} \pmod n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.66666em;vertical-align:-.08333em"></span><span class="mord mathnormal">c</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord">2</span><span class="mord">5</span><span class="mord"><span class="mord">6</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">5</span><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">âˆ’</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">â‰¡</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.8888799999999999em;vertical-align:-.19444em"></span><span class="mord mathnormal" style="margin-right:.10764em">f</span><span class="mord mathnormal" style="margin-right:.01968em">l</span><span class="mord mathnormal">a</span><span class="mord"><span class="mord mathnormal" style="margin-right:.03588em">g</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.664392em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">e</span></span></span></span></span></span></span></span></span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:.4444444444444444em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:.3333333333333333em"></span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span><br>æŠŠæ•°å­—åŒ–å°äº†ä¹‹åå°±æ˜¯æ­£å¸¸çš„ä½æŒ‡æ•°çˆ†ç ´é—®é¢˜äº†ã€‚<br>è´´ä¸€ä¸ªå®Œæ•´çš„ exp:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">n = <span class="number">23570098360097260908266914080954003513706885568390448463720576188146956287111601604870247233822682630020002051748117520481402155749832096007629686239669192722978473890311246293580246256300691145653885805730865515297134808702766299205253761028235483781919393575836334910012714628455073300114978717047912395404034141622115001451888302617428376998024080880564792294546406688814397757714979980790018933407614160131827023349206138480523080173634617167828920519758917549492886733519381497665596997617399404664611446202014908853898043742964782757859701755202188366852773164911994663079171498909577012208742001609095258401847</span></span><br><span class="line">c = <span class="number">7802816471025387606454709075933309958303134972861203739854774032383575355964299097074709350633475519273512630813578801152996777689686451397201513854823239337669091889776200179028891111154423623765139235199507280104544068425347533121731521700106757148551520759776111224072064131087547685154285120156917449926992033491342535410929828988598182819897435365878832122138552492908774845437576910276499625679469289655841639181182040186931130789588869657335253479416209378458303531995734157105918063227453396477282662136225029972745246845372963076381252679409317314514131852117346576265346926741908194011319430767975281696400</span></span><br><span class="line">e = <span class="number">3</span></span><br><span class="line">l = <span class="number">86</span></span><br><span class="line">flag = <span class="string">b&#x27;\xff&#x27;</span> + <span class="string">b&#x27;\x00&#x27;</span> * <span class="number">85</span></span><br><span class="line">key = gmpy2.invert(<span class="built_in">pow</span>(<span class="number">256</span>,<span class="number">252</span>),n)</span><br><span class="line">_c = c * key % n</span><br><span class="line"><span class="built_in">print</span>(_c)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">pow</span>(<span class="number">256</span>,<span class="number">252</span>))</span><br><span class="line">k = <span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    num = _c + k * n</span><br><span class="line">    <span class="keyword">if</span> gmpy2.iroot(num,<span class="number">3</span>)[<span class="number">1</span>] == <span class="literal">True</span>:</span><br><span class="line">        <span class="built_in">print</span>(long_to_bytes(gmpy2.iroot(num,<span class="number">3</span>)[<span class="number">0</span>]))</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    k += <span class="number">1</span></span><br></pre></td></tr></table></figure><h4 id="0x0f-2022é•¿å®‰æˆ˜å½¹math-110"><a class="anchor" href="#0x0f-2022é•¿å®‰æˆ˜å½¹math-110">#</a> 0x0F 2022 é•¿å®‰æˆ˜å½¹ math 1.10</h4><p>é™„ä»¶</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">pinvq = <span class="number">0x63367a2b947c21d5051144d2d40572e366e19e3539a3074a433a92161465543157854669134c03642a12d304d2d9036e6458fe4c850c772c19c4eb3f567902b3</span></span><br><span class="line">qinvp = <span class="number">0x79388eb6c541fffefc9cfb083f3662655651502d81ccc00ecde17a75f316bc97a8d888286f21b1235bde1f35efe13f8b3edb739c8f28e6e6043cb29569aa0e7b</span></span><br><span class="line">c = <span class="number">0x5a1e001edd22964dd501eac6071091027db7665e5355426e1fa0c6360accbc013c7a36da88797de1960a6e9f1cf9ad9b8fd837b76fea7e11eac30a898c7a8b6d8c8989db07c2d80b14487a167c0064442e1fb9fd657a519cac5651457d64223baa30d8b7689d22f5f3795659ba50fb808b1863b344d8a8753b60bb4188b5e386</span></span><br><span class="line">e = <span class="number">0x10005</span></span><br><span class="line">d = <span class="number">0xae285803302de933cfc181bd4b9ab2ae09d1991509cb165aa1650bef78a8b23548bb17175f10cddffcde1a1cf36417cc080a622a1f8c64deb6d16667851942375670c50c5a32796545784f0bbcfdf2c0629a3d4f8e1a8a683f2aa63971f8e126c2ef75e08f56d16e1ec492cf9d26e730eae4d1a3fecbbb5db81e74d5195f49f1</span></span><br></pre></td></tr></table></figure><p>å…ˆè´´ä¸€ä¸ª<span class="exturl" data-url="aHR0cHM6Ly9zY2VydXNoLmdpdGh1Yi5pby8yMDIwLzA5LzE3L2N0Zi1zaG93LXVudXN1YWxyc2E0Lw==">åŸé¢˜é“¾æ¥</span>ï¼Œè†œ la ä½¬</p><p>ç»™äº† 5 ä¸ªå€¼ï¼Œcã€eã€dã€<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>q</mi><mrow><mo>âˆ’</mo><mn>1</mn></mrow></msup><mspace></mspace><mspace width="0.4444444444444444em"><mo stretchy="false">(</mo><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mspace width="0.3333333333333333em"><mi>p</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">q^{-1} \pmod p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.008548em;vertical-align:-.19444em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.03588em">q</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">âˆ’</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:.4444444444444444em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:.3333333333333333em"></span><span class="mord mathnormal">p</span><span class="mclose">)</span></span></span></span>ã€<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>p</mi><mrow><mo>âˆ’</mo><mn>1</mn></mrow></msup><mspace></mspace><mspace width="0.4444444444444444em"><mo stretchy="false">(</mo><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mspace width="0.3333333333333333em"><mi>q</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">p^{-1} \pmod q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.008548em;vertical-align:-.19444em"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">âˆ’</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:.4444444444444444em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:.3333333333333333em"></span><span class="mord mathnormal" style="margin-right:.03588em">q</span><span class="mclose">)</span></span></span></span>ã€‚</p><p>å…¶å®æ¡ä»¶å¤šç»™äº†ä¸€ä¸ªï¼Œä¹Ÿæ— ä¼¤å¤§é›…åªæ˜¯å¤šç»™æ¡ä»¶å¯èƒ½æœ‰ç‚¹è¯¯å¯¼ã€‚</p><p>é¦–å…ˆå› ä¸º<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi><mo>Ã—</mo><mi>d</mi><mo>â‰¡</mo><mn>1</mn><mspace></mspace><mspace width="0.4444444444444444em"><mo stretchy="false">(</mo><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mspace width="0.3333333333333333em"><mi>Ï†</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">e \times d \equiv 1 \pmod {\varphi(n)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.66666em;vertical-align:-.08333em"></span><span class="mord mathnormal">e</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.69444em;vertical-align:0"></span><span class="mord mathnormal">d</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">â‰¡</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">1</span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:.4444444444444444em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:.3333333333333333em"></span><span class="mord mathnormal">Ï†</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mclose">)</span></span></span></span>ï¼Œå¯æ¨å¾—<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi><mo>Ã—</mo><mi>d</mi><mo>=</mo><mi>k</mi><mo>Ã—</mo><mi>Ï†</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">e \times d = k \times \varphi(n) + 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.66666em;vertical-align:-.08333em"></span><span class="mord mathnormal">e</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.69444em;vertical-align:0"></span><span class="mord mathnormal">d</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.77777em;vertical-align:-.08333em"></span><span class="mord mathnormal" style="margin-right:.03148em">k</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal">Ï†</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">1</span></span></span></span>ã€‚</p><p>æ¯”è¾ƒæ¯”ç‰¹ä½å¯å¾— k ä¸ e æ¯”ç‰¹ä½ç›¸åŒï¼Œå¯ä»¥é€šè¿‡çˆ†ç ´çš„æ–¹å¼æ±‚å¾— k å’Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Ï†</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\varphi(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal">Ï†</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span>ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">e = <span class="number">0x10005</span></span><br><span class="line">d = <span class="number">0xae285803302de933cfc181bd4b9ab2ae09d1991509cb165aa1650bef78a8b23548bb17175f10cddffcde1a1cf36417cc080a622a1f8c64deb6d16667851942375670c50c5a32796545784f0bbcfdf2c0629a3d4f8e1a8a683f2aa63971f8e126c2ef75e08f56d16e1ec492cf9d26e730eae4d1a3fecbbb5db81e74d5195f49f1</span></span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">100000</span>):</span><br><span class="line">	<span class="keyword">if</span>((e * d - <span class="number">1</span>) % (<span class="number">100000</span> - k) == <span class="number">0</span>):</span><br><span class="line">		<span class="built_in">print</span>(<span class="number">100000</span> - k)</span><br><span class="line">		<span class="keyword">break</span></span><br><span class="line">k = <span class="number">60701</span></span><br><span class="line">phi = (e * d - <span class="number">1</span>) // k</span><br><span class="line"><span class="built_in">print</span>(phi)</span><br></pre></td></tr></table></figure><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Ï†</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo>â‰¡</mo><mo>âˆ’</mo><mo stretchy="false">(</mo><mi>q</mi><mo>âˆ’</mo><mn>1</mn><mo stretchy="false">)</mo><mspace></mspace><mspace width="0.4444444444444444em"><mo stretchy="false">(</mo><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mspace width="0.3333333333333333em"><mi>p</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\varphi(n) \equiv -(q-1) \pmod p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal">Ï†</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">â‰¡</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord">âˆ’</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:.03588em">q</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:.4444444444444444em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:.3333333333333333em"></span><span class="mord mathnormal">p</span><span class="mclose">)</span></span></span></span></p><p>ä»¤<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mi>f</mi><mo>=</mo><msup><mi>q</mi><mrow><mo>âˆ’</mo><mn>1</mn></mrow></msup><mspace></mspace><mspace width="0.4444444444444444em"><mo stretchy="false">(</mo><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mspace width="0.3333333333333333em"><mi>p</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">cf = q^{-1} \pmod p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8888799999999999em;vertical-align:-.19444em"></span><span class="mord mathnormal">c</span><span class="mord mathnormal" style="margin-right:.10764em">f</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.008548em;vertical-align:-.19444em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.03588em">q</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">âˆ’</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:.4444444444444444em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:.3333333333333333em"></span><span class="mord mathnormal">p</span><span class="mclose">)</span></span></span></span></p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mi>f</mi><mo>Ã—</mo><mi>Ï†</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mspace></mspace><mspace width="0.4444444444444444em"><mo stretchy="false">(</mo><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mspace width="0.3333333333333333em"><mi>p</mi><mo stretchy="false">)</mo><mo>=</mo><mi>c</mi><mi>f</mi><mo>âˆ’</mo><mi>c</mi><mi>f</mi><mo>Ã—</mo><mi>q</mi><mspace></mspace><mspace width="0.4444444444444444em"><mo stretchy="false">(</mo><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mspace width="0.3333333333333333em"><mi>p</mi><mo stretchy="false">)</mo><mo>=</mo><mi>c</mi><mi>f</mi><mo>âˆ’</mo><mn>1</mn><mspace></mspace><mspace width="0.4444444444444444em"><mo stretchy="false">(</mo><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mspace width="0.3333333333333333em"><mi>p</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">cf \times \varphi(n) \pmod p = cf -cf\times q \pmod p = cf - 1 \pmod p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8888799999999999em;vertical-align:-.19444em"></span><span class="mord mathnormal">c</span><span class="mord mathnormal" style="margin-right:.10764em">f</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal">Ï†</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:.4444444444444444em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:.3333333333333333em"></span><span class="mord mathnormal">p</span><span class="mclose">)</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.8888799999999999em;vertical-align:-.19444em"></span><span class="mord mathnormal">c</span><span class="mord mathnormal" style="margin-right:.10764em">f</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.8888799999999999em;vertical-align:-.19444em"></span><span class="mord mathnormal">c</span><span class="mord mathnormal" style="margin-right:.10764em">f</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.625em;vertical-align:-.19444em"></span><span class="mord mathnormal" style="margin-right:.03588em">q</span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:.4444444444444444em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:.3333333333333333em"></span><span class="mord mathnormal">p</span><span class="mclose">)</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.8888799999999999em;vertical-align:-.19444em"></span><span class="mord mathnormal">c</span><span class="mord mathnormal" style="margin-right:.10764em">f</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">1</span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:.4444444444444444em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:.3333333333333333em"></span><span class="mord mathnormal">p</span><span class="mclose">)</span></span></span></span></p><p>æ•…<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>c</mi><mi>f</mi><mo>Ã—</mo><mi>Ï†</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo>âˆ’</mo><mi>c</mi><mi>f</mi><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo><mi mathvariant="normal">âˆ£</mi><mi>p</mi></mrow><annotation encoding="application/x-tex">(cf \times \varphi(n) - cf + 1) | p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord mathnormal">c</span><span class="mord mathnormal" style="margin-right:.10764em">f</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal">Ï†</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.8888799999999999em;vertical-align:-.19444em"></span><span class="mord mathnormal">c</span><span class="mord mathnormal" style="margin-right:.10764em">f</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord">1</span><span class="mclose">)</span><span class="mord">âˆ£</span><span class="mord mathnormal">p</span></span></span></span></p><p>ä»¤<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>=</mo><mi>c</mi><mi>f</mi><mo>Ã—</mo><mi>Ï†</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo>âˆ’</mo><mi>c</mi><mi>f</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">x=cf \times \varphi(n) - cf + 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.8888799999999999em;vertical-align:-.19444em"></span><span class="mord mathnormal">c</span><span class="mord mathnormal" style="margin-right:.10764em">f</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal">Ï†</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.8888799999999999em;vertical-align:-.19444em"></span><span class="mord mathnormal">c</span><span class="mord mathnormal" style="margin-right:.10764em">f</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">1</span></span></span></span><br>æ ¹æ®è´¹é©¬å°å®šç†<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mspace width="1em"><msup><mi>r</mi><mrow><mi>p</mi><mo>âˆ’</mo><mn>1</mn></mrow></msup><mo>â‰¡</mo><mn>1</mn><mspace></mspace><mspace width="0.4444444444444444em"><mo stretchy="false">(</mo><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mspace width="0.3333333333333333em"><mi>p</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\quad r^{p-1} \equiv 1 \pmod p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8141079999999999em;vertical-align:0"></span><span class="mspace" style="margin-right:1em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.02778em">r</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span><span class="mbin mtight">âˆ’</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">â‰¡</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">1</span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:.4444444444444444em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:.3333333333333333em"></span><span class="mord mathnormal">p</span><span class="mclose">)</span></span></span></span></p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>r</mi><mrow><mi>Ï†</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></msup><mo>â‰¡</mo><mn>1</mn><mspace></mspace><mspace width="0.4444444444444444em"><mo stretchy="false">(</mo><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mspace width="0.3333333333333333em"><mi>p</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">r^{\varphi(n)} \equiv 1 \pmod p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8879999999999999em;vertical-align:0"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.02778em">r</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8879999999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">Ï†</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">n</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">â‰¡</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">1</span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:.4444444444444444em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:.3333333333333333em"></span><span class="mord mathnormal">p</span><span class="mclose">)</span></span></span></span></p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>r</mi><mrow><mi>Ï†</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></msup><mspace></mspace><mspace width="0.4444444444444444em"><mo stretchy="false">(</mo><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mspace width="0.3333333333333333em"><mi>p</mi><mo stretchy="false">)</mo><mo>=</mo><msup><mi>r</mi><mrow><mi>Ï†</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></msup><mspace></mspace><mspace width="0.4444444444444444em"><mo stretchy="false">(</mo><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mspace width="0.3333333333333333em"><mi>x</mi><mo stretchy="false">)</mo><mspace></mspace><mspace width="0.4444444444444444em"><mo stretchy="false">(</mo><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mspace width="0.3333333333333333em"><mi>p</mi><mo stretchy="false">)</mo><mo>â‰¡</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">r^{\varphi(n)}\pmod p = r^{\varphi(n)} \pmod x \pmod p \equiv 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8879999999999999em;vertical-align:0"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.02778em">r</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8879999999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">Ï†</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">n</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:.4444444444444444em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:.3333333333333333em"></span><span class="mord mathnormal">p</span><span class="mclose">)</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.8879999999999999em;vertical-align:0"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.02778em">r</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8879999999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">Ï†</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">n</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:.4444444444444444em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:.3333333333333333em"></span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:.4444444444444444em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:.3333333333333333em"></span><span class="mord mathnormal">p</span><span class="mclose">)</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">â‰¡</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">1</span></span></span></span></p><p>æ‰€ä»¥æœ€ç»ˆå¾—åˆ°<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mspace width="1em"><msup><mi>r</mi><mrow><mi>Ï†</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></msup><mo>=</mo><mn>1</mn><mo>+</mo><mi>k</mi><mo>Ã—</mo><mi>p</mi></mrow><annotation encoding="application/x-tex">\quad r^{\varphi(n)}=1+k \times p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8879999999999999em;vertical-align:0"></span><span class="mspace" style="margin-right:1em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.02778em">r</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8879999999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">Ï†</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">n</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.72777em;vertical-align:-.08333em"></span><span class="mord">1</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.77777em;vertical-align:-.08333em"></span><span class="mord mathnormal" style="margin-right:.03148em">k</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.625em;vertical-align:-.19444em"></span><span class="mord mathnormal">p</span></span></span></span></p><p>ä»»æ„æ„å–è‹¥å¹²ä¸ª rï¼Œç®—å‡ºè‹¥å¹²ä¸ª<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>r</mi><mrow><mi>Ï†</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></msup><mo>âˆ’</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">r^{\varphi(n)}-1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.9713299999999999em;vertical-align:-.08333em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.02778em">r</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8879999999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">Ï†</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">n</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">1</span></span></span></span> å†æ±‚å…¬çº¦æ•°å°±å¾—åˆ°äº† p, åé¢å°±æ˜¯æ­£å¸¸çš„ RSA è§£å¯†æµç¨‹äº†ã€‚</p><p>exp</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"><span class="keyword">from</span> functools <span class="keyword">import</span> *</span><br><span class="line">pinvq = <span class="number">0x63367a2b947c21d5051144d2d40572e366e19e3539a3074a433a92161465543157854669134c03642a12d304d2d9036e6458fe4c850c772c19c4eb3f567902b3</span></span><br><span class="line">qinvp = <span class="number">0x79388eb6c541fffefc9cfb083f3662655651502d81ccc00ecde17a75f316bc97a8d888286f21b1235bde1f35efe13f8b3edb739c8f28e6e6043cb29569aa0e7b</span></span><br><span class="line">c = <span class="number">0x5a1e001edd22964dd501eac6071091027db7665e5355426e1fa0c6360accbc013c7a36da88797de1960a6e9f1cf9ad9b8fd837b76fea7e11eac30a898c7a8b6d8c8989db07c2d80b14487a167c0064442e1fb9fd657a519cac5651457d64223baa30d8b7689d22f5f3795659ba50fb808b1863b344d8a8753b60bb4188b5e386</span></span><br><span class="line">e = <span class="number">0x10005</span></span><br><span class="line">d = <span class="number">0xae285803302de933cfc181bd4b9ab2ae09d1991509cb165aa1650bef78a8b23548bb17175f10cddffcde1a1cf36417cc080a622a1f8c64deb6d16667851942375670c50c5a32796545784f0bbcfdf2c0629a3d4f8e1a8a683f2aa63971f8e126c2ef75e08f56d16e1ec492cf9d26e730eae4d1a3fecbbb5db81e74d5195f49f1</span></span><br><span class="line"><span class="built_in">print</span>(d)</span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">100000</span>):</span><br><span class="line">	<span class="keyword">if</span>((e * d - <span class="number">1</span>) % (<span class="number">100000</span> - k) == <span class="number">0</span>):</span><br><span class="line">		<span class="built_in">print</span>(<span class="number">100000</span> - k)</span><br><span class="line">		<span class="keyword">break</span></span><br><span class="line"><span class="comment"># print(e)</span></span><br><span class="line">k = <span class="number">60701</span></span><br><span class="line">phi = (e * d - <span class="number">1</span>) // k</span><br><span class="line"><span class="built_in">print</span>(phi)</span><br><span class="line"></span><br><span class="line">x = <span class="number">1</span> + qinvp * phi - qinvp</span><br><span class="line"></span><br><span class="line">tmp1 = <span class="built_in">pow</span>(<span class="number">2</span>,phi,x) - <span class="number">1</span></span><br><span class="line">tmp2 = <span class="built_in">pow</span>(<span class="number">3</span>,phi,x) - <span class="number">1</span></span><br><span class="line">tmp3 = <span class="built_in">pow</span>(<span class="number">5</span>,phi,x) - <span class="number">1</span></span><br><span class="line">p = reduce(gmpy2.gcd,[tmp1,tmp2,tmp3])</span><br><span class="line">q = gmpy2.invert(qinvp,p)</span><br><span class="line">n = p * q</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure><h4 id="0x0e-2021èµ£ç½‘æ¯leak-1229"><a class="anchor" href="#0x0e-2021èµ£ç½‘æ¯leak-1229">#</a> 0x0E 2021 èµ£ç½‘æ¯ leak 12.29</h4><p>é™„ä»¶</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> randint, getrandbits</span><br><span class="line"><span class="keyword">from</span> sympy <span class="keyword">import</span> nextprime</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag, secreteBitNum</span><br><span class="line"></span><br><span class="line">hint = bytes_to_long((<span class="string">f&#x27;secreteBitNum = <span class="subst">&#123;secreteBitNum&#125;</span>&#x27;</span>).encode())</span><br><span class="line">tmp_e = <span class="number">65537</span></span><br><span class="line">tmp_p = getPrime(<span class="built_in">int</span>(<span class="number">512</span>))</span><br><span class="line">tmp_q = getPrime(<span class="built_in">int</span>(<span class="number">512</span>))</span><br><span class="line">tmp_N = tmp_p * tmp_q</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;tmp_N = <span class="subst">&#123;tmp_N&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">pow</span>(hint, tmp_e, tmp_N))</span><br><span class="line"><span class="built_in">print</span>(tmp_p &gt;&gt; <span class="number">180</span>)</span><br><span class="line"></span><br><span class="line">target_bits = <span class="built_in">int</span>(<span class="number">256</span>)</span><br><span class="line">prime = getPrime(target_bits)</span><br><span class="line">s = randint(prime&gt;&gt;<span class="number">10</span>, prime)</span><br><span class="line">r = getrandbits(secreteBitNum)</span><br><span class="line">t = (r*(s^<span class="number">2</span> + <span class="number">2</span>*s)) % prime</span><br><span class="line">gifts = [<span class="number">3</span>, <span class="number">2</span>]</span><br><span class="line">ks = [floor(target_bits * (gift / (gift + <span class="number">1</span>))) <span class="keyword">for</span> gift <span class="keyword">in</span> gifts]</span><br><span class="line">leak1 = s &gt;&gt; (target_bits - ks[<span class="number">0</span>])</span><br><span class="line">leak2 = t &gt;&gt; (target_bits - ks[<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line">p = nextprime((s*(nextprime(s) * nextprime(r) + t)))</span><br><span class="line">q = getPrime(p.bit_length())</span><br><span class="line">N = p*q</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">c = <span class="built_in">pow</span>(m, e, N)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;prime = <span class="subst">&#123;prime&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;c = <span class="subst">&#123;c&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;N = <span class="subst">&#123;N&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;leak1 = <span class="subst">&#123;leak1&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;leak2 = <span class="subst">&#123;leak2&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">tmp_N = 67275889677378946734903321404206582364153218707836044936581311977721676158433934674861722018390091292542128885311842688233567992017423854706617140651934525455990460080562308585391373661331461122947028205118969966760791488914164391921330229025670176008518053339148134137770309365614255463111202481834705060173</span></span><br><span class="line"><span class="string">40399377632586118650556149454962332599993544072289982576457293479237148938553095258299197606759611718110458893982875730643146645623512300513916266262798465380752083932871857821720398540072426424439422364690204675516506456125988918985863308292449915493404572808822346197667419207669315093927318993921905479596</span></span><br><span class="line"><span class="string">4877155090632997781879191807827231697420271396210537080241322765167927413977000532975047982026915056</span></span><br><span class="line"><span class="string">prime = 82321753209337659641812698792368753307257174920293482309329229017641186204037</span></span><br><span class="line"><span class="string">c = 4327179356609269294409009935591795772603625779675971467878490086808144060225614005300908314649047950861015994603326121468330956776913366179511247457747179889685304469999218104955814145411915021238933150884498316563808220329632240175418452382843973948334446343545955570063628905102384071000832724697885872043017030707897928</span></span><br><span class="line"><span class="string">N = 43941665823196509154346632368475246193489316520677500866461851257383928558997955146720003171553041820199105630143274308184375615057136594812756966125202091119439909980006181740220827474838356621605513939553184451557022029987518161532780360148932769025277495283357745880781214097057768654158857096614016596756958574010574773</span></span><br><span class="line"><span class="string">leak1 = 4392924728395269190263639346144303703257730516994610750658</span></span><br><span class="line"><span class="string">leak2 = 838456777370923849008096179359487752850229097203212</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure><p>åˆ†æé¢˜ç›®é€»è¾‘å¯ä»¥çœ‹å‡ºé¢˜ç›®åˆ†ä¸ºä¸¤ä¸ªéƒ¨åˆ†ï¼Œä¸€ä¸ªæ˜¯æ±‚ hintï¼Œä¸€ä¸ªæ˜¯æ±‚ flagã€‚</p><p>æ±‚ hint çš„éƒ¨åˆ†è¿˜æ˜¯æ¯”è¾ƒæ˜¾è€Œæ˜“è§çš„ã€‚ä¹Ÿæ˜¯ä¸€ç»„ RSA åŠ å¯†ï¼Œé¢˜ç›®ç»™äº†é«˜ä½çš„ pï¼Œä¸€å…ƒ cop ç›´æ¥æ¢­ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#sage</span></span><br><span class="line">p4 = <span class="number">4877155090632997781879191807827231697420271396210537080241322765167927413977000532975047982026915056</span></span><br><span class="line">n = <span class="number">67275889677378946734903321404206582364153218707836044936581311977721676158433934674861722018390091292542128885311842688233567992017423854706617140651934525455990460080562308585391373661331461122947028205118969966760791488914164391921330229025670176008518053339148134137770309365614255463111202481834705060173</span></span><br><span class="line">pbits = <span class="number">512</span></span><br><span class="line">kbits = <span class="number">180</span></span><br><span class="line">p4 = p4 &lt;&lt; kbits</span><br><span class="line">PR.&lt;x&gt; = PolynomialRing(Zmod(n))</span><br><span class="line">f = p4 + x</span><br><span class="line">root = f.small_roots(X=<span class="number">2</span>^kbits, beta=<span class="number">0.4</span>)</span><br><span class="line">p = p4+root[<span class="number">0</span>]</span><br><span class="line"><span class="built_in">print</span>(p)</span><br></pre></td></tr></table></figure><p>å¾—åˆ° hint ä¸º</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">secreteBitNum = 26</span><br></pre></td></tr></table></figure><p>ç¬¬äºŒéƒ¨åˆ†å°±æ˜¯ä¸‰ä¸ªå˜é‡ s,t,rï¼Œä¸‰è€…ä¹‹é—´çš„å…³ç³»æœ‰ä¸€ä¸ªå¼å­ç»™å‡ºäº†</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">t = (r*(s^2 + 2*s)) % prime</span><br></pre></td></tr></table></figure><p>ç”±æ­¤å¯ä»¥æ„é€ ä¸€ä¸ªä¸‰å…ƒçš„å¤šé¡¹å¼ï¼Œç”¨ä¸‰å…ƒ cop çš„æ¿å­ä¸€æŠŠæ¢­</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#sage</span></span><br><span class="line"><span class="keyword">import</span> itertools</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">small_roots</span>(<span class="params">f, bounds, m=<span class="number">1</span>, d=<span class="literal">None</span></span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> d:</span><br><span class="line">        d = f.degree()</span><br><span class="line"></span><br><span class="line">    R = f.base_ring()</span><br><span class="line">    N = R.cardinality()</span><br><span class="line"></span><br><span class="line">    f /= f.coefficients().pop(<span class="number">0</span>)</span><br><span class="line">    f = f.change_ring(ZZ)</span><br><span class="line"></span><br><span class="line">    G = <span class="type">Sequence</span>([], f.parent())</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(m + <span class="number">1</span>):</span><br><span class="line">        base = N ^ (m - i) * f ^ i</span><br><span class="line">        <span class="keyword">for</span> shifts <span class="keyword">in</span> itertools.product(<span class="built_in">range</span>(d), repeat=f.nvariables()):</span><br><span class="line">            g = base * prod(<span class="built_in">map</span>(power, f.variables(), shifts))</span><br><span class="line">            G.append(g)</span><br><span class="line"></span><br><span class="line">    B, monomials = G.coefficient_matrix()</span><br><span class="line">    monomials = vector(monomials)</span><br><span class="line"></span><br><span class="line">    factors = [monomial(*bounds) <span class="keyword">for</span> monomial <span class="keyword">in</span> monomials]</span><br><span class="line">    <span class="keyword">for</span> i, factor <span class="keyword">in</span> <span class="built_in">enumerate</span>(factors):</span><br><span class="line">        B.rescale_col(i, factor)</span><br><span class="line"></span><br><span class="line">    B = B.dense_matrix().LLL()</span><br><span class="line"></span><br><span class="line">    B = B.change_ring(QQ)</span><br><span class="line">    <span class="keyword">for</span> i, factor <span class="keyword">in</span> <span class="built_in">enumerate</span>(factors):</span><br><span class="line">        B.rescale_col(i, <span class="number">1</span> / factor)</span><br><span class="line"></span><br><span class="line">    H = <span class="type">Sequence</span>([], f.parent().change_ring(QQ))</span><br><span class="line">    <span class="keyword">for</span> h <span class="keyword">in</span> <span class="built_in">filter</span>(<span class="literal">None</span>, B * monomials):</span><br><span class="line">        H.append(h)</span><br><span class="line">        I = H.ideal()</span><br><span class="line">        <span class="keyword">if</span> I.dimension() == -<span class="number">1</span>:</span><br><span class="line">            H.pop()</span><br><span class="line">        <span class="keyword">elif</span> I.dimension() == <span class="number">0</span>:</span><br><span class="line">            roots = []</span><br><span class="line">            <span class="keyword">for</span> root <span class="keyword">in</span> I.variety(ring=ZZ):</span><br><span class="line">                root = <span class="built_in">tuple</span>(R(root[var]) <span class="keyword">for</span> var <span class="keyword">in</span> f.variables())</span><br><span class="line">                roots.append(root)</span><br><span class="line">            <span class="keyword">return</span> roots</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> []</span><br><span class="line"></span><br><span class="line">hs = <span class="number">4392924728395269190263639346144303703257730516994610750658</span></span><br><span class="line">ht = <span class="number">838456777370923849008096179359487752850229097203212</span></span><br><span class="line">n = <span class="number">43941665823196509154346632368475246193489316520677500866461851257383928558997955146720003171553041820199105630143274308184375615057136594812756966125202091119439909980006181740220827474838356621605513939553184451557022029987518161532780360148932769025277495283357745880781214097057768654158857096614016596756958574010574773</span></span><br><span class="line">prime = <span class="number">82321753209337659641812698792368753307257174920293482309329229017641186204037</span></span><br><span class="line"></span><br><span class="line">P.&lt;s0,t0,r&gt; = PolynomialRing(Zmod(prime))</span><br><span class="line">s = (hs &lt;&lt; <span class="number">64</span>) + s0</span><br><span class="line">t = (ht &lt;&lt; <span class="number">86</span>) + t0</span><br><span class="line">f = r * (s ^ <span class="number">2</span> + <span class="number">2</span> * s) - t</span><br><span class="line">bounds = (<span class="number">1</span> &lt;&lt; <span class="number">64</span>,<span class="number">1</span> &lt;&lt; <span class="number">86</span>,<span class="number">1</span> &lt;&lt; <span class="number">26</span>)</span><br><span class="line">roots = small_roots(f,bounds,m=<span class="number">3</span>)[<span class="number">0</span>]</span><br><span class="line"><span class="built_in">print</span>(roots)</span><br><span class="line"><span class="comment">#(2837580634489900859, 63360403616040741532234070, 29943235)</span></span><br></pre></td></tr></table></figure><p>è¿™æ ·å°±å¾—åˆ°äº† s,t,r ä¸‰ä¸ªå˜é‡ï¼Œè¿™é¢˜ä¹Ÿå°±åšå®Œäº†ã€‚</p><p>æœ€åè´´ä¸€ä¸ªå®Œæ•´çš„ exp</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> floor</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> randint, getrandbits</span><br><span class="line"><span class="keyword">from</span> sympy <span class="keyword">import</span> nextprime</span><br><span class="line">tmp_e = <span class="number">65537</span></span><br><span class="line">tmp_n = <span class="number">67275889677378946734903321404206582364153218707836044936581311977721676158433934674861722018390091292542128885311842688233567992017423854706617140651934525455990460080562308585391373661331461122947028205118969966760791488914164391921330229025670176008518053339148134137770309365614255463111202481834705060173</span></span><br><span class="line">tmp_hp = <span class="number">4877155090632997781879191807827231697420271396210537080241322765167927413977000532975047982026915056</span></span><br><span class="line">tmp_c = <span class="number">40399377632586118650556149454962332599993544072289982576457293479237148938553095258299197606759611718110458893982875730643146645623512300513916266262798465380752083932871857821720398540072426424439422364690204675516506456125988918985863308292449915493404572808822346197667419207669315093927318993921905479596</span></span><br><span class="line">tmp_p = <span class="number">7474218428506439131024561238447007658574698902527126414652353026654065729675401366440504060759323896095490193371294094265057254763085596066166150006638181</span></span><br><span class="line">tmp_q = tmp_n // tmp_p</span><br><span class="line">tmp_phi = (tmp_p - <span class="number">1</span>) * (tmp_q - <span class="number">1</span>)</span><br><span class="line">tmp_d = gmpy2.invert(tmp_e,tmp_phi)</span><br><span class="line">hint = <span class="built_in">pow</span>(tmp_c,tmp_d,tmp_n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(hint))</span><br><span class="line">prime = <span class="number">82321753209337659641812698792368753307257174920293482309329229017641186204037</span></span><br><span class="line">c = <span class="number">4327179356609269294409009935591795772603625779675971467878490086808144060225614005300908314649047950861015994603326121468330956776913366179511247457747179889685304469999218104955814145411915021238933150884498316563808220329632240175418452382843973948334446343545955570063628905102384071000832724697885872043017030707897928</span></span><br><span class="line">n = <span class="number">43941665823196509154346632368475246193489316520677500866461851257383928558997955146720003171553041820199105630143274308184375615057136594812756966125202091119439909980006181740220827474838356621605513939553184451557022029987518161532780360148932769025277495283357745880781214097057768654158857096614016596756958574010574773</span></span><br><span class="line">hs = <span class="number">4392924728395269190263639346144303703257730516994610750658</span></span><br><span class="line">ht = <span class="number">838456777370923849008096179359487752850229097203212</span></span><br><span class="line">secreteBitNum = <span class="number">26</span></span><br><span class="line">gifts = [<span class="number">3</span>, <span class="number">2</span>]</span><br><span class="line">target_bits = <span class="built_in">int</span>(<span class="number">256</span>)</span><br><span class="line">ks = [floor(target_bits * (gift / (gift + <span class="number">1</span>))) <span class="keyword">for</span> gift <span class="keyword">in</span> gifts]</span><br><span class="line"><span class="built_in">print</span>(ks)</span><br><span class="line">r = getrandbits(secreteBitNum)</span><br><span class="line"><span class="built_in">print</span>(r)</span><br><span class="line"><span class="built_in">print</span>(r.bit_length())</span><br><span class="line"></span><br><span class="line">s0,t0,r = <span class="number">2837580634489900859</span>, <span class="number">63360403616040741532234070</span>, <span class="number">29943235</span></span><br><span class="line">s = (hs &lt;&lt; <span class="number">64</span>) + s0</span><br><span class="line">t = (ht &lt;&lt; <span class="number">86</span>) + t0</span><br><span class="line">p = nextprime((s*(nextprime(s) * nextprime(r) + t)))</span><br><span class="line"><span class="built_in">print</span>(p)</span><br><span class="line">q = n // p</span><br><span class="line">phi = (p - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">d = gmpy2.invert(e,phi)</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure><h4 id="0x0d-2021è¥¿æ¹–è®ºå‰‘unknown_dsa-1223"><a class="anchor" href="#0x0d-2021è¥¿æ¹–è®ºå‰‘unknown_dsa-1223">#</a> 0x0D 2021 è¥¿æ¹–è®ºå‰‘ unknown_dsa 12.23</h4><p>é™„ä»¶</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> DSA</span><br><span class="line"><span class="keyword">from</span> Crypto.Hash <span class="keyword">import</span> SHA1</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> invert, powmod</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag, m1, m2, ul, vl, wl</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>():</span><br><span class="line">    key = DSA.generate(<span class="built_in">int</span>(<span class="number">1024</span>))</span><br><span class="line">    q = key.q</span><br><span class="line">    p = key.p</span><br><span class="line">    g = key.g</span><br><span class="line">    x1 = bytes_to_long(flag[:<span class="built_in">len</span>(flag) // <span class="number">2</span>])</span><br><span class="line">    x2 = bytes_to_long(flag[<span class="built_in">len</span>(flag) // <span class="number">2</span>:])</span><br><span class="line">    <span class="keyword">assert</span> x1 &lt; q <span class="keyword">and</span> x2 &lt; q</span><br><span class="line">    t = powmod(g, p * q - (p + q), p * q)</span><br><span class="line">    hm1 = bytes_to_long(SHA1.new(m1).digest())</span><br><span class="line">    hm2 = bytes_to_long(SHA1.new(m2).digest())</span><br><span class="line">    k = random.randint(<span class="number">1</span>, q - <span class="number">1</span>)</span><br><span class="line">    r1 = powmod(g, k, p) % q</span><br><span class="line">    s1 = (hm1 + x1 * r1) * invert(k, q) % q</span><br><span class="line">    s2 = (hm2 + x1 * r1) * invert(k, q) % q</span><br><span class="line">    r2 = powmod(g, x1, p) % q</span><br><span class="line">    s3 = (hm1 + x2 * r2) * invert(k, q) % q</span><br><span class="line">    <span class="built_in">print</span>(p * q, (p - <span class="number">1</span>) // q, t, sep=<span class="string">&#x27;, &#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(r1, s1, s2, sep=<span class="string">&#x27;, &#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(r2, s3, sep=<span class="string">&#x27;, &#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(ul)):</span><br><span class="line">        <span class="keyword">assert</span> ul[i] ** <span class="number">2</span> - wl[i] * vl[i] ** <span class="number">2</span> == <span class="number">1</span></span><br><span class="line">    e = <span class="number">7</span></span><br><span class="line">    cl1 = [<span class="built_in">int</span>(powmod(bytes_to_long(m1), e, x)) <span class="keyword">for</span> x <span class="keyword">in</span> ul]</span><br><span class="line">    cl2 = [<span class="built_in">int</span>(powmod(bytes_to_long(m2), e, y)) <span class="keyword">for</span> y <span class="keyword">in</span> vl]</span><br><span class="line">    <span class="built_in">print</span>(wl, cl1, cl2, sep=<span class="string">&#x27;, &#x27;</span>)</span><br><span class="line"></span><br><span class="line">    encrypt()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    main()</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">[3912956711, 4013184893, 3260747771], [2852589223779928796266540600421678790889067284911682578924216186052590393595645322161563386615512475256726384365091711034449682791268994623758937752874750918200961888997082477100811025721898720783666868623498246219677221106227660895519058631965055790709130207760704, 21115849906180139656310664607458425637670520081983248258984166026222898753505008904136688820075720411004158264138659762101873588583686473388951744733936769732617279649797085152057880233721961, 301899179092185964785847705166950181255677272294377823045011205035318463496682788289651177635341894308537787449148199583490117059526971759804426977947952721266880757177055335088777693134693713345640206540670123872210178680306100865355059146219281124303460105424], [148052450029409767056623510365366602228778431569288407577131980435074529632715014971133452626021226944632282479312378667353792117133452069972334169386837227285924011187035671874758901028719505163887789382835770664218045743465222788859258272826217869877607314144, 1643631850318055151946938381389671039738824953272816402371095118047179758846703070931850238668262625444826564833452294807110544441537830199752050040697440948146092723713661125309994275256, 10949587016016795940445976198460149258144635366996455598605244743540728764635947061037779912661207322820180541114179612916018317600403816027703391110922112311910900034442340387304006761589708943814396303183085858356961537279163175384848010568152485779372842]</span></span><br><span class="line"><span class="string">85198615386075607567070020969981777827671873654631200472078241980737834438897900146248840279191139156416537108399682874370629888207334506237040017838313558911275073904148451540255705818477581182866269413018263079858680221647341680762989080418039972704759003343616652475438155806858735982352930771244880990190318526933267455248913782297991685041187565140859, 106239950213206316301683907545763916336055243955706210944736472425965200103461421781804731678430116333702099777855279469137219165293725500887590280355973107580745212368937514070059991848948031718253804694621821734957604838125210951711527151265000736896607029198, 60132176395922896902518845244051065417143507550519860211077965501783315971109433544482411208238485135554065241864956361676878220342500208011089383751225437417049893725546176799417188875972677293680033005399883113531193705353404892141811493415079755456185858889801456386910892239869732805273879281094613329645326287205736614546311143635580051444446576104548</span></span><br><span class="line"><span class="string">498841194617327650445431051685964174399227739376, 376599166921876118994132185660203151983500670896, 187705159843973102963593151204361139335048329243</span></span><br><span class="line"><span class="string">620827881415493136309071302986914844220776856282, 674735360250004315267988424435741132047607535029</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><p>è¿™é¢˜è¦è¿ç”¨çš„ä¸œè¥¿è¿˜æ˜¯å¾ˆå¤šçš„ï¼Œä½©å°”æ–¹ç¨‹æ±‚è§£ï¼Œæ‰©å±• CRTï¼Œæœ€å DSA çš„åŸç†å°±å½“æ•°è®ºé¢˜åšäº†ã€‚</p><p>ä» main è¿›å»å…ˆè§£ä¸€ä¸ªä½©å°”æ–¹ç¨‹ã€‚ä½©å°”æ–¹ç¨‹çš„åŸºæœ¬å½¢å¼ä¸º</p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>x</mi><mn>2</mn></msup><mo>âˆ’</mo><mi>n</mi><msup><mi>y</mi><mn>2</mn></msup><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">x^{2}-ny^{2}=1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.897438em;vertical-align:-.08333em"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.008548em;vertical-align:-.19444em"></span><span class="mord mathnormal">n</span><span class="mord"><span class="mord mathnormal" style="margin-right:.03588em">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">1</span></span></span></span><br>å…¶ä¸­ n ä¸ºæ­£æ•´æ•°ï¼ŒåŸºæœ¬è§£æ³•æ˜¯é€šè¿‡å¯¹ $\sqrt {n} $ çš„è¿åˆ†æ•°å±•å¼€æ±‚å‡º</p><p>å…·ä½“å‚ç…§<span class="exturl" data-url="aHR0cHM6Ly96aC53aWtpcGVkaWEub3JnL3dpa2kvJUU0JUJEJUE5JUU1JUIwJTk0JUU2JTk2JUI5JUU3JUE4JThC"> wiki ç™¾ç§‘çš„ä½©å°”æ–¹ç¨‹</span></p><p>è¿™é‡Œç”¨ sage çš„è¿åˆ†æ•°æ”»å‡»å¾—åˆ°æ¯ä¸ª ulã€vl</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#sage</span></span><br><span class="line">ul = []</span><br><span class="line">vl = []</span><br><span class="line">wl = [<span class="number">3912956711</span>, <span class="number">4013184893</span>, <span class="number">3260747771</span>]</span><br><span class="line"><span class="keyword">for</span> n <span class="keyword">in</span> wl:</span><br><span class="line">    cf = continued_fraction(sqrt(n))</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10000</span>):<span class="comment">#æ— ç†æ•°çš„è¿åˆ†æ•°æ˜¯æ— é™çš„ï¼Œè§„å®šä¸€ä¸ªå¾ªç¯æ¬¡æ•°ä¹Ÿå°±æ˜¯å®šä¸€ä¸ªç•Œ</span></span><br><span class="line">        fz = cf.numerator(i)</span><br><span class="line">        fm = cf.denominator(i)</span><br><span class="line">        <span class="keyword">if</span> fz ** <span class="number">2</span> - n * fm ** <span class="number">2</span> == <span class="number">1</span>:</span><br><span class="line">            ul.append(fz)</span><br><span class="line">            vl.append(fm)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"><span class="built_in">print</span>(ul)</span><br><span class="line"><span class="built_in">print</span>(vl)</span><br></pre></td></tr></table></figure><p>é¡ºç€é¢˜ç›®çš„æ€è·¯ï¼Œå¾—åˆ°äº† ulã€vlï¼Œcl1ã€cl2 é¢˜ç›®å·²ç»ç»™å‡ºï¼Œé€šè¿‡è¿™äº›å·²çŸ¥é‡æ±‚ m1 å’Œ m2ã€‚m1 å’Œ m2 çš„åŠ å¯†æ–¹å¼æ˜¯ä¸€æ ·çš„ï¼Œæ¯ä¸ª m ç»™äº† 3 ç»„æ•°æ®ï¼Œå¾ˆå®¹æ˜“æƒ³åˆ° CRT (ä¸­å›½å‰©ä½™å®šç†)ï¼Œä½†æ˜¯å¸¸è§„ CRT ä¸èƒ½è§£å†³è§£å†³æ¨¡æ•°ä¸äº’è´¨æƒ…å†µçš„æ¨¡çº¿æ€§åŒä½™æ–¹ç¨‹ç»„ã€‚å…·ä½“å‚ç…§<span class="exturl" data-url="aHR0cHM6Ly93d3cucnVhbngubmV0L2V4Y3J0Lw=="> ruanx å¤§ä½¬çš„ blog</span></p><p>æœ€åæ”¾äº†ä¸ªæ¿å­æˆ‘ä¹Ÿå°±ç›´æ¥ç”¨äº†ï½</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">exgcd</span>(<span class="params">a, b</span>):</span><br><span class="line">    <span class="keyword">if</span> b == <span class="number">0</span>: <span class="keyword">return</span> <span class="number">1</span>, <span class="number">0</span></span><br><span class="line">    x, y = exgcd(b, a % b)</span><br><span class="line">    <span class="keyword">return</span> y, x - a // b * y</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">uni</span>(<span class="params">P, Q</span>):</span><br><span class="line">    r1, m1 = P</span><br><span class="line">    r2, m2 = Q</span><br><span class="line">    d = gmpy2.gcd(m1, m2)</span><br><span class="line">    <span class="keyword">assert</span> (r2 - r1) % d == <span class="number">0</span></span><br><span class="line">    l1, l2 = exgcd(m1 // d, m2 // d)</span><br><span class="line">    <span class="keyword">return</span> (r1 + (r2 - r1) // d * l1 * m1) % gmpy2.lcm(m1, m2), gmpy2.lcm(m1, m2)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">CRT</span>(<span class="params">eq</span>):</span><br><span class="line">    <span class="keyword">return</span> reduce(uni, eq)</span><br><span class="line">e = <span class="number">7</span></span><br><span class="line">m1,mod1 = CRT(<span class="built_in">zip</span>(cl1,ul))<span class="comment">#å¾—åˆ°é€šè§£çš„å½¢å¼æ˜¯m1 + i * mod1</span></span><br><span class="line">m2,mod2 = CRT(<span class="built_in">zip</span>(cl2,vl))</span><br><span class="line"><span class="built_in">print</span>(m1)</span><br><span class="line">m1 = long_to_bytes(gmpy2.iroot(m1,e)[<span class="number">0</span>])</span><br><span class="line">m2 = long_to_bytes(gmpy2.iroot(m2,e)[<span class="number">0</span>])</span><br><span class="line"><span class="built_in">print</span>(m1)</span><br><span class="line"><span class="built_in">print</span>(m2)</span><br><span class="line"><span class="comment">#b&#x27;Hello, this is the first message.&#x27;</span></span><br><span class="line"><span class="comment">#b&#x27;YES!! that is the second message.&#x27;</span></span><br></pre></td></tr></table></figure><p>å¾—åˆ°äº† m1 å’Œ m2ã€‚ä¹Ÿå°±å¾—åˆ°äº† hm1ã€hm2ã€‚æœ€åæ¥åˆ†æä¸€ä¸‹å…³äº flag çš„åŠ å¯†ã€‚<br><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mn>1</mn><mo>â‰¡</mo><mo stretchy="false">(</mo><mi>h</mi><mi>m</mi><mn>1</mn><mo>+</mo><mi>x</mi><mn>1</mn><mo>Ã—</mo><mi>r</mi><mn>1</mn><mo stretchy="false">)</mo><mo>Ã—</mo><msup><mi>k</mi><mrow><mo>âˆ’</mo><mn>1</mn></mrow></msup><mspace></mspace><mspace width="0.4444444444444444em"><mo stretchy="false">(</mo><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mspace width="0.3333333333333333em"><mi>q</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">s1 \equiv (hm1 + x1 \times r1) \times k^{-1} \pmod q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord mathnormal">s</span><span class="mord">1</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">â‰¡</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord mathnormal">h</span><span class="mord mathnormal">m</span><span class="mord">1</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.72777em;vertical-align:-.08333em"></span><span class="mord mathnormal">x</span><span class="mord">1</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal" style="margin-right:.02778em">r</span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.8141079999999999em;vertical-align:0"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">âˆ’</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:.4444444444444444em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:.3333333333333333em"></span><span class="mord mathnormal" style="margin-right:.03588em">q</span><span class="mclose">)</span></span></span></span><br><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mn>2</mn><mo>â‰¡</mo><mo stretchy="false">(</mo><mi>h</mi><mi>m</mi><mn>2</mn><mo>+</mo><mi>x</mi><mn>1</mn><mo>Ã—</mo><mi>r</mi><mn>1</mn><mo stretchy="false">)</mo><mo>Ã—</mo><msup><mi>k</mi><mrow><mo>âˆ’</mo><mn>1</mn></mrow></msup><mspace></mspace><mspace width="0.4444444444444444em"><mo stretchy="false">(</mo><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mspace width="0.3333333333333333em"><mi>q</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">s2 \equiv (hm2 + x1 \times r1) \times k^{-1} \pmod q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord mathnormal">s</span><span class="mord">2</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">â‰¡</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord mathnormal">h</span><span class="mord mathnormal">m</span><span class="mord">2</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.72777em;vertical-align:-.08333em"></span><span class="mord mathnormal">x</span><span class="mord">1</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal" style="margin-right:.02778em">r</span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.8141079999999999em;vertical-align:0"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">âˆ’</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:.4444444444444444em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:.3333333333333333em"></span><span class="mord mathnormal" style="margin-right:.03588em">q</span><span class="mclose">)</span></span></span></span></p><p>é¢˜ç›®ä¹Ÿç»™äº†<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>Ã—</mo><mi>q</mi></mrow><annotation encoding="application/x-tex">p \times q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.7777700000000001em;vertical-align:-.19444em"></span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.625em;vertical-align:-.19444em"></span><span class="mord mathnormal" style="margin-right:.03588em">q</span></span></span></span> å’Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><mi>p</mi><mo>âˆ’</mo><mn>1</mn></mrow><mi>q</mi></mfrac></mrow><annotation encoding="application/x-tex">\frac{p - 1}{q}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.378324em;vertical-align:-.481108em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.897216em"><span style="top:-2.6550000000000002em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:.03588em">q</span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.446108em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span><span class="mbin mtight">âˆ’</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:.481108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span>ï¼Œè§£ä¸ªæ–¹ç¨‹å‡º pqï¼Œå¤ç°çš„æ—¶å€™è¯•äº†è¯• factorb ä¹Ÿèƒ½å‡ºã€‚å¾—åˆ° q ä¹‹åå°±è§£ kï¼Œä¸¤ä¸ªå¼å­ç›¸å‡ï¼Œéœ€æ³¨æ„çš„æ˜¯è¿™é‡Œçš„åŠ å‡ä¹˜é™¤éƒ½æ˜¯åœ¨æ¨¡æ„ä¹‰ä¸‹çš„ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">_m = hm1 - hm2<span class="comment">#æ˜¯è´Ÿæ•°</span></span><br><span class="line">_s = s1 - s2</span><br><span class="line">k = gmpy2.mul(_m,gmpy2.invert(_s,q)) % q</span><br><span class="line"><span class="built_in">print</span>(k)</span><br><span class="line">x1 = (gmpy2.mul(s1,k) - hm1) * gmpy2.invert(r1,q) % q</span><br><span class="line">x2 = (gmpy2.mul(s3,k) - hm1) * gmpy2.invert(r2,q) % q</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(x1) + long_to_bytes(x2))</span><br><span class="line"><span class="comment">#b&#x27;DASCTF&#123;f11bad18f529750fe52c56eed85d001b&#125;&#x27;</span></span><br></pre></td></tr></table></figure><h5 id="æ€»ç»“"><a class="anchor" href="#æ€»ç»“">#</a> æ€»ç»“</h5><p>é«˜ä¸­è€å¸ˆå°±æ•™è¿‡è¯´æ•°å­¦æ˜¯ä¸€é—¨å·¥å…·å­¦ç§‘ï¼Œctf çš„å¯†ç å­¦é¢˜ç›®ä¸­å¤§éƒ¨åˆ†ä¹Ÿéƒ½æ˜¯åå‘äºåº”ç”¨ã€‚é€šä¿—ä¸€ç‚¹è®²å°±æ˜¯ï¼Œæˆ‘çŸ¥é“äº†å˜é‡ aã€bï¼Œé¢˜ç›®è¦æ±‚ cï¼Œæˆ‘çŸ¥é“ python æˆ–è€… sage æˆ–è€…æ˜¯å…¶ä»–å“ªä¸ª<strong>å·¥å…·</strong>å¯ä»¥é€šè¿‡å·²çŸ¥é‡æ±‚å‡º cï¼Œæ¥ï¼Œä½†æ˜¯åŸç†æˆ‘å…¶å®ä¸èƒ½è®²çš„å¾ˆæ¸…æ¥šã€‚</p><p>å¾ˆç›´è§‚çš„ä½“ç°å°±æ˜¯ python é‡Œé¢çš„ gmpy2ï¼Œsympy ç­‰è¿™äº›åŒ…æˆ–è€…æ˜¯ sage é‡Œé¢çš„å‡½æ•°ï¼Œå¾ˆéš¾è¯´å»ç†è§£é‡Œé¢æ¯ä¸ªå‡½æ•°çš„åŸç†ä»£ç å®ç°ï¼ŒçŸ¥é“çš„æ›´å¤šå°±æ˜¯åº”ç”¨ã€‚</p><p>å½“ç„¶å®šç†çš„åŸç†è¿˜æ˜¯è¦å¼„æ¸…æ¥šï¼Œæ¯”å¦‚è¯´è¿™é¢˜çš„ excrtï¼Œè¿™æ ·é¢˜ç›®é­”æ”¹ä¹‹åä¹Ÿèƒ½å¾—å¿ƒåº”æ‰‹ã€‚</p><h4 id="0x0c-å°çœèµ›ç®€å•aes-125"><a class="anchor" href="#0x0c-å°çœèµ›ç®€å•aes-125">#</a> 0x0C å°çœèµ›ç®€å• aes 12.5</h4><p>é™„ä»¶</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> Crypto.Util <span class="keyword">import</span> Counter</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">KEY = os.urandom(<span class="number">16</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">plaintext</span>):</span><br><span class="line">    cipher = AES.new(KEY, AES.MODE_CTR, counter=Counter.new(<span class="number">128</span>))</span><br><span class="line">    ciphertext = cipher.encrypt(plaintext).<span class="built_in">hex</span>()</span><br><span class="line">    <span class="keyword">return</span> ciphertext</span><br><span class="line"></span><br><span class="line">message = <span class="string">b&quot;Don&#x27;t be afraid to fail. It&#x27;s not the end of the world and in many ways it&#x27;s the first step toward learning something better and getting better at it.&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(encrypt(message))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(bytes_to_long(message)))</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;flag.txt&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    flag = f.read().strip()</span><br><span class="line"><span class="built_in">print</span>(encrypt(flag))</span><br><span class="line"><span class="comment">#e453a54c22660a191c8d41f9a7e1709ea615bef755eb5b82bc99f58703bfca088e2d26f44dc84d54e0127a6586b45b94371a3f2f858ffd95bb0b0cfe941ace3272e8cb5ce1da10e8a7a38fa0f58ac0af688693cdcba10c4ea5ed94f01ba3c3676a96bdc5d3ecf926364a446aca8b958c0760a68eaca395b1514295b18f21444f72239f3828b22e4c11e8608fa69cc721db003fedcee0</span></span><br><span class="line"><span class="comment">#c650aa0c2d7459195e8915e8a7b12d8ab71facf70db5059aace5b49041af9406c96f36f94d95</span></span><br></pre></td></tr></table></figure><p>ä»£ç å¾ˆçŸ­ä¹Ÿå¾ˆå®¹æ˜“çœ‹æ‡‚ï¼Œå…ˆæŠŠç»™å‡ºçš„ message ç”¨ AES çš„ CTR æ¨¡å¼åŠ å¯†ç»™å‡ºç»“æœï¼Œå†ç»™å‡ºåŠ å¯†ä¹‹åçš„ flagï¼Œéœ€è¦é€†æ¨å›åŸæ¥çš„ flagã€‚å…ˆæ¥çœ‹çœ‹ CTR æ¨¡å¼çš„åŠ å¯†è§£å¯†ã€‚</p><img data-src="/images/2021120501.png" style="zoom:80%"> <img data-src="/images/2021120502.png" style="zoom:80%"><p>æˆ‘ä»¬å¯ä»¥ç”¨ç»™å‡ºçš„ message çš„æ˜æ–‡å¯†æ–‡å½¢å¼æ±‚å‡ºè®¡æ•°å™¨åŠ å¯†ä¹‹åçš„å­—èŠ‚ï¼Œå†ç”¨è¿™äº›æ¥å’Œ flag çš„å¯†æ–‡è¿›è¡Œå¼‚æˆ–å¾—åˆ°çš„å°±æ˜¯ flagï¼Œæ€è·¯è¿˜æ˜¯å¾ˆç®€å•çš„ï¼Œç›´æ¥è´´ exp äº†ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util <span class="keyword">import</span> Counter</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">xor</span>(<span class="params">a,b</span>):</span><br><span class="line">    ans = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">min</span>(<span class="built_in">len</span>(a),<span class="built_in">len</span>(b))):</span><br><span class="line">        num1 = <span class="built_in">eval</span>(<span class="string">&#x27;0x&#x27;</span> + a[i])</span><br><span class="line">        num2 = <span class="built_in">eval</span>(<span class="string">&#x27;0x&#x27;</span> + b[i])</span><br><span class="line">        ans += <span class="built_in">hex</span>(num1 ^ num2)[<span class="number">2</span>:]</span><br><span class="line">    <span class="keyword">return</span> ans</span><br><span class="line"></span><br><span class="line">message = <span class="string">b&quot;Don&#x27;t be afraid to fail. It&#x27;s not the end of the world and in many ways it&#x27;s the first step toward learning something better and getting better at it.&quot;</span></span><br><span class="line">c = <span class="string">&#x27;e453a54c22660a191c8d41f9a7e1709ea615bef755eb5b82bc99f58703bfca088e2d26f44dc84d54e0127a6586b45b94371a3f2f858ffd95bb0b0cfe941ace3272e8cb5ce1da10e8a7a38fa0f58ac0af688693cdcba10c4ea5ed94f01ba3c3676a96bdc5d3ecf926364a446aca8b958c0760a68eaca395b1514295b18f21444f72239f3828b22e4c11e8608fa69cc721db003fedcee0&#x27;</span></span><br><span class="line">eflag = <span class="string">&#x27;c650aa0c2d7459195e8915e8a7b12d8ab71facf70db5059aace5b49041af9406c96f36f94d95&#x27;</span></span><br><span class="line">hexmessage = <span class="built_in">hex</span>(bytes_to_long(message))[<span class="number">2</span>:]</span><br><span class="line"><span class="built_in">print</span>(hexmessage)</span><br><span class="line">key = xor(c,hexmessage)</span><br><span class="line">key = key[:<span class="number">76</span>]</span><br><span class="line">flag = xor(key,eflag)</span><br><span class="line">flag = long_to_bytes(<span class="built_in">eval</span>(<span class="string">&#x27;0x&#x27;</span> + flag))</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure><h4 id="0x0b-2020actfæ–°ç”Ÿèµ›crypto-aes-125"><a class="anchor" href="#0x0b-2020actfæ–°ç”Ÿèµ›crypto-aes-125">#</a> 0x0B 2020ACTF æ–°ç”Ÿèµ› crypto-aes 12.5</h4><p>é™„ä»¶</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Cryptodome.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> FLAG</span><br><span class="line"><span class="keyword">from</span> Cryptodome.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    key=os.urandom(<span class="number">2</span>)*<span class="number">16</span></span><br><span class="line">    iv=os.urandom(<span class="number">16</span>)</span><br><span class="line">    <span class="built_in">print</span>(bytes_to_long(key)^bytes_to_long(iv))</span><br><span class="line">    aes=AES.new(key,AES.MODE_CBC,iv)</span><br><span class="line">    enc_flag = aes.encrypt(FLAG)</span><br><span class="line">    <span class="built_in">print</span>(enc_flag)</span><br><span class="line"><span class="keyword">if</span> __name__==<span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure><p>ä»£ç å¾ˆå¥½æ‡‚ï¼Œkey æ˜¯ä¸¤ä¸ª bytes*16ï¼Œåˆå§‹å‘é‡ iv æ˜¯éšæœº 16 ä¸ª bytesã€‚å¯ä»¥çœ‹å‡º key æ˜¯æ¯” iv é•¿ä¸€å€çš„ï¼Œé¢˜ç›®ç»™äº† key^iv çš„å€¼ï¼Œå‰é¢ä¸€åŠå°±å¯ä»¥æ¨å‡º keyï¼Œæ¨å‡º key å†æ¨å‡º ivï¼Œè¿™é¢˜å°±åšå®Œäº†ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">tmp = <span class="number">91144196586662942563895769614300232343026691029427747065707381728622849079757</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(tmp))</span><br><span class="line"><span class="comment">#0xc981c981c981c981c981c981c981c9814eed98e380b1356763849930c850b9cd</span></span><br><span class="line">æ˜¾è€Œæ˜“è§å¯æ¨å‡º</span><br><span class="line">key = <span class="string">b&#x27;\xc9\x81&#x27;</span> * <span class="number">16</span></span><br></pre></td></tr></table></figure><p>ç„¶åå†å¼‚æˆ–å¾—åˆ° ivï¼Œè´´ä¸€ä¸ªå®Œæ•´çš„ exp</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">xor</span>(<span class="params">a,b</span>):</span><br><span class="line">    ans = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">min</span>(<span class="built_in">len</span>(a),<span class="built_in">len</span>(b))):</span><br><span class="line">        num1 = <span class="built_in">eval</span>(<span class="string">&#x27;0x&#x27;</span> + a[i])</span><br><span class="line">        num2 = <span class="built_in">eval</span>(<span class="string">&#x27;0x&#x27;</span> + b[i])</span><br><span class="line">        ans += <span class="built_in">hex</span>(num1 ^ num2)[<span class="number">2</span>:]</span><br><span class="line">    <span class="keyword">return</span> ans</span><br><span class="line"></span><br><span class="line">tmp = <span class="number">91144196586662942563895769614300232343026691029427747065707381728622849079757</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(tmp))</span><br><span class="line">key = <span class="string">b&#x27;\xc9\x81&#x27;</span> * <span class="number">16</span></span><br><span class="line"><span class="comment">#iv = xor(key,hex(tmp)[2:])</span></span><br><span class="line">iv = <span class="string">b&#x27;\x87\x6c\x51\x62\x49\x30\xfc\xe6\xaa\x05\x50\xb1\x01\xd1\x70\x4c&#x27;</span></span><br><span class="line">enc_flag = <span class="string">b&#x27;\x8c-\xcd\xde\xa7\xe9\x7f.b\x8aKs\xf1\xba\xc75\xc4d\x13\x07\xac\xa4&amp;\xd6\x91\xfe\xf3\x14\x10|\xf8p&#x27;</span></span><br><span class="line"><span class="comment"># print(key)</span></span><br><span class="line"><span class="comment"># print(iv)</span></span><br><span class="line">aes = AES.new(key,AES.MODE_CBC,iv)</span><br><span class="line">flag = aes.decrypt(enc_flag)</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure><h4 id="0x0a-2021swpu_nssctfæ–°ç”Ÿèµ›-crypto3-1129"><a class="anchor" href="#0x0a-2021swpu_nssctfæ–°ç”Ÿèµ›-crypto3-1129">#</a> 0x0A 2021swpu_nssctf æ–°ç”Ÿèµ› crypto3 11.29</h4><p>é™„ä»¶</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">flag  = <span class="string">&#x27;******************&#x27;</span></span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">q = getPrime(<span class="number">512</span>)</span><br><span class="line">m1 = bytes_to_long(<span class="built_in">bytes</span>(flag.encode()))</span><br><span class="line"></span><br><span class="line">n = p*q</span><br><span class="line"></span><br><span class="line">flag1 = <span class="built_in">pow</span>(m1,p,n)</span><br><span class="line">flag2 = <span class="built_in">pow</span>(m1,q,n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;flag1= &#x27;</span>+<span class="built_in">str</span>(flag1))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;flag2= &#x27;</span>+<span class="built_in">str</span>(flag2))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;n= &#x27;</span>+<span class="built_in">str</span>(n))</span><br><span class="line"></span><br><span class="line"><span class="comment">#flag1= 17893542812755845772427795161304049467610774531005620109503081344099161906017295486868699578946474114607624347167976713200068059018517606363517478396368430072890681401898145302336139240273132723451063402106360810413024642916851746118524166947301681245568333254648265529408446609050354235727237078987509705857</span></span><br><span class="line"><span class="comment">#flag2= 95580409405085606847879727622943874726633827220524165744517624606566789614499137069562997931972825651309707390763700301965277040876322904891716953565845966918293178547100704981251056401939781365264616997055296773593435626490578886752446381493929807909671245959154990639046333135728431707979143972145708806954</span></span><br><span class="line"><span class="comment">#n= 140457323583824160338989317689698102738341061967768153879646505422358544720607476140977064053629005764551339082120337223672330979298373653766782620973454095507484118565884885623328751648660379894592063436924903894986994746394508539721459355200184089470977772075720319482839923856979166319700474349042326898971</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>flag1ã€flag2 ä½œä¸ºä¸¤ä¸ªåŠ å¯†åçš„å¯†æ–‡ï¼Œè¿™é¢˜å°±æ˜¯çº¯çº¯çš„æ•°å­¦é¢˜ï¼Œæœ€åè¿ç”¨ sage çš„ PolynomialRing (Zmod (n)) æ±‚è§£ã€‚</p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mn>1</mn><mo>=</mo><msup><mi>m</mi><mi>p</mi></msup><mi mathvariant="normal">%</mi><mi>n</mi></mrow><annotation encoding="application/x-tex">c1=m^{p} \% n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord mathnormal">c</span><span class="mord">1</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.80556em;vertical-align:-.05556em"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.664392em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span></span></span></span></span></span></span></span></span><span class="mord">%</span><span class="mord mathnormal">n</span></span></span></span><br><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mn>2</mn><mo>=</mo><msup><mi>m</mi><mi>q</mi></msup><mi mathvariant="normal">%</mi><mi>n</mi></mrow><annotation encoding="application/x-tex">c2=m^{q} \% n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord mathnormal">c</span><span class="mord">2</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.80556em;vertical-align:-.05556em"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.664392em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:.03588em">q</span></span></span></span></span></span></span></span></span><span class="mord">%</span><span class="mord mathnormal">n</span></span></span></span></p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mn>1</mn><mi mathvariant="normal">%</mi><mi>p</mi><mo>=</mo><msup><mi>m</mi><mi>p</mi></msup><mi mathvariant="normal">%</mi><mi>p</mi></mrow><annotation encoding="application/x-tex">c1 \% p=m^{p} \% p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.94444em;vertical-align:-.19444em"></span><span class="mord mathnormal">c</span><span class="mord">1</span><span class="mord">%</span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.94444em;vertical-align:-.19444em"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.664392em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span></span></span></span></span></span></span></span></span><span class="mord">%</span><span class="mord mathnormal">p</span></span></span></span><br><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mn>2</mn><mi mathvariant="normal">%</mi><mi>q</mi><mo>=</mo><msup><mi>m</mi><mi>q</mi></msup><mi mathvariant="normal">%</mi><mi>p</mi></mrow><annotation encoding="application/x-tex">c2 \% q=m^{q} \% p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.94444em;vertical-align:-.19444em"></span><span class="mord mathnormal">c</span><span class="mord">2</span><span class="mord">%</span><span class="mord mathnormal" style="margin-right:.03588em">q</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.94444em;vertical-align:-.19444em"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.664392em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:.03588em">q</span></span></span></span></span></span></span></span></span><span class="mord">%</span><span class="mord mathnormal">p</span></span></span></span></p><p>æ ¹æ®è´¹é©¬å°å®šç†</p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>a</mi><mrow><mi>p</mi><mo>âˆ’</mo><mn>1</mn></mrow></msup><mo>â‰¡</mo><mn>1</mn><mspace></mspace><mspace width="0.4444444444444444em"><mo stretchy="false">(</mo><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mspace width="0.3333333333333333em"><mi>p</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">a^{p-1} \equiv 1\pmod p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8141079999999999em;vertical-align:0"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span><span class="mbin mtight">âˆ’</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">â‰¡</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">1</span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:.4444444444444444em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:.3333333333333333em"></span><span class="mord mathnormal">p</span><span class="mclose">)</span></span></span></span> p ä¸ºç´ æ•°<br>ä¹Ÿå¯ä»¥å†™æˆ<br><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>a</mi><mi>p</mi></msup><mo>â‰¡</mo><mi>a</mi><mspace></mspace><mspace width="0.4444444444444444em"><mo stretchy="false">(</mo><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mspace width="0.3333333333333333em"><mi>p</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">a^{p} \equiv a\pmod p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.664392em;vertical-align:0"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.664392em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">â‰¡</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord mathnormal">a</span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:.4444444444444444em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:.3333333333333333em"></span><span class="mord mathnormal">p</span><span class="mclose">)</span></span></span></span></p><p>å¯å¾—</p><p>$c1 % p=m^{p} % p=m % p \quad <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>å³</mtext></mrow><annotation encoding="application/x-tex">å³</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.68333em;vertical-align:0"></span><span class="mord cjk_fallback">å³</span></span></span></span> c1 \equiv m \pmod p$<br>åŒç† <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mn>2</mn><mo>â‰¡</mo><mi>m</mi><mspace></mspace><mspace width="0.4444444444444444em"><mo stretchy="false">(</mo><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mspace width="0.3333333333333333em"><mi>q</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">c2 \equiv m \pmod q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord mathnormal">c</span><span class="mord">2</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">â‰¡</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord mathnormal">m</span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:.4444444444444444em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:.3333333333333333em"></span><span class="mord mathnormal" style="margin-right:.03588em">q</span><span class="mclose">)</span></span></span></span></p><p>å†™æˆç­‰å¼å°±æ˜¯</p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mn>1</mn><mo>=</mo><mi>m</mi><mo>+</mo><msub><mi>k</mi><mn>1</mn></msub><mo>Ã—</mo><mi>p</mi></mrow><annotation encoding="application/x-tex">c1=m+k_1Ã—p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord mathnormal">c</span><span class="mord">1</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.66666em;vertical-align:-.08333em"></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.84444em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.625em;vertical-align:-.19444em"></span><span class="mord mathnormal">p</span></span></span></span><br><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mn>2</mn><mo>=</mo><mi>m</mi><mo>+</mo><msub><mi>k</mi><mn>2</mn></msub><mo>Ã—</mo><mi>q</mi></mrow><annotation encoding="application/x-tex">c2=m+k_2Ã—q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord mathnormal">c</span><span class="mord">2</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.66666em;vertical-align:-.08333em"></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.84444em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.625em;vertical-align:-.19444em"></span><span class="mord mathnormal" style="margin-right:.03588em">q</span></span></span></span></p><p>ç»è¿‡ç­‰å¼å˜æ¢å¯å¾—</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msup><mi>m</mi><mn>2</mn></msup><mo>âˆ’</mo><mi>m</mi><mo>Ã—</mo><mo stretchy="false">(</mo><mi>c</mi><mn>1</mn><mo>+</mo><mi>c</mi><mn>2</mn><mo stretchy="false">)</mo><mo>+</mo><mi>c</mi><mn>1</mn><mo>Ã—</mo><mi>c</mi><mn>2</mn><mo>=</mo><msub><mi>k</mi><mn>1</mn></msub><mo>Ã—</mo><msub><mi>k</mi><mn>2</mn></msub><mo>Ã—</mo><mi>n</mi><mo>â‰¡</mo><mn>0</mn><mspace></mspace><mspace width="1em"><mo stretchy="false">(</mo><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mspace width="0.3333333333333333em"><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">m^{2}-mÃ—(c1+c2)+c1Ã—c2=k_1\times k_2\times n \equiv 0 \pmod n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.9474379999999999em;vertical-align:-.08333em"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8641079999999999em"><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.66666em;vertical-align:-.08333em"></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord mathnormal">c</span><span class="mord">1</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal">c</span><span class="mord">2</span><span class="mclose">)</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.72777em;vertical-align:-.08333em"></span><span class="mord mathnormal">c</span><span class="mord">1</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord mathnormal">c</span><span class="mord">2</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.84444em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.84444em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.46375em;vertical-align:0"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">â‰¡</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">0</span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:1em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:.3333333333333333em"></span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span></span></p><p>æ¼”ç®—è‡³æ­¤ï¼Œå¯ç”¨ sage è§£åŒä½™æ–¹ç¨‹ï¼Œè¯¥åŒä½™å¼ä¸­ä»…æœ‰ m ä¸ºæœªçŸ¥å€¼</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#sage</span></span><br><span class="line">c1= <span class="number">17893542812755845772427795161304049467610774531005620109503081344099161906017295486868699578946474114607624347167976713200068059018517606363517478396368430072890681401898145302336139240273132723451063402106360810413024642916851746118524166947301681245568333254648265529408446609050354235727237078987509705857</span></span><br><span class="line">c2= <span class="number">95580409405085606847879727622943874726633827220524165744517624606566789614499137069562997931972825651309707390763700301965277040876322904891716953565845966918293178547100704981251056401939781365264616997055296773593435626490578886752446381493929807909671245959154990639046333135728431707979143972145708806954</span></span><br><span class="line">n= <span class="number">140457323583824160338989317689698102738341061967768153879646505422358544720607476140977064053629005764551339082120337223672330979298373653766782620973454095507484118565884885623328751648660379894592063436924903894986994746394508539721459355200184089470977772075720319482839923856979166319700474349042326898971</span></span><br><span class="line"></span><br><span class="line">PR.&lt;x&gt; = PolynomialRing(Zmod(n))</span><br><span class="line">f = x^<span class="number">2</span> - (c1 + c2) * x + c1 * c2<span class="comment">#åŒä½™æ–¹ç¨‹ å³è¾¹ä¸º0</span></span><br><span class="line">x0 = f.small_roots(X = <span class="number">2</span>^<span class="number">400</span>,beta = <span class="number">0.4</span>)<span class="comment">#Xä¸ºæ–¹ç¨‹ä¸­Xçš„å¤§æ¦‚å€¼</span></span><br><span class="line"><span class="built_in">print</span>(x0)<span class="comment">#å¾—åˆ°çš„ç»“æœå³ä¸ºmçš„å€¼</span></span><br></pre></td></tr></table></figure><p>æœ€åå°†å¾—åˆ°çš„ m ç›´æ¥ long_to_bytes å°±å¥½äº†ã€‚</p><h4 id="0x09-2021å®‰æ´µæ¯cry3-1128"><a class="anchor" href="#0x09-2021å®‰æ´µæ¯cry3-1128">#</a> 0x09 2021 å®‰æ´µæ¯ cry3 11.28</h4><p>é™„ä»¶</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">flag = <span class="string">b&#x27;D0g3&#123;&#125;&#x27;</span></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">1024</span>)</span><br><span class="line">q = getPrime(<span class="number">1024</span>)</span><br><span class="line">n = p * q</span><br><span class="line">e = <span class="number">3</span></span><br><span class="line"></span><br><span class="line">hint = bytes_to_long(os.urandom(<span class="number">256</span>))</span><br><span class="line"></span><br><span class="line">m1 = m | hint</span><br><span class="line">m2 = m &amp; hint</span><br><span class="line"></span><br><span class="line">c = <span class="built_in">pow</span>(m1, e, n)</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;output.txt&#x27;</span>,<span class="string">&#x27;a&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f.write(<span class="built_in">str</span>([n,c,m2,hint]))</span><br><span class="line">    f.close()</span><br></pre></td></tr></table></figure><p>ä»”ç»†è§‚å¯Ÿï¼Œç»™äº† m2 å’Œ hintï¼Œm1 æ˜¯ m å’Œ hint åšæˆ– | è¿ç®—ï¼Œm2 æ˜¯ m å’Œ hint åšä¸ | è¿ç®—ã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ c æ˜¯ç”± m1 åŠ å¯†å¾—åˆ°çš„ï¼Œæœ€ç»ˆæˆ‘ä»¬è¦æ±‚çš„æ˜¯ mã€‚è¿™é¢˜çš„éš¾ç‚¹å°±æ˜¯çœ‹å‡ºè¿™æ˜¯ä¸€ä¸ª coppersmith æ”»å‡»ã€‚çœ‹ä¸€ä¸‹ä½æ•°ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(hint.bit_length())<span class="comment">#2047</span></span><br><span class="line"><span class="built_in">print</span>(m2.bit_length())<span class="comment">#383</span></span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹å‡º hint æ˜¯æ¯” m2 é•¿å¾ˆå¤šçš„ï¼Œæ‰€ä»¥å¯ä»¥æ¨å‡º m çš„é•¿åº¦ä¸º 383ï¼Œ383 ä½çš„ m å’Œ 2047 ä½çš„ hint åšæˆ– | è¿ç®—ï¼Œå¾—åˆ°çš„ m1 ä¹Ÿæ˜¯ 2047 ä½çš„ï¼Œå¯ä»¥ç†è§£ä¸ºæ˜¯ hint çš„å 383 ä½è¢« m æ··æ·†å¾—åˆ°äº† m1ã€‚</p><p>è¿™æ ·æƒ³æ€è·¯å°±ç®€å•äº†ï¼Œå¯ä»¥ç†è§£ä¸ºæ˜¯ç»™å‡º m é«˜ä½çš„ coppersmith æ”»å‡»ï¼ŒStereotyped messages æ”»å‡»ã€‚æ‰€ä»¥è¿™é‡Œç›´æ¥å°† hint ç†è§£ä¸ºæ˜¯é«˜ä½çš„ m1ï¼Œç›´æ¥èˆå¼ƒåé¢è¢«æ··æ·†çš„ 383 ä½ï¼Œå…ˆåšä¸€ä¸ªå¤„ç†æ˜¯</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">m_high = hint &gt;&gt; <span class="number">383</span> &lt;&lt; <span class="number">383</span></span><br></pre></td></tr></table></figure><p>å†å°±æ˜¯è·‘ sage</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#sage</span></span><br><span class="line">e = </span><br><span class="line">b = <span class="comment">#é«˜ä½m</span></span><br><span class="line">n = </span><br><span class="line">c = </span><br><span class="line">kbits = <span class="comment">#ä½ä½mçš„ä½æ•°</span></span><br><span class="line">PR.&lt;x&gt; = PolynomialRing(Zmod(n))</span><br><span class="line">f = (x + b)^e-c</span><br><span class="line">x0 = f.small_roots(X=<span class="number">2</span>^kbits, beta=<span class="number">1</span>)[<span class="number">0</span>]</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">int</span>(x0))</span><br><span class="line"><span class="comment">#å¾—åˆ°çš„ç»“æœx0æ˜¯ä½ä½m</span></span><br></pre></td></tr></table></figure><p>è¿™æ ·å¯ä»¥å¾—åˆ°ä½ä½çš„ m1ï¼Œä¹Ÿå°±æ˜¯çŸ¥é“äº†åé¢ 383 ä½çš„ m1ï¼Œè¿™æ ·å·²çŸ¥ m1ã€m2ã€hintï¼Œå°±å¯ä»¥æŠŠ 383 ä½çš„ m æ¯ä¸€ä½ç»™è¯•å‡ºæ¥ã€‚å®Œæ•´è„šæœ¬å¦‚ä¸‹ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">n = <span class="number">13002904520196087913175026378157676218772224961198751789793139372975952998874109513709715017379230449514880674554473551508221946249854541352973100832075633211148140972925579736088058214014993082226530875284219933922497736077346225464349174819075866774069797318066487496627589111652333814065053663974480486379799102403118744672956634588445292675676671957278976483815342400168310432107890845293789670795394151784569722676109573685451673961309951157399183944789163591809561790491021872748674809148737825709985578568373545210653290368264452963080533949168735319775945818152681754882108865201849467932032981615400210529003</span></span><br><span class="line">c = <span class="number">8560367979088389639093355670052955344968008917787780010833158290316540154791612927595480968370338549837249823871244436946889198677945456273317343886485741297260557172704718731809632734567349815338988169177983222118718585249696953103962537942023413748690596354436063345873831550109098151014332237310265412976776977183110431262893144552042116871747127301026195142320678244525719655551498368460837394436842924713450715998795899172774573341189660227254331656916960984157772527015479797004423165812493802730996272276613362505737536007284308929288293814697988968407777480072409184261544708820877153825470988634588666018802</span></span><br><span class="line">m2 = <span class="number">9869907877594701353175281930839281485694004896356038595955883788511764488228640164047958227861871572990960024485992</span></span><br><span class="line">hint = <span class="number">9989639419782222444529129951526723618831672627603783728728767345257941311870269471651907118545783408295856954214259681421943807855554571179619485975143945972545328763519931371552573980829950864711586524281634114102102055299443001677757487698347910133933036008103313525651192020921231290560979831996376634906893793239834172305304964022881699764957699708192080739949462316844091240219351646138447816969994625883377800662643645172691649337353080140418336425506119542396319376821324619330083174008060351210307698279022584862990749963452589922185709026197210591472680780996507882639014068600165049839680108974873361895144</span></span><br><span class="line"><span class="comment"># print(hint.bit_length())</span></span><br><span class="line"><span class="comment"># print(m2.bit_length())</span></span><br><span class="line">m_part = hint &gt;&gt; <span class="number">383</span> &lt;&lt; <span class="number">383</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(m_part))</span><br><span class="line"><span class="comment">#sageå¾—åˆ°çš„m1_low</span></span><br><span class="line">m1_low = <span class="number">13420866878657192881981508918368509601760484822510871697454710042290632315733970543259862148639047993224391010676733</span></span><br><span class="line">m1 = m_part + m1_low</span><br><span class="line"><span class="built_in">print</span>(m1_low.bit_length())</span><br><span class="line"><span class="built_in">print</span>(m1.bit_length())</span><br><span class="line">_m1 = <span class="built_in">bin</span>(m1_low)[<span class="number">2</span>:]</span><br><span class="line">_m2 = <span class="built_in">bin</span>(m2)[<span class="number">2</span>:]</span><br><span class="line">_hint = <span class="built_in">bin</span>(hint)[-<span class="number">383</span>:]</span><br><span class="line">m = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">383</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="number">1</span> | <span class="built_in">int</span>(_hint[i]) == <span class="built_in">int</span>(_m1[i]) <span class="keyword">and</span> <span class="number">1</span> &amp; <span class="built_in">int</span>(_hint[i]) == <span class="built_in">int</span>(_m2[i]):</span><br><span class="line">        m += <span class="string">&#x27;1&#x27;</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        m += <span class="string">&#x27;0&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(m)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(m,<span class="number">2</span>)))</span><br></pre></td></tr></table></figure><h4 id="0x08-2020ç¾ŠåŸæ¯gmc-1124"><a class="anchor" href="#0x08-2020ç¾ŠåŸæ¯gmc-1124">#</a> 0x08 2020 ç¾ŠåŸæ¯ gmc 11.24</h4><p>é™„ä»¶</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getPrime,bytes_to_long,getRandomNBitInteger</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> gcd</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gmc</span>(<span class="params">a, p</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">pow</span>(a, (p-<span class="number">1</span>)//<span class="number">2</span>, p) == <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> -<span class="number">1</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gen_key</span>():</span><br><span class="line">    [gp,gq] = [getPrime(<span class="number">512</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>)]</span><br><span class="line">    gN = gp * gq</span><br><span class="line">    <span class="keyword">return</span> gN, gq, gp</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gen_x</span>(<span class="params">gq,gp</span>):</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        x = getRandomNBitInteger(<span class="number">512</span>)</span><br><span class="line">        <span class="keyword">if</span> gmc(x,gp) ^ gmc(x,gq) == -<span class="number">2</span>:</span><br><span class="line">            <span class="keyword">return</span> x</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gen_y</span>(<span class="params">gN</span>):</span><br><span class="line">    gy_list = []</span><br><span class="line">    <span class="keyword">while</span> <span class="built_in">len</span>(gy_list) != F_LEN:</span><br><span class="line">        ty = getRandomNBitInteger(<span class="number">768</span>)</span><br><span class="line">        <span class="keyword">if</span> gcd(ty,gN) == <span class="number">1</span>:</span><br><span class="line">            gy_list.append(ty)</span><br><span class="line">    <span class="keyword">return</span> gy_list</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line"></span><br><span class="line">    flag = <span class="built_in">bin</span>(bytes_to_long(flag))[<span class="number">2</span>:]</span><br><span class="line">    F_LEN = <span class="built_in">len</span>(flag)</span><br><span class="line">    N, q, p = gen_key()</span><br><span class="line">    x = gen_x(q, p)</span><br><span class="line">    y_list = gen_y(N)</span><br><span class="line">    ciphertext = []</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(F_LEN):</span><br><span class="line">        tc = <span class="built_in">pow</span>(y_list[i],<span class="number">2</span>) * <span class="built_in">pow</span>(x,<span class="built_in">int</span>(flag[i])) % N</span><br><span class="line">        ciphertext.append(tc)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;./output.txt&#x27;</span>,<span class="string">&#x27;w&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        f.write(<span class="built_in">str</span>(N) + <span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(F_LEN):</span><br><span class="line">            f.write(<span class="built_in">str</span>(ciphertext[i]) + <span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>é€šè¿‡ gmc ä¸­çš„æ¬§æ‹‰åˆ¤åˆ«å¼ä¸­åˆ¤æ–­å‡ºæ¥è¯´è¿™é¢˜è€ƒäºŒæ¬¡åŒä½™ï¼Œæ€è·¯æ¸…æ™°ï¼Œä»æ—§æ˜¯åˆ¤æ–­ tc æ˜¯å¦æ˜¯ n çš„äºŒæ¬¡å‰©ä½™ï¼Œç›´æ¥è´´ exp</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">ans = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;output.txt&#x27;</span>,<span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    n = <span class="built_in">int</span>(f.readline())</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> f:</span><br><span class="line">        <span class="keyword">if</span> gmpy2.jacobi(<span class="built_in">int</span>(i),n) == <span class="number">1</span>:</span><br><span class="line">            ans += <span class="string">&#x27;0&#x27;</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            ans += <span class="string">&#x27;1&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(ans,<span class="number">2</span>)))</span><br></pre></td></tr></table></figure><h4 id="0x07-2021geekchallenge-step_by_step-1124"><a class="anchor" href="#0x07-2021geekchallenge-step_by_step-1124">#</a> 0x07 2021Geekchallenge step_by_step 11.24</h4><p>äºŒæ¬¡åŒä½™ï¼Œé™„ä»¶</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getPrime, bytes_to_long, long_to_bytes</span><br><span class="line"><span class="keyword">import</span> gmpy2 <span class="keyword">as</span> gp</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> flag</span><br><span class="line">flag = bytes_to_long(flag)</span><br><span class="line">p = getPrime(<span class="number">100</span>)</span><br><span class="line">q = getPrime(<span class="number">100</span>)</span><br><span class="line">n = p * q</span><br><span class="line">clist = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">bin</span>(flag)[<span class="number">2</span>:]:</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        x = random.randint(<span class="number">1</span>, n)</span><br><span class="line">        <span class="keyword">if</span> gp.gcd(x, n) == <span class="number">1</span>:</span><br><span class="line">            c = (<span class="built_in">pow</span>(<span class="number">3</span>, <span class="built_in">int</span>(i) + x * <span class="number">2</span>, n) * x**<span class="number">2</span>) % n</span><br><span class="line">            clist.append(c)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"><span class="built_in">print</span>(n)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(clist)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">1254676922968308054473282588201432441748387886551758353389559</span></span><br><span class="line"><span class="string">clist...</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><p>æ•´ä¸ªåŠ å¯†ç®—æ³•æ ¸å¿ƒæ— ç–‘æ˜¯ c</p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mo>=</mo><msup><mn>3</mn><mrow><mi>i</mi><mo>+</mo><mn>2</mn><mi>x</mi></mrow></msup><mo>Ã—</mo><msup><mi>x</mi><mn>2</mn></msup><mspace></mspace><mspace width="0.4444444444444444em"><mo stretchy="false">(</mo><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mspace width="0.3333333333333333em"><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">c=3^{i+2x} Ã— x^{2} \pmod n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord mathnormal">c</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.907994em;vertical-align:-.08333em"></span><span class="mord"><span class="mord">3</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.824664em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">2</span><span class="mord mathnormal mtight">x</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.8141079999999999em;vertical-align:0"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:.4444444444444444em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:.3333333333333333em"></span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span> (i ä¸º 0 æˆ– 1)</p><p>æ­¤é¢˜ä»…éœ€åˆ¤æ–­ c æ˜¯å¦æ˜¯ n çš„äºŒæ¬¡å‰©ä½™ï¼Œç”¨é›…å¯æ¯”ç¬¦å·å°±å¥½äº†ã€‚</p><p>å…³äºé›…å¯æ¯”ç¬¦å·ï¼Œå®ƒå…¶å®æ˜¯å‹’è®©å¾·ç¬¦å·çš„æ¨å¹¿ï¼Œå…·ä½“çš„æ±‚æ³•ä¸å±•å¼€ç»†è¯´ç½‘ä¸Šçš„æ•™ç¨‹æŒºå¤šçš„ã€‚æ±‚é›…å¯æ¯”ç¬¦å·ä¹Ÿå¯ä»¥ç”¨ gmpy2 é‡Œçš„åº“æ±‚ã€‚è¿™é‡Œæœ€æ ¸å¿ƒå°±æ˜¯åˆ¤æ–­ï¼Œå…·ä½“å¦‚ä¸‹</p><p>è‹¥ i=0ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mo>=</mo><mo stretchy="false">(</mo><msup><mn>3</mn><mi>x</mi></msup><mo>Ã—</mo><mi>x</mi><msup><mo stretchy="false">)</mo><mn>2</mn></msup><mspace></mspace><mspace width="0.4444444444444444em"><mo stretchy="false">(</mo><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mspace width="0.3333333333333333em"><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">c=(3^{x}Ã—x)^{2}\pmod n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord mathnormal">c</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord"><span class="mord">3</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.664392em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-.25em"></span><span class="mord mathnormal">x</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:.4444444444444444em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:.3333333333333333em"></span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span>ã€‚å³ c ä¸ºäºŒæ¬¡å‰©ä½™ï¼Œé›…å¯æ¯”ç¬¦å·ä¸º 1<br>è‹¥ i=1ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mo>=</mo><msup><mn>3</mn><mrow><mn>1</mn><mo>+</mo><mn>2</mn><mi>x</mi></mrow></msup><mo>Ã—</mo><msup><mi>x</mi><mn>2</mn></msup><mspace></mspace><mspace width="0.4444444444444444em"><mo stretchy="false">(</mo><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mspace width="0.3333333333333333em"><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">c=3^{1+2x} Ã— x^{2} \pmod n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord mathnormal">c</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.897438em;vertical-align:-.08333em"></span><span class="mord"><span class="mord">3</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mbin mtight">+</span><span class="mord mtight">2</span><span class="mord mathnormal mtight">x</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.8141079999999999em;vertical-align:0"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:.4444444444444444em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:.3333333333333333em"></span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span>ã€‚2x+1 ä¸ºå¥‡æ•°ï¼Œc ä¸ºéäºŒæ¬¡å‰©ä½™ï¼Œé›…å¯æ¯”ç¬¦å·ä¸º 0</p><p>çŸ¥é“äº†è¿™ä¸ªä¹‹åè¿™é¢˜æ€è·¯å°±å¾ˆæ¸…æ™°äº†ï¼Œç›´æ¥ä¸Š exp</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">n = <span class="number">1254676922968308054473282588201432441748387886551758353389559</span></span><br><span class="line">c = [<span class="number">112490766735794793494258589897687977797993914062877995369853</span>, <span class="number">423825989606899409733986824741778284626898537704684650054048</span>, <span class="number">1239912440099782777043012567198356769914426423982980091061342</span>, <span class="number">1078272043845620437375344423460688188703277391763226546180151</span>, <span class="number">159286594418951337823608883690981934876156746053051292254402</span>, <span class="number">189434397083734065502133592439774066008070864031834709620441</span>, <span class="number">264105932521685455831442874483122006851812174082486446496525</span>, <span class="number">252479590298382195780257510632414277760400686563367629394825</span>, <span class="number">34602153293813328946647556336715300088648653636913843351330</span>, <span class="number">808692976248223555967993480457680585654329233137701900525232</span>, <span class="number">836623390705731389723338030121423143060093415003999783847569</span>, <span class="number">1218829648463542488706300570862499177531816513847669694517865</span>, <span class="number">571795296699927140597629733281737316938588378300113684751321</span>, <span class="number">324408602401500017634991400429058861929441907523133040616718</span>, <span class="number">652309276856121062936275131393396513436481452168222192943617</span>, <span class="number">135368324264829776566203256490111602190045577103623626459391</span>, <span class="number">677807894471260530035795635544578014296111908610448488780236</span>, <span class="number">1135708831589387209825610411788217272141435421502826225558333</span>, <span class="number">196882176169680492388044653063809988445336200851553236565493</span>, <span class="number">1130705847039352086713022625138307016610235729598245321418537</span>, <span class="number">974627899979016730650505688458957247745733629797568884460037</span>, <span class="number">948987355716018600108888773982169186615279073844787201014331</span>, <span class="number">364200727831752453880724784142441918092136276002472196567297</span>, <span class="number">811786724825671349602848333002825903390189436235744947667153</span>, <span class="number">248544601758659627780643527412918707686666534454807514221527</span>, <span class="number">1078860601713092925823762998344218082511712606733279204236487</span>, <span class="number">634851505432770176888905188832078431577879067601938324607512</span>, <span class="number">232972021265122845242665536151391828176473610240017058444456</span>, <span class="number">1080796896535347345799923528377657622102130648424673730618155</span>, <span class="number">622059452832122796944248249707923610120342427983134655552340</span>, <span class="number">837257289852652447556360719449396492271622453092839975184158</span>, <span class="number">626327369687614106133688347844033161113612134573404258486630</span>, <span class="number">1233019194503373412608053469954621323121044455057773900406773</span>, <span class="number">912564467902216938034173803480737819092198560216579817988291</span>, <span class="number">408076399689155479697691914877522087726703540593136498587215</span>, <span class="number">1118745562641959211267518507476218888452509349041078337285098</span>, <span class="number">1103228775032586830415033772993541541820163005491285279882940</span>, <span class="number">680899077364553221002722115625274809744677788062477442312086</span>, <span class="number">355349436487753936000721704075588637048102593449252106813298</span>, <span class="number">5254361838244723184679801326407268664182654715017847086461</span>, <span class="number">480145671282471097574354032682584083826945502763658946101104</span>, <span class="number">249136810947175342894562520096603076879372702701088690594445</span>, <span class="number">175216547555975039599856545426098941943382367602172941744494</span>, <span class="number">436310864447848960706296122266108102033486860525693191197797</span>, <span class="number">342620466614509535208918527767209905005823047382938223113086</span>, <span class="number">369848992268737575958936185907214270590887322936419642815242</span>, <span class="number">278575045025661827978388874494219837629182438978526195181637</span>, <span class="number">1189171180780533071473125545247289861677955100195126109964590</span>, <span class="number">256190182678715266654387215899616014762531664768736561586327</span>, <span class="number">719160215933023695898776016718481385742508618676368640641809</span>, <span class="number">147033122794177086112261858085593706727904275426698884436011</span>, <span class="number">247466503394960387825735598976068779045757078494832316444804</span>, <span class="number">787155643450160361724955357286670519256662665704845721250609</span>, <span class="number">112101120505278148126370035869523081506090979629681063614381</span>, <span class="number">890009544685851814191758439205974159586245412054287515881584</span>, <span class="number">1168625756997945588141764967298286550498540363325170551587334</span>, <span class="number">946031342434770434479581499217378781992921204179509449159996</span>, <span class="number">759124753621557368233069144948668001126536400499520990700641</span>, <span class="number">930584421635842804698880452391670787414151645249729141739148</span>, <span class="number">140981825203074314092967178062754008486703246602401550271041</span>, <span class="number">880126454149733441805446179826584472107299085899567279467558</span>, <span class="number">510129631452465708304688340114214360026947205003705062663759</span>, <span class="number">857274757020001316639221394675820731579775247610619594760511</span>, <span class="number">444486969413575687285961819261097401974268741167841964919716</span>, <span class="number">645830958128126799221416466698967430939726760487764050203821</span>, <span class="number">128864469762235652994228226148325614187747349331618451490354</span>, <span class="number">732913002124581119538173953534485652651112140400076340646452</span>, <span class="number">1245672039639609341331477592944058028011275464117654972595670</span>, <span class="number">1160765030758624190775369713232721901616189349905945190302338</span>, <span class="number">745734132091942990384796294800038299023052878196943617322617</span>, <span class="number">34973161572808799782240527358912894045293050940490682156733</span>, <span class="number">507586651070816931641904112686082840821460472219390068396982</span>, <span class="number">359195216122538975934588740641220005777478961423841727365432</span>, <span class="number">60506687352654743312206686911057762445232526009857863834444</span>, <span class="number">402036521271253699065227780662896890228371046068283711170220</span>, <span class="number">465427226677337673103293964961886503610313835775181975449721</span>, <span class="number">925246962888172144515172444374190859841851825972285013006527</span>, <span class="number">542176614893876361668218387162168517498644799220587472896002</span>, <span class="number">852215132196560596695876248813488364201491362280912035912061</span>, <span class="number">945548964927065532651141821562204387565145712002346337639711</span>, <span class="number">736943822066388892909878515650831955490636214039062998720510</span>, <span class="number">766357526983761241394182000478355475617711906398422036954152</span>, <span class="number">77156525593382594092608158744099524034892127423492520631820</span>, <span class="number">562562817542804973601572838378263130638457829485887327130286</span>, <span class="number">768093992370198202822524520006977816845162154854939167515517</span>, <span class="number">1099957424762490943973557935337350760135180754563993547358098</span>, <span class="number">698816668614997174913438496891169625976027534942525487303513</span>, <span class="number">417641699919584202170293946436276552973997395211792288687960</span>, <span class="number">1006229610175567855209117721408416419896921240126676949824724</span>, <span class="number">4206431689326446028142220658552064336105749936096602165359</span>, <span class="number">893846509909828693967573302731018066461118006150050253703744</span>, <span class="number">878425189026235350891203121924637130803808920422558040493294</span>, <span class="number">730047416245095988472212050949689633327186823542036387345181</span>, <span class="number">648095719945750715387983948406690533087473721929975873848169</span>, <span class="number">213513454359755001454814601053555627585345770061082141021326</span>, <span class="number">350001050012957205656929492039628823072469208940960439158263</span>, <span class="number">1016858635000037892730835311903706149371704230428070443107320</span>, <span class="number">1040987439471207869975679257301693610464700899302787643642354</span>, <span class="number">1194690615352550474729309715449838057220521596135246725909553</span>, <span class="number">508165053077110820797186371383859674371399129952105597675096</span>, <span class="number">266494438294281492504556232035584920066331725618646155019547</span>, <span class="number">28469482072427012244441092412738741355431846649166066368980</span>, <span class="number">790175775999108776289865518368056397969387298334297622465909</span>, <span class="number">590581138260907253939363764832940322585129285968275409510634</span>, <span class="number">221909012579985462013325803334419731308959816500415305934495</span>, <span class="number">1063780559219791515938747204569742799329237935871594345400252</span>, <span class="number">977747525495509380693721486866821791065499754056415279744653</span>, <span class="number">346306061371595730004513789139807509540063462412619321003626</span>, <span class="number">456103179467597859705969406860196938169100856240100927540401</span>, <span class="number">969300078509189631808517876996065933181606409375207150288464</span>, <span class="number">1029806631220370012120597683927351131622576733031694535189521</span>, <span class="number">344896431603140401163996810922500893279239069499717183710501</span>, <span class="number">430000423804197030568046280589772094106128395099434235915031</span>, <span class="number">700179843567016021775399107572964843751703290591400960796112</span>, <span class="number">961227906080189143689698720420426659986080298413605666115640</span>, <span class="number">607209606799750473714271393200060455739097869884727178692312</span>, <span class="number">106958847163040842225140399905505511449479709017540851084532</span>, <span class="number">953369942103273809257762268859167463617831445026988544378658</span>, <span class="number">428269440686506672744282327102546440435442014650795927162711</span>, <span class="number">56621803434665963032193024056111306570802155743250152849716</span>, <span class="number">800707635631355839166448276143596444307614901816577459076131</span>, <span class="number">1032256515703247765067950588859299047987257001987777631061065</span>, <span class="number">813725055801254665600156259482200403981770576173968929131487</span>, <span class="number">940024839745068011043019236327963504645352520797347949823455</span>, <span class="number">1065005324140908547287467504568283884363143527586278243210801</span>, <span class="number">1087828777506290663525994551834233065465427418753806182842291</span>, <span class="number">668387132001968449612224853010931354244797738682007519611989</span>, <span class="number">563185246196177998134932666270526715161378776103340983046580</span>, <span class="number">148292872313931508344196679476720973752571125303712466045656</span>, <span class="number">413889563851226543249984374872220761253120628252088546262699</span>, <span class="number">853542105910386365929770611480736086723126396438880650918917</span>, <span class="number">59730458840715910492468261806200793684923819793480597554146</span>, <span class="number">792260492800286127199649276659137441324248689470594987965190</span>, <span class="number">753608630500639136668081531883097047491651258191552267413126</span>, <span class="number">33514911499472634865669915075769163328171019557849259474018</span>, <span class="number">634963859228206842307837566519244534650818456901841184879977</span>, <span class="number">219354096455968590219445072777282329948785844491217770978344</span>, <span class="number">1123377226439583158729762969668999276741275445803396272436031</span>, <span class="number">357765295513680388973981712560200525235334734759663454993805</span>, <span class="number">385868499980630535766019957877752149506518574529845752144666</span>, <span class="number">138578212294299392480319417966870656714476525885983752756188</span>, <span class="number">1110526796192425688386237355263892073046060477008920073455044</span>, <span class="number">244699783645221387947312903861559688207612147588246639081699</span>, <span class="number">583209905862562678600202085212425597809036630416117298854978</span>, <span class="number">1207854793808762194414317661151529169444903662139065050090746</span>, <span class="number">1127506983223466275821900811940356395242309493951089427884032</span>, <span class="number">526185119576631048584313761548704536031634598332129570964689</span>, <span class="number">266882032196696984660521486449809902101615921156569537960109</span>, <span class="number">1188118705564450461919200724390473040524626320052324478509883</span>, <span class="number">682831747455078454647149830819696088960233603851250102828667</span>, <span class="number">669419928942561433130809268138650695825596612075801278942980</span>, <span class="number">1077750630919867687880983437504767304166615787212813240073843</span>, <span class="number">486023540111308483450127320955599047045479654684477043315645</span>, <span class="number">409429366346146233850088863324915025465847596238000661872172</span>, <span class="number">779883595226131237594759409249289551033410304517183865388408</span>, <span class="number">1155872225708857920911178110668279174877878422508206228579940</span>, <span class="number">411063490066038942009369947241345843238439795078686488373864</span>, <span class="number">1243453053541946030699872676712518536022061850799945414120045</span>, <span class="number">871711034820169700581685353768658469631429266493677466057997</span>, <span class="number">601920686459160120670719526703980120744719013393032353678765</span>, <span class="number">329932100141177850249406090412821976994089707958551194468769</span>, <span class="number">558327299751202100333335353826111016492585371503632197870640</span>, <span class="number">113444032302978611299580451314055133491399096282744687816086</span>, <span class="number">152525914892717139057165748051966776217223953242540511499945</span>, <span class="number">965404850400527912039904270871065001313018148780552532312669</span>, <span class="number">313557099445185696402013375071955475516203519824979749629786</span>, <span class="number">952254159335810337756614972813240144837526566801182319987154</span>]</span><br><span class="line">ans = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> c:</span><br><span class="line">    <span class="keyword">if</span> gmpy2.jacobi(i,n) == <span class="number">1</span>:</span><br><span class="line">        ans += <span class="string">&#x27;0&#x27;</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        ans += <span class="string">&#x27;1&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(ans,<span class="number">2</span>)))</span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="0x06-2021æ¹–æ¹˜æ¯-signin-1123"><a class="anchor" href="#0x06-2021æ¹–æ¹˜æ¯-signin-1123">#</a> 0x06 2021 æ¹–æ¹˜æ¯ signin 11.23</h4><p>è¿™é¢˜è¢«ç§’æˆç­¾åˆ°äº†ã€‚</p><p>è´´ä¸ªé™„ä»¶</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line">m1 = bytes_to_long(flag[:<span class="built_in">len</span>(flag) // <span class="number">2</span>])</span><br><span class="line">m2 = bytes_to_long(flag[<span class="built_in">len</span>(flag) // <span class="number">2</span>:])</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gen</span>(<span class="params">pbits, qbits</span>):</span><br><span class="line">    p1, q1 = getPrime(pbits), getPrime(qbits)</span><br><span class="line">    n1 = p1**<span class="number">4</span>*q1</span><br><span class="line">    q2 = getPrime(qbits)</span><br><span class="line">    bound = p1 // (<span class="number">8</span>*q1*q2) + <span class="number">1</span></span><br><span class="line">    p2 = random.randrange(p1, p1 + bound)</span><br><span class="line">    <span class="keyword">while</span> <span class="keyword">not</span> isPrime(p2):</span><br><span class="line">        p2 = random.randrange(p1, p1 + bound)</span><br><span class="line">    n2 = p2**<span class="number">4</span>*q2</span><br><span class="line">    <span class="keyword">return</span> (n1, n2), (p1, q1), (p2, q2)</span><br><span class="line"></span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line">pbits = <span class="built_in">int</span>(<span class="number">360</span>)</span><br><span class="line">qbits = <span class="built_in">int</span>(<span class="number">128</span>)</span><br><span class="line">pk, sk1, sk2 = gen(pbits, qbits)</span><br><span class="line">c1 = <span class="built_in">pow</span>(m1, e, pk[<span class="number">0</span>])</span><br><span class="line">c2 = <span class="built_in">pow</span>(m2, e, pk[<span class="number">1</span>])</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;pk = <span class="subst">&#123;pk&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;c1, c2 = <span class="subst">&#123;c1, c2&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">pk = (1150398070565459492080597718626032792435556703413923483458704675295997646493249759818468321328556510074044954676615760446708253531839417036997811506222349194302791943489195718713797322878586379546657275419261647635859989280700191441312691274285176619391539387875252135478424580680264554294179123254566796890998243909286508189826458854346825493157697201495100628216832191035903848391447704849808577310612723700318670466035077202673373956324725108350230357879374234418393233, 1242678737076048096780023147702514112272319497423818488193557934695583793070332178723043194823444815153743889740338870676093799728875725651036060313223096288606947708155579060628807516053981975820338028456770109640111153719903207363617099371353910243497871090334898522942934052035102902892149792570965804205461900841595290667647854346905445201396273291648968142608158533514391348407631818144116768794595226974831093526512117505486679153727123796834305088741279455621586989)</span></span><br><span class="line"><span class="string">c1, c2 = (361624030197288323178211941746074961985876772079713896964822566468795093475887773853629454653096485450671233584616088768705417987527877166166213574572987732852155320225332020636386698169212072312758052524652761304795529199864805108000796457423822443871436659548626629448170698048984709740274043050729249408577243328282313593461300703078854044587993248807613713896590402657788194264718603549894361488507629356532718775278399264279359256975688280723740017979438505001819438, 33322989148902718763644384246610630825314206644879155585369541624158380990667828419255828083639294898100922608833810585530801931417726134558845725168047585271855248605561256531342703212030641555260907310067120102069499927711242804407691706542428236208695153618955781372741765233319988193384708525251620506966304554054884590718068210659709406626033891748214407992041364462525367373648910810036622684929049996166651416565651803952838857960054689875755131784246099270581394)</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><mi>N</mi><mn>1</mn></mrow><mrow><mi>N</mi><mn>2</mn></mrow></mfrac></mrow><annotation encoding="application/x-tex">\frac{N1}{N2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.217331em;vertical-align:-.345em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.872331em"><span style="top:-2.6550000000000002em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:.10903em">N</span><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.394em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:.10903em">N</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:.345em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span> çš„è¿åˆ†æ•°å±•å¼€æ˜¯å¯¹<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><mi>q</mi><mn>1</mn></mrow><mrow><mi>q</mi><mn>2</mn></mrow></mfrac></mrow><annotation encoding="application/x-tex">\frac{q1}{q2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.378324em;vertical-align:-.481108em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.897216em"><span style="top:-2.6550000000000002em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:.03588em">q</span><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.446108em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:.03588em">q</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:.481108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span> çš„ä¸€ä¸ªé€¼è¿‘</p><p>å‚è€ƒå‰é¢˜ï¼Œç›´æ¥è´´ exp:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">continuedFra</span>(<span class="params">x,y</span>):</span><br><span class="line">    cf = []</span><br><span class="line">    <span class="keyword">while</span> y != <span class="number">0</span>:</span><br><span class="line">        cf.append(x // y)</span><br><span class="line">        x,y = y,x % y</span><br><span class="line">    <span class="keyword">return</span> cf</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">exp</span>(<span class="params">x,y</span>):</span><br><span class="line">    cf = continuedFra(x,y)</span><br><span class="line">    fz = [cf[<span class="number">0</span>],cf[<span class="number">0</span>] * cf[<span class="number">1</span>] + <span class="number">1</span>]</span><br><span class="line">    fm = [<span class="number">1</span>,cf[<span class="number">1</span>]]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>,<span class="built_in">len</span>(cf)):</span><br><span class="line">        z = fz[i - <span class="number">1</span>] * cf[i] + fz[i - <span class="number">2</span>]</span><br><span class="line">        m = fm[i - <span class="number">1</span>] * cf[i] + fm[i - <span class="number">2</span>]</span><br><span class="line">        fz.append(z)</span><br><span class="line">        fm.append(m)</span><br><span class="line">    <span class="keyword">return</span> fz,fm</span><br><span class="line"></span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line">c1 = <span class="number">361624030197288323178211941746074961985876772079713896964822566468795093475887773853629454653096485450671233584616088768705417987527877166166213574572987732852155320225332020636386698169212072312758052524652761304795529199864805108000796457423822443871436659548626629448170698048984709740274043050729249408577243328282313593461300703078854044587993248807613713896590402657788194264718603549894361488507629356532718775278399264279359256975688280723740017979438505001819438</span></span><br><span class="line">c2 = <span class="number">33322989148902718763644384246610630825314206644879155585369541624158380990667828419255828083639294898100922608833810585530801931417726134558845725168047585271855248605561256531342703212030641555260907310067120102069499927711242804407691706542428236208695153618955781372741765233319988193384708525251620506966304554054884590718068210659709406626033891748214407992041364462525367373648910810036622684929049996166651416565651803952838857960054689875755131784246099270581394</span></span><br><span class="line">n1 = <span class="number">1150398070565459492080597718626032792435556703413923483458704675295997646493249759818468321328556510074044954676615760446708253531839417036997811506222349194302791943489195718713797322878586379546657275419261647635859989280700191441312691274285176619391539387875252135478424580680264554294179123254566796890998243909286508189826458854346825493157697201495100628216832191035903848391447704849808577310612723700318670466035077202673373956324725108350230357879374234418393233</span></span><br><span class="line">n2 = <span class="number">1242678737076048096780023147702514112272319497423818488193557934695583793070332178723043194823444815153743889740338870676093799728875725651036060313223096288606947708155579060628807516053981975820338028456770109640111153719903207363617099371353910243497871090334898522942934052035102902892149792570965804205461900841595290667647854346905445201396273291648968142608158533514391348407631818144116768794595226974831093526512117505486679153727123796834305088741279455621586989</span></span><br><span class="line">_q1,_q2 = exp(n1,n2)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>,<span class="built_in">len</span>(_q1)):</span><br><span class="line">    q1,q2 = _q1[i],_q2[i]</span><br><span class="line">    <span class="keyword">if</span> n1 % q1 == <span class="number">0</span> <span class="keyword">and</span> n2 % q2 == <span class="number">0</span> <span class="keyword">and</span> n1 != q1 <span class="keyword">and</span> n2 != q2:</span><br><span class="line">        <span class="built_in">print</span>(q1,q2)</span><br><span class="line">q1 = <span class="number">181856133933383097933223133658050179553</span></span><br><span class="line">q2 = <span class="number">196443958511498599913330690975430421229</span></span><br><span class="line">p1 = gmpy2.iroot(n1 // q1,<span class="number">4</span>)[<span class="number">0</span>]</span><br><span class="line">p2 = gmpy2.iroot(n2 // q2,<span class="number">4</span>)[<span class="number">0</span>]</span><br><span class="line">phi1 = p1 ** <span class="number">3</span> * (p1 - <span class="number">1</span>) * (q1 - <span class="number">1</span>)</span><br><span class="line">phi2 = p2 ** <span class="number">3</span> * (p2 - <span class="number">1</span>) * (q2 - <span class="number">1</span>)</span><br><span class="line">d1 = gmpy2.invert(e,phi1)</span><br><span class="line">d2 = gmpy2.invert(e,phi2)</span><br><span class="line">m1 = <span class="built_in">pow</span>(c1,d1,n1)</span><br><span class="line">m2 = <span class="built_in">pow</span>(c2,d2,n2)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m1) + long_to_bytes(m2))</span><br></pre></td></tr></table></figure><h4 id="0x05-2020ç¾ŠåŸæ¯-rrrrrrrsa-1123"><a class="anchor" href="#0x05-2020ç¾ŠåŸæ¯-rrrrrrrsa-1123">#</a> 0x05 2020 ç¾ŠåŸæ¯ RRRRRRRSA 11.23</h4><p>æ‰“å®Œè¥¿æ¹–è®ºå‰‘ä¹‹åä¸€ç›´è¢«å­¦æ ¡çš„è¯¾é¢˜ç‰µç€ï¼Œå…¶å®ä¹Ÿæ˜¯ä¹‹å‰çš„å€ºã€‚</p><p>è¿åˆ†æ•°ï¼Œå…ˆè´´ä¸€ä¸ªé™„ä»¶å›¾</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> sympy</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&#x27;GWHT&#123;************&#125;&#x27;</span></span><br><span class="line"></span><br><span class="line">flag1 = flag[:<span class="number">19</span>].encode()</span><br><span class="line">flag2 = flag[<span class="number">19</span>:].encode()</span><br><span class="line"><span class="keyword">assert</span>(<span class="built_in">len</span>(flag) == <span class="number">38</span>)</span><br><span class="line"></span><br><span class="line">P1 = getPrime(<span class="number">1038</span>)</span><br><span class="line">P2 = sympy.nextprime(P1)</span><br><span class="line"><span class="keyword">assert</span>(P2 - P1 &lt; <span class="number">1000</span>)</span><br><span class="line"></span><br><span class="line">Q1 = getPrime(<span class="number">512</span>)</span><br><span class="line">Q2 = sympy.nextprime(Q1)</span><br><span class="line"></span><br><span class="line">N1 = P1 * P1 * Q1</span><br><span class="line">N2 = P2 * P2 * Q2</span><br><span class="line"></span><br><span class="line">E1 = getPrime(<span class="number">1024</span>)</span><br><span class="line">E2 = sympy.nextprime(E1)</span><br><span class="line"></span><br><span class="line">m1 = bytes_to_long(flag1)</span><br><span class="line">m2 = bytes_to_long(flag2)</span><br><span class="line"></span><br><span class="line">c1 = <span class="built_in">pow</span>(m1, E1, N1)</span><br><span class="line">c2 = <span class="built_in">pow</span>(m2, E2, N2)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">output = <span class="built_in">open</span>(<span class="string">&#x27;secret&#x27;</span>, <span class="string">&#x27;w&#x27;</span>)</span><br><span class="line">output.write(<span class="string">&#x27;N1=&#x27;</span> + <span class="built_in">str</span>(N1) + <span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">output.write(<span class="string">&#x27;c1=&#x27;</span> + <span class="built_in">str</span>(c1) + <span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">output.write(<span class="string">&#x27;E1=&#x27;</span> + <span class="built_in">str</span>(E1) + <span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">output.write(<span class="string">&#x27;N2=&#x27;</span> + <span class="built_in">str</span>(N2) + <span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">output.write(<span class="string">&#x27;c2=&#x27;</span> + <span class="built_in">str</span>(c2) + <span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">output.write(<span class="string">&#x27;E2=&#x27;</span> + <span class="built_in">str</span>(E2) + <span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">output.close()</span><br></pre></td></tr></table></figure><p>è¿™é‡Œéœ€è¦ç”¨ä¸€ä¸ªå®šç†</p><p><strong>è‹¥<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>âˆˆ</mo><mi>R</mi><mo>+</mo></mrow><annotation encoding="application/x-tex">x \in R+</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.5782em;vertical-align:-.0391em"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">âˆˆ</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.76666em;vertical-align:-.08333em"></span><span class="mord mathnormal" style="margin-right:.00773em">R</span><span class="mord">+</span></span></span></span>ï¼Œé‚£ä¹ˆåœ¨ x çš„è¿åˆ†æ•°å±•å¼€é€¼è¿‘å¼ä¸­ï¼Œè‹¥æœ‰<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">âˆ£</mi><mi>x</mi><mo>âˆ’</mo><mfrac><mi>b</mi><mi>c</mi></mfrac><mi mathvariant="normal">âˆ£</mi><mo>&lt;</mo><mfrac><mn>1</mn><mrow><mn>2</mn><msup><mi>c</mi><mn>2</mn></msup></mrow></mfrac></mrow><annotation encoding="application/x-tex">|x-\frac{b}{c}|&lt;\frac{1}{2c^{2}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord">âˆ£</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.2251079999999999em;vertical-align:-.345em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.8801079999999999em"><span style="top:-2.6550000000000002em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.394em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">b</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:.345em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord">âˆ£</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.190108em;vertical-align:-.345em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.845108em"><span style="top:-2.6550000000000002em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight"><span class="mord mathnormal mtight">c</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.7463142857142857em"><span style="top:-2.786em;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.394em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:.345em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span>, å…¶ä¸­ gcd (b,c)==1ï¼Œåˆ™å¯ä»¥è®¤ä¸º<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mi>b</mi><mi>c</mi></mfrac></mrow><annotation encoding="application/x-tex">\frac{b}{c}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2251079999999999em;vertical-align:-.345em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.8801079999999999em"><span style="top:-2.6550000000000002em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.394em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">b</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:.345em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span> æ˜¯ x è¿åˆ†æ•°å±•å¼€å¼ä¸­çš„ä¸€é¡¹ã€‚</strong></p><p>p1 ä¸ p2 ä¹‹é—´ï¼Œq1 ä¸ q2 ä¹‹é—´ç›¸å·®çš„å€¼éƒ½éå¸¸çš„å°ï¼Œe éå¸¸çš„å¤§ï¼Œflag çš„ä¸¤æ®µåŠ å¯†æ˜¯ç®—æ³•çš„ä¸€æ ·çš„ã€‚n ä¸å¹³å¸¸çš„ä¸åŒï¼Œæ­¤é¢˜çš„ n æ˜¯<br><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>=</mo><msup><mi>p</mi><mn>2</mn></msup><mo>Ã—</mo><mi>q</mi></mrow><annotation encoding="application/x-tex">n=p^{2}Ã—q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.008548em;vertical-align:-.19444em"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.625em;vertical-align:-.19444em"></span><span class="mord mathnormal" style="margin-right:.03588em">q</span></span></span></span><br>æˆ‘ä»¬å¯ä»¥æ„é€ å¼å­<br><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>q</mi><mn>1</mn><mo>Ã—</mo><mi>N</mi><mn>2</mn><mo>âˆ’</mo><mi>q</mi><mn>2</mn><mo>Ã—</mo><mi>N</mi><mn>1</mn><mo>=</mo><mi>q</mi><mn>1</mn><mo>Ã—</mo><mi>q</mi><mn>2</mn><mo>Ã—</mo><mo stretchy="false">(</mo><mi>p</mi><msup><mn>2</mn><mn>2</mn></msup><mo>âˆ’</mo><mi>p</mi><msup><mn>1</mn><mn>2</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">q1Ã—N2-q2Ã—N1=q1Ã—q2Ã—(p2^{2}-p1^{2})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8388800000000001em;vertical-align:-.19444em"></span><span class="mord mathnormal" style="margin-right:.03588em">q</span><span class="mord">1</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.76666em;vertical-align:-.08333em"></span><span class="mord mathnormal" style="margin-right:.10903em">N</span><span class="mord">2</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.8388800000000001em;vertical-align:-.19444em"></span><span class="mord mathnormal" style="margin-right:.03588em">q</span><span class="mord">2</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.68333em;vertical-align:0"></span><span class="mord mathnormal" style="margin-right:.10903em">N</span><span class="mord">1</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.8388800000000001em;vertical-align:-.19444em"></span><span class="mord mathnormal" style="margin-right:.03588em">q</span><span class="mord">1</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.8388800000000001em;vertical-align:-.19444em"></span><span class="mord mathnormal" style="margin-right:.03588em">q</span><span class="mord">2</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord mathnormal">p</span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-.25em"></span><span class="mord mathnormal">p</span><span class="mord"><span class="mord">1</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><br>æœ€åç»è¿‡åŒ–ç®€æ¨å¯¼å¯ä»¥å¾—åˆ°<br><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">âˆ£</mi><mfrac><mrow><mi>N</mi><mn>1</mn></mrow><mrow><mi>N</mi><mn>2</mn></mrow></mfrac><mo>âˆ’</mo><mfrac><mrow><mi>q</mi><mn>1</mn></mrow><mrow><mi>q</mi><mn>2</mn></mrow></mfrac><mi mathvariant="normal">âˆ£</mi><mo>=</mo><mfrac><mrow><mi>q</mi><mn>1</mn><mo>Ã—</mo><mi>q</mi><mn>2</mn><mo>Ã—</mo><mo stretchy="false">(</mo><mi>p</mi><msup><mn>2</mn><mn>2</mn></msup><mo>âˆ’</mo><mi>p</mi><msup><mn>1</mn><mn>2</mn></msup><mo stretchy="false">)</mo></mrow><mrow><mi>p</mi><msup><mn>2</mn><mn>2</mn></msup><mo>Ã—</mo><mi>q</mi><msup><mn>2</mn><mn>2</mn></msup></mrow></mfrac></mrow><annotation encoding="application/x-tex">|\frac{N1}{N2}-\frac{q1}{q2}|=\frac{q1Ã—q2Ã—(p2^{2}-p1^{2})}{p2^{2}Ã—q2^{2}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.217331em;vertical-align:-.345em"></span><span class="mord">âˆ£</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.872331em"><span style="top:-2.6550000000000002em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:.10903em">N</span><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.394em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:.10903em">N</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:.345em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.378324em;vertical-align:-.481108em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.897216em"><span style="top:-2.6550000000000002em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:.03588em">q</span><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.446108em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:.03588em">q</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:.481108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord">âˆ£</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.5900279999999998em;vertical-align:-.481108em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.10892em"><span style="top:-2.6550000000000002em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span><span class="mord mtight"><span class="mord mtight">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.7463142857142857em"><span style="top:-2.786em;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mbin mtight">Ã—</span><span class="mord mathnormal mtight" style="margin-right:.03588em">q</span><span class="mord mtight"><span class="mord mtight">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.7463142857142857em"><span style="top:-2.786em;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.485em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:.03588em">q</span><span class="mord mtight">1</span><span class="mbin mtight">Ã—</span><span class="mord mathnormal mtight" style="margin-right:.03588em">q</span><span class="mord mtight">2</span><span class="mbin mtight">Ã—</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">p</span><span class="mord mtight"><span class="mord mtight">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8913142857142857em"><span style="top:-2.931em;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mbin mtight">âˆ’</span><span class="mord mathnormal mtight">p</span><span class="mord mtight"><span class="mord mtight">1</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8913142857142857em"><span style="top:-2.931em;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:.481108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span><br>è‡³æ­¤ï¼Œéœ€è¦è¯æ˜<br><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><mi>q</mi><mn>1</mn><mo>Ã—</mo><mi>q</mi><mn>2</mn><mo>Ã—</mo><mo stretchy="false">(</mo><mi>p</mi><msup><mn>2</mn><mn>2</mn></msup><mo>âˆ’</mo><mi>p</mi><msup><mn>1</mn><mn>2</mn></msup><mo stretchy="false">)</mo></mrow><mrow><mi>p</mi><msup><mn>2</mn><mn>2</mn></msup><mo>Ã—</mo><mi>q</mi><msup><mn>2</mn><mn>2</mn></msup></mrow></mfrac><mo>&lt;</mo><mfrac><mn>1</mn><mrow><mn>2</mn><mi>q</mi><msup><mn>2</mn><mn>2</mn></msup></mrow></mfrac></mrow><annotation encoding="application/x-tex">\frac{q1Ã—q2Ã—(p2^{2}-p1^{2})}{p2^{2}Ã—q2^{2}}&lt;\frac{1}{2q2^{2}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.5900279999999998em;vertical-align:-.481108em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.10892em"><span style="top:-2.6550000000000002em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span><span class="mord mtight"><span class="mord mtight">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.7463142857142857em"><span style="top:-2.786em;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mbin mtight">Ã—</span><span class="mord mathnormal mtight" style="margin-right:.03588em">q</span><span class="mord mtight"><span class="mord mtight">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.7463142857142857em"><span style="top:-2.786em;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.485em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:.03588em">q</span><span class="mord mtight">1</span><span class="mbin mtight">Ã—</span><span class="mord mathnormal mtight" style="margin-right:.03588em">q</span><span class="mord mtight">2</span><span class="mbin mtight">Ã—</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">p</span><span class="mord mtight"><span class="mord mtight">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8913142857142857em"><span style="top:-2.931em;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mbin mtight">âˆ’</span><span class="mord mathnormal mtight">p</span><span class="mord mtight"><span class="mord mtight">1</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8913142857142857em"><span style="top:-2.931em;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:.481108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.326216em;vertical-align:-.481108em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.845108em"><span style="top:-2.6550000000000002em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mathnormal mtight" style="margin-right:.03588em">q</span><span class="mord mtight"><span class="mord mtight">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.7463142857142857em"><span style="top:-2.786em;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.394em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:.481108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span> æ˜ å°„åˆ°å…¬å¼ä¸­å°±æ˜¯ (c=q2)</p><p>è¯æ˜è¿‡ç¨‹çœç•¥ï¼Œç»“è®ºå°±å¯çŸ¥<br><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><mi>N</mi><mn>1</mn></mrow><mrow><mi>N</mi><mn>2</mn></mrow></mfrac></mrow><annotation encoding="application/x-tex">\frac{N1}{N2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.217331em;vertical-align:-.345em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.872331em"><span style="top:-2.6550000000000002em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:.10903em">N</span><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.394em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:.10903em">N</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:.345em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span> çš„è¿åˆ†æ•°å±•å¼€å¼ä¸­ä¸€é¡¹ä¸º<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><mi>q</mi><mn>1</mn></mrow><mrow><mi>q</mi><mn>2</mn></mrow></mfrac></mrow><annotation encoding="application/x-tex">\frac{q1}{q2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.378324em;vertical-align:-.481108em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.897216em"><span style="top:-2.6550000000000002em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:.03588em">q</span><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.446108em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:.03588em">q</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:.481108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span><br>è¿åˆ†æ•°çš„å±•å¼€å¼è®¡ç®—æœ‰é€’æ¨å…¬å¼</p><p>è¿åˆ†æ•°<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><msub><mi>p</mi><mi>k</mi></msub><msub><mi>q</mi><mi>k</mi></msub></mfrac></mrow><annotation encoding="application/x-tex">\frac{p_k}{q_k}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.228608em;vertical-align:-.481108em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.7475em"><span style="top:-2.6550000000000002em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:.03588em">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3448em"><span style="top:-2.3487714285714287em;margin-left:-.03588em;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:.03148em">k</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:.15122857142857138em"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.446108em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3448em"><span style="top:-2.3487714285714287em;margin-left:0;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:.03148em">k</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:.15122857142857138em"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:.481108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span> çš„å±•å¼€å¼æ»¡è¶³é€’æ¨å…³ç³»<br><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mi>k</mi></msub><mo>=</mo><msub><mi>a</mi><mi>k</mi></msub><msub><mi>p</mi><mrow><mi>k</mi><mo>âˆ’</mo><mn>1</mn></mrow></msub><mo>+</mo><msub><mi>p</mi><mrow><mi>k</mi><mo>âˆ’</mo><mn>2</mn></mrow></msub></mrow><annotation encoding="application/x-tex">p_{k}=a_{k}p_{k-1}+p_{k-2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.625em;vertical-align:-.19444em"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:.03148em">k</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.791661em;vertical-align:-.208331em"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:.03148em">k</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3361079999999999em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:.03148em">k</span><span class="mbin mtight">âˆ’</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:.208331em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.638891em;vertical-align:-.208331em"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3361079999999999em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:.03148em">k</span><span class="mbin mtight">âˆ’</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:.208331em"><span></span></span></span></span></span></span></span></span></span><br><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>q</mi><mi>k</mi></msub><mo>=</mo><msub><mi>a</mi><mi>k</mi></msub><msub><mi>q</mi><mrow><mi>k</mi><mo>âˆ’</mo><mn>1</mn></mrow></msub><mo>+</mo><msub><mi>q</mi><mrow><mi>k</mi><mo>âˆ’</mo><mn>2</mn></mrow></msub></mrow><annotation encoding="application/x-tex">q_{k}=a_{k}q_{k-1}+q_{k-2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.625em;vertical-align:-.19444em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.03588em">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:.03148em">k</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.791661em;vertical-align:-.208331em"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:.03148em">k</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:.03588em">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3361079999999999em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:.03148em">k</span><span class="mbin mtight">âˆ’</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:.208331em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.638891em;vertical-align:-.208331em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.03588em">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3361079999999999em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:.03148em">k</span><span class="mbin mtight">âˆ’</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:.208331em"><span></span></span></span></span></span></span></span></span></span><br><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">a_{k}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.58056em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:.03148em">k</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span> ä¸ºè¯¥é¡¹è¿åˆ†æ•°å±•å¼€çš„å€¼</p><p>äºæ˜¯å¯ä»¥é€šè¿‡è¿åˆ†æ•°å±•å¼€æ±‚å‡º q1,q2 çš„å€¼ï¼Œå®Œæ•´ exp å¦‚ä¸‹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">n1=<span class="number">60143104944034567859993561862949071559877219267755259679749062284763163484947626697494729046430386559610613113754453726683312513915610558734802079868190554644983911078936369464590301246394586190666760362763580192139772729890492729488892169933099057105842090125200369295070365451134781912223048179092058016446222199742919885472867511334714233086339832790286482634562102936600597781342756061479024744312357407750731307860842457299116947352106025529309727703385914891200109853084742321655388368371397596144557614128458065859276522963419738435137978069417053712567764148183279165963454266011754149684758060746773409666706463583389316772088889398359242197165140562147489286818190852679930372669254697353483887004105934649944725189954685412228899457155711301864163839538810653626724347</span></span><br><span class="line">c1=<span class="number">55094296873556883585060020895253176070835143350249581136609315815308788255684072804968957510292559743192424646169207794748893753882418256401223641287546922358162629295622258913168323493447075410872354874300793298956869374606043622559405978242734950156459436487837698668489891733875650048466360950142617732135781244969524095348835624828008115829566644654403962285001724209210887446203934276651265377137788183939798543755386888532680013170540716736656670269251318800501517579803401154996881233025210176293554542024052540093890387437964747460765498713092018160196637928204190194154199389276666685436565665236397481709703644555328705818892269499380797044554054118656321389474821224725533693520856047736578402581854165941599254178019515615183102894716647680969742744705218868455450832</span></span><br><span class="line">e1=<span class="number">125932919717342481428108392434488550259190856475011752106073050593074410065655587870702051419898088541590032209854048032649625269856337901048406066968337289491951404384300466543616578679539808215698754491076340386697518948419895268049696498272031094236309803803729823608854215226233796069683774155739820423103</span></span><br><span class="line">n2=<span class="number">60143104944034567859993561862949071559877219267755259679749062284763163484947626697494729046430386559610613113754453726683312513915610558734802079868195633647431732875392121458684331843306730889424418620069322578265236351407591029338519809538995249896905137642342435659572917714183543305243715664380787797562011006398730320980994747939791561885622949912698246701769321430325902912003041678774440704056597862093530981040696872522868921139041247362592257285423948870944137019745161211585845927019259709501237550818918272189606436413992759328318871765171844153527424347985462767028135376552302463861324408178183842139330244906606776359050482977256728910278687996106152971028878653123533559760167711270265171441623056873903669918694259043580017081671349232051870716493557434517579121</span></span><br><span class="line">c2=<span class="number">39328446140156257571484184713861319722905864197556720730852773059147902283123252767651430278357950872626778348596897711320942449693270603776870301102881405303651558719085454281142395652056217241751656631812580544180434349840236919765433122389116860827593711593732385562328255759509355298662361508611531972386995239908513273236239858854586845849686865360780290350287139092143587037396801704351692736985955152935601987758859759421886670907735120137698039900161327397951758852875291442188850946273771733011504922325622240838288097946309825051094566685479503461938502373520983684296658971700922069426788236476575236189040102848418547634290214175167767431475003216056701094275899211419979340802711684989710130215926526387138538819531199810841475218142606691152928236362534181622201347</span></span><br><span class="line">e2=<span class="number">125932919717342481428108392434488550259190856475011752106073050593074410065655587870702051419898088541590032209854048032649625269856337901048406066968337289491951404384300466543616578679539808215698754491076340386697518948419895268049696498272031094236309803803729823608854215226233796069683774155739820425393</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">continuedfra</span>(<span class="params">x,y</span>):<span class="comment">#å¾—åˆ°è¿åˆ†æ•°çš„å±•å¼€å¼</span></span><br><span class="line">    ans = []</span><br><span class="line">    <span class="keyword">while</span>(y != <span class="number">0</span>):</span><br><span class="line">        ans.append(x // y)</span><br><span class="line">        x,y = y ,x % y</span><br><span class="line">    <span class="keyword">return</span> ans</span><br><span class="line">    </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">exp</span>(<span class="params">x,y</span>):</span><br><span class="line">    cf = continuedfra(x,y)</span><br><span class="line">    fz = [cf[<span class="number">0</span>],cf[<span class="number">0</span>] * cf[<span class="number">1</span>] + <span class="number">1</span>]</span><br><span class="line">    fm = [<span class="number">1</span>,cf[<span class="number">1</span>]]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>,<span class="built_in">len</span>(cf)):</span><br><span class="line">        z = cf[i] * fz[i - <span class="number">1</span>] + fz[i - <span class="number">2</span>]</span><br><span class="line">        m = cf[i] * fm[i - <span class="number">1</span>] + fm[i - <span class="number">2</span>]</span><br><span class="line">        fz.append(z)</span><br><span class="line">        fm.append(m)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> fz,fm</span><br><span class="line"></span><br><span class="line"><span class="comment">#print(exp(415,93))</span></span><br><span class="line">_q1,_q2 = exp(n1,n2)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>,<span class="built_in">len</span>(_q1)):</span><br><span class="line">    <span class="keyword">if</span> n1 % _q1[i] == <span class="number">0</span> <span class="keyword">and</span> n2 % _q2[i] == <span class="number">0</span> <span class="keyword">and</span> n1 != _q1[i] <span class="keyword">and</span> n2 != _q2[i]:</span><br><span class="line">        q1,q2 = _q1[i],_q2[i]</span><br><span class="line">        <span class="built_in">print</span>(q1,q2)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">q1 = <span class="number">11628371843051760370952910026406764366191062991235308941262037248377376991693250742343307155422036713746576338866595433599862614339347536916226536644210947</span></span><br><span class="line">q2 = <span class="number">11628371843051760370952910026406764366191062991235308941262037248377376991693250742343307155422036713746576338866595433599862614339347536916226536644211929</span></span><br><span class="line">p1 = gmpy2.iroot(n1 // q1,<span class="number">2</span>)[<span class="number">0</span>]</span><br><span class="line">p2 = gmpy2.iroot(n2 // q2,<span class="number">2</span>)[<span class="number">0</span>]</span><br><span class="line">phi1 = p1 * (p1 - <span class="number">1</span>) * (q1 - <span class="number">1</span>)</span><br><span class="line">phi2 = p2 * (p2 - <span class="number">1</span>) * (q2 - <span class="number">1</span>)</span><br><span class="line">d1 = gmpy2.invert(e1,phi1)</span><br><span class="line">d2 = gmpy2.invert(e2,phi2)</span><br><span class="line">m1 = <span class="built_in">pow</span>(c1,d1,n1)</span><br><span class="line">m2 = <span class="built_in">pow</span>(c2,d2,n2)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m1) + long_to_bytes(m2))</span><br></pre></td></tr></table></figure><h4 id="0x04-çœèµ›crypto2-1026"><a class="anchor" href="#0x04-çœèµ›crypto2-1026">#</a> 0x04 çœèµ› crypto2 10.26</h4><p>é™„ä»¶ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag, NBIT, MIDDLE</span><br><span class="line"><span class="keyword">assert</span> MIDDLE &lt; <span class="number">4096</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rsarsa</span>(<span class="params">nbit</span>):</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        p = getPrime(nbit)</span><br><span class="line">        middle = (<span class="number">2</span>**nbit - <span class="number">3</span>) ^ p</span><br><span class="line">        q = middle + MIDDLE</span><br><span class="line">        <span class="keyword">if</span> isPrime(q):</span><br><span class="line">            <span class="keyword">return</span> p,q</span><br><span class="line"></span><br><span class="line">p,q = rsarsa(NBIT)</span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line">n = p * q </span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">c = <span class="built_in">pow</span>(m,e,n)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;n =&#x27;</span>, n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;c =&#x27;</span>, c)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">n = 692224041388945379000542945310902880889100544298206558809223921382304144887565486168738878540375370962131523216110266003450063038852597901973959069961409252090233088923246072020448653242413438525803983280986587695098100053523677324314279892099704680639276122605007782194993832619487191722743054531524695485466578897531910673635843617334895918839728199336965513679879931120369894252383320216068550188557341291620047417322944706390751843111508918089789408109422357563835039746241760245490926252447703597477533668752930171198897054058982716965576506579176144003183647342789557878319494827627831312013617439863026665812607443</span></span><br><span class="line"><span class="string">c = 307197727308287745314426467002903248074969761558679046606456172330293223597622415661766314599586983706525802752702590834171088229466177584813058269117390420554764305566689318459776899180134066369190626054796865325243251558047293127988662783785017198221284274732844911397443405439812227924713443788235973809737857889544240278704700770780579167766105940360383012181564955578959555701526997721449721679761556310570137638766549920135248234070586743609456381815893734230223940645912347773433002389063138902856398043379520285872239709077175291162768996775352120726794354655215827681853155145863834324898022202315574453344333550</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><p>è¿™é¢˜å½“æ—¶çº¿ä¸‹æ²¡æ‰“å‡ºæ¥ï¼Œæˆ‘å¤ªèœäº†å‘œå‘œå‘œã€‚èµ›ååœ¨å—ç‚¹æ‹¨ä¹‹åç»ˆäºæ‰“å‡ºæ¥äº†ã€‚<br>è¿™é¢˜çš„æ ¸å¿ƒä»£ç å°±æ˜¯ p å’Œ q çš„å–å€¼</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">rsarsa</span>(<span class="params">nbit</span>):</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        p = getPrime(nbit)</span><br><span class="line">        middle = (<span class="number">2</span>**nbit - <span class="number">3</span>) ^ p</span><br><span class="line">        q = middle + MIDDLE</span><br><span class="line">        <span class="keyword">if</span> isPrime(q):</span><br><span class="line">            <span class="keyword">return</span> p,q</span><br></pre></td></tr></table></figure><p>ç»“åˆä¸Šä¸€ä¸ªè®°å½•çš„ä¾‹é¢˜ï¼Œå‘ç°äº†ç«¯å€ªï¼Œæœ‰ä¸€ä¸ªç­‰å¼å¾ˆå…³é”®<br><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>+</mo><mi>m</mi><mi>i</mi><mi>d</mi><mi>d</mi><mi>l</mi><mi>e</mi><mo>=</mo><msup><mn>2</mn><mrow><mi>n</mi><mi>b</mi><mi>i</mi><mi>t</mi><mi>s</mi></mrow></msup><mo>+</mo><mn>1</mn><mtext>æˆ–</mtext><msup><mn>2</mn><mrow><mi>n</mi><mi>b</mi><mi>i</mi><mi>t</mi><mi>s</mi></mrow></msup><mo>âˆ’</mo><mn>3</mn></mrow><annotation encoding="application/x-tex">p+middle=2^{nbits}+1æˆ–2^{nbits}-3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.7777700000000001em;vertical-align:-.19444em"></span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.69444em;vertical-align:0"></span><span class="mord mathnormal">m</span><span class="mord mathnormal">i</span><span class="mord mathnormal">d</span><span class="mord mathnormal">d</span><span class="mord mathnormal" style="margin-right:.01968em">l</span><span class="mord mathnormal">e</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.932438em;vertical-align:-.08333em"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.849108em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mord mathnormal mtight">b</span><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight">s</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.932438em;vertical-align:-.08333em"></span><span class="mord">1</span><span class="mord cjk_fallback">æˆ–</span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.849108em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mord mathnormal mtight">b</span><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight">s</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">3</span></span></span></span><br>ä¸¤ä¸ªç­”æ¡ˆä¹‹é—´æ‰ç›¸å·® 4ï¼Œåˆç”±äºæœ‰ MIDDLE çš„å­˜åœ¨ï¼Œæ‰€ä»¥å¯ä»¥å¾—åˆ°ä¸€ä¸ªæ›´å…³é”®çš„ç­‰å¼<br><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>+</mo><mi>q</mi><mo>=</mo><msup><mn>2</mn><mrow><mi>n</mi><mi>b</mi><mi>i</mi><mi>t</mi><mi>s</mi></mrow></msup><mo>+</mo><mi>M</mi><mi>I</mi><mi>D</mi><mi>D</mi><mi>L</mi><mi>E</mi></mrow><annotation encoding="application/x-tex">p+q=2^{nbits}+MIDDLE</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.7777700000000001em;vertical-align:-.19444em"></span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.625em;vertical-align:-.19444em"></span><span class="mord mathnormal" style="margin-right:.03588em">q</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.932438em;vertical-align:-.08333em"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.849108em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mord mathnormal mtight">b</span><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight">s</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.68333em;vertical-align:0"></span><span class="mord mathnormal" style="margin-right:.10903em">M</span><span class="mord mathnormal" style="margin-right:.07847em">I</span><span class="mord mathnormal" style="margin-right:.02778em">D</span><span class="mord mathnormal" style="margin-right:.02778em">D</span><span class="mord mathnormal">L</span><span class="mord mathnormal" style="margin-right:.05764em">E</span></span></span></span><br>åšåˆ°è¿™è¿™é¢˜åŸºæœ¬ä¸Šå¯ä»¥ç®—æ˜¯åšå‡ºæ¥äº†ï¼Œn çš„ä½æ•°æ˜¯ 2063 (n.bit_length ())ï¼Œä¼°æ‘¸ç€ p çš„ä½æ•°åœ¨ 1033 å·¦å³ï¼Œå– p å’Œ q çš„å…³é”®ä»£ç å¦‚ä¸‹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">nbit = <span class="number">1033</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    <span class="keyword">for</span> MIDDLE <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4100</span>):</span><br><span class="line">        tmp = MIDDLE + <span class="built_in">pow</span>(<span class="number">2</span>,nbit) + <span class="number">1</span></span><br><span class="line">        _tmp = gmpy2.iroot(tmp * tmp - <span class="number">4</span> * n,<span class="number">2</span>)[<span class="number">0</span>]</span><br><span class="line">        <span class="comment">#print(_tmp)</span></span><br><span class="line">        p = (tmp + _tmp) // <span class="number">2</span></span><br><span class="line">        q = (tmp - _tmp) // <span class="number">2</span></span><br><span class="line">        <span class="keyword">if</span> p * q == n:</span><br><span class="line">            <span class="built_in">print</span>(p,q)</span><br><span class="line">    nbit += <span class="number">1</span></span><br></pre></td></tr></table></figure><p>è¿™æ ·å¯ä»¥æŠŠ p å’Œ q çš„å€¼æ±‚å‡ºæ¥ï¼Œæœ€åå®Œæ•´ exp å¦‚ä¸‹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> sympy</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">n = <span class="number">692224041388945379000542945310902880889100544298206558809223921382304144887565486168738878540375370962131523216110266003450063038852597901973959069961409252090233088923246072020448653242413438525803983280986587695098100053523677324314279892099704680639276122605007782194993832619487191722743054531524695485466578897531910673635843617334895918839728199336965513679879931120369894252383320216068550188557341291620047417322944706390751843111508918089789408109422357563835039746241760245490926252447703597477533668752930171198897054058982716965576506579176144003183647342789557878319494827627831312013617439863026665812607443</span></span><br><span class="line">c = <span class="number">307197727308287745314426467002903248074969761558679046606456172330293223597622415661766314599586983706525802752702590834171088229466177584813058269117390420554764305566689318459776899180134066369190626054796865325243251558047293127988662783785017198221284274732844911397443405439812227924713443788235973809737857889544240278704700770780579167766105940360383012181564955578959555701526997721449721679761556310570137638766549920135248234070586743609456381815893734230223940645912347773433002389063138902856398043379520285872239709077175291162768996775352120726794354655215827681853155145863834324898022202315574453344333550</span></span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line">nbit = <span class="number">1033</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;while True:</span></span><br><span class="line"><span class="string">    for MIDDLE in range(4100):</span></span><br><span class="line"><span class="string">        tmp = MIDDLE + pow(2,nbit) + 1</span></span><br><span class="line"><span class="string">        _tmp = gmpy2.iroot(tmp * tmp - 4 * n,2)[0]</span></span><br><span class="line"><span class="string">        #print(_tmp)</span></span><br><span class="line"><span class="string">        p = (tmp + _tmp) // 2</span></span><br><span class="line"><span class="string">        q = (tmp - _tmp) // 2</span></span><br><span class="line"><span class="string">        if p * q == n:</span></span><br><span class="line"><span class="string">            print(p,q)</span></span><br><span class="line"><span class="string">    nbit += 1&#x27;&#x27;&#x27;</span></span><br><span class="line">p = <span class="number">83779430298667510005030233140133481557110011860444148119338405921926228260533780776148652029157919380426250379194849091713116366415687948044381119153358182529766538707906804669498361969372946520124225189026692780636946602267126307798394572549518588479133844354106171812548366397662316259990312379415967213934437</span></span><br><span class="line">q = <span class="number">8262458206283064470710192628264584804130409461401948404657795630832901751882712347798088359914739062387247927299304307408183995217293362671956765334052569151650622725624323791968374466465053669035753282440830173008186547092214687516248940047384956948501617116402012886304623522839298488085390061351635544321239</span></span><br><span class="line">phi = (p - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line">d = gmpy2.invert(e,phi)</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure><p>å»çº¿ä¸‹è¢«é£ä¿¡å­çš„å¸ˆå‚…æ‰“çƒ‚äº†ï¼Œäº‰å–ä¸‹æ¬¡ä¸è¢«æ‰“å¾—é‚£ä¹ˆæƒ¨ã€‚</p><h4 id="0x03-roxen-1025"><a class="anchor" href="#0x03-roxen-1025">#</a> 0x03 roXen 10.25</h4><p>é™„ä»¶ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> exp, flag, nbit</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> exp &amp; (exp + <span class="number">1</span>) == <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">adlit</span>(<span class="params">x</span>):</span><br><span class="line">    l = <span class="built_in">len</span>(<span class="built_in">bin</span>(x)[<span class="number">2</span>:])</span><br><span class="line">    <span class="keyword">return</span> (<span class="number">2</span> ** l - <span class="number">1</span>) ^ x</span><br><span class="line"></span><br><span class="line">nbit = <span class="number">1024</span></span><br><span class="line">l = [<span class="number">1023</span>,<span class="number">1024</span>,<span class="number">1025</span>]</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">genadlit</span>(<span class="params">nbit</span>):</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        p = getPrime(nbit)</span><br><span class="line">        q = adlit(p) + <span class="number">31337</span></span><br><span class="line">        <span class="keyword">if</span> isPrime(q):</span><br><span class="line">            <span class="keyword">return</span> p, q</span><br><span class="line"></span><br><span class="line">p, q = genadlit(nbit)</span><br><span class="line">e, n = exp, p * q</span><br><span class="line"></span><br><span class="line">c = <span class="built_in">pow</span>(bytes_to_long(flag), e, n)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span> <span class="string">&#x27;n =&#x27;</span>, <span class="built_in">hex</span>(n)</span><br><span class="line"><span class="built_in">print</span> <span class="string">&#x27;c =&#x27;</span>, <span class="built_in">hex</span>(c)</span><br><span class="line"><span class="comment">#n = 0x3ff77ad8783e006b6a2c9857f2f13a9d896297558e7c986c491e30c1a920512a0bad9f07c5569cf998fc35a3071de9d8b0f5ada4f8767b828e35044abce5dcf88f80d1c0a0b682605cce776a184e1bcb8118790fff92dc519d24f998a9c04faf43c434bef6c0fa39a3db7452dc07ccfced9271799f37d91d56b5f21c51651d6a9a41ee5a8af17a2f945fac2b1a0ea98bc70ef0f3e37371c9c7b6f90d3d811212fc80e0abcd5bbefe0c6edb3ca6845ded90677ccd8ff4de2c747b37265fc1250ba9aa89b4fd2bdfb4b4b72a7ff5b5ee67e81fd25027b6cb49db610ec60a05016e125ce0848f2c32bff33eed415a6d227262b338b0d1f3803d83977341c0d3638fL</span></span><br><span class="line"><span class="comment">#c = 0x2672cade2272f3024fd2d1984ea1b8e54809977e7a8c70a07e2560f39e6fcce0e292426e28df51492dec67d000d640f3e5b4c6c447845e70d1432a3c816a33da6a276b0baabd0111279c9f267a90333625425b1d73f1cdc254ded2ad54955914824fc99e65b3dea3e365cfb1dce6e025986b2485b6c13ca0ee73c2433cf0ca0265afe42cbf647b5c721a6e51514220bab8fcb9cff570a6922bceb12e9d61115357afe1705bda3c3f0b647ba37711c560b75841135198cc076d0a52c74f9802760c1f881887cc3e50b7e0ff36f0d9fa1bfc66dff717f032c066b555e315cb07e3df13774eaa70b18ea1bb3ea0fd1227d4bac84be2660552d3885c79815baef661L</span></span><br></pre></td></tr></table></figure><p>è¿™é¢˜å’Œçœèµ›çº¿ä¸‹é‚£é“é¢˜å¾ˆç±»ä¼¼ï¼Œè¿™é¢˜ç†è§£èµ·æ¥å€’ä¸éš¾ã€‚ç»†çœ‹è¿™ä¸ª adlit å‡½æ•°ï¼Œå’Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mi>l</mi></msup></mrow><annotation encoding="application/x-tex">2^l</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.849108em;vertical-align:0"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.849108em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:.01968em">l</span></span></span></span></span></span></span></span></span></span></span>-1 å¼‚æˆ–ï¼Œä¸å°±æ˜¯å–åå—ã€‚ç„¶åå¯ä»¥å¾—åˆ°è¿™ä¸ªå¼å­<br><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>+</mo><mi>a</mi><mi>d</mi><mi>l</mi><mi>i</mi><mi>t</mi><mo stretchy="false">(</mo><mi>p</mi><mo stretchy="false">)</mo><mo>=</mo><msup><mn>2</mn><mrow><mi>n</mi><mi>b</mi><mi>i</mi><mi>t</mi></mrow></msup><mo>âˆ’</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">p+adlit(p)=2^{nbit}-1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.7777700000000001em;vertical-align:-.19444em"></span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal">a</span><span class="mord mathnormal">d</span><span class="mord mathnormal" style="margin-right:.01968em">l</span><span class="mord mathnormal">i</span><span class="mord mathnormal">t</span><span class="mopen">(</span><span class="mord mathnormal">p</span><span class="mclose">)</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.932438em;vertical-align:-.08333em"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.849108em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mord mathnormal mtight">b</span><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">1</span></span></span></span><br>ç„¶åé¢˜ç›®åˆç»™äº†æ¡ä»¶ï¼š<br><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>q</mi><mo>=</mo><mi>a</mi><mi>d</mi><mi>l</mi><mi>i</mi><mi>t</mi><mo stretchy="false">(</mo><mi>p</mi><mo stretchy="false">)</mo><mo>+</mo><mn>31337</mn></mrow><annotation encoding="application/x-tex">q=adlit(p)+31337</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.625em;vertical-align:-.19444em"></span><span class="mord mathnormal" style="margin-right:.03588em">q</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal">a</span><span class="mord mathnormal">d</span><span class="mord mathnormal" style="margin-right:.01968em">l</span><span class="mord mathnormal">i</span><span class="mord mathnormal">t</span><span class="mopen">(</span><span class="mord mathnormal">p</span><span class="mclose">)</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">3</span><span class="mord">1</span><span class="mord">3</span><span class="mord">3</span><span class="mord">7</span></span></span></span><br>è”ç«‹ä¸€ä¸‹å¯ä»¥æ±‚å‡º p å’Œ q</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sympy</span><br><span class="line">p = sympy.Symbol(<span class="string">&#x27;p&#x27;</span>)</span><br><span class="line">q = sympy.Symbol(<span class="string">&#x27;q&#x27;</span>)</span><br><span class="line">f1 = <span class="built_in">pow</span>(<span class="number">2</span>,<span class="number">1024</span>) - <span class="number">1</span> + <span class="number">31337</span> - (p + q)</span><br><span class="line">f2 = n - p * q</span><br><span class="line">result = sympy.solve([f1,f2],[p,q])</span><br><span class="line"><span class="built_in">print</span>(result)</span><br><span class="line"><span class="comment">#æˆ‘æ˜¯æ‡’ç‹—åˆ«éª‚äº†</span></span><br></pre></td></tr></table></figure><p>ç„¶åæ˜¯ eï¼Œé¢˜ç›®ç»™äº†ä¸€ä¸ªæ¡ä»¶<strong> assert exp &amp; (exp + 1) == 0</strong>ï¼Œä»…èƒ½ç¡®å®š<br><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi><mo>=</mo><msup><mn>2</mn><mi>k</mi></msup><mo>âˆ’</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">e=2^k-1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord mathnormal">e</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.932438em;vertical-align:-.08333em"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.849108em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:.03148em">k</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">1</span></span></span></span><br>ä¸è¿‡è¿™ä¹Ÿå¤Ÿäº†ï¼Œè´´ä¸€ä¸ª exp</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> sympy</span><br><span class="line">n = <span class="number">8075050082948443349212340895390914595911667800472259304754411169066015177591933999426560842475863558771524178567197246061634705069273801684590339376649250275207876158732481939003115606742710400986721591279999826858150876137968993463656776832026731671417714759299940616065017786507499266738676453484280827236651674321383863812748279151357153518973782147856930772203682878762471730337625339948570784785485324346140610598746611747268908435220575244445870697107881309658419479841845001923938819243466739611923893747979395011225704679540471165704211172427337362271759859075915131503186516103524664973440454762264198865807</span></span><br><span class="line">c = <span class="number">4853661856538137406464034645906094152913630881745619406489837142176663842103161345726810796014324314815721708473241794990602572186090153630178109119000213575671689095484555801915325918814943882491883912939695163112247489821713563958885663470619257776668644302133854563122818923079903345131503071641985122522971974296790978299728014731290028116679328055229119298349730647468258800098306200875957662303051682669135862889528217767209821797678213735216907093405968738909692976414606843097568371074804700587363228896629583675336567001789346679322477777578268489982160639014959437742274169277165123841304006603130339784289</span></span><br><span class="line"><span class="comment">#print(n)</span></span><br><span class="line"><span class="comment">#print(c)</span></span><br><span class="line">p = sympy.Symbol(<span class="string">&#x27;p&#x27;</span>)</span><br><span class="line">q = sympy.Symbol(<span class="string">&#x27;q&#x27;</span>)</span><br><span class="line">f1 = <span class="built_in">pow</span>(<span class="number">2</span>,<span class="number">1024</span>) - <span class="number">1</span> + <span class="number">31337</span> - (p + q)</span><br><span class="line">f2 = n - p * q</span><br><span class="line">result = sympy.solve([f1,f2],[p,q])</span><br><span class="line"><span class="built_in">print</span>(result)</span><br><span class="line"></span><br><span class="line">tmp1 = <span class="built_in">pow</span>(<span class="number">2</span>,<span class="number">1024</span>) - <span class="number">1</span> + <span class="number">31337</span></span><br><span class="line">tmp2 = gmpy2.sqrt(tmp1 * tmp1 - <span class="number">4</span> * n)</span><br><span class="line"><span class="comment">#p = (tmp1 + tmp2) // 2</span></span><br><span class="line"><span class="comment">#q = (tmp1 - tmp2) // 2</span></span><br><span class="line">p = <span class="number">87834916545113015336000964296144306577174555879027549345134855850783246277838709952680829156347468418886211490335525241607253688425417142115840218894244902812798763051744684655923207165455737209507609386779708842318917975391900956941587572141475884466544826179681669143055208345737430546444402480246313669813</span></span><br><span class="line">q = <span class="number">91934396941118575436929554782758166784623142015203107928295225306949429527662253180027648166060067602233902389535868116051536080388999480377007211745229221564969130373120800620379012435790356909945473565305296926519232706950561924532325538399351352696805684504904629096892037592742285758390953849377910498739</span></span><br><span class="line">phi = (p - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line">k = <span class="number">1</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    k += <span class="number">1</span></span><br><span class="line">    e = <span class="number">2</span> ** k - <span class="number">1</span></span><br><span class="line">    gcd = gmpy2.gcd(e, phi)</span><br><span class="line">    e2 = e // gcd</span><br><span class="line">    d = gmpy2.invert(e2, phi//gcd)</span><br><span class="line">    m = <span class="built_in">pow</span>(c, d, n)</span><br><span class="line">    p, judge = gmpy2.iroot(m, gcd)</span><br><span class="line">    plaintext = long_to_bytes(p)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">b&#x27;CTF&#x27;</span> <span class="keyword">in</span> plaintext <span class="keyword">and</span> judge:</span><br><span class="line">        <span class="built_in">print</span>(plaintext)</span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure><h4 id="0x02-geek-challenge-2021-superposition_under_the_starry_sky-1016"><a class="anchor" href="#0x02-geek-challenge-2021-superposition_under_the_starry_sky-1016">#</a> 0x02 Geek Challenge 2021 Superposition_under_the_starry_sky 10.16</h4><p>é™„ä»¶ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> bytes_to_long, getPrime</span><br><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> flag</span><br><span class="line">a = getPrime(<span class="number">400</span>)</span><br><span class="line">b = getPrime(<span class="number">400</span>)</span><br><span class="line">n = getPrime(<span class="number">400</span>)</span><br><span class="line">flag = bytes_to_long(flag)</span><br><span class="line">seed = flag</span><br><span class="line">result = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>):</span><br><span class="line">    seed = (seed * a + b) % n</span><br><span class="line">    result.append(seed)</span><br><span class="line"><span class="built_in">print</span>(result)</span><br><span class="line"><span class="built_in">print</span>(n)</span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">[1633086272556604467630727869278140040711140555507257984778706962389364338237377391272504059109316040445365656669071569236, 1206389051656797336925675372412697477889689141174380289961348552709531162180853687116202278892215286522581909284859193494, 664238088423928246579566483655935746695807924062694495126404306361290788561253706421181510449476188038387172722467882193]</span></span><br><span class="line"><span class="string">2482696698513566590184292572066254640333143735400366745928208268241117181592178071999744746850718587310205478604372055081</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure><p>å®‹å¸ˆçˆ¶è·Ÿæˆ‘è¯´æ˜¯<span class="exturl" data-url="aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3N1cGVycHJpbnRmL2FydGljbGUvZGV0YWlscy8xMDg5NjQ1NjM="> lcg ç®—æ³•</span>ï¼Œç„¶åå–æ¨¡è¿ç®—é‡Œæœ‰ä¸€å¥å¾ˆå…³é”®çš„è¯æ˜¯ï¼Œæ¨¡æ„ä¹‰ä¸‹çš„é™¤æ³•éƒ½æ˜¯æ±‚é€†å…ƒã€‚å…¬å¼è‡ªå·±éƒ½æ¨çš„ä¸ƒä¸ƒå…«å…«äº†ï¼Œç›´æ¥é™¤æ³•æ”¹é€†å…ƒå°±å‡ºäº†ï¼Œexpï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">n = <span class="number">2482696698513566590184292572066254640333143735400366745928208268241117181592178071999744746850718587310205478604372055081</span></span><br><span class="line">result1 = <span class="number">1633086272556604467630727869278140040711140555507257984778706962389364338237377391272504059109316040445365656669071569236</span></span><br><span class="line">result2 = <span class="number">1206389051656797336925675372412697477889689141174380289961348552709531162180853687116202278892215286522581909284859193494</span></span><br><span class="line">result3 = <span class="number">664238088423928246579566483655935746695807924062694495126404306361290788561253706421181510449476188038387172722467882193</span></span><br><span class="line"></span><br><span class="line">tmp1 = result2 - result1</span><br><span class="line">tmp2 = result3 - result2</span><br><span class="line">a = tmp2 * gmpy2.invert(tmp1,n) % n</span><br><span class="line">b = (result2 - a * result1) % n</span><br><span class="line"><span class="built_in">print</span>(a)</span><br><span class="line"><span class="built_in">print</span>(b)</span><br><span class="line">flag = (result1 - b) * gmpy2.invert(a,n) % n</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(flag))</span><br></pre></td></tr></table></figure><h4 id="0x01-gkctf2021-rrrrsa-a-hrefhttpsfilesbuuojcnfilesd1b63e8c299922ae7f8db550dd0c81e2rarç‚¹å‡»ä¸‹è½½a"><a class="anchor" href="#0x01-gkctf2021-rrrrsa-a-hrefhttpsfilesbuuojcnfilesd1b63e8c299922ae7f8db550dd0c81e2rarç‚¹å‡»ä¸‹è½½a">#</a> 0x01 GKCTF2021 RRRRsa <span class="exturl" data-url="aHR0cHM6Ly9maWxlcy5idXVvai5jbi9maWxlcy9kMWI2M2U4YzI5OTkyMmFlN2Y4ZGI1NTBkZDBjODFlMi9yYXI=">ç‚¹å‡»ä¸‹è½½</span></h4><p>é™„ä»¶å¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> gcd</span><br><span class="line"></span><br><span class="line">flag = <span class="string">b&#x27;xxxxxxxxxxxxx&#x27;</span></span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">q = getPrime(<span class="number">512</span>)</span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">n = p*q</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">c = <span class="built_in">pow</span>(m,e,n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;c=&#123;&#125;&#x27;</span>.<span class="built_in">format</span>(c))</span><br><span class="line"></span><br><span class="line">p1 = getPrime(<span class="number">512</span>)</span><br><span class="line">q1 = getPrime(<span class="number">512</span>)</span><br><span class="line">n1 = p1*q1</span><br><span class="line">e1 = <span class="number">65537</span></span><br><span class="line"><span class="keyword">assert</span> gcd(e1,(p1-<span class="number">1</span>)*(q1-<span class="number">1</span>)) == <span class="number">1</span></span><br><span class="line">c1 = <span class="built_in">pow</span>(p,e1,n1)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;n1=&#123;&#125;&#x27;</span>.<span class="built_in">format</span>(n1))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;c1=&#123;&#125;&#x27;</span>.<span class="built_in">format</span>(c1))</span><br><span class="line">hint1 = <span class="built_in">pow</span>(<span class="number">2020</span> * p1 + q1, <span class="number">202020</span>, n1)</span><br><span class="line">hint2 = <span class="built_in">pow</span>(<span class="number">2021</span> * p1 + <span class="number">212121</span>, q1, n1)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;hint1=&#123;&#125;&#x27;</span>.<span class="built_in">format</span>(hint1))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;hint2=&#123;&#125;&#x27;</span>.<span class="built_in">format</span>(hint2))</span><br><span class="line"></span><br><span class="line">p2 = getPrime(<span class="number">512</span>)</span><br><span class="line">q2 = getPrime(<span class="number">512</span>)</span><br><span class="line">n2 = p2*q2</span><br><span class="line">e2 = <span class="number">65537</span></span><br><span class="line"><span class="keyword">assert</span> gcd(e1,(p2-<span class="number">1</span>)*(q2-<span class="number">1</span>)) == <span class="number">1</span></span><br><span class="line">c2 = <span class="built_in">pow</span>(q,e2,n2)</span><br><span class="line">hint3 = <span class="built_in">pow</span>(<span class="number">2020</span> * p2 + <span class="number">2021</span> * q2, <span class="number">202020</span>, n2)</span><br><span class="line">hint4 = <span class="built_in">pow</span>(<span class="number">2021</span> * p2 + <span class="number">2020</span> * q2, <span class="number">212121</span>, n2)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;n2=&#123;&#125;&#x27;</span>.<span class="built_in">format</span>(n2))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;c2=&#123;&#125;&#x27;</span>.<span class="built_in">format</span>(c2))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;hint3=&#123;&#125;&#x27;</span>.<span class="built_in">format</span>(hint3))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;hint4=&#123;&#125;&#x27;</span>.<span class="built_in">format</span>(hint4))</span><br><span class="line"></span><br><span class="line"><span class="comment">#c=13492392717469817866883431475453770951837476241371989714683737558395769731416522300851917887957945766132864151382877462142018129852703437240533684604508379950293643294877725773675505912622208813435625177696614781601216465807569201380151669942605208425645258372134465547452376467465833013387018542999562042758</span></span><br><span class="line"><span class="comment">#n1=75003557379080252219517825998990183226659117019770735080523409561757225883651040882547519748107588719498261922816865626714101556207649929655822889945870341168644508079317582220034374613066751916750036253423990673764234066999306874078424803774652754587494762629397701664706287999727238636073466137405374927829</span></span><br><span class="line"><span class="comment">#c1=68111901092027813007099627893896838517426971082877204047110404787823279211508183783468891474661365139933325981191524511345219830693064573462115529345012970089065201176142417462299650761299758078141504126185921304526414911455395289228444974516503526507906721378965227166653195076209418852399008741560796631569</span></span><br><span class="line"><span class="comment">#hint1=23552090716381769484990784116875558895715552896983313406764042416318710076256166472426553520240265023978449945974218435787929202289208329156594838420190890104226497263852461928474756025539394996288951828172126419569993301524866753797584032740426259804002564701319538183190684075289055345581960776903740881951</span></span><br><span class="line"><span class="comment">#hint2=52723229698530767897979433914470831153268827008372307239630387100752226850798023362444499211944996778363894528759290565718266340188582253307004810850030833752132728256929572703630431232622151200855160886614350000115704689605102500273815157636476901150408355565958834764444192860513855376978491299658773170270</span></span><br><span class="line"><span class="comment">#n2=114535923043375970380117920548097404729043079895540320742847840364455024050473125998926311644172960176471193602850427607899191810616953021324742137492746159921284982146320175356395325890407704697018412456350862990849606200323084717352630282539156670636025924425865741196506478163922312894384285889848355244489</span></span><br><span class="line"><span class="comment">#c2=67054203666901691181215262587447180910225473339143260100831118313521471029889304176235434129632237116993910316978096018724911531011857469325115308802162172965564951703583450817489247675458024801774590728726471567407812572210421642171456850352167810755440990035255967091145950569246426544351461548548423025004</span></span><br><span class="line"><span class="comment">#hint3=25590923416756813543880554963887576960707333607377889401033718419301278802157204881039116350321872162118977797069089653428121479486603744700519830597186045931412652681572060953439655868476311798368015878628002547540835719870081007505735499581449077950263721606955524302365518362434928190394924399683131242077</span></span><br><span class="line"><span class="comment">#hint4=104100726926923869566862741238876132366916970864374562947844669556403268955625670105641264367038885706425427864941392601593437305258297198111819227915453081797889565662276003122901139755153002219126366611021736066016741562232998047253335141676203376521742965365133597943669838076210444485458296240951668402513</span></span><br></pre></td></tr></table></figure><p>è¿™é¢˜ç®—æ˜¯è€ƒå¯Ÿå¯¹æ¨¡è¿ç®—çš„ç†è§£å’Œçµæ´»è¿ç”¨ï¼Œå…¶ä¸­ç”¨åˆ°äº†<strong>è´¹é©¬å°å®šç†</strong>å’Œ<strong>äºŒé¡¹å¼å®šç†</strong>ã€‚ç”¨ RSA å¯¹å…¬é’¥ä¸­çš„ pã€q åˆ†åˆ«åŠ å¯†ã€‚æ•°å­¦è¿ç®—è¿‡ç¨‹å¦‚ä¸‹å›¾</p><img data-src="/images/2021092201.jpg" width="80%" height="80%"> <img data-src="/images/2021092202.jpg" width="80%" height="80%"><p>å¦‚æœæ˜¯ mod qï¼Œé‚£ç­‰å¼ç›¸å‡çš„ç›®çš„å°±æ˜¯å°†ç­‰å¼ä¸­çš„ p ç›¸å‡æ¶ˆå»ï¼Œç›¸å‡ä¹‹ååªå‰©ä¸‹ q å’Œç³»æ•°ï¼Œå¯ä»¥ç”¨ gcd æ±‚å‡ºå…¬çº¦æ•°ã€‚æ³¨æ„ç›¸å‡çš„å¼å­è¦å…ˆ mod n ç¼©å°æ•°çš„å¤§å°ï¼Œè¿™æ ·å¹¶ä¸ä¼šæ”¹å˜è¿ç®—ç»“æœã€‚æœ€ç»ˆ exp å¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">c = <span class="number">13492392717469817866883431475453770951837476241371989714683737558395769731416522300851917887957945766132864151382877462142018129852703437240533684604508379950293643294877725773675505912622208813435625177696614781601216465807569201380151669942605208425645258372134465547452376467465833013387018542999562042758</span></span><br><span class="line"></span><br><span class="line">hint1 = <span class="number">23552090716381769484990784116875558895715552896983313406764042416318710076256166472426553520240265023978449945974218435787929202289208329156594838420190890104226497263852461928474756025539394996288951828172126419569993301524866753797584032740426259804002564701319538183190684075289055345581960776903740881951</span></span><br><span class="line">hint2 = <span class="number">52723229698530767897979433914470831153268827008372307239630387100752226850798023362444499211944996778363894528759290565718266340188582253307004810850030833752132728256929572703630431232622151200855160886614350000115704689605102500273815157636476901150408355565958834764444192860513855376978491299658773170270</span></span><br><span class="line">n1 = <span class="number">75003557379080252219517825998990183226659117019770735080523409561757225883651040882547519748107588719498261922816865626714101556207649929655822889945870341168644508079317582220034374613066751916750036253423990673764234066999306874078424803774652754587494762629397701664706287999727238636073466137405374927829</span></span><br><span class="line">c1 = <span class="number">68111901092027813007099627893896838517426971082877204047110404787823279211508183783468891474661365139933325981191524511345219830693064573462115529345012970089065201176142417462299650761299758078141504126185921304526414911455395289228444974516503526507906721378965227166653195076209418852399008741560796631569</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">tmp2 = <span class="built_in">pow</span>(hint2 - <span class="number">212121</span>,<span class="number">202020</span>,n1) * <span class="built_in">pow</span>(<span class="number">2020</span>,<span class="number">202020</span>)</span><br><span class="line">tmp1 = hint1 * <span class="built_in">pow</span>(<span class="number">2021</span>,<span class="number">202020</span>)</span><br><span class="line">q1 = gmpy2.gcd(tmp2 - tmp1,n1)</span><br><span class="line"><span class="built_in">print</span>(q1)</span><br><span class="line">p1 = n1 // q1</span><br><span class="line">phi1 = (p1 - <span class="number">1</span>) * (q1 - <span class="number">1</span>)</span><br><span class="line">d1 = gmpy2.invert(e,phi1)</span><br><span class="line">p = <span class="built_in">pow</span>(c1,d1,n1)</span><br><span class="line"></span><br><span class="line">n2 = <span class="number">114535923043375970380117920548097404729043079895540320742847840364455024050473125998926311644172960176471193602850427607899191810616953021324742137492746159921284982146320175356395325890407704697018412456350862990849606200323084717352630282539156670636025924425865741196506478163922312894384285889848355244489</span></span><br><span class="line">c2 = <span class="number">67054203666901691181215262587447180910225473339143260100831118313521471029889304176235434129632237116993910316978096018724911531011857469325115308802162172965564951703583450817489247675458024801774590728726471567407812572210421642171456850352167810755440990035255967091145950569246426544351461548548423025004</span></span><br><span class="line">hint3 = <span class="number">25590923416756813543880554963887576960707333607377889401033718419301278802157204881039116350321872162118977797069089653428121479486603744700519830597186045931412652681572060953439655868476311798368015878628002547540835719870081007505735499581449077950263721606955524302365518362434928190394924399683131242077</span></span><br><span class="line">hint4 = <span class="number">104100726926923869566862741238876132366916970864374562947844669556403268955625670105641264367038885706425427864941392601593437305258297198111819227915453081797889565662276003122901139755153002219126366611021736066016741562232998047253335141676203376521742965365133597943669838076210444485458296240951668402513</span></span><br><span class="line"></span><br><span class="line">tmp3 = <span class="built_in">pow</span>(hint3,<span class="number">212121</span>,n2) * <span class="built_in">pow</span>(<span class="number">2021</span>,<span class="number">202020</span> * <span class="number">212121</span>,n2)</span><br><span class="line">tmp4 = <span class="built_in">pow</span>(hint4,<span class="number">202020</span>,n2) * <span class="built_in">pow</span>(<span class="number">2020</span>,<span class="number">202020</span> * <span class="number">212121</span>,n2)</span><br><span class="line">q2 = gmpy2.gcd(tmp4 - tmp3,n2)</span><br><span class="line">p2 = n2 // q2</span><br><span class="line">phi2 = (p2 - <span class="number">1</span>) * (q2 - <span class="number">1</span>)</span><br><span class="line">d2 = gmpy2.invert(e,phi2)</span><br><span class="line">q = <span class="built_in">pow</span>(c2,d2,n2)</span><br><span class="line">phi = (p - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line">d = gmpy2.invert(e,phi)</span><br><span class="line">n = p * q</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure><div class="tags"><a href="/tags/%E5%AD%A6%E4%B9%A0/" rel="tag"><i class="ic i-tag"></i> å­¦ä¹ </a> <a href="/tags/crypto/" rel="tag"><i class="ic i-tag"></i> crypto</a></div></div><footer><div class="meta"><span class="item"><span class="icon"><i class="ic i-calendar-check"></i> </span><span class="text">Edited on</span> <time title="Modified: 2022-05-15 10:57:57" itemprop="dateModified" datetime="2022-05-15T10:57:57+08:00">2022-05-15</time></span></div><div class="reward"><button><i class="ic i-heartbeat"></i> Donate</button><p>Give me a cup of [coffee]~(ï¿£â–½ï¿£)~*</p><div id="qr"><div><img data-src="/images/Alipay.jpg" alt="tsuppari Alipay"><p>Alipay</p></div><div><img data-src="/images/WeChatpay.jpg" alt="tsuppari PayPal"><p>PayPal</p></div></div></div><div id="copyright"><ul><li class="author"><strong>Post author: </strong>tsuppari <i class="ic i-at"><em>@</em></i>è’Ÿè’»çš„å…¥åœŸå²</li><li class="link"><strong>Post link: </strong><a href="https://tsuppari404.github.io/2099/09/12/crypto%E7%9A%84%E6%8C%A8%E6%89%93%E4%B9%8B%E8%B7%AF(%E4%B8%80)/" title="cryptoçš„æŒ¨æ‰“ä¹‹è·¯ï¼ˆä¸€ï¼‰">https://tsuppari404.github.io/2099/09/12/cryptoçš„æŒ¨æ‰“ä¹‹è·¯(ä¸€)/</a></li><li class="license"><strong>Copyright Notice: </strong>All articles in this blog are licensed under <span class="exturl" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9kZWVkLnpoLUNOLnltbA=="><i class="ic i-creative-commons"><em>(CC)</em></i>BY-NC-SA</span> unless stating additionally.</li></ul></div></footer></article></div><div class="post-nav"><div class="item left"><a href="/2022/11/26/docker%E6%98%AF%E4%B8%AA%E8%82%BE%E4%B9%88%E7%8E%A9%E6%84%8F/" itemprop="url" rel="prev" data-background-image="https:&#x2F;&#x2F;tva4.sinaimg.cn&#x2F;mw690&#x2F;6833939bly1gipevo9j1jj20zk0m8e81.jpg" title="dockeræ˜¯ä¸ªè‚¾ä¹ˆç©æ„"><span class="type">Previous Post</span> <span class="category"><i class="ic i-flag"></i></span><h3>dockeræ˜¯ä¸ªè‚¾ä¹ˆç©æ„</h3></a></div><div class="item right"><a href="/2199/04/13/crypto%E7%9A%84%E6%8C%A8%E6%89%93%E4%B9%8B%E8%B7%AF(%E4%BA%8C)/" itemprop="url" rel="next" data-background-image="https:&#x2F;&#x2F;tva4.sinaimg.cn&#x2F;mw690&#x2F;6833939bly1gipexj2jgzj20zk0m8b09.jpg" title="cryptoçš„æŒ¨æ‰“ä¹‹è·¯ï¼ˆäºŒï¼‰"><span class="type">Next Post</span> <span class="category"><i class="ic i-flag"></i></span><h3>cryptoçš„æŒ¨æ‰“ä¹‹è·¯ï¼ˆäºŒï¼‰</h3></a></div></div><div class="wrap" id="comments"></div></div><div id="sidebar"><div class="inner"><div class="panels"><div class="inner"><div class="contents panel pjax" data-title="Contents"><ol class="toc"><li class="toc-item toc-level-4"><a class="toc-link" href="#0x14-2022securinets-ctf-quals-2022-aes-2-411"><span class="toc-number">1.</span> <span class="toc-text">0x14 2022Securinets CTF Quals 2022 AES-2 4.11</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#0x13-2022securinets-ctf-quals-2022-escrime-411"><span class="toc-number">2.</span> <span class="toc-text">0x13 2022Securinets CTF Quals 2022 escrime 4.11</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#0x12-2022hgame-week2-the-password-plus-pro-max-ultra-210"><span class="toc-number">3.</span> <span class="toc-text">0x12 2022hgame week2 The Password Plus Pro Max Ultra 2.10</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#0x11-2020%E7%BE%8A%E5%9F%8E%E6%9D%AF-invitations-117"><span class="toc-number">4.</span> <span class="toc-text">0x11 2020 ç¾ŠåŸæ¯ Invitations 1.17</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#0x10-ctfshow%E6%91%86%E7%83%82%E6%9D%AF-easypeasy-110"><span class="toc-number">5.</span> <span class="toc-text">0x10 ctfshow æ‘†çƒ‚æ¯ easypeasy 1.10</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#0x0f-2022%E9%95%BF%E5%AE%89%E6%88%98%E5%BD%B9math-110"><span class="toc-number">6.</span> <span class="toc-text">0x0F 2022 é•¿å®‰æˆ˜å½¹ math 1.10</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#0x0e-2021%E8%B5%A3%E7%BD%91%E6%9D%AFleak-1229"><span class="toc-number">7.</span> <span class="toc-text">0x0E 2021 èµ£ç½‘æ¯ leak 12.29</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#0x0d-2021%E8%A5%BF%E6%B9%96%E8%AE%BA%E5%89%91unknown_dsa-1223"><span class="toc-number">8.</span> <span class="toc-text">0x0D 2021 è¥¿æ¹–è®ºå‰‘ unknown_dsa 12.23</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%80%BB%E7%BB%93"><span class="toc-number">8.1.</span> <span class="toc-text">æ€»ç»“</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#0x0c-%E5%B0%8F%E7%9C%81%E8%B5%9B%E7%AE%80%E5%8D%95aes-125"><span class="toc-number">9.</span> <span class="toc-text">0x0C å°çœèµ›ç®€å• aes 12.5</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#0x0b-2020actf%E6%96%B0%E7%94%9F%E8%B5%9Bcrypto-aes-125"><span class="toc-number">10.</span> <span class="toc-text">0x0B 2020ACTF æ–°ç”Ÿèµ› crypto-aes 12.5</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#0x0a-2021swpu_nssctf%E6%96%B0%E7%94%9F%E8%B5%9B-crypto3-1129"><span class="toc-number">11.</span> <span class="toc-text">0x0A 2021swpu_nssctf æ–°ç”Ÿèµ› crypto3 11.29</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#0x09-2021%E5%AE%89%E6%B4%B5%E6%9D%AFcry3-1128"><span class="toc-number">12.</span> <span class="toc-text">0x09 2021 å®‰æ´µæ¯ cry3 11.28</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#0x08-2020%E7%BE%8A%E5%9F%8E%E6%9D%AFgmc-1124"><span class="toc-number">13.</span> <span class="toc-text">0x08 2020 ç¾ŠåŸæ¯ gmc 11.24</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#0x07-2021geekchallenge-step_by_step-1124"><span class="toc-number">14.</span> <span class="toc-text">0x07 2021Geekchallenge step_by_step 11.24</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#0x06-2021%E6%B9%96%E6%B9%98%E6%9D%AF-signin-1123"><span class="toc-number">15.</span> <span class="toc-text">0x06 2021 æ¹–æ¹˜æ¯ signin 11.23</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#0x05-2020%E7%BE%8A%E5%9F%8E%E6%9D%AF-rrrrrrrsa-1123"><span class="toc-number">16.</span> <span class="toc-text">0x05 2020 ç¾ŠåŸæ¯ RRRRRRRSA 11.23</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#0x04-%E7%9C%81%E8%B5%9Bcrypto2-1026"><span class="toc-number">17.</span> <span class="toc-text">0x04 çœèµ› crypto2 10.26</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#0x03-roxen-1025"><span class="toc-number">18.</span> <span class="toc-text">0x03 roXen 10.25</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#0x02-geek-challenge-2021-superposition_under_the_starry_sky-1016"><span class="toc-number">19.</span> <span class="toc-text">0x02 Geek Challenge 2021 Superposition_under_the_starry_sky 10.16</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#0x01-gkctf2021-rrrrsa-a-hrefhttpsfilesbuuojcnfilesd1b63e8c299922ae7f8db550dd0c81e2rar%E7%82%B9%E5%87%BB%E4%B8%8B%E8%BD%BDa"><span class="toc-number">20.</span> <span class="toc-text">0x01 GKCTF2021 RRRRsa ç‚¹å‡»ä¸‹è½½</span></a></li></ol></div><div class="related panel pjax" data-title="Related"></div><div class="overview panel" data-title="Overview"><div class="author" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="image" itemprop="image" alt="tsuppari" data-src="/images/head.jpg"><p class="name" itemprop="name">tsuppari</p><div class="description" itemprop="description"></div></div><nav class="state"><div class="item posts"><a href="/archives/"><span class="count">21</span> <span class="name">posts</span></a></div><div class="item tags"><a href="/tags/"><span class="count">8</span> <span class="name">tags</span></a></div></nav><div class="social"><span class="exturl item email" data-url="bWFpbHRvOjE2MjcxMDA3NDEwQHFxLmNvbQ==" title="mailto:16271007410@qq.com"><i class="ic i-envelope"></i></span> <span class="exturl item QQ" data-url="dGVuY2VudDovL01lc3NhZ2UvP1Vpbj0xNjI3MTAwNDEwJndlYnNpdGVOYW1lPXEtem9uZS5xcS5jb20mTWVudT15ZXM=" title="tencent:&#x2F;&#x2F;Message&#x2F;?Uin&#x3D;1627100410&amp;websiteName&#x3D;q-zone.qq.com&amp;Menu&#x3D;yes"><i class="ic i-qq"></i></span></div><ul class="menu"><li class="item"><a href="/" rel="section"><i class="ic i-home"></i>Home</a></li><li class="item"><a href="/about/" rel="section"><i class="ic i-user"></i>About</a></li><li class="item"><a href="/friends/" rel="section"><i class="ic i-heart"></i>friends</a></li></ul></div></div></div><ul id="quick"><li class="prev pjax"><a href="/2022/11/26/docker%E6%98%AF%E4%B8%AA%E8%82%BE%E4%B9%88%E7%8E%A9%E6%84%8F/" rel="prev" title="Previous Post"><i class="ic i-chevron-left"></i></a></li><li class="up"><i class="ic i-arrow-up"></i></li><li class="down"><i class="ic i-arrow-down"></i></li><li class="next pjax"><a href="/2199/04/13/crypto%E7%9A%84%E6%8C%A8%E6%89%93%E4%B9%8B%E8%B7%AF(%E4%BA%8C)/" rel="next" title="Next Post"><i class="ic i-chevron-right"></i></a></li><li class="percent"></li></ul></div></div><div class="dimmer"></div></div></main><footer id="footer"><div class="inner"><div class="widgets"><div class="rpost pjax"><h2>Random Posts</h2><ul><li class="item"><div class="breadcrumb"></div><span><a href="/2021/02/20/%E8%92%9F%E8%92%BB%E7%9A%84C%E7%AC%94%E8%AE%B0/" title="è’Ÿè’»çš„Cç¬”è®°">è’Ÿè’»çš„Cç¬”è®°</a></span></li><li class="item"><div class="breadcrumb"></div><span><a href="/2099/09/12/crypto%E7%9A%84%E6%8C%A8%E6%89%93%E4%B9%8B%E8%B7%AF(%E4%B8%80)/" title="cryptoçš„æŒ¨æ‰“ä¹‹è·¯ï¼ˆä¸€ï¼‰">cryptoçš„æŒ¨æ‰“ä¹‹è·¯ï¼ˆä¸€ï¼‰</a></span></li><li class="item"><div class="breadcrumb"></div><span><a href="/2021/07/14/%E8%92%9F%E8%92%BB%E7%9A%84pwn%E4%B9%8B%E8%B7%AF/" title="è’Ÿè’»çš„pwnä¹‹è·¯">è’Ÿè’»çš„pwnä¹‹è·¯</a></span></li><li class="item"><div class="breadcrumb"></div><span><a href="/2021/08/02/%E8%92%9F%E8%92%BB%E7%9A%84%E6%8C%A8%E6%89%93%E4%B9%8B%E8%B7%AF/" title="è’Ÿè’»çš„æŒ¨æ‰“ä¹‹è·¯">è’Ÿè’»çš„æŒ¨æ‰“ä¹‹è·¯</a></span></li><li class="item"><div class="breadcrumb"></div><span><a href="/2020/11/01/%E7%AC%AC%E4%B8%80%E7%AF%87%E5%8D%9A%E5%AE%A2/" title="ç¬¬ä¸€ç¯‡åšå®¢">ç¬¬ä¸€ç¯‡åšå®¢</a></span></li><li class="item"><div class="breadcrumb"></div><span><a href="/2021/06/21/%E7%A6%8F%E5%B7%9E%E5%88%92%E6%B0%B4%E5%B0%8F%E9%80%89%E6%89%8B/" title="ç¦å·åˆ’æ°´å°é€‰æ‰‹">ç¦å·åˆ’æ°´å°é€‰æ‰‹</a></span></li><li class="item"><div class="breadcrumb"></div><span><a href="/2021/12/20/2021%E5%B9%B4%E7%BB%88%E6%80%BB%E7%BB%93/" title="2021å¹´ç»ˆæ€»ç»“">2021å¹´ç»ˆæ€»ç»“</a></span></li><li class="item"><div class="breadcrumb"></div><span><a href="/2020/11/02/%E6%AD%A5%E5%85%A5CTF%E7%9A%84%E7%AC%AC%E4%B8%80%E5%A4%A9/" title="æ­¥å…¥CTFçš„ç¬¬ä¸€å¤©">æ­¥å…¥CTFçš„ç¬¬ä¸€å¤©</a></span></li><li class="item"><div class="breadcrumb"></div><span><a href="/2021/02/27/%E4%BA%8C%E7%BA%A7%E7%82%AE%E7%81%B0%E8%B7%AF/" title="äºŒçº§ç‚®ç°è·¯">äºŒçº§ç‚®ç°è·¯</a></span></li><li class="item"><div class="breadcrumb"></div><span><a href="/2021/01/25/%E7%B1%BB%E4%BC%BC%E4%BA%8E%E5%AD%A6%E6%9C%9F%E6%80%BB%E7%BB%93/" title="ç±»ä¼¼äºå­¦æœŸæ€»ç»“">ç±»ä¼¼äºå­¦æœŸæ€»ç»“</a></span></li></ul></div><div><h2>Recent Comments</h2><ul class="leancloud-recent-comment"></ul></div></div><div class="status"><div class="copyright">&copy; 2020 â€“ <span itemprop="copyrightYear">2022</span> <span class="with-love"><i class="ic i-sakura rotate"></i> </span><span class="author" itemprop="copyrightHolder">tsuppari @ T5uppari</span></div><div class="powered-by">Powered by <span class="exturl" data-url="aHR0cHM6Ly9oZXhvLmlv">Hexo</span> & Theme.<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2FtZWhpbWUvaGV4by10aGVtZS1zaG9rYQ==">Shoka</span></div></div></div></footer></div><script data-config type="text/javascript">var LOCAL={path:"2099/09/12/cryptoçš„æŒ¨æ‰“ä¹‹è·¯(ä¸€)/",favicon:{show:"ï¼ˆâ—Â´3ï½€â—ï¼‰Goooood",hide:"(Â´Ğ”ï½€)Booooom"},search:{placeholder:"Search for Posts",empty:"We didn't find any results for the search: ${query}",stats:"${hits} results found in ${time} ms"},valine:!0,fancybox:!0,copyright:'Copied to clipboard successfully! <br> All articles in this blog are licensed under <i class="ic i-creative-commons"></i>BY-NC-SA.',ignores:[function(e){return e.includes("#")},function(e){return new RegExp(LOCAL.path+"$").test(e)}]}</script><script src="https://cdn.polyfill.io/v2/polyfill.js"></script><script src="//cdn.jsdelivr.net/combine/npm/pace-js@1.0.2/pace.min.js,npm/pjax@0.2.8/pjax.min.js,npm/whatwg-fetch@3.4.0/dist/fetch.umd.min.js,npm/animejs@3.2.0/lib/anime.min.js,npm/algoliasearch@4/dist/algoliasearch-lite.umd.js,npm/instantsearch.js@4/dist/instantsearch.production.min.js,npm/lozad@1/dist/lozad.min.js,npm/quicklink@2/dist/quicklink.umd.js"></script><script src="/js/app.js?v=0.2.5"></script></body></html><!-- rebuild by hrmmi -->