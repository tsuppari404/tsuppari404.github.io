<!-- build time:Thu Sep 21 2023 19:46:11 GMT+0800 (中国标准时间) --><!DOCTYPE html><html lang="ja"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#FFF"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png"><link rel="icon" type="image/ico" sizes="32x32" href="/images/favicon.ico"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="alternate" type="application/rss+xml" title="蒟蒻的入土史" href="https://tsuppari404.github.io/rss.xml"><link rel="alternate" type="application/atom+xml" title="蒟蒻的入土史" href="https://tsuppari404.github.io/atom.xml"><link rel="alternate" type="application/json" title="蒟蒻的入土史" href="https://tsuppari404.github.io/feed.json"><link rel="stylesheet" href="//fonts.googleapis.com/css?family=Mulish:300,300italic,400,400italic,700,700italic%7CFredericka%20the%20Great:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20JP:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20SC:300,300italic,400,400italic,700,700italic%7CInconsolata:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext"><link rel="stylesheet" href="/css/app.css?v=0.2.5"><link rel="canonical" href="https://tsuppari404.github.io/2022/11/28/2022%E5%AE%89%E6%B4%B5%E6%9D%AFcrypto%E6%96%B9%E5%90%91writeup/"><title>2022安洵杯crypto方向writeup | T5uppari = 蒟蒻的入土史</title><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css"><meta name="generator" content="Hexo 6.0.0"></head><body itemscope itemtype="http://schema.org/WebPage"><div id="loading"><div class="cat"><div class="body"></div><div class="head"><div class="face"></div></div><div class="foot"><div class="tummy-end"></div><div class="bottom"></div><div class="legs left"></div><div class="legs right"></div></div><div class="paw"><div class="hands left"></div><div class="hands right"></div></div></div></div><div id="container"><header id="header" itemscope itemtype="http://schema.org/WPHeader"><div class="inner"><div id="brand"><div class="pjax"><h1 itemprop="name headline">2022安洵杯crypto方向writeup</h1><div class="meta"><span class="item" title="作成日：2022-11-28 16:00:40"><span class="icon"><i class="ic i-calendar"></i> </span><span class="text">投稿日</span> <time itemprop="dateCreated datePublished" datetime="2022-11-28T16:00:40+08:00">2022-11-28</time></span></div></div></div><nav id="nav"><div class="inner"><div class="toggle"><div class="lines" aria-label="ナビゲーションバーの切り替え"><span class="line"></span> <span class="line"></span> <span class="line"></span></div></div><ul class="menu"><li class="item title"><a href="/" rel="start">T5uppari</a></li></ul><ul class="right"><li class="item theme"><i class="ic i-sun"></i></li><li class="item search"><i class="ic i-search"></i></li></ul></div></nav></div><div id="imgs" class="pjax"><ul><li class="item" data-background-image="https://api.vvhan.com/api/acgimg?908467"></li><li class="item" data-background-image="https://api.vvhan.com/api/acgimg?937009"></li><li class="item" data-background-image="https://api.vvhan.com/api/acgimg?20059"></li><li class="item" data-background-image="https://api.vvhan.com/api/acgimg?407915"></li><li class="item" data-background-image="https://api.vvhan.com/api/acgimg?326094"></li><li class="item" data-background-image="https://api.vvhan.com/api/acgimg?968165"></li></ul></div></header><div id="waves"><svg class="waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z"/></defs><g class="parallax"><use xlink:href="#gentle-wave" x="48" y="0"/><use xlink:href="#gentle-wave" x="48" y="3"/><use xlink:href="#gentle-wave" x="48" y="5"/><use xlink:href="#gentle-wave" x="48" y="7"/></g></svg></div><main><div class="inner"><div id="main" class="pjax"><div class="article wrap"><div class="breadcrumb" itemscope itemtype="https://schema.org/BreadcrumbList"><i class="ic i-home"></i> <span><a href="/">ホーム</a></span></div><article itemscope itemtype="http://schema.org/Article" class="post block" lang="ja"><link itemprop="mainEntityOfPage" href="https://tsuppari404.github.io/2022/11/28/2022%E5%AE%89%E6%B4%B5%E6%9D%AFcrypto%E6%96%B9%E5%90%91writeup/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/head.jpg"><meta itemprop="name" content="tsuppari"><meta itemprop="description" content=", "></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="蒟蒻的入土史"></span><div class="body md" itemprop="articleBody"><p>趁着主办方环境还在 (11.28) 赛后将安洵杯三道题都复现了一遍，难度比较友好。赛后复现过程比较顺利于是水一篇 wp。</p><h3 id="cry1"><a class="anchor" href="#cry1">#</a> cry1</h3><p>一个猜数字的签到题，连进去之后硬猜就行了，多试几次就出了</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> itertools</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line">table = string.ascii_letters + string.digits</span><br><span class="line">context(log_level = <span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line">ip = <span class="string">&#x27;120.78.131.38&#x27;</span></span><br><span class="line">port = <span class="number">10001</span></span><br><span class="line">r = remote(ip,port)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">proof</span>():</span><br><span class="line">    r.recvuntil(<span class="string">b&#x27;SHA256(XXXX&#x27;</span>)</span><br><span class="line">    line = r.recvline()[:-<span class="number">1</span>].decode()</span><br><span class="line">    <span class="built_in">print</span>(line)</span><br><span class="line">    tmp = line[line.find(<span class="string">&#x27; + &#x27;</span>) + <span class="number">3</span>:line.find(<span class="string">&#x27;)&#x27;</span>)]</span><br><span class="line">    <span class="built_in">print</span>(tmp)</span><br><span class="line">    aim = line[line.find(<span class="string">&#x27;:&#x27;</span>) + <span class="number">1</span>:]</span><br><span class="line">    <span class="built_in">print</span>(aim)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> itertools.product(table,repeat=<span class="number">4</span>):</span><br><span class="line">        ans = <span class="string">&#x27;&#x27;</span>.join(i)</span><br><span class="line">        <span class="keyword">if</span> hashlib.sha256((ans + tmp).encode()).hexdigest() == aim:</span><br><span class="line">            <span class="built_in">print</span>(ans)</span><br><span class="line">            r.recvuntil(<span class="string">b&#x27;Give Me XXXX:\n&#x27;</span>)</span><br><span class="line">            r.sendline(ans.encode())</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">proof()</span><br><span class="line">r.recvuntil(<span class="string">b&quot;If you guessed right, I&#x27;ll give you the flag!, You only have 6 chances (1~20)\n&quot;</span>)</span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">6</span>):</span><br><span class="line">    num = random.randint(<span class="number">1</span>,<span class="number">20</span>)</span><br><span class="line">    r.send(<span class="built_in">str</span>(num).encode())</span><br><span class="line">    r.recvline()</span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure><h3 id="cry2"><a class="anchor" href="#cry2">#</a> cry2</h3><p>附件</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding:utf-8 -*-</span></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"><span class="keyword">import</span> socketserver</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&#x27;D0g3&#123;&#x27;</span> + <span class="string">&#x27;&#x27;</span>.join([random.choice(string.ascii_letters + string.digits) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">18</span>)]) + <span class="string">&#x27;&#125;&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MyServer</span>(socketserver.BaseRequestHandler):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">proof</span>(<span class="params">self</span>):</span><br><span class="line">        random.seed(os.urandom(<span class="number">8</span>))</span><br><span class="line">        random_str = <span class="string">&#x27;&#x27;</span>.join([random.choice(string.ascii_letters + string.digits) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">20</span>)])</span><br><span class="line">        str_sha256 = hashlib.sha256(random_str.encode()).hexdigest()</span><br><span class="line">        self.request.sendall((<span class="string">&#x27;SHA256(XXXX + %s):%s\n&#x27;</span> % (random_str[<span class="number">4</span>:], str_sha256)).encode())</span><br><span class="line">        self.request.sendall(<span class="string">&#x27;Give Me XXXX:\n&#x27;</span>.encode())</span><br><span class="line">        XXXX = self.request.recv(<span class="number">2048</span>).strip()</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> hashlib.sha256((XXXX + random_str[<span class="number">4</span>:].encode())).hexdigest() != str_sha256:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">pad</span>(<span class="params">self, message</span>):</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(message) % <span class="number">16</span> != <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">return</span> message.ljust((<span class="built_in">len</span>(message) // <span class="number">16</span> + <span class="number">1</span>) * <span class="number">16</span>, <span class="string">&#x27;0&#x27;</span>).encode()</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> message.encode()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">self, key, message</span>):</span><br><span class="line">        aes = AES.new(key, AES.MODE_ECB)</span><br><span class="line">        <span class="keyword">return</span> aes.encrypt(message)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">self, key, message</span>):</span><br><span class="line">        aes = AES.new(key, AES.MODE_ECB)</span><br><span class="line">        <span class="keyword">return</span> aes.decrypt(message)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">handle</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> self.proof():</span><br><span class="line">            self.request.sendall(<span class="string">b&#x27;Error Hash!&#x27;</span>)</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">        flag1, flag2 = flag[:<span class="number">8</span>], flag[<span class="number">8</span>:]</span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            self.request.sendall(<span class="string">&#x27;You can input anything:\n&#x27;</span>.encode())</span><br><span class="line">            iMessage = self.request.recv(<span class="number">2048</span>).strip().decode()</span><br><span class="line">            message = self.pad(flag1 + iMessage + flag2)</span><br><span class="line">            cipher = binascii.hexlify(self.encrypt(flag2.encode(), message))</span><br><span class="line">            self.request.sendall((<span class="string">&#x27;Here is your cipher: %s\n&#x27;</span> % cipher).encode())</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    sever = socketserver.ThreadingTCPServer((<span class="string">&#x27;0.0.0.0&#x27;</span>, <span class="number">10086</span>), MyServer)</span><br><span class="line">    sever.serve_forever()</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>主要逻辑在 handle 中。主要逻辑是我们输入 <code>iMessage</code> 变量，之后和 <code>flag1</code> 与 <code>flag2</code> 一起 pad，pad 函数用的不是库里面的函数，是题目自己写的，每次将输入的信息用 <code>0</code> 补齐为 16 长度的整数倍。注意 flag 被分成了两部分，第一部分 8 长度，第二部分 16 长度。</p><p>测试 pad 函数的作用 (flag 为自行生成的)</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">pad</span>(<span class="params">message</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(message) % <span class="number">16</span> != <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> message.ljust((<span class="built_in">len</span>(message) // <span class="number">16</span> + <span class="number">1</span>) * <span class="number">16</span>, <span class="string">&#x27;0&#x27;</span>).encode()</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> message.encode()</span><br><span class="line">flag = <span class="string">&#x27;D0g3&#123;ikq6HOskfLMKqJk825&#125;&#x27;</span></span><br><span class="line">flag1, flag2 = flag[:<span class="number">8</span>], flag[<span class="number">8</span>:]</span><br><span class="line">iMessage = <span class="string">&#x27;0000000&#x27;</span></span><br><span class="line">tmp = flag1 + iMessage + flag2</span><br><span class="line">p = pad(tmp)</span><br><span class="line">out = [p[i:i + <span class="number">16</span>] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(p),<span class="number">16</span>)]</span><br><span class="line"><span class="built_in">print</span>(out)</span><br><span class="line"><span class="comment">#[b&#x27;D0g3&#123;ikq00000006&#x27;, b&#x27;HOskfLMKqJk825&#125;0&#x27;]</span></span><br></pre></td></tr></table></figure><p>交互次数是无限，需要依靠我们构造 <code>iMessage</code> 变量进而得到 flag。 <code>flag2</code> 作为 AES 的密钥，置于 <code>iMessage</code> 的后半部分，其位置是可以根据我们输入而改变的，而 <code>flag1</code> 相对固定在前面。</p><p>第一次尝试，首先观察到 flag 头为 <code>D0g3&#123;</code> ，这就占据了 5 个长度，后面 <code>flag1</code> 剩下的三个长度可以尝试爆破。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">iMessage = <span class="string">&#x27;00000000D0g3&#123;xxx00000000&#x27;</span></span><br><span class="line"><span class="comment">#out = [b&#x27;D0g3&#123;ikq00000000&#x27;, b&#x27;D0g3&#123;xxx00000000&#x27;, b&#x27;6HOskfLMKqJk825&#125;&#x27;]</span></span><br></pre></td></tr></table></figure><p>其中 xxx 为爆破范围，这样可以得到 <code>flag1</code> 。但由于题目是交互的爆破的速度很慢，可以尝试多线程进行爆破，但是在比赛中并没有想到。</p><p>第二次尝试，从 <code>flag2</code> 入手，前面说了位置可变也就是说 <code>flag2</code> 可以单字节爆破。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">iMessage = <span class="string">&#x27;00000000&#x27;</span> + <span class="string">&#x27;000000000000000&#x27;</span> + <span class="string">&#x27;x&#x27;</span> + <span class="string">&#x27;000000000000000&#x27;</span></span><br><span class="line"><span class="comment">#out = [b&#x27;D0g3&#123;ikq00000000&#x27;, b&#x27;000000000000000x&#x27;, b&#x27;0000000000000006&#x27;, b&#x27;HOskfLMKqJk825&#125;0&#x27;]</span></span><br></pre></td></tr></table></figure><p>可以看出分块进行 AES 之后，第二块和第三块是可以进行爆破的，只需不断地改变第二块的的内容即可爆破出 <code>flag2</code> 的内容。</p><p>得到 <code>flag2</code> 之后将 <code>flag2</code> 作为密钥即可解得 <code>flag1</code></p><h4 id="exp"><a class="anchor" href="#exp">#</a> exp</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> itertools</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> tqdm</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> tqdm</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line">table = string.ascii_letters + string.digits</span><br><span class="line"><span class="comment"># context(log_level = &#x27;debug&#x27;)</span></span><br><span class="line">ip = <span class="string">&#x27;120.78.131.38&#x27;</span></span><br><span class="line">port = <span class="number">10086</span></span><br><span class="line">r = remote(ip,port)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">proof</span>():</span><br><span class="line">    r.recvuntil(<span class="string">b&#x27;SHA256(XXXX&#x27;</span>)</span><br><span class="line">    line = r.recvline()[:-<span class="number">1</span>].decode()</span><br><span class="line">    <span class="built_in">print</span>(line)</span><br><span class="line">    tmp = line[line.find(<span class="string">&#x27; + &#x27;</span>) + <span class="number">3</span>:line.find(<span class="string">&#x27;)&#x27;</span>)]</span><br><span class="line">    <span class="built_in">print</span>(tmp)</span><br><span class="line">    aim = line[line.find(<span class="string">&#x27;:&#x27;</span>) + <span class="number">1</span>:]</span><br><span class="line">    <span class="built_in">print</span>(aim)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> itertools.product(table,repeat=<span class="number">4</span>):</span><br><span class="line">        ans = <span class="string">&#x27;&#x27;</span>.join(i)</span><br><span class="line">        <span class="keyword">if</span> hashlib.sha256((ans + tmp).encode()).hexdigest() == aim:</span><br><span class="line">            <span class="built_in">print</span>(ans)</span><br><span class="line">            r.recvuntil(<span class="string">b&#x27;Give Me XXXX:\n&#x27;</span>)</span><br><span class="line">            r.sendline(ans.encode())</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">proof()</span><br><span class="line">fleg = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> tqdm(<span class="built_in">range</span>(<span class="number">1</span>,<span class="number">16</span>)):</span><br><span class="line">    <span class="keyword">for</span> t <span class="keyword">in</span> table:</span><br><span class="line">        payload = <span class="string">&#x27;0&#x27;</span> * <span class="number">8</span> + <span class="string">&#x27;0&#x27;</span> * (<span class="number">16</span> - i) + fleg + t + <span class="string">&#x27;0&#x27;</span> * (<span class="number">16</span> - i)</span><br><span class="line">        <span class="comment"># print(payload)</span></span><br><span class="line">        r.recvuntil(<span class="string">b&#x27;You can input anything:\n&#x27;</span>)</span><br><span class="line">        r.send(payload.encode())</span><br><span class="line">        r.recvuntil(<span class="string">b&quot;Here is your cipher: b&#x27;&quot;</span>)</span><br><span class="line">        cipher = r.recvuntil(<span class="string">b&quot;&#x27;&quot;</span>)[:-<span class="number">1</span>]</span><br><span class="line">        <span class="comment"># print(cipher)</span></span><br><span class="line">        p = [cipher[i : i + <span class="number">32</span>] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(cipher),<span class="number">32</span>)]</span><br><span class="line">        <span class="keyword">if</span> p[<span class="number">1</span>] == p[<span class="number">2</span>]:</span><br><span class="line">            fleg += t</span><br><span class="line">            <span class="built_in">print</span>(fleg)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">fleg += <span class="string">&#x27;&#125;&#x27;</span></span><br><span class="line">key = fleg.encode()</span><br><span class="line">cipher = <span class="built_in">bytes</span>.fromhex(<span class="string">&#x27;ee05ba9cf6a3fe5d0681741d0206e9ce7b287f063c78b2d1775af6b4d4768cca&#x27;</span>)<span class="comment">#输入全0第一部分</span></span><br><span class="line">aes = AES.new(key=key,mode=AES.MODE_ECB)</span><br><span class="line">flag1 = aes.decrypt(cipher)[:<span class="number">8</span>]</span><br><span class="line">flag = flag1 + key</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure><img data-src="/images/2022112801.png" width="80%" height="80%"><h3 id="cry3"><a class="anchor" href="#cry3">#</a> cry3</h3><p>附件</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> socketserver</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.Padding <span class="keyword">import</span> pad</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getPrime, bytes_to_long</span><br><span class="line"></span><br><span class="line">hint = <span class="string">&#x27;&#x27;</span></span><br><span class="line">flag = <span class="string">b&#x27;&#x27;</span></span><br><span class="line">key = os.urandom(<span class="number">16</span>)</span><br><span class="line"></span><br><span class="line">GOD = [<span class="string">b&#x27;Whitfield__Diffie&#x27;</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">message</span>):</span><br><span class="line">    message = pad(message, <span class="number">16</span>)</span><br><span class="line">    aes = AES.new(key, AES.MODE_CBC, iv=<span class="string">b&#x27;\x00&#x27;</span> * AES.block_size)</span><br><span class="line">    <span class="keyword">return</span> binascii.hexlify(aes.encrypt(message)[-<span class="number">16</span>:])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Authentication = encrypt(<span class="string">b&#x27;Whitfield__Diffie&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">CryptoPalace</span>(socketserver.StreamRequestHandler):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">proof1</span>(<span class="params">self</span>):</span><br><span class="line">        random.seed(os.urandom(<span class="number">8</span>))</span><br><span class="line">        random_str = <span class="string">&#x27;&#x27;</span>.join([random.choice(string.ascii_letters + string.digits) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">20</span>)])</span><br><span class="line">        str_sha256 = hashlib.sha256(random_str.encode()).hexdigest()</span><br><span class="line">        self.request.sendall((<span class="string">&#x27;SHA256(XXXX + %s):%s\n&#x27;</span> % (random_str[<span class="number">4</span>:], str_sha256)).encode())</span><br><span class="line">        self.request.sendall(<span class="string">&#x27;Give Me XXXX:\n&#x27;</span>.encode())</span><br><span class="line">        XXXX = self.request.recv(<span class="number">2048</span>).strip()</span><br><span class="line">        <span class="keyword">if</span> hashlib.sha256((XXXX + random_str[<span class="number">4</span>:].encode())).hexdigest() != str_sha256:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">proof2</span>(<span class="params">self</span>):</span><br><span class="line">        self.request.sendall(<span class="string">b&#x27;You must prove your identity to enter the palace &#x27;</span> + Authentication + <span class="string">b&#x27;\n--&gt; &#x27;</span>)</span><br><span class="line">        name = self.request.recv(<span class="number">1024</span>)</span><br><span class="line">        <span class="keyword">if</span> name <span class="keyword">in</span> GOD:</span><br><span class="line">            self.request.sendall(<span class="string">b&#x27;You are not him!\n&#x27;</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">        <span class="keyword">if</span> encrypt(name) != Authentication:</span><br><span class="line">            self.request.sendall(<span class="string">b&#x27;Wrong, try again......\n&#x27;</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            self.request.sendall(hint.encode() + <span class="string">b&quot;\n&quot;</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">DiffieEncrypt</span>(<span class="params">self</span>):</span><br><span class="line">        p, q = getPrime(<span class="number">1024</span>), getPrime(<span class="number">1024</span>)</span><br><span class="line">        E = [getPrime(<span class="number">512</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>)]</span><br><span class="line">        e1, e2, e3 = E[<span class="number">0</span>] * E[<span class="number">1</span>], E[<span class="number">0</span>] * E[<span class="number">2</span>], E[<span class="number">1</span>] * E[<span class="number">2</span>]</span><br><span class="line">        n = p * q</span><br><span class="line">        m = bytes_to_long(flag)</span><br><span class="line">        c1, c2, c3 = <span class="built_in">pow</span>(m, e1, p * q), <span class="built_in">pow</span>(m, e2, p * q), <span class="built_in">pow</span>(m, e3, p * q)</span><br><span class="line">        <span class="keyword">return</span> n, e1, e2, e3, c1, c2, c3</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">handle</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> self.proof1():</span><br><span class="line">            self.request.sendall(<span class="string">b&#x27;Error Hash!&#x27;</span>)</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> self.proof2():</span><br><span class="line">            self.request.sendall(<span class="string">b&#x27;You did not enter the palace\n&#x27;</span>)</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">        self.request.sendall(<span class="string">b&#x27;Flag has been encrypted by Diffie\n&#x27;</span>)</span><br><span class="line">        cipher = self.DiffieEncrypt()</span><br><span class="line">        self.request.sendall(<span class="built_in">str</span>(cipher).encode())</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ThreadedTCPServer</span>(socketserver.ThreadingMixIn, socketserver.TCPServer):</span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    host, port = <span class="string">&#x27;127.0.0.1&#x27;</span>, <span class="number">10010</span></span><br><span class="line">    server = ThreadedTCPServer((host, port), CryptoPalace)</span><br><span class="line">    ThreadedTCPServer.allow_reuse_address = <span class="literal">True</span></span><br><span class="line">    ThreadedTCPServer.allow_reuse_port = <span class="literal">True</span></span><br><span class="line">    server.serve_forever()</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>也是 AES 构造题，名字的长度为 17，刚好比一组多一点点，由于是 CBC 模式，多了一个异或。下图是 CBC 模式基本的逻辑。</p><img data-src="/images/2022112802.png" width="80%" height="80%"><p>观察 <code>encrypt</code> 函数，他只输出最后一组密文，也就是 16 长度，给出的 <code>Authentication</code> 是明文为 <code>Whitfield__Diffie</code> 的值，也就是第二块密文的值，两块明文分别为 <code>[b'Whitfield__Diffi',b'e\x0f\x0f\x0f\x0f\x0f\x0f\x0f\x0f\x0f\x0f\x0f\x0f\x0f\x0f\x0f']</code> ，只需构造一组 payload 让最后一组密文与 <code>Authentication</code> 相等即可。</p><p>由于是异或，于是想到再构造两组明文，使得在有 iv 的情况下与直接输入 <code>Whitfield__Diffie</code> 的值相同，即可得到 payload</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">tmp = <span class="built_in">bytes</span>.fromhex(<span class="string">&#x27;f95651580444fa622eacbccf9770b3ff&#x27;</span>)</span><br><span class="line">payload = <span class="string">b&#x27;Whitfield__Diffie&#x27;</span> + <span class="string">b&#x27;\x0f&#x27;</span> * <span class="number">15</span> + xor(<span class="string">b&#x27;Whitfield__Diffi&#x27;</span>,tmp) + <span class="string">b&#x27;e&#x27;</span></span><br></pre></td></tr></table></figure><p>过了 proof2，之后的共模就没什么问题了，缝合题实锤了</p><h4 id="exp1pass-proof2"><a class="anchor" href="#exp1pass-proof2">#</a> exp1(pass proof2)</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> itertools</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> tqdm</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> tqdm</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">table = string.ascii_letters + string.digits</span><br><span class="line"><span class="comment"># context(log_level = &#x27;debug&#x27;)</span></span><br><span class="line">ip = <span class="string">&#x27;120.78.131.38&#x27;</span></span><br><span class="line">port = <span class="number">10010</span></span><br><span class="line">r = remote(ip,port)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">proof</span>():</span><br><span class="line">    r.recvuntil(<span class="string">b&#x27;SHA256(XXXX&#x27;</span>)</span><br><span class="line">    line = r.recvline()[:-<span class="number">1</span>].decode()</span><br><span class="line">    <span class="built_in">print</span>(line)</span><br><span class="line">    tmp = line[line.find(<span class="string">&#x27; + &#x27;</span>) + <span class="number">3</span>:line.find(<span class="string">&#x27;)&#x27;</span>)]</span><br><span class="line">    <span class="built_in">print</span>(tmp)</span><br><span class="line">    aim = line[line.find(<span class="string">&#x27;:&#x27;</span>) + <span class="number">1</span>:]</span><br><span class="line">    <span class="built_in">print</span>(aim)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> itertools.product(table,repeat=<span class="number">4</span>):</span><br><span class="line">        ans = <span class="string">&#x27;&#x27;</span>.join(i)</span><br><span class="line">        <span class="keyword">if</span> hashlib.sha256((ans + tmp).encode()).hexdigest() == aim:</span><br><span class="line">            <span class="built_in">print</span>(ans)</span><br><span class="line">            r.recvuntil(<span class="string">b&#x27;Give Me XXXX:\n&#x27;</span>)</span><br><span class="line">            r.sendline(ans.encode())</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">proof()</span><br><span class="line">r.recvuntil(<span class="string">b&#x27;--&gt; &#x27;</span>)</span><br><span class="line">tmp = <span class="built_in">bytes</span>.fromhex(<span class="string">&#x27;f95651580444fa622eacbccf9770b3ff&#x27;</span>)</span><br><span class="line">payload = <span class="string">b&#x27;Whitfield__Diffie&#x27;</span> + <span class="string">b&#x27;\x0f&#x27;</span> * <span class="number">15</span> + xor(<span class="string">b&#x27;Whitfield__Diffi&#x27;</span>,tmp) + <span class="string">b&#x27;e&#x27;</span></span><br><span class="line"><span class="built_in">print</span>([payload[i:i + <span class="number">16</span>] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(payload),<span class="number">16</span>)])</span><br><span class="line">r.send(payload)</span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure><img data-src="/images/2022112803.png" width="80%" height="80%"><h4 id="exp2common-attack"><a class="anchor" href="#exp2common-attack">#</a> exp2(common attack)</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">commonattack</span>(<span class="params">n,e1,e2,c1,c2</span>):</span><br><span class="line">    ee,r,s = gmpy2.gcdext(e1,e2)</span><br><span class="line">    c = <span class="built_in">pow</span>(c1,r,n) * <span class="built_in">pow</span>(c2,s,n) % n</span><br><span class="line">    <span class="keyword">return</span> c,ee</span><br><span class="line"></span><br><span class="line">n,e1,e2,e3,c1,c2,c3 = (<span class="number">16486440901534735026079416493978454741894450403370110556952100122086322920105571130678250641915372185243929998120476723068695888574253004920214978656633731730934749677776991026227603288006133099065288831437504027746249576607479919237472214622575391394869006854656815062954603003816034710663602456213441098153480223142198387502026080500041270898650584914586278372694499229218974168098064855994816922143612998429807879165810732197097573046444802021890672546454283234079813058136359660986111588178104564665665995304715176338309871165836308611716088141650281105068996898382923846380193870192761814739770139653510966104751</span>, <span class="number">65802495601435430884014164157983149653203234623955505267125287361071963315770434981892489974384879593873475142501241145601723614323897723390501569002238572356829910984628103822201481335709487416159863618946979440659041547154114671899486525434770880129425262757246368430750708258408326309187727652234815585419</span>, <span class="number">84052869410714090640770403216113230839277321067057519586163704644665358725739224991736973759295254145044042178560300574832616468703956602526618738222660187695293011922181988315448711453435542605573956962547119211022419616008368704660669748535610493674183565028329838917447904176113207220156826317340699437593</span>, <span class="number">100371728547256384949982888634783641299739616870044358688489836785922608820763172440149617632810996373515955734547335005130521600356592560907659378731935960310234428511482927378131465278097987481799823820647036963781201324775423352332305006477403812596207497116554664505759556095955969342792848402226512368627</span>, <span class="number">15261004370119214706959515968030854191676456800616973538461959351992471464540836687005984690248717559047758489987075986638520702850349454321186989410905549534938155294092893987905452866242184643209787138089818105935430742879317741198594417901200437260065347672412023361258620469658844098562410561877333794386845203425148899503389833324831538953801957720002237277374463904872142541483848759043201174370604819350967351480308608451984840477429244165300686159356916664991123401159451171030927965396910313264155646628985987191742297420283292174316356246349668749837737731953899269189198217168274383101947026425204456838160</span>, <span class="number">71541617104238844958487883021039355278444019837455251172339485579078558869398357227856788593394214298852960639376075294395532407694214339231233954736459666326541522892558895015959786142034356758961868446449789420201526410878223759959717267639969116877402196009127044915222666560782895827404862951164041265622628489520482847258656360871516832377682501732333658245587098059235130566229239937380443671627999879470372170836594286189086444701729878229745439484364124684303687046151033508502467956620647993774042769260686510115761978384809134836689414925273265255556855227957345350020071650407106382453330165304050197474</span>, <span class="number">4766757679370684627017583733506550957309188382850543696266351427239582260983573264265386195971548917594018584776176071576579345048652554955857423115095296425367939489411211052506084195876524626560037042894405386200124478821492919219428968603842929228479615125568877310704339398411026343270768242395465278977326077353312529870220454930150817570343099012869314391994452805895801588178295809919103392518876039767473895127244168371888478145986283201565121940213119882431394835910683821456518678860431760302804169923498220501378863302643422731675387021209640484519081168169948208503539321061060436845781388861085417706035</span>)</span><br><span class="line"></span><br><span class="line">cc1,ee1 = commonattack(n,e1,e2,c1,c2)</span><br><span class="line">cc2,ee2 = commonattack(n,e1,e3,c1,c3)</span><br><span class="line">m,_ = commonattack(n,ee1,ee2,cc1,cc2)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line"><span class="comment">#b&#x27;D0g3&#123;New_3ra_@f_PK_Crypt0graphy_1976&#125;&#x27;</span></span><br></pre></td></tr></table></figure></div><footer><div class="meta"><span class="item"><span class="icon"><i class="ic i-calendar-check"></i> </span><span class="text">編集日</span> <time title="修正日：2022-11-28 17:08:09" itemprop="dateModified" datetime="2022-11-28T17:08:09+08:00">2022-11-28</time> </span><span id="2022/11/28/2022安洵杯crypto方向writeup/" class="item leancloud_visitors" data-flag-title="2022安洵杯crypto方向writeup" title="閲覧数"><span class="icon"><i class="ic i-eye"></i> </span><span class="text">閲覧数</span> <span class="leancloud-visitors-count"></span> <span class="text">回</span></span></div><div class="reward"><button><i class="ic i-heartbeat"></i> 寄付</button><p>*~(￣▽￣)~[お茶]を一杯ください</p><div id="qr"><div><img data-src="/images/Alipay.jpg" alt="tsuppari Alipay"><p>Alipay</p></div><div><img data-src="/images/WeChatpay.jpg" alt="tsuppari PayPal"><p>PayPal</p></div></div></div><div id="copyright"><ul><li class="author"><strong>著者： </strong>tsuppari <i class="ic i-at"><em>@</em></i>蒟蒻的入土史</li><li class="link"><strong>記事へのリンク：</strong> <a href="https://tsuppari404.github.io/2022/11/28/2022%E5%AE%89%E6%B4%B5%E6%9D%AFcrypto%E6%96%B9%E5%90%91writeup/" title="2022安洵杯crypto方向writeup">https://tsuppari404.github.io/2022/11/28/2022安洵杯crypto方向writeup/</a></li><li class="license"><strong>著作権表示： </strong>このブログ内のすべての記事は、特別な記載がない限り <span class="exturl" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9kZWVkLnpoLUNOLnltbA=="><i class="ic i-creative-commons"><em>(CC)</em></i>BY-NC-SA</span> の下のライセンスで保護されています。</li></ul></div></footer></article></div><div class="post-nav"><div class="item left"><a href="/2022/11/26/docker%E6%98%AF%E4%B8%AA%E8%82%BE%E4%B9%88%E7%8E%A9%E6%84%8F/" itemprop="url" rel="prev" data-background-image="https:&#x2F;&#x2F;api.vvhan.com&#x2F;api&#x2F;acgimg?843192" title="docker是个肾么玩意"><span class="type">前の記事</span> <span class="category"><i class="ic i-flag"></i></span><h3>docker是个肾么玩意</h3></a></div><div class="item right"><a href="/2022/12/20/%E7%94%BB%E4%B8%80%E4%B8%AA%E5%8F%A5%E5%8F%B7/" itemprop="url" rel="next" data-background-image="https:&#x2F;&#x2F;api.vvhan.com&#x2F;api&#x2F;acgimg?822034" title="画一个句号"><span class="type">次の記事</span> <span class="category"><i class="ic i-flag"></i></span><h3>画一个句号</h3></a></div></div><div class="wrap" id="comments"></div></div><div id="sidebar"><div class="inner"><div class="panels"><div class="inner"><div class="contents panel pjax" data-title="見出し"><ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#cry1"><span class="toc-number">1.</span> <span class="toc-text">cry1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#cry2"><span class="toc-number">2.</span> <span class="toc-text">cry2</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#exp"><span class="toc-number">2.1.</span> <span class="toc-text">exp</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#cry3"><span class="toc-number">3.</span> <span class="toc-text">cry3</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#exp1pass-proof2"><span class="toc-number">3.1.</span> <span class="toc-text">exp1(pass proof2)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#exp2common-attack"><span class="toc-number">3.2.</span> <span class="toc-text">exp2(common attack)</span></a></li></ol></li></ol></div><div class="related panel pjax" data-title="関連記事"></div><div class="overview panel" data-title="概要"><div class="author" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="image" itemprop="image" alt="tsuppari" data-src="/images/head.jpg"><p class="name" itemprop="name">tsuppari</p><div class="description" itemprop="description"></div></div><nav class="state"><div class="item posts"><a href="/archives/"><span class="count">20</span> <span class="name">ポスト</span></a></div><div class="item tags"><a href="/tags/"><span class="count">8</span> <span class="name">タグ</span></a></div></nav><div class="social"><span class="exturl item email" data-url="bWFpbHRvOjE2MjcxMDA3NDEwQHFxLmNvbQ==" title="mailto:16271007410@qq.com"><i class="ic i-envelope"></i></span> <span class="exturl item QQ" data-url="dGVuY2VudDovL01lc3NhZ2UvP1Vpbj0xNjI3MTAwNDEwJndlYnNpdGVOYW1lPXEtem9uZS5xcS5jb20mTWVudT15ZXM=" title="tencent:&#x2F;&#x2F;Message&#x2F;?Uin&#x3D;1627100410&amp;websiteName&#x3D;q-zone.qq.com&amp;Menu&#x3D;yes"><i class="ic i-qq"></i></span></div><ul class="menu"><li class="item"><a href="/" rel="section"><i class="ic i-home"></i>ホーム</a></li><li class="item"><a href="/about/" rel="section"><i class="ic i-user"></i>プロフィール</a></li><li class="item"><a href="/friends/" rel="section"><i class="ic i-heart"></i>friends</a></li></ul></div></div></div><ul id="quick"><li class="prev pjax"><a href="/2022/11/26/docker%E6%98%AF%E4%B8%AA%E8%82%BE%E4%B9%88%E7%8E%A9%E6%84%8F/" rel="prev" title="前の記事"><i class="ic i-chevron-left"></i></a></li><li class="up"><i class="ic i-arrow-up"></i></li><li class="down"><i class="ic i-arrow-down"></i></li><li class="next pjax"><a href="/2022/12/20/%E7%94%BB%E4%B8%80%E4%B8%AA%E5%8F%A5%E5%8F%B7/" rel="next" title="次の記事"><i class="ic i-chevron-right"></i></a></li><li class="percent"></li></ul></div></div><div class="dimmer"></div></div></main><footer id="footer"><div class="inner"><div class="widgets"><div class="rpost pjax"><h2>ランダムな記事</h2><ul><li class="item"><div class="breadcrumb"></div><span><a href="/2021/06/08/%E6%9D%82_%E9%9D%9E%E5%B8%B8%E6%9D%82/" title="杂_非常杂">杂_非常杂</a></span></li><li class="item"><div class="breadcrumb"></div><span><a href="/2020/11/01/%E7%AC%AC%E4%B8%80%E7%AF%87%E5%8D%9A%E5%AE%A2/" title="第一篇博客">第一篇博客</a></span></li><li class="item"><div class="breadcrumb"></div><span><a href="/2022/01/30/%E6%B5%85%E6%9E%90CRT/" title="浅析CRT">浅析CRT</a></span></li><li class="item"><div class="breadcrumb"></div><span><a href="/2022/12/20/%E7%94%BB%E4%B8%80%E4%B8%AA%E5%8F%A5%E5%8F%B7/" title="画一个句号">画一个句号</a></span></li><li class="item"><div class="breadcrumb"></div><span><a href="/2023/09/19/%E4%B8%80%E7%82%B9%E7%82%B9%E7%AC%94%E8%AE%B0/" title="一点点笔记">一点点笔记</a></span></li><li class="item"><div class="breadcrumb"></div><span><a href="/2022/02/28/Gauss/" title="Gauss">Gauss</a></span></li><li class="item"><div class="breadcrumb"></div><span><a href="/2022/11/28/2022%E5%AE%89%E6%B4%B5%E6%9D%AFcrypto%E6%96%B9%E5%90%91writeup/" title="2022安洵杯crypto方向writeup">2022安洵杯crypto方向writeup</a></span></li><li class="item"><div class="breadcrumb"></div><span><a href="/2299/01/30/crypto%E7%9A%84%E6%8C%A8%E6%89%93%E4%B9%8B%E8%B7%AF(%E9%80%80%E5%BD%B9%E7%89%88)/" title="crypto的挨打之路（退役版）">crypto的挨打之路（退役版）</a></span></li><li class="item"><div class="breadcrumb"></div><span><a href="/2021/07/14/%E8%92%9F%E8%92%BB%E7%9A%84pwn%E4%B9%8B%E8%B7%AF/" title="蒟蒻的pwn之路">蒟蒻的pwn之路</a></span></li><li class="item"><div class="breadcrumb"></div><span><a href="/2099/09/12/crypto%E7%9A%84%E6%8C%A8%E6%89%93%E4%B9%8B%E8%B7%AF(%E4%B8%80)/" title="crypto的挨打之路（一）">crypto的挨打之路（一）</a></span></li></ul></div><div><h2>最近のコメント</h2><ul class="leancloud-recent-comment"></ul></div></div><div class="status"><div class="copyright">&copy; 2020 – <span itemprop="copyrightYear">2023</span> <span class="with-love"><i class="ic i-sakura rotate"></i> </span><span class="author" itemprop="copyrightHolder">tsuppari @ T5uppari</span></div><div class="powered-by">Powered by <span class="exturl" data-url="aHR0cHM6Ly9oZXhvLmlv">Hexo</span> & Theme.<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2FtZWhpbWUvaGV4by10aGVtZS1zaG9rYQ==">Shoka</span></div></div></div></footer></div><script data-config type="text/javascript">var LOCAL={path:"2022/11/28/2022安洵杯crypto方向writeup/",favicon:{show:"（●´3｀●）やれやれだぜ",hide:"(´Д｀)大変だ！"},search:{placeholder:"検索…",empty:"「 ${query} 」については何も見つかりませんでした",stats:"${time} ms以内に ${hits} 件の結果が見つかりました"},valine:!0,fancybox:!0,copyright:"コピーは成功しました。 <br> 再印刷については、 ％s 契約に従ってください。",ignores:[function(e){return e.includes("#")},function(e){return new RegExp(LOCAL.path+"$").test(e)}]}</script><script src="https://cdn.polyfill.io/v2/polyfill.js"></script><script src="//cdn.jsdelivr.net/combine/npm/pace-js@1.0.2/pace.min.js,npm/pjax@0.2.8/pjax.min.js,npm/whatwg-fetch@3.4.0/dist/fetch.umd.min.js,npm/animejs@3.2.0/lib/anime.min.js,npm/algoliasearch@4/dist/algoliasearch-lite.umd.js,npm/instantsearch.js@4/dist/instantsearch.production.min.js,npm/lozad@1/dist/lozad.min.js,npm/quicklink@2/dist/quicklink.umd.js"></script><script src="/js/app.js?v=0.2.5"></script></body></html><!-- rebuild by hrmmi -->