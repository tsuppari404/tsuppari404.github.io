<!-- build time:Wed Sep 20 2023 19:29:56 GMT+0800 (中国标准时间) --><!DOCTYPE html><html><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#FFF"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png"><link rel="icon" type="image/ico" sizes="32x32" href="/images/favicon.ico"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="alternate" type="application/rss+xml" title="蒟蒻的入土史" href="https://tsuppari404.github.io/rss.xml"><link rel="alternate" type="application/atom+xml" title="蒟蒻的入土史" href="https://tsuppari404.github.io/atom.xml"><link rel="alternate" type="application/json" title="蒟蒻的入土史" href="https://tsuppari404.github.io/feed.json"><link rel="stylesheet" href="//fonts.googleapis.com/css?family=Mulish:300,300italic,400,400italic,700,700italic%7CFredericka%20the%20Great:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20JP:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20SC:300,300italic,400,400italic,700,700italic%7CInconsolata:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext"><link rel="stylesheet" href="/css/app.css?v=0.2.5"><meta name="keywords" content="学习,crypto"><link rel="canonical" href="https://tsuppari404.github.io/2299/01/30/crypto%E7%9A%84%E6%8C%A8%E6%89%93%E4%B9%8B%E8%B7%AF(%E9%80%80%E5%BD%B9%E7%89%88)/"><title>crypto的挨打之路（退役版） | T5uppari = 蒟蒻的入土史</title><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css"><meta name="generator" content="Hexo 6.0.0"></head><body itemscope itemtype="http://schema.org/WebPage"><div id="loading"><div class="cat"><div class="body"></div><div class="head"><div class="face"></div></div><div class="foot"><div class="tummy-end"></div><div class="bottom"></div><div class="legs left"></div><div class="legs right"></div></div><div class="paw"><div class="hands left"></div><div class="hands right"></div></div></div></div><div id="container"><header id="header" itemscope itemtype="http://schema.org/WPHeader"><div class="inner"><div id="brand"><div class="pjax"><h1 itemprop="name headline">crypto的挨打之路（退役版）</h1><div class="meta"><span class="item" title="Created: 2299-01-30 14:16:31"><span class="icon"><i class="ic i-calendar"></i> </span><span class="text">Posted on</span> <time itemprop="dateCreated datePublished" datetime="2299-01-30T14:16:31+08:00">2299-01-30</time></span></div></div></div><nav id="nav"><div class="inner"><div class="toggle"><div class="lines" aria-label="Toggle navigation bar"><span class="line"></span> <span class="line"></span> <span class="line"></span></div></div><ul class="menu"><li class="item title"><a href="/" rel="start">T5uppari</a></li></ul><ul class="right"><li class="item theme"><i class="ic i-sun"></i></li><li class="item search"><i class="ic i-search"></i></li></ul></div></nav></div><div id="imgs" class="pjax"><img src="https://i.loli.net/2020/10/30/qAMYEFXxJcKRsiG.gif"></div></header><div id="waves"><svg class="waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z"/></defs><g class="parallax"><use xlink:href="#gentle-wave" x="48" y="0"/><use xlink:href="#gentle-wave" x="48" y="3"/><use xlink:href="#gentle-wave" x="48" y="5"/><use xlink:href="#gentle-wave" x="48" y="7"/></g></svg></div><main><div class="inner"><div id="main" class="pjax"><div class="article wrap"><div class="breadcrumb" itemscope itemtype="https://schema.org/BreadcrumbList"><i class="ic i-home"></i> <span><a href="/">Home</a></span></div><article itemscope itemtype="http://schema.org/Article" class="post block" lang="default"><link itemprop="mainEntityOfPage" href="https://tsuppari404.github.io/2299/01/30/crypto%E7%9A%84%E6%8C%A8%E6%89%93%E4%B9%8B%E8%B7%AF(%E9%80%80%E5%BD%B9%E7%89%88)/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/head.jpg"><meta itemprop="name" content="tsuppari"><meta itemprop="description" content=", "></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="蒟蒻的入土史"></span><div class="body md" itemprop="articleBody"><p>2023.1.30，退役篇，最后随缘更新20题了</p><span id="more"></span><h4 id="0x0b-from-rec-matrix_e-913"><a class="markdownIt-Anchor" href="#0x0b-from-rec-matrix_e-913"></a> 0x0B from rec matrix_e 9.13</h4><p>附件</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env sage</span></span><br><span class="line"><span class="comment"># Problem by rec, with nothing.</span></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> secret</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getPrime</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.Padding <span class="keyword">import</span> pad</span><br><span class="line"></span><br><span class="line">LEN = <span class="number">32</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">xor</span>(<span class="params">a, b</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">bytes</span>([a[i%<span class="built_in">len</span>(a)] ^^ b[i%<span class="built_in">len</span>(b)] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">max</span>(<span class="built_in">len</span>(a), <span class="built_in">len</span>(b)))])</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">challenge</span>(<span class="params">m: <span class="built_in">bytes</span>, pbits: <span class="built_in">int</span>, level: <span class="built_in">int</span>=<span class="number">0</span></span>):</span><br><span class="line">    p = getPrime(pbits)</span><br><span class="line">    M = random_matrix(GF(p), LEN).matrix_from_rows_and_columns(<span class="built_in">range</span>(LEN), <span class="built_in">range</span>(LEN-level))</span><br><span class="line">    c = vector(GF(p), m) * M</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> &#123;<span class="string">&quot;p&quot;</span>: p, <span class="string">&quot;M&quot;</span>: M.<span class="built_in">list</span>(), <span class="string">&quot;c&quot;</span>: c.<span class="built_in">list</span>()&#125;</span><br><span class="line"></span><br><span class="line">args = &#123;</span><br><span class="line">    <span class="string">&quot;chall1&quot;</span>: &#123;</span><br><span class="line">        <span class="string">&quot;m&quot;</span>: os.urandom(LEN),</span><br><span class="line">        <span class="string">&quot;pbits&quot;</span>: <span class="number">512</span>,</span><br><span class="line">        <span class="string">&quot;level&quot;</span>: <span class="number">0x00</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="string">&quot;chall2&quot;</span>: &#123;</span><br><span class="line">        <span class="string">&quot;m&quot;</span>: os.urandom(LEN),</span><br><span class="line">        <span class="string">&quot;pbits&quot;</span>: <span class="number">10</span>,</span><br><span class="line">        <span class="string">&quot;level&quot;</span>: <span class="number">0x01</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="string">&quot;chall3&quot;</span>: &#123;</span><br><span class="line">        <span class="string">&quot;m&quot;</span>: os.urandom(LEN),</span><br><span class="line">        <span class="string">&quot;pbits&quot;</span>: <span class="number">256</span>,</span><br><span class="line">        <span class="string">&quot;level&quot;</span>: <span class="number">0x10</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">out = <span class="built_in">dict</span>()</span><br><span class="line">enc = pad(secret.flag, LEN)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>):</span><br><span class="line">    out[<span class="string">f&quot;chall<span class="subst">&#123;i+<span class="number">1</span>&#125;</span>&quot;</span>] = challenge(**args[<span class="string">f&quot;chall<span class="subst">&#123;i+<span class="number">1</span>&#125;</span>&quot;</span>])</span><br><span class="line">    enc = xor(enc, hashlib.sha512(args[<span class="string">f&quot;chall<span class="subst">&#123;i+<span class="number">1</span>&#125;</span>&quot;</span>][<span class="string">&quot;m&quot;</span>]).digest())</span><br><span class="line">out[<span class="string">&quot;enc&quot;</span>] = enc.<span class="built_in">hex</span>()</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;output.txt&#x27;</span>, <span class="string">&#x27;w&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f.write(<span class="string">f&quot;<span class="subst">&#123;out = &#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure><p>总能从rec大佬的题里学到很多！</p><p>题目分为三部分，都是涉及到矩阵乘法，一部分一部分分别看吧</p><p>第一部分，<strong>32长度的向量m乘上32*32的矩阵M得到32长度的向量c</strong></p><p>没啥说法，直接矩阵求逆即可</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#chall1</span></span><br><span class="line">data = &#123;<span class="string">&quot;p&quot;</span>: p, <span class="string">&quot;M&quot;</span>: M.<span class="built_in">list</span>(), <span class="string">&quot;c&quot;</span>: c.<span class="built_in">list</span>()&#125;</span><br><span class="line">p = data[<span class="string">&#x27;p&#x27;</span>]</span><br><span class="line">M = data[<span class="string">&#x27;M&#x27;</span>]</span><br><span class="line">c = data[<span class="string">&#x27;c&#x27;</span>]</span><br><span class="line">c = vector(GF(p),c)</span><br><span class="line">M = [M[i:i + <span class="number">32</span>] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(M),<span class="number">32</span>)]</span><br><span class="line">M = matrix(GF(p),M)</span><br><span class="line"></span><br><span class="line">m = c * M.inverse()</span><br><span class="line"><span class="built_in">print</span>(m)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>(m))</span><br><span class="line"><span class="comment">#(217, 220, 57, 174, 24, 89, 132, 130, 40, 56, 42, 134, 44, 31, 52, 244, 80, 57, 169, 240, 71, 19, 73, 92, 142, 118, 147, 184, 215, 105, 6, 40)</span></span><br><span class="line"><span class="comment">#d9dc39ae1859848228382a862c1f34f45039a9f04713495c8e7693b8d7690628</span></span><br></pre></td></tr></table></figure><p>第二部分，<strong>32长度的向量m乘上32*31的矩阵M得到31长度的向量c</strong></p><p>只差了一位，可以直接爆破向量m的最后一位，在(0,256)的范围，之后将这一位所作的运算减到向量c里面，再对31*31的矩阵求逆，用得到的向量m是否都为(0,256)来进行判断即可</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#chall2</span></span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> tqdm</span><br><span class="line">data = &#123;<span class="string">&quot;p&quot;</span>: p, <span class="string">&quot;M&quot;</span>: M.<span class="built_in">list</span>(), <span class="string">&quot;c&quot;</span>: c.<span class="built_in">list</span>()&#125;</span><br><span class="line">p = data[<span class="string">&#x27;p&#x27;</span>]</span><br><span class="line">M = data[<span class="string">&#x27;M&#x27;</span>]</span><br><span class="line">c = data[<span class="string">&#x27;c&#x27;</span>]</span><br><span class="line">M = [M[i:i + <span class="number">31</span>] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(M),<span class="number">31</span>)]</span><br><span class="line">mat = matrix(GF(p),M[:-<span class="number">1</span>])</span><br><span class="line"><span class="keyword">for</span> key <span class="keyword">in</span> tqdm(<span class="built_in">range</span>(<span class="number">256</span>)):</span><br><span class="line">    M = data[<span class="string">&#x27;M&#x27;</span>]</span><br><span class="line">    cc = data[<span class="string">&#x27;c&#x27;</span>]</span><br><span class="line">    M = [M[i:i + <span class="number">31</span>] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(M),<span class="number">31</span>)]</span><br><span class="line">    cc = vector(GF(p),cc)</span><br><span class="line">    cc = cc - key * vector(GF(p),M[-<span class="number">1</span>])</span><br><span class="line">    M = matrix(GF(p),M[:-<span class="number">1</span>])</span><br><span class="line">    m = cc * M.inverse()</span><br><span class="line">    numlist = <span class="built_in">list</span>(m) + [key]</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">all</span>(num &lt;= <span class="number">256</span> <span class="keyword">for</span> num <span class="keyword">in</span> numlist):</span><br><span class="line">        <span class="comment">#print(numlist,cc,M)</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">bytes</span>(numlist).<span class="built_in">hex</span>())</span><br><span class="line">        <span class="comment">#966865a39e934abd1bf22cf32aa279702add8ac172bdfc252dfc6b17b418ee47</span></span><br></pre></td></tr></table></figure><p>第三部分，<strong>32长度的向量m乘上32*16的矩阵M得到16长度的向量c</strong></p><p>有点像背包算法，将等式写出可以发现<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>m</mi><mn>1</mn></msub><msub><mi>a</mi><mn>1</mn></msub><mo>+</mo><msub><mi>m</mi><mn>2</mn></msub><msub><mi>a</mi><mn>2</mn></msub><mo>+</mo><mi>k</mi><mi>p</mi><mo>−</mo><mi>c</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">m_1a_1+m_2a_2+kp-c=0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.73333em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathdefault">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.73333em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathdefault">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.8888799999999999em;vertical-align:-.19444em"></span><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="mord mathdefault">p</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord mathdefault">c</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">0</span></span></span></span>，m的范围在(0,256)，p和c已知，m很小，构造49*49的格子得到</p><p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mo fence="true">[</mo><mtable rowspacing="0.15999999999999992em" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mi>m</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi>k</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mrow><mo fence="true">[</mo><mtable rowspacing="0.15999999999999992em" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi>M</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi>p</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi>c</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mrow><mo fence="true">[</mo><mtable rowspacing="0.15999999999999992em" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mi>m</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex">\begin{bmatrix} {m}&amp;k&amp;1 \end{bmatrix} \begin{bmatrix} 1&amp;M&amp; \\ &amp;p&amp; \\ &amp;c&amp;1 \end{bmatrix} \begin{bmatrix} m&amp;0&amp;1 \end{bmatrix}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:3.60004em;vertical-align:-1.55002em"></span><span class="minner"><span class="mopen delimcenter" style="top:0"><span class="delimsizing size1">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.8500000000000001em"><span style="top:-3.01em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">m</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.35000000000000003em"><span></span></span></span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.8500000000000001em"><span style="top:-3.01em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.35000000000000003em"><span></span></span></span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.8500000000000001em"><span style="top:-3.01em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.35000000000000003em"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0"><span class="delimsizing size1">]</span></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05002em"><span style="top:-2.2500000000000004em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎣</span></span></span><span style="top:-4.05002em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎡</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.55002em"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em"><span style="top:-4.21em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">1</span></span></span><span style="top:-3.0099999999999993em"><span class="pstrut" style="height:3em"></span><span class="mord"></span></span><span style="top:-1.8099999999999994em"><span class="pstrut" style="height:3em"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.5500000000000007em"><span></span></span></span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em"><span style="top:-4.21em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.10903em">M</span></span></span><span style="top:-3.0099999999999993em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">p</span></span></span><span style="top:-1.8099999999999994em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">c</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.5500000000000007em"><span></span></span></span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em"><span style="top:-4.21em"><span class="pstrut" style="height:3em"></span><span class="mord"></span></span><span style="top:-3.0099999999999993em"><span class="pstrut" style="height:3em"></span><span class="mord"></span></span><span style="top:-1.8099999999999994em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.5500000000000007em"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05002em"><span style="top:-2.2500000000000004em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎦</span></span></span><span style="top:-4.05002em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎤</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.55002em"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="minner"><span class="mopen delimcenter" style="top:0"><span class="delimsizing size1">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.8500000000000001em"><span style="top:-3.01em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.35000000000000003em"><span></span></span></span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.8500000000000001em"><span style="top:-3.01em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.35000000000000003em"><span></span></span></span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.8500000000000001em"><span style="top:-3.01em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.35000000000000003em"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0"><span class="delimsizing size1">]</span></span></span></span></span></span></span></p><p>M为题目给出的32*16的矩阵，p放置斜对角，c放最后一行，这样右边可以得到0，格基规约后就可以得到我们想要的向量<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo stretchy="false">(</mo><mi>m</mi><mo separator="true">,</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(m,0,1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord mathdefault">m</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">data = &#123;<span class="string">&quot;p&quot;</span>: p, <span class="string">&quot;M&quot;</span>: M.<span class="built_in">list</span>(), <span class="string">&quot;c&quot;</span>: c.<span class="built_in">list</span>()&#125;</span><br><span class="line">p = data[<span class="string">&#x27;p&#x27;</span>]</span><br><span class="line">M = data[<span class="string">&#x27;M&#x27;</span>]</span><br><span class="line">c = data[<span class="string">&#x27;c&#x27;</span>]</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(c))</span><br><span class="line">m = <span class="built_in">list</span>(<span class="built_in">bytes</span>.fromhex(<span class="string">&#x27;9cc4498a21d9bebfd9798205f21d620dc86278e475b31cd01c8fae85c39028a9&#x27;</span>))</span><br><span class="line">M = [M[i:i + <span class="number">16</span>] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(M),<span class="number">16</span>)]</span><br><span class="line">mat = [[<span class="number">0</span> <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">49</span>)] <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">49</span>)]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line">    mat[i][i] = <span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>,<span class="number">48</span>):</span><br><span class="line">        mat[i][j] = M[i][j - <span class="number">32</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>,<span class="number">48</span>):</span><br><span class="line">    mat[i][i] = p</span><br><span class="line">    mat[-<span class="number">1</span>][i] = c[i - <span class="number">32</span>]</span><br><span class="line">mat[-<span class="number">1</span>][-<span class="number">1</span>] = <span class="number">1</span></span><br><span class="line">mat = matrix(ZZ,mat)</span><br><span class="line">ans = mat.LLL()[<span class="number">0</span>].<span class="built_in">list</span>()</span><br><span class="line"><span class="built_in">print</span>(mat.LLL())</span><br><span class="line">m = [<span class="built_in">int</span>(<span class="built_in">abs</span>(i)) <span class="keyword">for</span> i <span class="keyword">in</span> ans[:<span class="number">32</span>]]</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>(m).<span class="built_in">hex</span>())</span><br><span class="line"><span class="comment">#1190f7db6972605611dc8c28672e66c201369a8f467391d3149d638397274a6d</span></span><br></pre></td></tr></table></figure><p>格基规约第一行就是向量<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo stretchy="false">(</mo><mi>m</mi><mo separator="true">,</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(m,0,1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord mathdefault">m</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span></p><p>最后按照题目逻辑sha512完了异或即可</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">from</span> functools <span class="keyword">import</span> reduce</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">hashkey</span>(<span class="params">m</span>):</span><br><span class="line">    <span class="keyword">return</span> hashlib.sha512(<span class="built_in">bytes</span>.fromhex(m)).digest()</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">xor</span>(<span class="params">a, b</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">bytes</span>([a[i%<span class="built_in">len</span>(a)] ^^ b[i%<span class="built_in">len</span>(b)] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">max</span>(<span class="built_in">len</span>(a), <span class="built_in">len</span>(b)))])</span><br><span class="line">key1 = <span class="string">&#x27;d9dc39ae1859848228382a862c1f34f45039a9f04713495c8e7693b8d7690628&#x27;</span></span><br><span class="line">key2 = <span class="string">&#x27;966865a39e934abd1bf22cf32aa279702add8ac172bdfc252dfc6b17b418ee47&#x27;</span></span><br><span class="line">key3 = <span class="string">&#x27;1190f7db6972605611dc8c28672e66c201369a8f467391d3149d638397274a6d&#x27;</span></span><br><span class="line">key1,key2,key3 = hashkey(key1),hashkey(key2),hashkey(key3)</span><br><span class="line">enc = <span class="string">&#x27;72c0e8ef53c726969a91368ca600a081f38f5cfaa1d0669d9049f278fb2f0fb4f36dced86bf9b7e9ef59af082cc5a5b2458cae490ab23c0c8c5b9361499ae2e2&#x27;</span></span><br><span class="line">enc = <span class="built_in">bytes</span>.fromhex(enc)</span><br><span class="line">flag = reduce(xor,[key1,key2,key3,enc])</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure><h4 id="0x0a-2023bluehat-dhrsa-827"><a class="markdownIt-Anchor" href="#0x0a-2023bluehat-dhrsa-827"></a> 0x0A 2023bluehat DHRSA 8.27</h4><p>附件</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># sage</span></span><br><span class="line"><span class="keyword">from</span> sage.<span class="built_in">all</span> <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getPrime,getStrongPrime, isPrime, bytes_to_long</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> r,g</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> r.bit_length() == <span class="number">512</span> <span class="keyword">and</span> isPrime(r)</span><br><span class="line">FLAG = bytes_to_long(flag)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gen_DH_key</span>(<span class="params">g,r</span>):</span><br><span class="line">    x = randint(<span class="number">2</span>,r-<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">return</span> x, <span class="built_in">pow</span>(g,x,r)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gen_RSA_parameters</span>(<span class="params">g,r</span>):</span><br><span class="line">    main_key = gen_DH_key(g,r)</span><br><span class="line">    sub_key = gen_DH_key(g,r)</span><br><span class="line">    x, X = main_key</span><br><span class="line">    w, W = sub_key</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;[+] Public DH Keys <span class="subst">&#123; X = &#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;[+] Public DH Keys <span class="subst">&#123; W = &#125;</span>&quot;</span>)</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        c, C = gen_DH_key(g,r)</span><br><span class="line">        t1 = randint(<span class="number">0</span>,<span class="number">1</span>)</span><br><span class="line">        t2 = randint(<span class="number">0</span>,<span class="number">1</span>)</span><br><span class="line">        p = ZZ(C * W^t1 * <span class="built_in">pow</span>(X, c, r) % r)</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> is_prime(p):</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        q = ZZ(<span class="built_in">pow</span>(W, -t2, r) * <span class="built_in">pow</span>(X, -c, r) % r)</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> is_prime(q):</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;[+] Try <span class="subst">&#123;c ,C&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        <span class="keyword">return</span> p,q</span><br><span class="line">    </span><br><span class="line">p, q = gen_RSA_parameters(g,r)</span><br><span class="line">n = p*q</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">c = <span class="built_in">pow</span>(FLAG,e,n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123; c = &#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123; n = &#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure><p>观察题目，变量都是通过以下函数生成</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">gen_DH_key</span>(<span class="params">g,r</span>):</span><br><span class="line">    x = randint(<span class="number">2</span>,r-<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">return</span> x, <span class="built_in">pow</span>(g,x,r)</span><br></pre></td></tr></table></figure><p>通过后面的try给出的c，有式子<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>C</mi><mo>≡</mo><msup><mi>g</mi><mi>c</mi></msup><mtext></mtext><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mtext></mtext><mi>n</mi></mrow><annotation encoding="application/x-tex">C \equiv g^c \bmod n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.68333em;vertical-align:0"></span><span class="mord mathdefault" style="margin-right:.07153em">C</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">≡</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.8888799999999999em;vertical-align:-.19444em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">g</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.664392em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">c</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mspace" style="margin-right:.05555555555555555em"></span><span class="mbin"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mspace" style="margin-right:.05555555555555555em"></span></span><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord mathdefault">n</span></span></span></span>可以进行尝试构造格子，只需找到一组合适的系数<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.69444em;vertical-align:0"></span><span class="mord mathdefault" style="margin-right:.03148em">k</span></span></span></span>使得<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></msubsup><msub><mi>k</mi><mi>i</mi></msub><msub><mi>c</mi><mi>i</mi></msub><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\sum_{i=1}^nk_ic_i=0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.104002em;vertical-align:-.29971000000000003em"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-.0000050000000000050004em">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.804292em"><span style="top:-2.40029em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.29971000000000003em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">0</span></span></span></span>，其中系数k有正有负。这样就有<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>g</mi><mrow><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></msubsup><msub><mi>k</mi><mi>i</mi></msub><msub><mi>c</mi><mi>i</mi></msub></mrow></msup><mo>=</mo><mn>1</mn><mtext></mtext><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mtext></mtext><mi>n</mi></mrow><annotation encoding="application/x-tex">g^{\sum_{i=1}^nk_ic_i}=1 \bmod n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0824399999999998em;vertical-align:-.19444em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">g</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8879999999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mop mtight"><span class="mop op-symbol small-op mtight" style="position:relative;top:-.0000050000000000050004em">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.7385428571428572em"><span style="top:-2.1785614285714283em;margin-left:0;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-2.931em;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.32143857142857146em"><span></span></span></span></span></span></span><span class="mspace mtight" style="margin-right:.19516666666666668em"></span><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3280857142857143em"><span style="top:-2.357em;margin-left:-.03148em;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.143em"><span></span></span></span></span></span></span><span class="mord mtight"><span class="mord mathdefault mtight">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3280857142857143em"><span style="top:-2.357em;margin-left:0;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.143em"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.69444em;vertical-align:0"></span><span class="mord">1</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mspace" style="margin-right:.05555555555555555em"></span><span class="mbin"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mspace" style="margin-right:.05555555555555555em"></span></span><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord mathdefault">n</span></span></span></span>，同过格基规约可以找到我们想要的系数，格子如下</p><p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mo fence="true">[</mo><mtable rowspacing="0.15999999999999992em" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>k</mi><mn>1</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>k</mi><mn>2</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>k</mi><mn>3</mn></msub></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mrow><mo fence="true">[</mo><mtable rowspacing="0.15999999999999992em" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>N</mi><msub><mi>c</mi><mn>1</mn></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>N</mi><msub><mi>c</mi><mn>2</mn></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>N</mi><msub><mi>c</mi><mn>3</mn></msub></mrow></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mrow><mo fence="true">[</mo><mtable rowspacing="0.15999999999999992em" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>k</mi><mn>1</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>k</mi><mn>2</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>k</mi><mn>3</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex">\begin{bmatrix} {k_1}&amp;{k_2}&amp;{k_3} \end{bmatrix} \begin{bmatrix} 1&amp;0&amp;0&amp;Nc_1\\ 0&amp;1&amp;0&amp;Nc_2\\ 0&amp;0&amp;1&amp;Nc_3\\ \end{bmatrix} \begin{bmatrix} {k_1}&amp;{k_2}&amp;{k_3}&amp;0 \end{bmatrix}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:3.60004em;vertical-align:-1.55002em"></span><span class="minner"><span class="mopen delimcenter" style="top:0"><span class="delimsizing size1">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.8500000000000001em"><span style="top:-3.01em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.35000000000000003em"><span></span></span></span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.8500000000000001em"><span style="top:-3.01em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.35000000000000003em"><span></span></span></span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.8500000000000001em"><span style="top:-3.01em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.35000000000000003em"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0"><span class="delimsizing size1">]</span></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05002em"><span style="top:-2.2500000000000004em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎣</span></span></span><span style="top:-4.05002em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎡</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.55002em"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em"><span style="top:-4.21em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">1</span></span></span><span style="top:-3.0099999999999993em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-1.8099999999999994em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.5500000000000007em"><span></span></span></span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em"><span style="top:-4.21em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-3.0099999999999993em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">1</span></span></span><span style="top:-1.8099999999999994em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.5500000000000007em"><span></span></span></span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em"><span style="top:-4.21em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-3.0099999999999993em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-1.8099999999999994em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.5500000000000007em"><span></span></span></span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em"><span style="top:-4.21em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.10903em">N</span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span style="top:-3.0099999999999993em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.10903em">N</span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span style="top:-1.8099999999999994em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.10903em">N</span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.5500000000000007em"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05002em"><span style="top:-2.2500000000000004em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎦</span></span></span><span style="top:-4.05002em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎤</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.55002em"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="minner"><span class="mopen delimcenter" style="top:0"><span class="delimsizing size1">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.8500000000000001em"><span style="top:-3.01em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.35000000000000003em"><span></span></span></span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.8500000000000001em"><span style="top:-3.01em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.35000000000000003em"><span></span></span></span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.8500000000000001em"><span style="top:-3.01em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.35000000000000003em"><span></span></span></span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.8500000000000001em"><span style="top:-3.01em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.35000000000000003em"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0"><span class="delimsizing size1">]</span></span></span></span></span></span></span></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sage.<span class="built_in">all</span> <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> functools <span class="keyword">import</span> reduce</span><br><span class="line">data = <span class="built_in">open</span>(<span class="string">&#x27;out.txt&#x27;</span>,<span class="string">&#x27;r&#x27;</span>).read().splitlines()[<span class="number">2</span>:-<span class="number">2</span>]</span><br><span class="line">ee = []</span><br><span class="line">cc = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> data:</span><br><span class="line">    line = i.replace(<span class="string">&#x27;[+] Try (&#x27;</span>,<span class="string">&#x27;&#x27;</span>).replace(<span class="string">&#x27;)&#x27;</span>,<span class="string">&#x27;&#x27;</span>).split(<span class="string">&#x27;, &#x27;</span>)</span><br><span class="line">    e,c = <span class="built_in">list</span>(<span class="built_in">map</span>(<span class="built_in">int</span>,line))</span><br><span class="line">    ee.append(e)</span><br><span class="line">    cc.append(c)</span><br><span class="line">l = <span class="built_in">len</span>(ee)</span><br><span class="line">pad = <span class="number">2</span> ** <span class="number">12</span></span><br><span class="line"></span><br><span class="line">mat = [[<span class="number">0</span> <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(l + <span class="number">1</span>)] <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(l)]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(l):</span><br><span class="line">    mat[i][i] = <span class="number">1</span></span><br><span class="line">    mat[i][-<span class="number">1</span>] = pad * ee[i]</span><br><span class="line">mat = matrix(ZZ,mat)</span><br><span class="line"><span class="comment"># print(mat)</span></span><br><span class="line"><span class="built_in">print</span>(mat.LLL())</span><br><span class="line">kk = <span class="built_in">list</span>(mat.LLL()[<span class="number">0</span>])[:-<span class="number">1</span>]</span><br><span class="line">mul = <span class="keyword">lambda</span> x,y:x * y</span><br><span class="line">ans = <span class="built_in">sum</span>([k * e <span class="keyword">for</span> k,e <span class="keyword">in</span> <span class="built_in">zip</span>(kk,ee)])</span><br><span class="line"><span class="keyword">assert</span> ans == <span class="number">0</span></span><br></pre></td></tr></table></figure><p>得到系数之后，下一步将其放在指数位上，由于没有取模，直接运算的指数中有正有负，得到的就不是一个整数，会得到结果<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><msup><mi>g</mi><mrow><msub><mi>k</mi><mi>i</mi></msub><msub><mi>c</mi><mi>i</mi></msub></mrow></msup><msup><mi>g</mi><mrow><msub><mi>k</mi><mi>j</mi></msub><msub><mi>c</mi><mi>j</mi></msub></mrow></msup></mfrac><mo>=</mo><mn>1</mn><mtext></mtext><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mtext></mtext><mi>n</mi></mrow><annotation encoding="application/x-tex">\frac{g^{k_ic_i}}{g^{k_jc_j}}=1 \bmod n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.7183609999999998em;vertical-align:-.6233329999999999em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.095028em"><span style="top:-2.5127750000000004em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.03588em">g</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.9674642857142857em"><span style="top:-2.9714357142857146em;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3448em"><span style="top:-2.3448em;margin-left:-.03148em;margin-right:.1em"><span class="pstrut" style="height:2.65952em"></span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.5091600000000001em"><span></span></span></span></span></span></span><span class="mord mtight"><span class="mord mathdefault mtight">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3448em"><span style="top:-2.3448em;margin-left:0;margin-right:.1em"><span class="pstrut" style="height:2.65952em"></span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.5091600000000001em"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.446108em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.03588em">g</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.9270285714285713em"><span style="top:-2.931em;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3448em"><span style="top:-2.3448em;margin-left:-.03148em;margin-right:.1em"><span class="pstrut" style="height:2.65952em"></span><span class="mord mathdefault mtight">i</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.31472em"><span></span></span></span></span></span></span><span class="mord mtight"><span class="mord mathdefault mtight">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3448em"><span style="top:-2.3448em;margin-left:0;margin-right:.1em"><span class="pstrut" style="height:2.65952em"></span><span class="mord mathdefault mtight">i</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.31472em"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.6233329999999999em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.69444em;vertical-align:0"></span><span class="mord">1</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mspace" style="margin-right:.05555555555555555em"></span><span class="mbin"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mspace" style="margin-right:.05555555555555555em"></span></span><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord mathdefault">n</span></span></span></span>，也就是说，分子分母做差就是k倍的n，得到两组进行GCD即可得到我们的模数，也就是我们的r。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">l = <span class="built_in">len</span>(ee)</span><br><span class="line">pad = <span class="number">2</span> ** <span class="number">10</span></span><br><span class="line"></span><br><span class="line">mat = [[<span class="number">0</span> <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(l + <span class="number">1</span>)] <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(l)]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(l):</span><br><span class="line">    mat[i][i] = <span class="number">1</span></span><br><span class="line">    mat[i][-<span class="number">1</span>] = pad * ee[i]</span><br><span class="line">mat = matrix(ZZ,mat)</span><br><span class="line"></span><br><span class="line">result = mat.LLL()</span><br><span class="line">kk1 = <span class="built_in">list</span>(result[<span class="number">0</span>])[:-<span class="number">1</span>]</span><br><span class="line">kk2 = <span class="built_in">list</span>(result[<span class="number">1</span>])[:-<span class="number">1</span>]</span><br><span class="line">mul = <span class="keyword">lambda</span> x,y:x * y</span><br><span class="line">ans1 = <span class="built_in">sum</span>([k * e <span class="keyword">for</span> k,e <span class="keyword">in</span> <span class="built_in">zip</span>(kk1,ee)])</span><br><span class="line"><span class="keyword">assert</span> ans1 == <span class="number">0</span></span><br><span class="line">ans2 = <span class="built_in">sum</span>([k * e <span class="keyword">for</span> k,e <span class="keyword">in</span> <span class="built_in">zip</span>(kk2,ee)])</span><br><span class="line"><span class="keyword">assert</span> ans2 == <span class="number">0</span></span><br><span class="line">tmp1 = reduce(mul,[ZZ(C) ** k <span class="keyword">for</span> C,k <span class="keyword">in</span> <span class="built_in">zip</span>(cc,kk1)])</span><br><span class="line">kr1 = tmp1.numer() - tmp1.denom()</span><br><span class="line">tmp2 = reduce(mul,[ZZ(C) ** k <span class="keyword">for</span> C,k <span class="keyword">in</span> <span class="built_in">zip</span>(cc,kk2)])</span><br><span class="line">kr2 = tmp2.numer() - tmp2.denom()</span><br><span class="line">r = GCD(kr1,kr2)</span><br><span class="line"><span class="built_in">print</span>(r,isPrime(r))</span><br><span class="line"><span class="comment">#10667924450645948100608927157603781268991945924055943816082403476371801785989561454936076097627912279097114498936308342036099904242687703932444772733243819 1</span></span><br></pre></td></tr></table></figure><p>得到r之后可以共模攻击得到g，取两组没有公约数的e即可，这样可以得到g。得到的r发现r-1光滑，也就是说指数位可解</p><p>之后分析p和q的生成，可以看出</p><p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>p</mi><mo>=</mo><mo stretchy="false">(</mo><mi>C</mi><msup><mi>W</mi><msub><mi>t</mi><mn>1</mn></msub></msup><msup><mi>X</mi><mi>c</mi></msup><mo stretchy="false">)</mo><mtext></mtext><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mtext></mtext><mi>r</mi><mspace linebreak="newline"></mspace><mi>q</mi><mo>=</mo><mo stretchy="false">(</mo><msup><mi>W</mi><mrow><mo>−</mo><msub><mi>t</mi><mn>2</mn></msub></mrow></msup><msup><mi>X</mi><mrow><mo>−</mo><mi>c</mi></mrow></msup><mo stretchy="false">)</mo><mtext></mtext><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mtext></mtext><mi>r</mi><mspace linebreak="newline"></mspace><mi>n</mi><mo>=</mo><mi>p</mi><mo>×</mo><mi>q</mi><mo>=</mo><mi>C</mi><msup><mi>W</mi><mrow><msub><mi>t</mi><mn>1</mn></msub><mo>−</mo><msub><mi>t</mi><mn>2</mn></msub></mrow></msup><mtext></mtext><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mtext></mtext><mi>r</mi></mrow><annotation encoding="application/x-tex">p=(CW^{t_1}X^c) \bmod r \\ q=(W^{-t_2}X^{-c}) \bmod r \\ n=p\times q= CW^{t_1-t_2} \bmod r</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.625em;vertical-align:-.19444em"></span><span class="mord mathdefault">p</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.093556em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:.07153em">C</span><span class="mord"><span class="mord mathdefault" style="margin-right:.13889em">W</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.843556em"><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31731428571428577em"><span style="top:-2.357em;margin-left:0;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.143em"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.07847em">X</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.7143919999999999em"><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">c</span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mspace" style="margin-right:.05555555555555555em"></span><span class="mbin"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mspace" style="margin-right:.05555555555555555em"></span></span><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord mathdefault" style="margin-right:.02778em">r</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:.625em;vertical-align:-.19444em"></span><span class="mord mathdefault" style="margin-right:.03588em">q</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.093556em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:.13889em">W</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.843556em"><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31731428571428577em"><span style="top:-2.357em;margin-left:0;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.143em"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.07847em">X</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.821331em"><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mathdefault mtight">c</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mspace" style="margin-right:.05555555555555555em"></span><span class="mbin"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mspace" style="margin-right:.05555555555555555em"></span></span><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord mathdefault" style="margin-right:.02778em">r</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.7777700000000001em;vertical-align:-.19444em"></span><span class="mord mathdefault">p</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">×</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.625em;vertical-align:-.19444em"></span><span class="mord mathdefault" style="margin-right:.03588em">q</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.843556em;vertical-align:0"></span><span class="mord mathdefault" style="margin-right:.07153em">C</span><span class="mord"><span class="mord mathdefault" style="margin-right:.13889em">W</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.843556em"><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31731428571428577em"><span style="top:-2.357em;margin-left:0;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.143em"><span></span></span></span></span></span></span><span class="mbin mtight">−</span><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31731428571428577em"><span style="top:-2.357em;margin-left:0;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.143em"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mspace" style="margin-right:.05555555555555555em"></span><span class="mbin"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mspace" style="margin-right:.05555555555555555em"></span></span><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord mathdefault" style="margin-right:.02778em">r</span></span></span></span></span></p><p>其中<code>t1-t2</code>的范围只有三个值<code>-1,0,1</code>，这样可以得到三个C的可能值，逐个尝试即可，之后按照原逻辑生成即可。完整exp为</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sage.<span class="built_in">all</span> <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> functools <span class="keyword">import</span> reduce</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">X = <span class="number">197551296081022143608034360606381334253374533627365455002683616928330857539205836504075700389569213696043700490195977045586318090211726350917451410932216</span></span><br><span class="line">W = <span class="number">10625560347436147537644301075885059900758953251551866239435327407977591190018531918316486861730777808988185029637608372445416280896280058313924537678128258</span></span><br><span class="line">n = <span class="number">66022752859576751705544115674843820574619778139841743306742674741819040147745776264697779394213058328572691946505564202779552568613562176486470653760142864852745249430164256770469301179840812051842363261404790355057115296671805975126795017665392798621718740402876024901551851638786170466127104615340863081593</span></span><br><span class="line">enc = <span class="number">61040814411609979711931510878805548760848686739454567580358315369154260598969544907138563610735920809370306294050956464828615417082277087799410050319871691154003766481799397897519555113273982347768485719165972634089532894585256662433949694618032747408071953491187718726218120284389638124624152241321006634774</span></span><br><span class="line">data = <span class="built_in">open</span>(<span class="string">&#x27;out.txt&#x27;</span>,<span class="string">&#x27;r&#x27;</span>).read().splitlines()[<span class="number">2</span>:-<span class="number">2</span>]</span><br><span class="line">ee = []</span><br><span class="line">cc = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> data:</span><br><span class="line">    line = i.replace(<span class="string">&#x27;[+] Try (&#x27;</span>,<span class="string">&#x27;&#x27;</span>).replace(<span class="string">&#x27;)&#x27;</span>,<span class="string">&#x27;&#x27;</span>).split(<span class="string">&#x27;, &#x27;</span>)</span><br><span class="line">    e,c = <span class="built_in">list</span>(<span class="built_in">map</span>(<span class="built_in">int</span>,line))</span><br><span class="line">    ee.append(e)</span><br><span class="line">    cc.append(c)</span><br><span class="line">l = <span class="built_in">len</span>(ee)</span><br><span class="line">pad = <span class="number">2</span> ** <span class="number">10</span></span><br><span class="line"></span><br><span class="line">mat = [[<span class="number">0</span> <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(l + <span class="number">1</span>)] <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(l)]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(l):</span><br><span class="line">    mat[i][i] = <span class="number">1</span></span><br><span class="line">    mat[i][-<span class="number">1</span>] = pad * ee[i]</span><br><span class="line">mat = matrix(ZZ,mat)</span><br><span class="line"></span><br><span class="line">result = mat.LLL()</span><br><span class="line">kk1 = <span class="built_in">list</span>(result[<span class="number">0</span>])[:-<span class="number">1</span>]</span><br><span class="line">kk2 = <span class="built_in">list</span>(result[<span class="number">1</span>])[:-<span class="number">1</span>]</span><br><span class="line">mul = <span class="keyword">lambda</span> x,y:x * y</span><br><span class="line">ans1 = <span class="built_in">sum</span>([k * e <span class="keyword">for</span> k,e <span class="keyword">in</span> <span class="built_in">zip</span>(kk1,ee)])</span><br><span class="line"><span class="keyword">assert</span> ans1 == <span class="number">0</span></span><br><span class="line">ans2 = <span class="built_in">sum</span>([k * e <span class="keyword">for</span> k,e <span class="keyword">in</span> <span class="built_in">zip</span>(kk2,ee)])</span><br><span class="line"><span class="keyword">assert</span> ans2 == <span class="number">0</span></span><br><span class="line">tmp1 = reduce(mul,[ZZ(C) ** k <span class="keyword">for</span> C,k <span class="keyword">in</span> <span class="built_in">zip</span>(cc,kk1)])</span><br><span class="line">kr1 = tmp1.numer() - tmp1.denom()</span><br><span class="line">tmp2 = reduce(mul,[ZZ(C) ** k <span class="keyword">for</span> C,k <span class="keyword">in</span> <span class="built_in">zip</span>(cc,kk2)])</span><br><span class="line">kr2 = tmp2.numer() - tmp2.denom()</span><br><span class="line">r = GCD(kr1,kr2)</span><br><span class="line"><span class="comment"># print(r,isPrime(r))</span></span><br><span class="line">s,s1,s2 = xgcd(ee[<span class="number">1</span>],ee[<span class="number">2</span>])</span><br><span class="line"><span class="keyword">assert</span> s == <span class="number">1</span></span><br><span class="line">g = <span class="built_in">pow</span>(cc[<span class="number">1</span>],s1,r) * <span class="built_in">pow</span>(cc[<span class="number">2</span>],s2,r) % r</span><br><span class="line">C1 = <span class="built_in">int</span>(n * <span class="built_in">pow</span>(W,<span class="number">1</span>,r) % r)</span><br><span class="line">C2 = <span class="built_in">int</span>(n * <span class="built_in">pow</span>(W,<span class="number">0</span>,r) % r)</span><br><span class="line">C3 = <span class="built_in">int</span>(n * <span class="built_in">pow</span>(W,-<span class="number">1</span>,r) % r)</span><br><span class="line"><span class="keyword">for</span> C <span class="keyword">in</span> [C1,C2,C3]:</span><br><span class="line">    c = discrete_log(Zmod(r)(C),Zmod(r)(g))</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;Try c:<span class="subst">&#123;c&#125;</span>&#x27;</span>)</span><br><span class="line">    p1 = <span class="built_in">int</span>((C * W ** <span class="number">0</span> * <span class="built_in">pow</span>(X, c, r) % r))</span><br><span class="line">    p2 = <span class="built_in">int</span>((C * W ** <span class="number">1</span> * <span class="built_in">pow</span>(X, c, r) % r))</span><br><span class="line">    <span class="keyword">for</span> p <span class="keyword">in</span> [p1,p2]:</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">int</span>(n) % <span class="built_in">int</span>(p) != <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        q = <span class="built_in">int</span>(n // p)</span><br><span class="line">        <span class="keyword">assert</span> p * q == n</span><br><span class="line">        phi = <span class="built_in">int</span>((p - <span class="number">1</span>) * (q - <span class="number">1</span>))</span><br><span class="line">        d = inverse_mod(<span class="number">65537</span>,phi)</span><br><span class="line">        m = <span class="built_in">pow</span>(enc,d,n)</span><br><span class="line">        <span class="keyword">assert</span> <span class="built_in">pow</span>(m,<span class="number">0x10001</span>,n) == enc</span><br><span class="line">        <span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(m)))</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="0x09-2023hws-random-715"><a class="markdownIt-Anchor" href="#0x09-2023hws-random-715"></a> 0x09 2023HWS Random 7.15</h4><p>附件</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> os <span class="keyword">import</span> urandom</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> next_prime</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> randint</span><br><span class="line"><span class="keyword">from</span> functools <span class="keyword">import</span> reduce</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> bytes_to_long</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> flag[:<span class="number">4</span>] == <span class="string">b&#x27;flag&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">padding</span>(<span class="params">m, length</span>):</span><br><span class="line">    <span class="keyword">return</span> m + urandom((length &gt;&gt; <span class="number">3</span>) - <span class="built_in">len</span>(m))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">generate_p</span>(<span class="params">base</span>):</span><br><span class="line">    <span class="keyword">return</span> next_prime(base + randint(<span class="number">1</span>, <span class="number">500000</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">generate_e</span>():</span><br><span class="line">    <span class="keyword">return</span> reduce(<span class="keyword">lambda</span> x, y: x * y, [randint(<span class="number">1</span>, <span class="number">100</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(randint(<span class="number">2</span>, <span class="number">5</span>))])</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">generate_pubkey</span>():</span><br><span class="line">    base = <span class="number">1</span> &lt;&lt; randint(<span class="number">128</span>, <span class="number">256</span>)</span><br><span class="line">    </span><br><span class="line">    n = reduce(<span class="keyword">lambda</span> x, y: x * y, [generate_p(base) ** randint(<span class="number">1</span>, <span class="number">5</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(randint(<span class="number">2</span>, <span class="number">10</span>))])</span><br><span class="line">    e = generate_e()</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> (n, e)</span><br><span class="line"></span><br><span class="line">n, e = generate_pubkey()</span><br><span class="line"></span><br><span class="line">m = bytes_to_long(padding(flag, n.bit_length()))</span><br><span class="line"><span class="keyword">assert</span> m &lt; n</span><br><span class="line">c = <span class="built_in">pow</span>(m, e, n)</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span> (<span class="string">&quot;./data.txt&quot;</span>,<span class="string">&quot;w&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f.write(<span class="string">&quot;n = &#123;&#125;\ne = &#123;&#125;\nc = &#123;&#125;&quot;</span>.<span class="built_in">format</span>(n, e, c))</span><br><span class="line">    f.close()</span><br></pre></td></tr></table></figure><p>算是我见过最恶心的AMM了。</p><p>首先要先分解n，观察n的生成函数，可以看到是一个公共的base，通过这个base来生成素数p，偏差只有<code>randint(1,500000)</code>，素数p还有一个<code>randint(1,5)</code>的次方，综上n的分解应该为</p><p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>n</mi><mo>=</mo><munderover><mo>∏</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mo stretchy="false">(</mo><mi>p</mi><mo>+</mo><msub><mi>k</mi><mi>i</mi></msub><msup><mo stretchy="false">)</mo><msub><mi>e</mi><mi>i</mi></msub></msup></mrow><annotation encoding="application/x-tex">n=\prod_{i=1}^{n}(p+k_i)^{e_i}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:2.929066em;vertical-align:-1.277669em"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6513970000000002em"><span style="top:-1.872331em;margin-left:0"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em"><span class="pstrut" style="height:3.05em"></span><span><span class="mop op-symbol large-op">∏</span></span></span><span style="top:-4.3000050000000005em;margin-left:0"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.277669em"><span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">p</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.7143919999999999em"><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3280857142857143em"><span style="top:-2.357em;margin-left:0;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.143em"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p><p>尝试直接对n开es次方，es为<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>e</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">e_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.58056em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span>的乘积，如果es是正确的，那得到开方结果的高位应该是<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mn>2</mn><mi>i</mi></msup></mrow><annotation encoding="application/x-tex">2^i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.824664em;vertical-align:0"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.824664em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span></span></span></span></span></span></span>形式。所以直接用一个<code>table</code>变量打表出范围内<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mn>2</mn><mi>i</mi></msup></mrow><annotation encoding="application/x-tex">2^i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.824664em;vertical-align:0"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.824664em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span></span></span></span></span></span></span>的所有值，之后进行爆破就可以得到可能满足条件的所有base</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> tqdm</span><br><span class="line"><span class="keyword">from</span> os <span class="keyword">import</span> urandom</span><br><span class="line"></span><br><span class="line">n = <span class="number">255550794734774347335455038653204099810524562323968101081052744238324333979282590769066826059535810339765419405089707653972316828518446466787073982991340735273047955757161722774546888128720663627716647123110956021905275918358574092054477588935546729192812379266210918802470144452212508255209922150559524376661512464064852413804511191503030046546647554981646983220695416838829085308878177824361071544916728725428437436959573167863053126718594118224053088660739173865895266537548733106779437480905737491231720771570860988017959907437998012442781279100256862684919251885437194156545435396952798548033193683684362049646718627530076461463826459504520525895649547513376441325848313193080013281816762156916219271109726593135112626577858906494025788770088106285316571255392298608980679161123528759865796345121056864973189231253364595956642612401745212207858555858704724770456899071144650909246822311039572915447866615638976747716646382091135281119109866295649034560378368202797914202112090339159898226929176034503535419893300159083361891627300767030933209665917744361038219820997348160094737332979677839131999258559999565207302339242257832022939036526481610130970477187338439181123984340269665409009894192138483254592729253191096427332283419085864095600303323775372526431524911842065699875575955728772820558157791292247976982470646890930951250598649964200733076634093613078091713383782021194766013790646324780327618195433827227105459480409797466859653960886570869469172506894631937612508518886406112758352094014377947728184352908630672750330561369500089138179794848896959683336195170519521</span></span><br><span class="line">e = <span class="number">57564</span></span><br><span class="line">c = <span class="number">29259244746260903447574448389058952310000390135231599667104954615635954705912759181552349897154663199516384757779582324312559110410628822220097857204989378367616522573650610718867075518776621505865327181301059226036067398269476892575801933638458560523584293063843890012581096233699743704556897984235725492806550009731913445801481786988321848320254380607620726887530437151238556482879159888862341096974129499878601309077513908335631417136332585391767849651968095851808312565329858938394084369711172343300695636449663297542069122814607488273607842533010193498547579501368165500427762712900139188279259336486273788664239339542187191374015805659616093967428577968683677885747775540903578723024681500272919689849253480672194507905399890280339044782040395397922973935735424691828624724029439840506402735626398047317544972966643810550593849196291833043243448655939654884418027006572740130515844853007135331296523599052132266288322473865775521953742444721612389547052020839760259179074124960827686670217980159612966767064088131176654212504654177367329044762238432531402899949096987765334061101859346928585114984440559379578507872401025874782849854603895110182401204202962118890563473961321104811452539667609870771280348801335004559132482743318366689808669972965573335905879806817618597010442262336079838039317609336210571773187461470707420797827741277982208089496339300646565067740673242728353659143107970717482392927903021102141779217003523105389389513154792904745687959335115429159530013641777064904216646895961910784920181748841104318013067029395394948190384737300533803009402182800702</span></span><br><span class="line">table = &#123;&#125;</span><br><span class="line">bases = []</span><br><span class="line">ee = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">128</span>,<span class="number">257</span>):</span><br><span class="line">    base = <span class="number">2</span> ** i</span><br><span class="line">    idx,data = i,<span class="built_in">str</span>(base)[:<span class="number">30</span>]</span><br><span class="line">    table[data] = idx</span><br><span class="line"><span class="comment"># print(table)</span></span><br><span class="line"><span class="keyword">for</span> es <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>,<span class="number">100</span>):</span><br><span class="line">    tmp = gmpy2.iroot(n,es)</span><br><span class="line">    cnt = <span class="built_in">str</span>(tmp[<span class="number">0</span>])[:<span class="number">30</span>]</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="built_in">print</span>(table[cnt],es)</span><br><span class="line">        bases.append(table[cnt])</span><br><span class="line">        ee.append(es)</span><br><span class="line">        <span class="comment"># print(es)</span></span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"><span class="comment">#bases = [250, 210, 175, 150]</span></span><br><span class="line"><span class="comment">#es = [21, 25, 30, 35]</span></span><br></pre></td></tr></table></figure><p>这样就得到了所有可能的base，之后再对这些base进行爆破，得到了正确的base，也就成功地将n进行了分解</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">base = <span class="number">47890485652059026823698344598447161988085597568237568</span></span><br><span class="line">primes = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> tqdm(<span class="built_in">range</span>(<span class="number">500000</span>)):</span><br><span class="line">    p = base + i</span><br><span class="line">    <span class="keyword">if</span> n % p == <span class="number">0</span>:</span><br><span class="line">        primes.append(p)</span><br><span class="line"><span class="built_in">print</span>(primes)</span><br><span class="line">fac = []</span><br><span class="line"><span class="keyword">for</span> p <span class="keyword">in</span> primes:</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">6</span>,<span class="number">0</span>,-<span class="number">1</span>):</span><br><span class="line">        <span class="keyword">if</span> n % (p ** i) == <span class="number">0</span>:</span><br><span class="line">            fac.append((p,i))</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"><span class="built_in">print</span>(fac)</span><br><span class="line"><span class="comment">#[(47890485652059026823698344598447161988085597568251161, 5), (47890485652059026823698344598447161988085597568297951, 4), (47890485652059026823698344598447161988085597568338059, 3), (47890485652059026823698344598447161988085597568363667, 4), (47890485652059026823698344598447161988085597568398337, 3), (47890485652059026823698344598447161988085597568433917, 5), (47890485652059026823698344598447161988085597568484111, 1), (47890485652059026823698344598447161988085597568667099, 2), (47890485652059026823698344598447161988085597568729849, 3)]</span></span><br></pre></td></tr></table></figure><p>得到了n的分解之后，观察e的生成，都是一些小因数的乘积，肯定会有模不互素。意思是要批量amm，而且素数都有次方，还得hensel lift。在sage里面发现一个很厉害的有限域开方函数<code>Zmod(p ** i)(c).nth_root(e,all=True)</code>，也自带了hensel lift，这个函数跑出来的结果就是c在<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>p</mi><mi>i</mi></msup></mrow><annotation encoding="application/x-tex">p^i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.019104em;vertical-align:-.19444em"></span><span class="mord"><span class="mord mathdefault">p</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.824664em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span></span></span></span></span></span></span>的有限域下开e次方的列表集合，功能非常强大。用这个函数打这个题也很快了，但是跑一次flag得花半个钟头</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> tqdm</span><br><span class="line"><span class="keyword">import</span> itertools</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">n = <span class="number">255550794734774347335455038653204099810524562323968101081052744238324333979282590769066826059535810339765419405089707653972316828518446466787073982991340735273047955757161722774546888128720663627716647123110956021905275918358574092054477588935546729192812379266210918802470144452212508255209922150559524376661512464064852413804511191503030046546647554981646983220695416838829085308878177824361071544916728725428437436959573167863053126718594118224053088660739173865895266537548733106779437480905737491231720771570860988017959907437998012442781279100256862684919251885437194156545435396952798548033193683684362049646718627530076461463826459504520525895649547513376441325848313193080013281816762156916219271109726593135112626577858906494025788770088106285316571255392298608980679161123528759865796345121056864973189231253364595956642612401745212207858555858704724770456899071144650909246822311039572915447866615638976747716646382091135281119109866295649034560378368202797914202112090339159898226929176034503535419893300159083361891627300767030933209665917744361038219820997348160094737332979677839131999258559999565207302339242257832022939036526481610130970477187338439181123984340269665409009894192138483254592729253191096427332283419085864095600303323775372526431524911842065699875575955728772820558157791292247976982470646890930951250598649964200733076634093613078091713383782021194766013790646324780327618195433827227105459480409797466859653960886570869469172506894631937612508518886406112758352094014377947728184352908630672750330561369500089138179794848896959683336195170519521</span></span><br><span class="line">e = <span class="number">57564</span></span><br><span class="line">c = <span class="number">29259244746260903447574448389058952310000390135231599667104954615635954705912759181552349897154663199516384757779582324312559110410628822220097857204989378367616522573650610718867075518776621505865327181301059226036067398269476892575801933638458560523584293063843890012581096233699743704556897984235725492806550009731913445801481786988321848320254380607620726887530437151238556482879159888862341096974129499878601309077513908335631417136332585391767849651968095851808312565329858938394084369711172343300695636449663297542069122814607488273607842533010193498547579501368165500427762712900139188279259336486273788664239339542187191374015805659616093967428577968683677885747775540903578723024681500272919689849253480672194507905399890280339044782040395397922973935735424691828624724029439840506402735626398047317544972966643810550593849196291833043243448655939654884418027006572740130515844853007135331296523599052132266288322473865775521953742444721612389547052020839760259179074124960827686670217980159612966767064088131176654212504654177367329044762238432531402899949096987765334061101859346928585114984440559379578507872401025874782849854603895110182401204202962118890563473961321104811452539667609870771280348801335004559132482743318366689808669972965573335905879806817618597010442262336079838039317609336210571773187461470707420797827741277982208089496339300646565067740673242728353659143107970717482392927903021102141779217003523105389389513154792904745687959335115429159530013641777064904216646895961910784920181748841104318013067029395394948190384737300533803009402182800702</span></span><br><span class="line"></span><br><span class="line">ps = [(<span class="number">47890485652059026823698344598447161988085597568251161</span>, <span class="number">5</span>), (<span class="number">47890485652059026823698344598447161988085597568297951</span>, <span class="number">4</span>), (<span class="number">47890485652059026823698344598447161988085597568338059</span>, <span class="number">3</span>), (<span class="number">47890485652059026823698344598447161988085597568363667</span>, <span class="number">4</span>), (<span class="number">47890485652059026823698344598447161988085597568398337</span>, <span class="number">3</span>), (<span class="number">47890485652059026823698344598447161988085597568433917</span>, <span class="number">5</span>), (<span class="number">47890485652059026823698344598447161988085597568484111</span>, <span class="number">1</span>), (<span class="number">47890485652059026823698344598447161988085597568667099</span>, <span class="number">2</span>), (<span class="number">47890485652059026823698344598447161988085597568729849</span>, <span class="number">3</span>)]</span><br><span class="line">mods = [<span class="built_in">int</span>(p ** k) <span class="keyword">for</span> p,k <span class="keyword">in</span> ps]</span><br><span class="line">phi = <span class="number">1</span></span><br><span class="line"><span class="keyword">for</span> p,ee <span class="keyword">in</span> ps:</span><br><span class="line">    <span class="keyword">if</span> ee != <span class="number">1</span>:</span><br><span class="line">        phi *= p ** (ee - <span class="number">1</span>) * (p - <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        phi *= (p - <span class="number">1</span>)</span><br><span class="line">eps = [GCD(e,p - <span class="number">1</span>) <span class="keyword">for</span> p,_ <span class="keyword">in</span> ps]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">ee = e // <span class="number">108</span></span><br><span class="line">d = inverse_mod(ee,phi)</span><br><span class="line">c = <span class="built_in">int</span>(<span class="built_in">pow</span>(c,d,n))</span><br><span class="line">e = <span class="number">108</span></span><br><span class="line">root = Zmod(<span class="built_in">int</span>(ps[<span class="number">0</span>][<span class="number">0</span>]) ** ps[<span class="number">0</span>][<span class="number">1</span>])(c).nth_root(<span class="number">108</span>,<span class="built_in">all</span>=<span class="literal">True</span>)</span><br><span class="line"><span class="built_in">print</span>(root)</span><br><span class="line">roots = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> tqdm(<span class="built_in">range</span>(<span class="number">9</span>)):</span><br><span class="line">    root = Zmod(ps[i][<span class="number">0</span>] ** ps[i][<span class="number">1</span>])(c).nth_root(<span class="number">108</span>,<span class="built_in">all</span>=<span class="literal">True</span>)</span><br><span class="line">    roots.append(root)</span><br><span class="line"><span class="comment"># print(roots)</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> tqdm(itertools.product(*roots,repeat=<span class="number">1</span>)):</span><br><span class="line">    ai = <span class="built_in">list</span>(<span class="built_in">map</span>(<span class="built_in">int</span>,i))</span><br><span class="line">    m = CRT_list(ai,mods)</span><br><span class="line">    flag = long_to_bytes(<span class="built_in">int</span>(m))</span><br><span class="line">    <span class="keyword">if</span> <span class="string">b&#x27;flag&#x27;</span> <span class="keyword">in</span> flag:</span><br><span class="line">        <span class="built_in">print</span>(flag)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    </span><br></pre></td></tr></table></figure><h4 id="0x08-2023ichunqiu-cisticola-522"><a class="markdownIt-Anchor" href="#0x08-2023ichunqiu-cisticola-522"></a> 0x08 2023ichunqiu cisticola 5.22</h4><p>附件</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env sage</span></span><br><span class="line"><span class="comment"># Problem by rec, with nothing.</span></span><br><span class="line"><span class="keyword">import</span> Q</span><br><span class="line"><span class="keyword">import</span> secret</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.Padding <span class="keyword">import</span> pad</span><br><span class="line"></span><br><span class="line">key = os.urandom(<span class="number">16</span>)</span><br><span class="line">cipher = AES.new(key=key, iv=<span class="built_in">bytes</span>(<span class="built_in">range</span>(<span class="number">16</span>)), mode=AES.MODE_CBC)</span><br><span class="line">enc = cipher.encrypt(pad(secret.flag, <span class="number">16</span>)).<span class="built_in">hex</span>()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;enc = &#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">p = <span class="number">1439830214451992034013504859825496348425599138552815552028441481225682951310010651304957987750558339128649248859043607574873717185051113737355019502086518775325158336557488060325293103679742942484012852921804371007968007851081933599</span></span><br><span class="line">R.&lt;x&gt; = PolynomialRing(GF(p))</span><br><span class="line">Q = R(Q.Q)</span><br><span class="line"></span><br><span class="line">t = <span class="number">17</span></span><br><span class="line">pos = random.sample(<span class="built_in">range</span>(<span class="number">600</span>), t) + [<span class="number">600</span>]</span><br><span class="line">poly = [<span class="built_in">int</span>(os.urandom(<span class="number">16</span>).<span class="built_in">hex</span>(), <span class="number">16</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(t)] + [<span class="built_in">int</span>(key.<span class="built_in">hex</span>(), <span class="number">16</span>)]</span><br><span class="line">hint = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(t+<span class="number">1</span>):</span><br><span class="line">    hint = (hint + poly[i]*x^pos[i]) % Q</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;pos = &#125;</span>\n<span class="subst">&#123;hint = &#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure><p>抽代的内容了，研究的不多，比较粗俗的理解就是不涉及进位的进制，例如<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>x</mi><mn>2</mn></msup><mo>−</mo><mn>1</mn><mtext></mtext><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mtext></mtext><mo stretchy="false">(</mo><mi>p</mi><mo>=</mo><mn>17</mn><mo stretchy="false">)</mo><mo>=</mo><msup><mi>x</mi><mn>2</mn></msup><mo>+</mo><mn>16</mn><mtext></mtext><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mtext></mtext><mo stretchy="false">(</mo><mi>p</mi><mo>=</mo><mn>17</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">x^2-1 \bmod (p=17) = x^2 + 16 \bmod (p = 17)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.897438em;vertical-align:-.08333em"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.69444em;vertical-align:0"></span><span class="mord">1</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mspace" style="margin-right:.05555555555555555em"></span><span class="mbin"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mspace" style="margin-right:.05555555555555555em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord mathdefault">p</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord">1</span><span class="mord">7</span><span class="mclose">)</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.897438em;vertical-align:-.08333em"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.69444em;vertical-align:0"></span><span class="mord">1</span><span class="mord">6</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mspace" style="margin-right:.05555555555555555em"></span><span class="mbin"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mspace" style="margin-right:.05555555555555555em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord mathdefault">p</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord">1</span><span class="mord">7</span><span class="mclose">)</span></span></span></span></p><p>这题最后是用非预期做出来的，非预期的方法也是值得学习的。</p><p>首先仔细观察hint的生成，poly的量为待求量，<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>h</mi><mi>i</mi><mi>n</mi><mi>t</mi><mo>=</mo><mo>∑</mo><mo stretchy="false">(</mo><mi>p</mi><mi>o</mi><mi>l</mi><msub><mi>y</mi><mi>i</mi></msub><mo>×</mo><msup><mi>x</mi><mrow><mi>p</mi><mi>o</mi><msub><mi>s</mi><mi>i</mi></msub></mrow></msup><mo stretchy="false">)</mo><mtext></mtext><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mtext></mtext><mi>Q</mi></mrow><annotation encoding="application/x-tex">hint = \sum(poly_i \times x^{pos_i}) \bmod Q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.69444em;vertical-align:0"></span><span class="mord mathdefault">h</span><span class="mord mathdefault">i</span><span class="mord mathdefault">n</span><span class="mord mathdefault">t</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.00001em;vertical-align:-.25001em"></span><span class="mop op-symbol small-op" style="position:relative;top:-.0000050000000000050004em">∑</span><span class="mopen">(</span><span class="mord mathdefault">p</span><span class="mord mathdefault">o</span><span class="mord mathdefault" style="margin-right:.01968em">l</span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">×</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.664392em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">p</span><span class="mord mathdefault mtight">o</span><span class="mord mtight"><span class="mord mathdefault mtight">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3280857142857143em"><span style="top:-2.357em;margin-left:0;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.143em"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mspace" style="margin-right:.05555555555555555em"></span><span class="mbin"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mspace" style="margin-right:.05555555555555555em"></span></span><span class="base"><span class="strut" style="height:.8777699999999999em;vertical-align:-.19444em"></span><span class="mord mathdefault">Q</span></span></span></span>，其中Q，pos是已知量，poly是待求量但是相对模数<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.625em;vertical-align:-.19444em"></span><span class="mord mathdefault">p</span></span></span></span>来说较小。预期解应该是找关系打格子，可惜才疏学浅。</p><p>仔细分析可得，Q的最高位是系数为1的<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>x</mi><mn>430</mn></msup></mrow><annotation encoding="application/x-tex">x^{430}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8141079999999999em;vertical-align:0"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">4</span><span class="mord mtight">3</span><span class="mord mtight">0</span></span></span></span></span></span></span></span></span></span></span></span>，即后续的pos若小于430，则模除<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Q</mi></mrow><annotation encoding="application/x-tex">Q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8777699999999999em;vertical-align:-.19444em"></span><span class="mord mathdefault">Q</span></span></span></span>之后还是原始值，若大于则会发生复杂的取模运算。分析hint的组成，在每一项中<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>h</mi><mi>i</mi><mi>n</mi><msub><mi>t</mi><mi>i</mi></msub><mo>=</mo><mi>p</mi><mi>o</mi><mi>l</mi><msub><mi>y</mi><mi>i</mi></msub><mo>×</mo><msup><mi>x</mi><mrow><mi>p</mi><mi>o</mi><msub><mi>s</mi><mi>i</mi></msub></mrow></msup><mtext></mtext><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mtext></mtext><mi>Q</mi></mrow><annotation encoding="application/x-tex">hint_{i}=poly_{i} \times x^{pos_i} \bmod Q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.84444em;vertical-align:-.15em"></span><span class="mord mathdefault">h</span><span class="mord mathdefault">i</span><span class="mord mathdefault">n</span><span class="mord"><span class="mord mathdefault">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.8888799999999999em;vertical-align:-.19444em"></span><span class="mord mathdefault">p</span><span class="mord mathdefault">o</span><span class="mord mathdefault" style="margin-right:.01968em">l</span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">×</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.69444em;vertical-align:0"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.664392em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">p</span><span class="mord mathdefault mtight">o</span><span class="mord mtight"><span class="mord mathdefault mtight">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3280857142857143em"><span style="top:-2.357em;margin-left:0;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.143em"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mspace" style="margin-right:.05555555555555555em"></span><span class="mbin"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mspace" style="margin-right:.05555555555555555em"></span></span><span class="base"><span class="strut" style="height:.8777699999999999em;vertical-align:-.19444em"></span><span class="mord mathdefault">Q</span></span></span></span>，运算的优先级可以这样考虑<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>h</mi><mi>i</mi><mi>n</mi><msub><mi>t</mi><mi>i</mi></msub><mo>=</mo><mi>p</mi><mi>o</mi><mi>l</mi><msub><mi>y</mi><mi>i</mi></msub><mo>×</mo><mo stretchy="false">(</mo><msup><mi>x</mi><mrow><mi>p</mi><mi>o</mi><msub><mi>s</mi><mi>i</mi></msub></mrow></msup><mtext></mtext><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mtext></mtext><mi>Q</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">hint_{i}=poly_{i} \times (x^{pos_i} \bmod Q)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.84444em;vertical-align:-.15em"></span><span class="mord mathdefault">h</span><span class="mord mathdefault">i</span><span class="mord mathdefault">n</span><span class="mord"><span class="mord mathdefault">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.8888799999999999em;vertical-align:-.19444em"></span><span class="mord mathdefault">p</span><span class="mord mathdefault">o</span><span class="mord mathdefault" style="margin-right:.01968em">l</span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">×</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.664392em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">p</span><span class="mord mathdefault mtight">o</span><span class="mord mtight"><span class="mord mathdefault mtight">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3280857142857143em"><span style="top:-2.357em;margin-left:0;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.143em"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mspace" style="margin-right:.05555555555555555em"></span><span class="mbin"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mspace" style="margin-right:.05555555555555555em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathdefault">Q</span><span class="mclose">)</span></span></span></span>，则括号内的内容就是可以运算的量，hint的长度为430，pos的长度为18，也就是说有18个变量，430个同余式，解方程就好了。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">Q = </span><br><span class="line">p = <span class="number">1439830214451992034013504859825496348425599138552815552028441481225682951310010651304957987750558339128649248859043607574873717185051113737355019502086518775325158336557488060325293103679742942484012852921804371007968007851081933599</span></span><br><span class="line">R.&lt;x&gt; = PolynomialRing(GF(p))</span><br><span class="line">Q = R(Q)</span><br><span class="line">enc = <span class="string">&#x27;e086deeb9f060c014867c5adbd1ee1b449193b6e6177f58a36948282e1728f3b529b2def3c39f69c7a9001b4cac4d1d5&#x27;</span></span><br><span class="line">pos = [<span class="number">477</span>, <span class="number">491</span>, <span class="number">210</span>, <span class="number">515</span>, <span class="number">150</span>, <span class="number">142</span>, <span class="number">561</span>, <span class="number">5</span>, <span class="number">475</span>, <span class="number">329</span>, <span class="number">598</span>, <span class="number">274</span>, <span class="number">241</span>, <span class="number">310</span>, <span class="number">108</span>, <span class="number">483</span>, <span class="number">181</span>, <span class="number">600</span>]</span><br><span class="line">hint = </span><br><span class="line">mat = [[<span class="number">0</span> <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">430</span>)] <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">18</span>)]</span><br><span class="line"><span class="comment"># print(Q)</span></span><br><span class="line">PR.&lt;a0,a1,a2,a3,a4,a5,a6,a7,a8,a9,a10,a11,a12,a13,a14,a15,a16,a17&gt; = PolynomialRing(GF(p))</span><br><span class="line">a = [a0,a1,a2,a3,a4,a5,a6,a7,a8,a9,a10,a11,a12,a13,a14,a15,a16,a17]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i,pp <span class="keyword">in</span> <span class="built_in">enumerate</span>(pos):</span><br><span class="line">    tmp = <span class="built_in">list</span>(x ** pp % Q)</span><br><span class="line">    <span class="keyword">for</span> j,t <span class="keyword">in</span> <span class="built_in">enumerate</span>(tmp):</span><br><span class="line">        mat[i][j] = a[i] * t</span><br><span class="line"><span class="comment"># print(mat) </span></span><br><span class="line">mat.append(<span class="built_in">list</span>(hint))</span><br><span class="line">ff = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">430</span>):</span><br><span class="line">    tmp = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">18</span>):</span><br><span class="line">        tmp += mat[j][i]</span><br><span class="line">    tmp -= mat[-<span class="number">1</span>][i]</span><br><span class="line">    ff.append(tmp)</span><br><span class="line"><span class="built_in">print</span>(ff)</span><br><span class="line">I = Ideal(ff)</span><br><span class="line"><span class="built_in">print</span>(I.groebner_basis())</span><br><span class="line"><span class="comment"># [a0 + 1439830214451992034013504859825496348425599138552815552028441481225682951310010651304957987750558339128649248859043607574873717185051113737355019502086518775325158336557488060325293103679742942251245947429682847423244896114784571840, a1 + 1439830214451992034013504859825496348425599138552815552028441481225682951310010651304957987750558339128649248859043607574873717185051113737355019502086518775325158336557488060325293103679742942155951579510371133104055248512821058402, a2 + 1439830214451992034013504859825496348425599138552815552028441481225682951310010651304957987750558339128649248859043607574873717185051113737355019502086518775325158336557488060325293103679742942333546689677540574648441829120164200263, a3 + 1439830214451992034013504859825496348425599138552815552028441481225682951310010651304957987750558339128649248859043607574873717185051113737355019502086518775325158336557488060325293103679742942419856042732508027928937880966528965678, a4 + 1439830214451992034013504859825496348425599138552815552028441481225682951310010651304957987750558339128649248859043607574873717185051113737355019502086518775325158336557488060325293103679742942477242440201679929560431846449850728314, a5 + 1439830214451992034013504859825496348425599138552815552028441481225682951310010651304957987750558339128649248859043607574873717185051113737355019502086518775325158336557488060325293103679742942402850007349508639046549625566370735523, a6 + 1439830214451992034013504859825496348425599138552815552028441481225682951310010651304957987750558339128649248859043607574873717185051113737355019502086518775325158336557488060325293103679742942338856934358003057852501739714995242544, a7 + 1439830214451992034013504859825496348425599138552815552028441481225682951310010651304957987750558339128649248859043607574873717185051113737355019502086518775325158336557488060325293103679742942188922148901513137769699923520143568903, a8 + 1439830214451992034013504859825496348425599138552815552028441481225682951310010651304957987750558339128649248859043607574873717185051113737355019502086518775325158336557488060325293103679742942202100080454223166267793321382393527839, a9 + 1439830214451992034013504859825496348425599138552815552028441481225682951310010651304957987750558339128649248859043607574873717185051113737355019502086518775325158336557488060325293103679742942444212108989123403851398643912126051811, a10 + 1439830214451992034013504859825496348425599138552815552028441481225682951310010651304957987750558339128649248859043607574873717185051113737355019502086518775325158336557488060325293103679742942356103439790326992493002039390602461809, a11 + 1439830214451992034013504859825496348425599138552815552028441481225682951310010651304957987750558339128649248859043607574873717185051113737355019502086518775325158336557488060325293103679742942160739218709559983956317741927065496004, a12 + 1439830214451992034013504859825496348425599138552815552028441481225682951310010651304957987750558339128649248859043607574873717185051113737355019502086518775325158336557488060325293103679742942411486325717861983300194796811016589910, a13 + 1439830214451992034013504859825496348425599138552815552028441481225682951310010651304957987750558339128649248859043607574873717185051113737355019502086518775325158336557488060325293103679742942343857452774108124499344398633347051679, a14 + 1439830214451992034013504859825496348425599138552815552028441481225682951310010651304957987750558339128649248859043607574873717185051113737355019502086518775325158336557488060325293103679742942198611477667309363260275106661907181321, a15 + 1439830214451992034013504859825496348425599138552815552028441481225682951310010651304957987750558339128649248859043607574873717185051113737355019502086518775325158336557488060325293103679742942307880784830630882477073480841448524000, a16 + 1439830214451992034013504859825496348425599138552815552028441481225682951310010651304957987750558339128649248859043607574873717185051113737355019502086518775325158336557488060325293103679742942193549940805400643378549025789266511646, a17 + 1439830214451992034013504859825496348425599138552815552028441481225682951310010651304957987750558339128649248859043607574873717185051113737355019502086518775325158336557488060325293103679742942208402895698278177510126987163765863091]</span></span><br><span class="line">key = (-<span class="number">1439830214451992034013504859825496348425599138552815552028441481225682951310010651304957987750558339128649248859043607574873717185051113737355019502086518775325158336557488060325293103679742942208402895698278177510126987163765863091</span>) % p</span><br><span class="line">key = long_to_bytes(<span class="built_in">int</span>(key))</span><br><span class="line">enc = <span class="built_in">bytes</span>.fromhex(enc)</span><br><span class="line">cipher = AES.new(key=key, iv=<span class="built_in">bytes</span>(<span class="built_in">range</span>(<span class="number">16</span>)), mode=AES.MODE_CBC)</span><br><span class="line">flag = cipher.decrypt(enc)</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure><h4 id="0x07-2023ichunqiu-ecdsa-522"><a class="markdownIt-Anchor" href="#0x07-2023ichunqiu-ecdsa-522"></a> 0x07 2023ichunqiu ecdsa 5.22</h4><p>附件</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> ecdsa</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.strxor <span class="keyword">import</span> strxor <span class="keyword">as</span> xor</span><br><span class="line"><span class="keyword">import</span> secret</span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">256</span>)</span><br><span class="line">gen = <span class="keyword">lambda</span>: p + getPrime(<span class="number">16</span>)</span><br><span class="line">pad = <span class="keyword">lambda</span> m: m + os.urandom(<span class="number">32</span> - <span class="built_in">len</span>(m) % <span class="number">32</span>)</span><br><span class="line"></span><br><span class="line">key = os.urandom(<span class="number">30</span>)</span><br><span class="line">sk = ecdsa.SigningKey.from_secret_exponent(</span><br><span class="line">    secexp=bytes_to_long(key),</span><br><span class="line">    curve=ecdsa.SECP256k1</span><br><span class="line">)</span><br><span class="line">sig1 = sk.sign(data=<span class="string">b&#x27;This is the first message.&#x27;</span>, k=gen()).<span class="built_in">hex</span>()</span><br><span class="line">sig2 = sk.sign(data=<span class="string">b&#x27;Here is another message.&#x27;</span>, k=gen()).<span class="built_in">hex</span>()</span><br><span class="line">enc = xor(hashlib.sha512(key).digest(), pad(secret.flag)).<span class="built_in">hex</span>()</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;sig1 = &#125;</span>\n<span class="subst">&#123;sig2 = &#125;</span>\n<span class="subst">&#123;enc = &#125;</span>&quot;</span>)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">sig1 = &#x27;3f4a6f288e35a4397201d246a98c1f9cfa463e67717fbbdcbd26d7fac75f875855455c2bfb355f7f593ffbe4c4bd1fc729cc129976b56905639100c8ac716b37&#x27;</span></span><br><span class="line"><span class="string">sig2 = &#x27;9f563b21f0ee31b2f7a1a8c6edc8ff23b63e0a9d5dd4a699ecc3164871b4982df51bb2feb4bc06c578afd21d3e6227231dd5fe1d8440f3dcd025fd3ea68f5516&#x27;</span></span><br><span class="line"><span class="string">enc = &#x27;cc66d251bfa54954890c81dc1c607bae716573949f327db18aa1f4c0f420b8d29dc7e7ff9edb17b90306bd2aa753fc3fd4dafb9cc4b771cbdd79000ef05a40c0&#x27;</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><p>用的第三方包<code>ecdsa</code>来做的，首先要清楚签名的流程。</p><p>观察变量定义的代码</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sk = ecdsa.SigningKey.from_secret_exponent(</span><br><span class="line">    secexp=bytes_to_long(key),</span><br><span class="line">    curve=ecdsa.SECP256k1</span><br><span class="line">)</span><br></pre></td></tr></table></figure><p>说明其中私钥用的是<code>key</code>,曲线用的是固定的曲线<code>ecdsa.SECP256k1</code>。其中用ecdsa签名的曲线都是相对固定的，对应的参数也都可以找到。以下是一个签名的流程</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#sage</span></span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> tqdm</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.strxor <span class="keyword">import</span> strxor <span class="keyword">as</span> xor</span><br><span class="line">p = <span class="number">0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFC2F</span></span><br><span class="line">a,b = <span class="number">0</span>,<span class="number">7</span></span><br><span class="line">E = EllipticCurve(Zmod(p),[a,b])</span><br><span class="line">_Gx = <span class="number">0x79BE667EF9DCBBAC55A06295CE870B07029BFCDB2DCE28D959F2815B16F81798</span></span><br><span class="line">_Gy = <span class="number">0x483ADA7726A3C4655DA4FBFC0E1108A8FD17B448A68554199C47D08FFB10D4B8</span></span><br><span class="line">G = E(_Gx,_Gy)</span><br><span class="line">n = <span class="built_in">int</span>(G.order())</span><br><span class="line">key = <span class="string">b&#x27;\r\x10\x12\xc9\xdc=_\x17\xf9~^\x94\x88\xc9)2Q)\xf1\xf6\xb7n\x85\xe6\xf8j\xa8\xdb\xb4\xe7&#x27;</span></span><br><span class="line">d = bytes_to_long(key)</span><br><span class="line">k = <span class="number">87388283475313773609267381590151961688122112605990157606506013532563806668001</span></span><br><span class="line">msg1 = <span class="string">b&#x27;This is the first message.&#x27;</span></span><br><span class="line">msg2 = <span class="string">b&#x27;Here is another message.&#x27;</span></span><br><span class="line">z = <span class="built_in">int</span>(hashlib.sha1(msg1).hexdigest(),<span class="number">16</span>)</span><br><span class="line">K = k * G</span><br><span class="line">kx,ky,_ = K</span><br><span class="line">r = <span class="built_in">int</span>(kx)</span><br><span class="line">s = inverse_mod(k,n) * (z + r * d) % n</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(r)[<span class="number">2</span>:] + <span class="built_in">hex</span>(s)[<span class="number">2</span>:])</span><br><span class="line"><span class="comment">#21f3a9a4c280a50b7dc2aac6d21562744445853396833d740260ba704d256bfc69cac9a4714ce22f319adc0d4ba78bc9807289b77193149fb935786af9448844</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#python</span></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> ecdsa</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.strxor <span class="keyword">import</span> strxor <span class="keyword">as</span> xor</span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="comment"># import secret</span></span><br><span class="line">flag = <span class="string">b&#x27;flag&#123;1234567890123123456423423321454&#125;&#x27;</span></span><br><span class="line"><span class="comment"># p = getPrime(256)</span></span><br><span class="line"><span class="comment"># gen = lambda: p + getPrime(16)</span></span><br><span class="line"><span class="comment"># pad = lambda m: m + os.urandom(32 - len(m) % 32)</span></span><br><span class="line">p = <span class="number">87388283475313773609267381590151961688122112605990157606506013532563806668001</span></span><br><span class="line"></span><br><span class="line">key = <span class="string">b&#x27;\r\x10\x12\xc9\xdc=_\x17\xf9~^\x94\x88\xc9)2Q)\xf1\xf6\xb7n\x85\xe6\xf8j\xa8\xdb\xb4\xe7&#x27;</span></span><br><span class="line"><span class="comment"># print(hashlib.sha512(key).digest())</span></span><br><span class="line"><span class="comment"># print(pad(flag))</span></span><br><span class="line">sk = ecdsa.SigningKey.from_secret_exponent(</span><br><span class="line">    secexp=bytes_to_long(key),</span><br><span class="line">    curve=ecdsa.SECP256k1</span><br><span class="line">)</span><br><span class="line">sig1 = sk.sign(data=<span class="string">b&#x27;This is the first message.&#x27;</span>, k=p).<span class="built_in">hex</span>()</span><br><span class="line">sig2 = sk.sign(data=<span class="string">b&#x27;Here is another message.&#x27;</span>, k=p).<span class="built_in">hex</span>()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;sig1 = &#125;</span>\n<span class="subst">&#123;sig2 = &#125;</span>&quot;</span>)</span><br><span class="line"><span class="comment">#sig1 = &#x27;21f3a9a4c280a50b7dc2aac6d21562744445853396833d740260ba704d256bfc69cac9a4714ce22f319adc0d4ba78bc9807289b77193149fb935786af9448844&#x27;</span></span><br></pre></td></tr></table></figure><p>可以看出，自己签名和第三方包签名是一致的，分别解释一下就是</p><table><thead><tr><th>参数</th><th>含义</th></tr></thead><tbody><tr><td>k</td><td>随机整数<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>k</mi><mo>∈</mo><mo stretchy="false">[</mo><mn>1</mn><mo separator="true">,</mo><mi>n</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">k \in [1,n]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.73354em;vertical-align:-.0391em"></span><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">[</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord mathdefault">n</span><span class="mclose">]</span></span></span></span>，用于计算<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>P</mi><mo>=</mo><mi>k</mi><mi>G</mi><mo>=</mo><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">P = kG = (x,y)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.68333em;vertical-align:0"></span><span class="mord mathdefault" style="margin-right:.13889em">P</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.69444em;vertical-align:0"></span><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="mord mathdefault">G</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord mathdefault" style="margin-right:.03588em">y</span><span class="mclose">)</span></span></span></span></td></tr><tr><td>G</td><td>对应曲线中的基点</td></tr><tr><td>n</td><td>基点G的阶</td></tr><tr><td>d</td><td>私钥</td></tr><tr><td>z</td><td><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>H</mi><mi>a</mi><mi>s</mi><mi>h</mi><mo stretchy="false">(</mo><mi>m</mi><mi>s</mi><mi>g</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">Hash(msg)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathdefault" style="margin-right:.08125em">H</span><span class="mord mathdefault">a</span><span class="mord mathdefault">s</span><span class="mord mathdefault">h</span><span class="mopen">(</span><span class="mord mathdefault">m</span><span class="mord mathdefault">s</span><span class="mord mathdefault" style="margin-right:.03588em">g</span><span class="mclose">)</span></span></span></span>，其中hash签名算法根据具体的曲线算法而定</td></tr><tr><td>r,s</td><td>签名的结果</td></tr></tbody></table><p>签名的流程如下</p><p>1.选择一个随机整数k，计算出<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>K</mi><mo>=</mo><mi>k</mi><mi>G</mi></mrow><annotation encoding="application/x-tex">K = kG</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.68333em;vertical-align:0"></span><span class="mord mathdefault" style="margin-right:.07153em">K</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.69444em;vertical-align:0"></span><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="mord mathdefault">G</span></span></span></span>，签名<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>r</mi></mrow><annotation encoding="application/x-tex">r</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord mathdefault" style="margin-right:.02778em">r</span></span></span></span>即为点<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>K</mi></mrow><annotation encoding="application/x-tex">K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.68333em;vertical-align:0"></span><span class="mord mathdefault" style="margin-right:.07153em">K</span></span></span></span>的横坐标</p><p>2.计算出<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>z</mi><mo>=</mo><mi>H</mi><mi>a</mi><mi>s</mi><mi>h</mi><mo stretchy="false">(</mo><mi>m</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">z=Hash(m)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord mathdefault" style="margin-right:.04398em">z</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathdefault" style="margin-right:.08125em">H</span><span class="mord mathdefault">a</span><span class="mord mathdefault">s</span><span class="mord mathdefault">h</span><span class="mopen">(</span><span class="mord mathdefault">m</span><span class="mclose">)</span></span></span></span>，在本题中用的曲线为<code>SECP256k1</code>，跳转到源码中查看发现hash算法是<code>sha1</code>，则得到<code>z = int(hashlib.sha1(msg1).hexdigest(),16)</code></p><p>3.计算出<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>s</mi><mo>=</mo><msup><mi>k</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo stretchy="false">(</mo><mi>z</mi><mo>+</mo><mi>r</mi><mo>×</mo><mi>d</mi><mo stretchy="false">)</mo><mtext></mtext><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mtext></mtext><mi>n</mi></mrow><annotation encoding="application/x-tex">s=k^{-1}(z+r \times d) \bmod n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord mathdefault">s</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-.25em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:.04398em">z</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.66666em;vertical-align:-.08333em"></span><span class="mord mathdefault" style="margin-right:.02778em">r</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">×</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathdefault">d</span><span class="mclose">)</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mspace" style="margin-right:.05555555555555555em"></span><span class="mbin"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mspace" style="margin-right:.05555555555555555em"></span></span><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord mathdefault">n</span></span></span></span></p><p>4.签名值即为<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo stretchy="false">(</mo><mi>r</mi><mo separator="true">,</mo><mi>s</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(r,s)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:.02778em">r</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord mathdefault">s</span><span class="mclose">)</span></span></span></span></p><p>在本题中，两个签名所用的私钥<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>d</mi></mrow><annotation encoding="application/x-tex">d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.69444em;vertical-align:0"></span><span class="mord mathdefault">d</span></span></span></span>是一样的，不同的是随机整数<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.69444em;vertical-align:0"></span><span class="mord mathdefault" style="margin-right:.03148em">k</span></span></span></span>，但是差值不会很大，范围是可以爆破的，理清楚同余式的逻辑之后就很好写exp</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> tqdm</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.strxor <span class="keyword">import</span> strxor <span class="keyword">as</span> xor</span><br><span class="line"><span class="comment"># from pwn import xor</span></span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">sig1 = <span class="string">&#x27;3f4a6f288e35a4397201d246a98c1f9cfa463e67717fbbdcbd26d7fac75f875855455c2bfb355f7f593ffbe4c4bd1fc729cc129976b56905639100c8ac716b37&#x27;</span></span><br><span class="line">sig2 = <span class="string">&#x27;9f563b21f0ee31b2f7a1a8c6edc8ff23b63e0a9d5dd4a699ecc3164871b4982df51bb2feb4bc06c578afd21d3e6227231dd5fe1d8440f3dcd025fd3ea68f5516&#x27;</span></span><br><span class="line">enc = <span class="string">&#x27;cc66d251bfa54954890c81dc1c607bae716573949f327db18aa1f4c0f420b8d29dc7e7ff9edb17b90306bd2aa753fc3fd4dafb9cc4b771cbdd79000ef05a40c0&#x27;</span></span><br><span class="line">n = <span class="number">115792089237316195423570985008687907852837564279074904382605163141518161494337</span></span><br><span class="line">r1,s1 = <span class="built_in">int</span>(sig1[:<span class="number">64</span>],<span class="number">16</span>),<span class="built_in">int</span>(sig1[<span class="number">64</span>:],<span class="number">16</span>)</span><br><span class="line">r2,s2 = <span class="built_in">int</span>(sig2[:<span class="number">64</span>],<span class="number">16</span>),<span class="built_in">int</span>(sig2[<span class="number">64</span>:],<span class="number">16</span>)</span><br><span class="line">hm1 = <span class="built_in">int</span>(hashlib.sha1(<span class="string">b&#x27;This is the first message.&#x27;</span>).hexdigest(),<span class="number">16</span>)</span><br><span class="line">hm2 = <span class="built_in">int</span>(hashlib.sha1(<span class="string">b&#x27;Here is another message.&#x27;</span>).hexdigest(),<span class="number">16</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> t <span class="keyword">in</span> tqdm(<span class="built_in">range</span>(-<span class="number">65537</span>,<span class="number">65537</span>)):</span><br><span class="line">    k1 = (hm1 * r2 - hm2 * r1 + s2 * t * r1) * gmpy2.invert(s1 * r2 - s2 * r1,n) % n</span><br><span class="line">    d = (s1 * k1 - hm1) * gmpy2.invert(r1,n) % n</span><br><span class="line">    key = long_to_bytes(d)</span><br><span class="line">    key = hashlib.sha512(key).digest()</span><br><span class="line">    flag = xor(key,<span class="built_in">bytes</span>.fromhex(enc))</span><br><span class="line">    <span class="keyword">if</span> <span class="string">b&#x27;flag&#x27;</span> <span class="keyword">in</span> flag:</span><br><span class="line">        <span class="built_in">print</span>(flag)</span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure><h4 id="0x06-2023minil-curvesignin-511"><a class="markdownIt-Anchor" href="#0x06-2023minil-curvesignin-511"></a> 0x06 2023miniL curvesignin 5.11</h4><p>附件</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line">flag = flag.strip(<span class="string">b&#x27;miniLctf&#123;&#x27;</span>).strip(<span class="string">b&#x27;&#125;&#x27;</span>)</span><br><span class="line">flag1 = bytes_to_long(flag[:<span class="built_in">len</span>(flag)//<span class="number">2</span>])</span><br><span class="line">flag2 = bytes_to_long(flag[<span class="built_in">len</span>(flag)//<span class="number">2</span>:])</span><br><span class="line"></span><br><span class="line">q = getPrime(<span class="number">80</span>)</span><br><span class="line">a,b,c = [random.randrange(<span class="number">1</span>,q-<span class="number">1</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="string">&quot;_what_is_this_equation_?_&quot;</span>][:<span class="number">3</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">add</span>(<span class="params">P,Q</span>):</span><br><span class="line">	<span class="keyword">if</span> P[<span class="number">0</span>] != Q[<span class="number">0</span>] <span class="keyword">and</span> P[<span class="number">1</span>] != Q[<span class="number">1</span>]:</span><br><span class="line">		t = ((Q[<span class="number">1</span>]-P[<span class="number">1</span>]) * inverse(Q[<span class="number">0</span>]-P[<span class="number">0</span>],q)) %q</span><br><span class="line">	<span class="keyword">else</span>:</span><br><span class="line">		t = ((<span class="number">3</span>*c*P[<span class="number">0</span>]*P[<span class="number">0</span>]+a) * inverse(<span class="number">2</span>*b*P[<span class="number">1</span>],q))%q</span><br><span class="line"></span><br><span class="line">	x3 = b*inverse(c,q)*t*t - P[<span class="number">0</span>] - Q[<span class="number">0</span>]</span><br><span class="line">	y3 = t*(P[<span class="number">0</span>] - x3) - P[<span class="number">1</span>]</span><br><span class="line">	<span class="keyword">return</span> (x3%q, y3%q)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">mul</span>(<span class="params">t, A, B=<span class="number">0</span></span>):</span><br><span class="line">	<span class="keyword">if</span> <span class="keyword">not</span> t: <span class="keyword">return</span> B</span><br><span class="line">	<span class="keyword">return</span> mul(t//<span class="number">2</span>, add(A,A), B <span class="keyword">if</span> <span class="keyword">not</span> t&amp;<span class="number">1</span> <span class="keyword">else</span> add(B,A) <span class="keyword">if</span> B <span class="keyword">else</span> A)</span><br><span class="line"></span><br><span class="line">G = (<span class="number">543964449142803087188784</span>, <span class="number">288605946000947449279542</span>)</span><br><span class="line"><span class="keyword">assert</span> G[<span class="number">0</span>] == flag1</span><br><span class="line"></span><br><span class="line">Ps = []</span><br><span class="line">ms = [random.randrange(<span class="number">1</span>,q-<span class="number">1</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="string">&quot;welcome_to_xxxctf2023&quot;</span>[:<span class="number">4</span>]] + [flag2]</span><br><span class="line"><span class="keyword">for</span> m <span class="keyword">in</span> ms:</span><br><span class="line">	P = mul(m,G)</span><br><span class="line">	Ps.append(P)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;G = <span class="subst">&#123;G&#125;</span>\nPs = <span class="subst">&#123;Ps&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">G = (543964449142803087188784, 288605946000947449279542)</span></span><br><span class="line"><span class="string">Ps = [(615716520116903164238350, 815735349922061558569393), (256042693223413187255214, 400772499742719022770893), (620452972415969514798065, 660749148335795540667246), (118301218326000413235697, 338882909672963432813505), (793604064853039619406880, 93386361837996865025986)]</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><p>首先得通过加法函数推出原曲线，加法函数如下</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">add</span>(<span class="params">P,Q</span>):</span><br><span class="line">	<span class="keyword">if</span> P[<span class="number">0</span>] != Q[<span class="number">0</span>] <span class="keyword">and</span> P[<span class="number">1</span>] != Q[<span class="number">1</span>]:</span><br><span class="line">		t = ((Q[<span class="number">1</span>]-P[<span class="number">1</span>]) * inverse(Q[<span class="number">0</span>]-P[<span class="number">0</span>],q)) %q</span><br><span class="line">	<span class="keyword">else</span>:</span><br><span class="line">		t = ((<span class="number">3</span>*c*P[<span class="number">0</span>]*P[<span class="number">0</span>]+a) * inverse(<span class="number">2</span>*b*P[<span class="number">1</span>],q))%q</span><br><span class="line"></span><br><span class="line">	x3 = b*inverse(c,q)*t*t - P[<span class="number">0</span>] - Q[<span class="number">0</span>]</span><br><span class="line">	y3 = t*(P[<span class="number">0</span>] - x3) - P[<span class="number">1</span>]</span><br><span class="line">	<span class="keyword">return</span> (x3%q, y3%q)</span><br></pre></td></tr></table></figure><p>可以看出斜率就是t，当两个相同的点相加时，切线的斜率为<code>t = ((3*c*P[0]*P[0]+a) * inverse(2*b*P[1],q))%q</code>，也就是<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mrow><mo stretchy="false">(</mo><mn>3</mn><mi>c</mi><msup><mi>x</mi><mn>2</mn></msup><mo>+</mo><mi>a</mi><mo stretchy="false">)</mo></mrow><mrow><mo stretchy="false">(</mo><mn>2</mn><mi>b</mi><mi>y</mi><mo stretchy="false">)</mo></mrow></mfrac></mrow><annotation encoding="application/x-tex">\frac{(3cx^2+a)}{(2by)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.62892em;vertical-align:-.52em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.10892em"><span style="top:-2.655em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">2</span><span class="mord mathdefault mtight">b</span><span class="mord mathdefault mtight" style="margin-right:.03588em">y</span><span class="mclose mtight">)</span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.485em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">3</span><span class="mord mathdefault mtight">c</span><span class="mord mtight"><span class="mord mathdefault mtight">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8913142857142857em"><span style="top:-2.931em;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mbin mtight">+</span><span class="mord mathdefault mtight">a</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.52em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span>，由此可推出原曲线的格式为<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>b</mi><msup><mi>y</mi><mn>2</mn></msup><mo>=</mo><mi>c</mi><msup><mi>x</mi><mn>3</mn></msup><mo>+</mo><mi>a</mi><mi>x</mi><mo>+</mo><mi>d</mi></mrow><annotation encoding="application/x-tex">by^2=cx^3+ax+d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.008548em;vertical-align:-.19444em"></span><span class="mord mathdefault">b</span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.897438em;vertical-align:-.08333em"></span><span class="mord mathdefault">c</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.66666em;vertical-align:-.08333em"></span><span class="mord mathdefault">a</span><span class="mord mathdefault">x</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.69444em;vertical-align:0"></span><span class="mord mathdefault">d</span></span></span></span>，简化计算可令<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>c</mi></mrow><annotation encoding="application/x-tex">c</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord mathdefault">c</span></span></span></span>为1，其他系数跟着变化即可。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">PR.&lt;a,b,d&gt; = PolynomialRing(ZZ)</span><br><span class="line">ff = []</span><br><span class="line"><span class="keyword">for</span> P <span class="keyword">in</span> Ps + [G]:</span><br><span class="line">    x,y = P</span><br><span class="line">    f = x ** <span class="number">3</span> + a * x + d - b * y ** <span class="number">2</span></span><br><span class="line">    ff.append(f)</span><br><span class="line">I = Ideal(ff)</span><br><span class="line"><span class="built_in">print</span>(I.groebner_basis())</span><br><span class="line"><span class="comment">#[a + 1383761324420174433943441, b + 4911310444444537745356422, d + 101839133990109714860886, 5271017285827233379503222]</span></span><br></pre></td></tr></table></figure><p>这样就求出了各个系数，由于flag2是作为加密系数，加密方式为<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>P</mi><mo>=</mo><mi>m</mi><mi>G</mi></mrow><annotation encoding="application/x-tex">P=mG</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.68333em;vertical-align:0"></span><span class="mord mathdefault" style="margin-right:.13889em">P</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.68333em;vertical-align:0"></span><span class="mord mathdefault">m</span><span class="mord mathdefault">G</span></span></span></span>，求m，可以进行一个映射。</p><p>我们得到的曲线为<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>b</mi><msup><mi>y</mi><mn>2</mn></msup><mo>=</mo><msup><mi>x</mi><mn>3</mn></msup><mo>+</mo><mi>a</mi><mi>x</mi><mo>+</mo><mi>d</mi></mrow><annotation encoding="application/x-tex">by^2=x^3+ax+d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.008548em;vertical-align:-.19444em"></span><span class="mord mathdefault">b</span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.897438em;vertical-align:-.08333em"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.66666em;vertical-align:-.08333em"></span><span class="mord mathdefault">a</span><span class="mord mathdefault">x</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.69444em;vertical-align:0"></span><span class="mord mathdefault">d</span></span></span></span>，稍作变换可写成形如<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>y</mi><mn>2</mn></msup><mo>=</mo><msup><mi>x</mi><mn>3</mn></msup><mo>+</mo><mi>a</mi><mi>x</mi><mo>+</mo><mi>b</mi></mrow><annotation encoding="application/x-tex">y^2=x^3+ax+b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.008548em;vertical-align:-.19444em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.897438em;vertical-align:-.08333em"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.66666em;vertical-align:-.08333em"></span><span class="mord mathdefault">a</span><span class="mord mathdefault">x</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.69444em;vertical-align:0"></span><span class="mord mathdefault">b</span></span></span></span>的格式，即</p><p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo stretchy="false">(</mo><msup><mi>b</mi><mn>2</mn></msup><mi>y</mi><msup><mo stretchy="false">)</mo><mn>2</mn></msup><mo>=</mo><mo stretchy="false">(</mo><mi>b</mi><mi>x</mi><msup><mo stretchy="false">)</mo><mn>3</mn></msup><mo>+</mo><mo stretchy="false">(</mo><mi>a</mi><msup><mi>b</mi><mn>2</mn></msup><mo stretchy="false">)</mo><mo stretchy="false">(</mo><mi>b</mi><mi>x</mi><mo stretchy="false">)</mo><mo>+</mo><msup><mi>b</mi><mn>3</mn></msup><mi>d</mi></mrow><annotation encoding="application/x-tex">(b^2y)^2=(bx)^3+(ab^2)(bx)+b^3d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mord mathdefault" style="margin-right:.03588em">y</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord mathdefault">b</span><span class="mord mathdefault">x</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord mathdefault">a</span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mopen">(</span><span class="mord mathdefault">b</span><span class="mord mathdefault">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.8141079999999999em;vertical-align:0"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span><span class="mord mathdefault">d</span></span></span></span></p><p>已知的点P和点G映射到新的曲线上即可，就可以用sage中的函数求解系数，完整exp如下</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">G = (<span class="number">543964449142803087188784</span>, <span class="number">288605946000947449279542</span>)</span><br><span class="line">Ps = [(<span class="number">615716520116903164238350</span>, <span class="number">815735349922061558569393</span>), (<span class="number">256042693223413187255214</span>, <span class="number">400772499742719022770893</span>), (<span class="number">620452972415969514798065</span>, <span class="number">660749148335795540667246</span>), (<span class="number">118301218326000413235697</span>, <span class="number">338882909672963432813505</span>), (<span class="number">793604064853039619406880</span>, <span class="number">93386361837996865025986</span>)]</span><br><span class="line">P = Ps[-<span class="number">1</span>]</span><br><span class="line"><span class="comment"># PR.&lt;a,b,d&gt; = PolynomialRing(ZZ)</span></span><br><span class="line"><span class="comment"># ff = []</span></span><br><span class="line"><span class="comment"># for P in Ps + [G]:</span></span><br><span class="line"><span class="comment">#     x,y = P</span></span><br><span class="line"><span class="comment">#     f = x ** 3 + a * x + d - b * y ** 2</span></span><br><span class="line"><span class="comment">#     ff.append(f)</span></span><br><span class="line"><span class="comment"># I = Ideal(ff)</span></span><br><span class="line"><span class="comment"># print(I.groebner_basis())</span></span><br><span class="line"><span class="comment"># [a + 1383761324420174433943441, b + 4911310444444537745356422, d + 101839133990109714860886, 5271017285827233379503222]</span></span><br><span class="line">p = <span class="number">878502880971205563250537</span></span><br><span class="line">a = (-<span class="number">1383761324420174433943441</span>) % p</span><br><span class="line">b = (-<span class="number">4911310444444537745356422</span>) % p</span><br><span class="line">d = (-<span class="number">101839133990109714860886</span>) % p</span><br><span class="line">aa = (a * b ** <span class="number">2</span>) % p</span><br><span class="line">bb = (b ** <span class="number">3</span> * d) % p</span><br><span class="line">E = EllipticCurve(Zmod(p),[aa,bb])</span><br><span class="line">flag1 = long_to_bytes(G[<span class="number">0</span>])</span><br><span class="line">xg,yg = G</span><br><span class="line">xp,yp = P</span><br><span class="line">GG = ((xg * b) % p,(yg * b ** <span class="number">2</span>) % p)</span><br><span class="line">PP = ((xp * b) % p,(yp * b ** <span class="number">2</span>) % p)</span><br><span class="line">GG = E(GG)</span><br><span class="line">PP = E(PP)</span><br><span class="line">oo = GG.order()</span><br><span class="line">flag2 = GG.discrete_log(PP)</span><br><span class="line"><span class="comment">#此处求得的flag2满足mG=P，但是不是我们要求的flag2，需要再算上阶</span></span><br><span class="line">flag2 += oo</span><br><span class="line">flag2 = long_to_bytes(flag2)</span><br><span class="line"><span class="built_in">print</span>(flag1 + flag2)</span><br></pre></td></tr></table></figure><h4 id="0x05-2023nkctf-raven-328"><a class="markdownIt-Anchor" href="#0x05-2023nkctf-raven-328"></a> 0x05 2023nkctf raven 3.28</h4><p>附件</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env sage</span></span><br><span class="line"><span class="comment"># Problem by rec, with a bad raven.</span></span><br><span class="line"><span class="keyword">import</span> os, hashlib</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Raven</span>(<span class="params">n: <span class="built_in">int</span>, secret: <span class="built_in">bytes</span></span>):</span><br><span class="line">    H = <span class="keyword">lambda</span> x: hashlib.md5(os.urandom(<span class="number">8</span>) + x).digest()</span><br><span class="line"></span><br><span class="line">    p = getPrime(<span class="number">728</span>)</span><br><span class="line">    R.&lt;z&gt; = PolynomialRing(GF(p))</span><br><span class="line"></span><br><span class="line">    seed = H(secret)</span><br><span class="line">    f = R(</span><br><span class="line">        [bytes_to_long(secret)] + [bytes_to_long(H(seed)) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(n - <span class="number">1</span>)]</span><br><span class="line">    )</span><br><span class="line">    x = [getRandomRange(<span class="number">2</span>, p - <span class="number">1</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(n)]</span><br><span class="line">    y = [ZZ(f(xi)^<span class="number">2</span> + getPrime(<span class="number">256</span>)) <span class="keyword">for</span> xi <span class="keyword">in</span> x]</span><br><span class="line"></span><br><span class="line">    pairs = <span class="built_in">list</span>(<span class="built_in">zip</span>(x, y))</span><br><span class="line">    <span class="keyword">return</span> p, pairs</span><br><span class="line"></span><br><span class="line">flag = <span class="string">b&#x27;#####&#x27;</span></span><br><span class="line">key = os.urandom(<span class="number">16</span>)</span><br><span class="line">cipher = AES.new(key=key, IV=<span class="built_in">bytes</span>(<span class="built_in">range</span>(<span class="number">16</span>)), mode=AES.MODE_CBC)</span><br><span class="line">ct = cipher.encrypt(flag + os.urandom(<span class="number">16</span> - <span class="built_in">len</span>(flag) % <span class="number">16</span>))</span><br><span class="line">p, pairs = Raven(<span class="number">4</span>, key)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;p = &#125;</span>\n<span class="subst">&#123;pairs = &#125;</span>\n<span class="subst">&#123;ct = &#125;</span>&quot;</span>)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">p = 1018551160851728231474335384388576586031917743463656622083024684199383855595168341728561337234276243780407755294430553694832049089534855113774546001494743212076463713621965520780122783825100696968959866614846174188401153</span></span><br><span class="line"><span class="string">pairs = [(615358616404864757405587650175842125441380884418119777842292095751090237848084440177153221092040264723889917863863854377665802549748720692225139890884830475485512763149974948701807492663962748292710803434009673589337265, 84982753624462868217739962129526665082932464631118597651920986288766037499319751354013335054886685186857222944776560264528363811382359242656883760986496856164448940929282013856762706210675691655747370624405968909408102), (528363810186974800127873139379943131424126521611531830591311656948009967709310974894584084912262479395720199930206495204352231804549705720854271566421006481173043064265399467682307971910488405265826107365679757755866812, 496810092723839642457928776423789418365006215801711874210443222720529161066621876103037104247173440072986344011599384793861949574577559989016501090247331146721371126871470611440468688947950954988175225633457347666551944), (68711183101845981499596464753252121346970486988311398916877579778110690480447199642602267233989256728822535174215153145632158860662954277116345331672194812126361911061449082917955000137698138358926301360506687271134873, 995428771589393162202488762223106955302099250561593105620410424291405842350539887383005328242236156038373244928147473800972534658018117705291472213770335998508454938607290279268848513727721410314612261163489156360908800), (61574167546312883246262193556029081771904529137922128124933785599227801608271357738142074310192454183183340219301304405636497744152219785042075198056952749425345561162612590170550454476602892138914473795478531165181812, 618169326093802548516842299173393893046765466917311052414967158839652012130855552015876657514610755108820971877570295328618373296493668146691687291894702228119875561585283226588768969944781923428807766632578060221034862)]</span></span><br><span class="line"><span class="string">ct = b&quot;|2\xf0v7\x05Y\x89\r]\xe93s\rr)#3\xe9\x90%Z\x9a\xd9\x9ck\xba\xec]q\xb8\xf2&#x27;\xc8e~fL\xcf\x93\x00\xd6^s-\xc9\xd6M&quot;</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><p>这个格子算是我目前调过最复杂的格子了，但是原理不太难，理清楚关系即可。</p><p>理解raven中的函数，观察到函数f的函数的系数都是经过sha256的，不太可能通过逆向或者是正向爆破得解。可以确定的是sha256之后的数都不太大。本地调试的时候可以直接<code>print(f)</code>可以看到f大概是等于<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>f</mi><mo>=</mo><mi>a</mi><msup><mi>x</mi><mn>3</mn></msup><mo>+</mo><mi>b</mi><msup><mi>x</mi><mn>2</mn></msup><mo>+</mo><mi>c</mi><msup><mi>x</mi><mn>2</mn></msup><mo>+</mo><mi>d</mi></mrow><annotation encoding="application/x-tex">f=ax^3+bx^2+cx^2+d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8888799999999999em;vertical-align:-.19444em"></span><span class="mord mathdefault" style="margin-right:.10764em">f</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.897438em;vertical-align:-.08333em"></span><span class="mord mathdefault">a</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.897438em;vertical-align:-.08333em"></span><span class="mord mathdefault">b</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.897438em;vertical-align:-.08333em"></span><span class="mord mathdefault">c</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.69444em;vertical-align:0"></span><span class="mord mathdefault">d</span></span></span></span>，而其中系数<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>d</mi></mrow><annotation encoding="application/x-tex">d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.69444em;vertical-align:0"></span><span class="mord mathdefault">d</span></span></span></span>就是我们要求的量。我们有以下关于x和y的关系</p><p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>a</mi><mn>0</mn></msub><msubsup><mi>x</mi><mi>i</mi><mn>6</mn></msubsup><mo>+</mo><msub><mi>a</mi><mn>1</mn></msub><msubsup><mi>x</mi><mi>i</mi><mn>5</mn></msubsup><mo>+</mo><msub><mi>a</mi><mn>2</mn></msub><msubsup><mi>x</mi><mi>i</mi><mn>4</mn></msubsup><mo>+</mo><msub><mi>a</mi><mn>3</mn></msub><msubsup><mi>x</mi><mi>i</mi><mn>3</mn></msubsup><mo>+</mo><msub><mi>a</mi><mn>4</mn></msub><msubsup><mi>x</mi><mi>i</mi><mn>2</mn></msubsup><mo>+</mo><msub><mi>a</mi><mn>5</mn></msub><msub><mi>x</mi><mi>i</mi></msub><mo>+</mo><msub><mi>a</mi><mn>6</mn></msub><mo>+</mo><msub><mi>t</mi><mi>i</mi></msub><mo>=</mo><mi>y</mi><mo>+</mo><msub><mi>k</mi><mi>i</mi></msub><mi>p</mi></mrow><annotation encoding="application/x-tex">a_0x_i^6+a_1x_i^5+a_2x_i^4+a_3x_i^3+a_4x_i^2+a_5x_i+a_6+t_i=y+k_ip</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.072772em;vertical-align:-.258664em"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-2.441336em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">6</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.258664em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.072772em;vertical-align:-.258664em"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-2.441336em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">5</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.258664em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.072772em;vertical-align:-.258664em"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-2.441336em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.258664em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.072772em;vertical-align:-.258664em"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-2.441336em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.258664em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.072772em;vertical-align:-.258664em"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-2.441336em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.258664em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.73333em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">5</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.73333em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">6</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.76508em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathdefault">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.7777700000000001em;vertical-align:-.19444em"></span><span class="mord mathdefault" style="margin-right:.03588em">y</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.8888799999999999em;vertical-align:-.19444em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord mathdefault">p</span></span></span></span></p><p>i的范围从0-3共4组，t为256位的素数，由此我们可以构造格(中间加一列常数<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mn>2</mn><mn>256</mn></msup></mrow><annotation encoding="application/x-tex">2^{256}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8141079999999999em;vertical-align:0"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">5</span><span class="mord mtight">6</span></span></span></span></span></span></span></span></span></span></span></span>是为了让格子成为一个方阵)</p><p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mo fence="true">[</mo><mtable rowspacing="0.15999999999999992em" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>a</mi><mn>0</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>a</mi><mn>1</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mo>…</mo></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>a</mi><mn>5</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>−</mo><mn>1</mn></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>k</mi><mn>0</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>k</mi><mn>1</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>k</mi><mn>2</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>k</mi><mn>3</mn></msub></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mrow><mo fence="true">[</mo><mtable rowspacing="0.15999999999999992em" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mo>…</mo></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msup><msub><mi>x</mi><mn>0</mn></msub><mn>6</mn></msup></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msup><msub><mi>x</mi><mn>1</mn></msub><mn>6</mn></msup></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msup><msub><mi>x</mi><mn>2</mn></msub><mn>6</mn></msup></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msup><msub><mi>x</mi><mn>3</mn></msub><mn>6</mn></msup></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mo>…</mo></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msup><msub><mi>x</mi><mn>0</mn></msub><mn>5</mn></msup></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msup><msub><mi>x</mi><mn>1</mn></msub><mn>5</mn></msup></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msup><msub><mi>x</mi><mn>2</mn></msub><mn>5</mn></msup></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msup><msub><mi>x</mi><mn>3</mn></msub><mn>5</mn></msup></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mi mathvariant="normal">⋮</mi><mpadded height="+0em" voffset="0em"><mspace mathbackground="black" width="0em" height="1.5em"></mspace></mpadded></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi mathvariant="normal">⋮</mi><mpadded height="+0em" voffset="0em"><mspace mathbackground="black" width="0em" height="1.5em"></mspace></mpadded></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mo>⋱</mo></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi mathvariant="normal">⋮</mi><mpadded height="+0em" voffset="0em"><mspace mathbackground="black" width="0em" height="1.5em"></mspace></mpadded></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi mathvariant="normal">⋮</mi><mpadded height="+0em" voffset="0em"><mspace mathbackground="black" width="0em" height="1.5em"></mspace></mpadded></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi mathvariant="normal">⋮</mi><mpadded height="+0em" voffset="0em"><mspace mathbackground="black" width="0em" height="1.5em"></mspace></mpadded></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi mathvariant="normal">⋮</mi><mpadded height="+0em" voffset="0em"><mspace mathbackground="black" width="0em" height="1.5em"></mspace></mpadded></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi mathvariant="normal">⋮</mi><mpadded height="+0em" voffset="0em"><mspace mathbackground="black" width="0em" height="1.5em"></mspace></mpadded></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi mathvariant="normal">⋮</mi><mpadded height="+0em" voffset="0em"><mspace mathbackground="black" width="0em" height="1.5em"></mspace></mpadded></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mo>…</mo></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>x</mi><mn>0</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>x</mi><mn>1</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>x</mi><mn>2</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>x</mi><mn>3</mn></msub></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mo>…</mo></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msup><mn>2</mn><mn>256</mn></msup></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>y</mi><mn>0</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>y</mi><mn>1</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>y</mi><mn>2</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>y</mi><mn>3</mn></msub></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mo>…</mo></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi>p</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mo>…</mo></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi>p</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mo>…</mo></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi>p</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mo>…</mo></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi>p</mi></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mrow><mo fence="true">[</mo><mtable rowspacing="0.15999999999999992em" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>a</mi><mn>0</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>a</mi><mn>1</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mo>…</mo></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>a</mi><mn>5</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msup><mn>2</mn><mn>256</mn></msup></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>a</mi><mn>6</mn></msub><mo>+</mo><msub><mi>t</mi><mn>0</mn></msub></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>a</mi><mn>6</mn></msub><mo>+</mo><msub><mi>t</mi><mn>1</mn></msub></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>a</mi><mn>6</mn></msub><mo>+</mo><msub><mi>t</mi><mn>2</mn></msub></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>a</mi><mn>6</mn></msub><mo>+</mo><msub><mi>t</mi><mn>3</mn></msub></mrow></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex">\begin{bmatrix} {a_0}&amp;{a_1}&amp;\dots&amp;{a_5}&amp;-1&amp;{k_0}&amp;{k_1}&amp;{k_2}&amp;{k_3} \end{bmatrix} \begin{bmatrix} 1&amp;0&amp;\dots&amp;0&amp;0&amp;{x_0}^6&amp;{x_1}^6&amp;{x_2}^6&amp;{x_3}^6\\ 0&amp;1&amp;\dots&amp;0&amp;0&amp;{x_0}^5&amp;{x_1}^5&amp;{x_2}^5&amp;{x_3}^5\\ \vdots&amp;\vdots&amp;\ddots&amp;\vdots&amp;\vdots&amp;\vdots&amp;\vdots&amp;\vdots&amp;\vdots\\ 0&amp;0&amp;\dots&amp;1&amp;0&amp;{x_0}&amp;{x_1}&amp;{x_2}&amp;{x_3}\\ 0&amp;0&amp;\dots&amp;0&amp;2^{256}&amp;{y_0}&amp;{y_1}&amp;{y_2}&amp;{y_3}\\ 0&amp;0&amp;\dots&amp;0&amp;0&amp;p&amp;0&amp;0&amp;0 \\ 0&amp;0&amp;\dots&amp;0&amp;0&amp;0&amp;p&amp;0&amp;0 \\ 0&amp;0&amp;\dots&amp;0&amp;0&amp;0&amp;0&amp;p&amp;0 \\ 0&amp;0&amp;\dots&amp;0&amp;0&amp;0&amp;0&amp;0&amp;p \\ \end{bmatrix} \begin{bmatrix} {a_0}&amp;{a_1}&amp;\dots&amp;{a_5}&amp;2^{256}&amp;{a_6} + {t_0}&amp;{a_6} + {t_1}&amp;{a_6} + {t_2}&amp;{a_6} + {t_3} \end{bmatrix}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:11.459999999999999em;vertical-align:-5.4799999999999995em"></span><span class="minner"><span class="mopen delimcenter" style="top:0"><span class="delimsizing size1">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.8500000000000001em"><span style="top:-3.01em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.35000000000000003em"><span></span></span></span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.8500000000000001em"><span style="top:-3.01em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.35000000000000003em"><span></span></span></span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.8500000000000001em"><span style="top:-3.01em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="minner">…</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.35000000000000003em"><span></span></span></span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.8500000000000001em"><span style="top:-3.01em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">5</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.35000000000000003em"><span></span></span></span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.8500000000000001em"><span style="top:-3.01em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">−</span><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.35000000000000003em"><span></span></span></span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.8500000000000001em"><span style="top:-3.01em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.35000000000000003em"><span></span></span></span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.8500000000000001em"><span style="top:-3.01em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.35000000000000003em"><span></span></span></span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.8500000000000001em"><span style="top:-3.01em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.35000000000000003em"><span></span></span></span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.8500000000000001em"><span style="top:-3.01em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.35000000000000003em"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0"><span class="delimsizing size1">]</span></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:5.962955em"><span style="top:1.6500649999999992em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎣</span></span></span><span style="top:.4950649999999994em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎢</span></span></span><span style="top:-.10593500000000056em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎢</span></span></span><span style="top:-.7069350000000005em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎢</span></span></span><span style="top:-1.3079350000000005em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎢</span></span></span><span style="top:-1.9089350000000005em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎢</span></span></span><span style="top:-2.5099350000000005em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎢</span></span></span><span style="top:-3.1109350000000004em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎢</span></span></span><span style="top:-3.7119350000000004em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎢</span></span></span><span style="top:-4.312935em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎢</span></span></span><span style="top:-4.913935em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎢</span></span></span><span style="top:-5.514935em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎢</span></span></span><span style="top:-6.115935em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎢</span></span></span><span style="top:-6.716935em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎢</span></span></span><span style="top:-7.962955em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎡</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:5.450085em"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:5.9799999999999995em"><span style="top:-8.827499999999999em"><span class="pstrut" style="height:3.6875em"></span><span class="mord"><span class="mord">1</span></span></span><span style="top:-7.6274999999999995em"><span class="pstrut" style="height:3.6875em"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-5.7675em"><span class="pstrut" style="height:3.6875em"></span><span class="mord"><span class="mord"><span class="mord">⋮</span><span class="mord rule" style="border-right-width:0;border-top-width:1.5em;bottom:0"></span></span></span></span><span style="top:-4.567500000000001em"><span class="pstrut" style="height:3.6875em"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-3.3675em"><span class="pstrut" style="height:3.6875em"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-2.1675em"><span class="pstrut" style="height:3.6875em"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-.9674999999999991em"><span class="pstrut" style="height:3.6875em"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:.2325000000000002em"><span class="pstrut" style="height:3.6875em"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:1.4324999999999994em"><span class="pstrut" style="height:3.6875em"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:5.4799999999999995em"><span></span></span></span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:5.9799999999999995em"><span style="top:-8.827499999999999em"><span class="pstrut" style="height:3.6875em"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-7.6274999999999995em"><span class="pstrut" style="height:3.6875em"></span><span class="mord"><span class="mord">1</span></span></span><span style="top:-5.7675em"><span class="pstrut" style="height:3.6875em"></span><span class="mord"><span class="mord"><span class="mord">⋮</span><span class="mord rule" style="border-right-width:0;border-top-width:1.5em;bottom:0"></span></span></span></span><span style="top:-4.567500000000001em"><span class="pstrut" style="height:3.6875em"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-3.3675em"><span class="pstrut" style="height:3.6875em"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-2.1675em"><span class="pstrut" style="height:3.6875em"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-.9674999999999991em"><span class="pstrut" style="height:3.6875em"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:.2325000000000002em"><span class="pstrut" style="height:3.6875em"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:1.4324999999999994em"><span class="pstrut" style="height:3.6875em"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:5.4799999999999995em"><span></span></span></span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:5.9799999999999995em"><span style="top:-8.639999999999999em"><span class="pstrut" style="height:3.5em"></span><span class="mord"><span class="minner">…</span></span></span><span style="top:-7.4399999999999995em"><span class="pstrut" style="height:3.5em"></span><span class="mord"><span class="minner">…</span></span></span><span style="top:-5.58em"><span class="pstrut" style="height:3.5em"></span><span class="mord"><span class="minner">⋱</span></span></span><span style="top:-4.380000000000001em"><span class="pstrut" style="height:3.5em"></span><span class="mord"><span class="minner">…</span></span></span><span style="top:-3.18em"><span class="pstrut" style="height:3.5em"></span><span class="mord"><span class="minner">…</span></span></span><span style="top:-1.9800000000000002em"><span class="pstrut" style="height:3.5em"></span><span class="mord"><span class="minner">…</span></span></span><span style="top:-.7799999999999991em"><span class="pstrut" style="height:3.5em"></span><span class="mord"><span class="minner">…</span></span></span><span style="top:.4200000000000002em"><span class="pstrut" style="height:3.5em"></span><span class="mord"><span class="minner">…</span></span></span><span style="top:1.6199999999999994em"><span class="pstrut" style="height:3.5em"></span><span class="mord"><span class="minner">…</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:5.4799999999999995em"><span></span></span></span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:5.9799999999999995em"><span style="top:-8.827499999999999em"><span class="pstrut" style="height:3.6875em"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-7.6274999999999995em"><span class="pstrut" style="height:3.6875em"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-5.7675em"><span class="pstrut" style="height:3.6875em"></span><span class="mord"><span class="mord"><span class="mord">⋮</span><span class="mord rule" style="border-right-width:0;border-top-width:1.5em;bottom:0"></span></span></span></span><span style="top:-4.567500000000001em"><span class="pstrut" style="height:3.6875em"></span><span class="mord"><span class="mord">1</span></span></span><span style="top:-3.3675em"><span class="pstrut" style="height:3.6875em"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-2.1675em"><span class="pstrut" style="height:3.6875em"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-.9674999999999991em"><span class="pstrut" style="height:3.6875em"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:.2325000000000002em"><span class="pstrut" style="height:3.6875em"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:1.4324999999999994em"><span class="pstrut" style="height:3.6875em"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:5.4799999999999995em"><span></span></span></span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:5.9799999999999995em"><span style="top:-8.827499999999999em"><span class="pstrut" style="height:3.6875em"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-7.6274999999999995em"><span class="pstrut" style="height:3.6875em"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-5.7675em"><span class="pstrut" style="height:3.6875em"></span><span class="mord"><span class="mord"><span class="mord">⋮</span><span class="mord rule" style="border-right-width:0;border-top-width:1.5em;bottom:0"></span></span></span></span><span style="top:-4.567500000000001em"><span class="pstrut" style="height:3.6875em"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-3.3675em"><span class="pstrut" style="height:3.6875em"></span><span class="mord"><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">5</span><span class="mord mtight">6</span></span></span></span></span></span></span></span></span></span></span><span style="top:-2.1675em"><span class="pstrut" style="height:3.6875em"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-.9674999999999991em"><span class="pstrut" style="height:3.6875em"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:.2325000000000002em"><span class="pstrut" style="height:3.6875em"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:1.4324999999999994em"><span class="pstrut" style="height:3.6875em"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:5.4799999999999995em"><span></span></span></span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:5.9799999999999995em"><span style="top:-8.827499999999999em"><span class="pstrut" style="height:3.6875em"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">6</span></span></span></span></span></span></span></span></span></span><span style="top:-7.6274999999999995em"><span class="pstrut" style="height:3.6875em"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">5</span></span></span></span></span></span></span></span></span></span><span style="top:-5.7675em"><span class="pstrut" style="height:3.6875em"></span><span class="mord"><span class="mord"><span class="mord">⋮</span><span class="mord rule" style="border-right-width:0;border-top-width:1.5em;bottom:0"></span></span></span></span><span style="top:-4.567500000000001em"><span class="pstrut" style="height:3.6875em"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.3675em"><span class="pstrut" style="height:3.6875em"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span><span style="top:-2.1675em"><span class="pstrut" style="height:3.6875em"></span><span class="mord"><span class="mord mathdefault">p</span></span></span><span style="top:-.9674999999999991em"><span class="pstrut" style="height:3.6875em"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:.2325000000000002em"><span class="pstrut" style="height:3.6875em"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:1.4324999999999994em"><span class="pstrut" style="height:3.6875em"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:5.4799999999999995em"><span></span></span></span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:5.9799999999999995em"><span style="top:-8.827499999999999em"><span class="pstrut" style="height:3.6875em"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">6</span></span></span></span></span></span></span></span></span></span><span style="top:-7.6274999999999995em"><span class="pstrut" style="height:3.6875em"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">5</span></span></span></span></span></span></span></span></span></span><span style="top:-5.7675em"><span class="pstrut" style="height:3.6875em"></span><span class="mord"><span class="mord"><span class="mord">⋮</span><span class="mord rule" style="border-right-width:0;border-top-width:1.5em;bottom:0"></span></span></span></span><span style="top:-4.567500000000001em"><span class="pstrut" style="height:3.6875em"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.3675em"><span class="pstrut" style="height:3.6875em"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span><span style="top:-2.1675em"><span class="pstrut" style="height:3.6875em"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-.9674999999999991em"><span class="pstrut" style="height:3.6875em"></span><span class="mord"><span class="mord mathdefault">p</span></span></span><span style="top:.2325000000000002em"><span class="pstrut" style="height:3.6875em"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:1.4324999999999994em"><span class="pstrut" style="height:3.6875em"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:5.4799999999999995em"><span></span></span></span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:5.9799999999999995em"><span style="top:-8.827499999999999em"><span class="pstrut" style="height:3.6875em"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">6</span></span></span></span></span></span></span></span></span></span><span style="top:-7.6274999999999995em"><span class="pstrut" style="height:3.6875em"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">5</span></span></span></span></span></span></span></span></span></span><span style="top:-5.7675em"><span class="pstrut" style="height:3.6875em"></span><span class="mord"><span class="mord"><span class="mord">⋮</span><span class="mord rule" style="border-right-width:0;border-top-width:1.5em;bottom:0"></span></span></span></span><span style="top:-4.567500000000001em"><span class="pstrut" style="height:3.6875em"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.3675em"><span class="pstrut" style="height:3.6875em"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span><span style="top:-2.1675em"><span class="pstrut" style="height:3.6875em"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-.9674999999999991em"><span class="pstrut" style="height:3.6875em"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:.2325000000000002em"><span class="pstrut" style="height:3.6875em"></span><span class="mord"><span class="mord mathdefault">p</span></span></span><span style="top:1.4324999999999994em"><span class="pstrut" style="height:3.6875em"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:5.4799999999999995em"><span></span></span></span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:5.9799999999999995em"><span style="top:-8.827499999999999em"><span class="pstrut" style="height:3.6875em"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">6</span></span></span></span></span></span></span></span></span></span><span style="top:-7.6274999999999995em"><span class="pstrut" style="height:3.6875em"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">5</span></span></span></span></span></span></span></span></span></span><span style="top:-5.7675em"><span class="pstrut" style="height:3.6875em"></span><span class="mord"><span class="mord"><span class="mord">⋮</span><span class="mord rule" style="border-right-width:0;border-top-width:1.5em;bottom:0"></span></span></span></span><span style="top:-4.567500000000001em"><span class="pstrut" style="height:3.6875em"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.3675em"><span class="pstrut" style="height:3.6875em"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span><span style="top:-2.1675em"><span class="pstrut" style="height:3.6875em"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-.9674999999999991em"><span class="pstrut" style="height:3.6875em"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:.2325000000000002em"><span class="pstrut" style="height:3.6875em"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:1.4324999999999994em"><span class="pstrut" style="height:3.6875em"></span><span class="mord"><span class="mord mathdefault">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:5.4799999999999995em"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:5.962955em"><span style="top:1.6500649999999992em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎦</span></span></span><span style="top:.4950649999999994em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎥</span></span></span><span style="top:-.10593500000000056em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎥</span></span></span><span style="top:-.7069350000000005em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎥</span></span></span><span style="top:-1.3079350000000005em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎥</span></span></span><span style="top:-1.9089350000000005em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎥</span></span></span><span style="top:-2.5099350000000005em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎥</span></span></span><span style="top:-3.1109350000000004em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎥</span></span></span><span style="top:-3.7119350000000004em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎥</span></span></span><span style="top:-4.312935em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎥</span></span></span><span style="top:-4.913935em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎥</span></span></span><span style="top:-5.514935em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎥</span></span></span><span style="top:-6.115935em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎥</span></span></span><span style="top:-6.716935em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎥</span></span></span><span style="top:-7.962955em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎤</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:5.450085em"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="minner"><span class="mopen delimcenter" style="top:0"><span class="delimsizing size1">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.8500000000000001em"><span style="top:-3.01em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.35000000000000003em"><span></span></span></span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.8500000000000001em"><span style="top:-3.01em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.35000000000000003em"><span></span></span></span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.8500000000000001em"><span style="top:-3.01em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="minner">…</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.35000000000000003em"><span></span></span></span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.8500000000000001em"><span style="top:-3.01em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">5</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.35000000000000003em"><span></span></span></span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.8500000000000001em"><span style="top:-3.01em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">5</span><span class="mord mtight">6</span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.35000000000000003em"><span></span></span></span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.8500000000000001em"><span style="top:-3.01em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">6</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.35000000000000003em"><span></span></span></span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.8500000000000001em"><span style="top:-3.01em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">6</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.35000000000000003em"><span></span></span></span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.8500000000000001em"><span style="top:-3.01em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">6</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.35000000000000003em"><span></span></span></span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.8500000000000001em"><span style="top:-3.01em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">6</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.35000000000000003em"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0"><span class="delimsizing size1">]</span></span></span></span></span></span></span></p><p>造好中间这个格子之后，LLL出来第一行就是我们要的变量，通过5个系数可以求出最后的secret，之后便可求得flag</p><p>最后的exp为</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line">p = <span class="number">1018551160851728231474335384388576586031917743463656622083024684199383855595168341728561337234276243780407755294430553694832049089534855113774546001494743212076463713621965520780122783825100696968959866614846174188401153</span></span><br><span class="line">pairs = [(<span class="number">615358616404864757405587650175842125441380884418119777842292095751090237848084440177153221092040264723889917863863854377665802549748720692225139890884830475485512763149974948701807492663962748292710803434009673589337265</span>, <span class="number">84982753624462868217739962129526665082932464631118597651920986288766037499319751354013335054886685186857222944776560264528363811382359242656883760986496856164448940929282013856762706210675691655747370624405968909408102</span>), (<span class="number">528363810186974800127873139379943131424126521611531830591311656948009967709310974894584084912262479395720199930206495204352231804549705720854271566421006481173043064265399467682307971910488405265826107365679757755866812</span>, <span class="number">496810092723839642457928776423789418365006215801711874210443222720529161066621876103037104247173440072986344011599384793861949574577559989016501090247331146721371126871470611440468688947950954988175225633457347666551944</span>), (<span class="number">68711183101845981499596464753252121346970486988311398916877579778110690480447199642602267233989256728822535174215153145632158860662954277116345331672194812126361911061449082917955000137698138358926301360506687271134873</span>, <span class="number">995428771589393162202488762223106955302099250561593105620410424291405842350539887383005328242236156038373244928147473800972534658018117705291472213770335998508454938607290279268848513727721410314612261163489156360908800</span>), (<span class="number">61574167546312883246262193556029081771904529137922128124933785599227801608271357738142074310192454183183340219301304405636497744152219785042075198056952749425345561162612590170550454476602892138914473795478531165181812</span>, <span class="number">618169326093802548516842299173393893046765466917311052414967158839652012130855552015876657514610755108820971877570295328618373296493668146691687291894702228119875561585283226588768969944781923428807766632578060221034862</span>)]</span><br><span class="line">ct = <span class="string">b&quot;|2\xf0v7\x05Y\x89\r]\xe93s\rr)#3\xe9\x90%Z\x9a\xd9\x9ck\xba\xec]q\xb8\xf2&#x27;\xc8e~fL\xcf\x93\x00\xd6^s-\xc9\xd6M&quot;</span></span><br><span class="line">xs = [x <span class="keyword">for</span> x,y <span class="keyword">in</span> pairs]</span><br><span class="line">ys = [y <span class="keyword">for</span> x,y <span class="keyword">in</span> pairs]</span><br><span class="line">mat = [[<span class="number">0</span> <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">11</span>)] <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">11</span>)]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">6</span>):</span><br><span class="line">    mat[i][i] = <span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">        mat[i][<span class="number">7</span> + j] = <span class="built_in">int</span>(xs[j] ** (<span class="number">6</span> - i))</span><br><span class="line">mat[<span class="number">6</span>][<span class="number">6</span>] = <span class="number">1</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">7</span>,<span class="number">11</span>):</span><br><span class="line">    mat[<span class="number">6</span>][i] = ys[i - <span class="number">7</span>]</span><br><span class="line">    mat[i][i] = p</span><br><span class="line">mat = matrix(ZZ,mat)</span><br><span class="line"><span class="comment"># print(mat.LLL())</span></span><br><span class="line">ans = <span class="built_in">list</span>(<span class="built_in">map</span>(<span class="built_in">abs</span>,<span class="built_in">list</span>(mat.LLL()[<span class="number">0</span>])))</span><br><span class="line"><span class="built_in">print</span>(ans)</span><br><span class="line">t1,t2,t3,_,_,t6 = ans[:<span class="number">6</span>]</span><br><span class="line">a = isqrt(t1)</span><br><span class="line">b = t2 // (<span class="number">2</span> * a)</span><br><span class="line">c = (t3 - b ** <span class="number">2</span>) // (<span class="number">2</span> * a)</span><br><span class="line">secret = t6 // (<span class="number">2</span> * c)</span><br><span class="line"><span class="built_in">print</span>(a,b,c,secret)</span><br><span class="line">key = long_to_bytes(secret)</span><br><span class="line">aes = AES.new(key=key, IV=<span class="built_in">bytes</span>(<span class="built_in">range</span>(<span class="number">16</span>)), mode=AES.MODE_CBC)</span><br><span class="line">flag = aes.decrypt(ct)</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure><h4 id="0x04-2023nkctf-fake_mt-328"><a class="markdownIt-Anchor" href="#0x04-2023nkctf-fake_mt-328"></a> 0x04 2023nkctf fake_MT 3.28</h4><p>附件</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="comment"># import signal</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">guess_number_1</span>():</span><br><span class="line">    randoms = []</span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">208</span>):</span><br><span class="line">        randoms.append(random.getrandbits(<span class="number">96</span>))</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;randoms = &quot;</span>+<span class="built_in">str</span>(randoms))</span><br><span class="line">    number = <span class="built_in">str</span>(random.getrandbits(<span class="number">96</span>))</span><br><span class="line">    guess = <span class="built_in">str</span>(<span class="built_in">input</span>(<span class="string">&quot;Guess after number:&quot;</span>))</span><br><span class="line">    <span class="keyword">if</span> guess != number:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Wrong Number! Guess again.&quot;</span>)</span><br><span class="line">        exit(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">guess_number_2</span>():</span><br><span class="line">    number = <span class="built_in">str</span>(random.getrandbits(<span class="number">96</span>))</span><br><span class="line">    randoms = []</span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">627</span>):</span><br><span class="line">        randoms.append(random.getrandbits(<span class="number">32</span>))</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;randoms = &quot;</span>+<span class="built_in">str</span>(randoms))</span><br><span class="line">    guess = <span class="built_in">str</span>(<span class="built_in">input</span>(<span class="string">&quot;Guess pre number:&quot;</span>))</span><br><span class="line">    <span class="keyword">if</span> guess != number:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Wrong Number! Guess again.&quot;</span>)</span><br><span class="line">        exit(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">guess_number_3</span>():</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_int32</span>(<span class="params">x</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">int</span>(<span class="number">0xFFFFFFFF</span> &amp; x)  </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">init</span>(<span class="params">seed</span>):</span><br><span class="line">        mt = [<span class="number">0</span>] * <span class="number">624</span></span><br><span class="line">        mt[<span class="number">0</span>] = seed</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">624</span>):</span><br><span class="line">            mt[i] = _int32(<span class="number">1812433253</span> * (mt[i - <span class="number">1</span>] ^ mt[i - <span class="number">1</span>] &gt;&gt; <span class="number">30</span>) + i)</span><br><span class="line">        <span class="keyword">return</span> mt[-<span class="number">1</span>]</span><br><span class="line">    number = random.getrandbits(<span class="number">32</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;last number = &quot;</span>+ <span class="built_in">str</span>(init(number)))</span><br><span class="line">    guess = <span class="built_in">int</span>(<span class="built_in">str</span>(<span class="built_in">input</span>(<span class="string">&quot;Guess seed number:&quot;</span>)))</span><br><span class="line">    <span class="keyword">if</span> guess != number:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Wrong Number! Guess again.&quot;</span>)</span><br><span class="line">        exit(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">guess_number_4</span>():</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">extract_number</span>(<span class="params">y</span>):</span><br><span class="line">        y = y ^ y &gt;&gt; <span class="number">11</span></span><br><span class="line">        y = y ^ y &lt;&lt; <span class="number">7</span> &amp; <span class="number">2636928640</span></span><br><span class="line">        y = y ^ y &lt;&lt; <span class="number">15</span> &amp; <span class="number">4022730752</span></span><br><span class="line">        y = y ^ y &gt;&gt; <span class="number">18</span></span><br><span class="line">        <span class="keyword">return</span> y&amp;<span class="number">0xffffffff</span></span><br><span class="line"></span><br><span class="line">    number = random.getrandbits(<span class="number">32</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;extract number = &quot;</span>+ <span class="built_in">str</span>(extract_number(number)))</span><br><span class="line">    guess = <span class="built_in">int</span>(<span class="built_in">str</span>(<span class="built_in">input</span>(<span class="string">&quot;Guess be extracted number:&quot;</span>)))</span><br><span class="line">    <span class="keyword">if</span> guess != number:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Wrong Number! Guess again.&quot;</span>)</span><br><span class="line">        exit(<span class="number">0</span>)</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Welcome to the Mersenne Twister basic challenge. Please try to solve 20 challenges in 60 seconds.&quot;</span>)</span><br><span class="line"><span class="comment"># signal.alarm(60)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">20</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Round: &quot;</span>+<span class="built_in">str</span>(i+<span class="number">1</span>))</span><br><span class="line">    random.choice([guess_number_1,guess_number_2,guess_number_3,guess_number_4])()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Good job!&quot;</span>)</span><br><span class="line"></span><br><span class="line">flag = <span class="built_in">open</span>(<span class="string">&#x27;/flag&#x27;</span>).read()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Congratulations on passing the challenge. This is your flag: &quot;</span> + <span class="built_in">str</span>(flag))</span><br></pre></td></tr></table></figure><p>题目不难，一直没有在blog里记过mt19937的题目。</p><p>题目一共4个不同的挑战，通过20次即可拿到flag。</p><p><code>guess_number_1</code>是预测后一位随机数，<code>guess_number_2</code>是预测之前的随机数，<code>guess_number_3</code>是根据mt19937的原理逆向函数预测之前的数，<code>guess_number_4</code>也是逆向函数。</p><p>mt19937一直有一个很好用的包，<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2tteWsvbWVyc2VubmUtdHdpc3Rlci1wcmVkaWN0b3IlRUYlQkMlOEMlRTQlQjglOEQlRTUlQkIlQkElRTglQUUlQUUlRTUlODglOUQlRTUlQUQlQTYlRTglODAlODUlRTQlQkQlQkYlRTclOTQlQTglRUYlQkMlOEMlRTglQkYlODclRTQlQkElOEUlRTYlOTYlQjklRTQlQkUlQkYlRTQlQjglOEQlRTklODAlODIlRTUlOTAlODglRTUlOUMlQTglRTQlQkElODYlRTglQTclQTMlRTUlOEUlOUYlRTclOTAlODYlRTclOUElODQlRTklOTglQjYlRTYlQUUlQjUlRTQlQkQlQkYlRTclOTQlQTglRTMlODAlODIlRTklOUElQkUlRTUlQkElQTYlRTQlQjglOEQlRTUlQTQlQTclRUYlQkMlOEMlRTUlQjAlQjElRTclOUIlQjQlRTYlOEUlQTUlRTYlOTQlQkVleHAlRTQlQkElODY=">https://github.com/kmyk/mersenne-twister-predictor，不建议初学者使用，过于方便不适合在了解原理的阶段使用。难度不大，就直接放exp了</span></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> tqdm</span><br><span class="line"><span class="keyword">from</span> extend_mt19937_predictor <span class="keyword">import</span> ExtendMT19937Predictor</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">inverse_right</span>(<span class="params">res, shift</span>):</span><br><span class="line">    tmp = res</span><br><span class="line">    bits = <span class="built_in">len</span>(<span class="built_in">bin</span>(res)[<span class="number">2</span>:])</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(bits // shift):</span><br><span class="line">        tmp = res ^ tmp &gt;&gt; shift</span><br><span class="line">    <span class="keyword">return</span> tmp</span><br><span class="line"></span><br><span class="line"><span class="comment"># right shift with mask inverse</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">inverse_right_mask</span>(<span class="params">res, shift, mask</span>):</span><br><span class="line">    tmp = res</span><br><span class="line">    bits = <span class="built_in">len</span>(<span class="built_in">bin</span>(res)[<span class="number">2</span>:])</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(bits // shift):</span><br><span class="line">        tmp = res ^ tmp &gt;&gt; shift &amp; mask</span><br><span class="line">    <span class="keyword">return</span> tmp</span><br><span class="line"></span><br><span class="line"><span class="comment"># left shift inverse</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">inverse_left</span>(<span class="params">res, shift</span>):</span><br><span class="line">    tmp = res</span><br><span class="line">    bits = <span class="built_in">len</span>(<span class="built_in">bin</span>(res)[<span class="number">2</span>:])</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(bits // shift):</span><br><span class="line">        tmp = res ^ tmp &lt;&lt; shift</span><br><span class="line">    <span class="keyword">return</span> tmp</span><br><span class="line"></span><br><span class="line"><span class="comment"># left shift with mask inverse</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">inverse_left_mask</span>(<span class="params">res, shift, mask</span>):</span><br><span class="line">    tmp = res</span><br><span class="line">    bits = <span class="built_in">len</span>(<span class="built_in">bin</span>(res)[<span class="number">2</span>:])</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(bits // shift):</span><br><span class="line">        tmp = res ^ tmp &lt;&lt; shift &amp; mask</span><br><span class="line">    <span class="keyword">return</span> tmp</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">extract_number</span>(<span class="params">y</span>):</span><br><span class="line">    y = y ^ y &gt;&gt; <span class="number">11</span></span><br><span class="line">    y = y ^ y &lt;&lt; <span class="number">7</span> &amp; <span class="number">2636928640</span></span><br><span class="line">    y = y ^ y &lt;&lt; <span class="number">15</span> &amp; <span class="number">4022730752</span></span><br><span class="line">    y = y ^ y &gt;&gt; <span class="number">18</span></span><br><span class="line">    <span class="keyword">return</span> y</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">recover</span>(<span class="params">y</span>):</span><br><span class="line">    y = inverse_right(y, <span class="number">18</span>)</span><br><span class="line">    y = inverse_left_mask(y, <span class="number">15</span>, <span class="number">4022730752</span>)</span><br><span class="line">    y = inverse_left_mask(y, <span class="number">7</span>, <span class="number">2636928640</span>)</span><br><span class="line">    y = inverse_right(y, <span class="number">11</span>)</span><br><span class="line">    <span class="keyword">return</span> y</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">hacker1</span>(<span class="params">randoms</span>):</span><br><span class="line">    hacker = ExtendMT19937Predictor()</span><br><span class="line">    [hacker.setrandbits(i,<span class="number">96</span>) <span class="keyword">for</span> i <span class="keyword">in</span> randoms]</span><br><span class="line">    ans = hacker.predict_getrandbits(<span class="number">96</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">str</span>(ans).encode()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">hacker2</span>(<span class="params">randoms</span>):</span><br><span class="line">    hacker = ExtendMT19937Predictor()</span><br><span class="line">    [hacker.setrandbits(i,<span class="number">32</span>) <span class="keyword">for</span> i <span class="keyword">in</span> randoms]</span><br><span class="line">    [hacker.backtrack_getrandbits(<span class="number">32</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">627</span>)]</span><br><span class="line">    ans = hacker.backtrack_getrandbits(<span class="number">96</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">str</span>(ans).encode()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">hacker3</span>(<span class="params">num</span>):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">623</span>,<span class="number">0</span>,-<span class="number">1</span>):</span><br><span class="line">        num = (num - i) * gmpy2.invert(<span class="number">1812433253</span>,<span class="number">2</span> ** <span class="number">32</span>) % (<span class="number">2</span> ** <span class="number">32</span>)</span><br><span class="line">        num = inverse_right(num,<span class="number">30</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">str</span>(num).encode()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">hacker4</span>(<span class="params">num</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">str</span>(recover(num)).encode()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">recvrandoms</span>():</span><br><span class="line">    r.recv(<span class="number">1</span>)</span><br><span class="line">    num = <span class="built_in">int</span>(r.recvuntil(<span class="string">b&#x27;L, &#x27;</span>)[:-<span class="number">3</span>].decode())</span><br><span class="line">    randoms = [num]</span><br><span class="line">    <span class="keyword">if</span> num.bit_length() &gt; <span class="number">40</span>:</span><br><span class="line">        <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">206</span>):</span><br><span class="line">            num = <span class="built_in">int</span>(r.recvuntil(<span class="string">b&#x27;, &#x27;</span>)[:-<span class="number">3</span>].decode())</span><br><span class="line">            randoms.append(num)</span><br><span class="line">        num = <span class="built_in">int</span>(r.recvuntil(<span class="string">b&#x27;]\n&#x27;</span>)[:-<span class="number">3</span>].decode())</span><br><span class="line">        randoms.append(num)</span><br><span class="line">        <span class="keyword">return</span> randoms</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">625</span>):</span><br><span class="line">            num = <span class="built_in">int</span>(r.recvuntil(<span class="string">b&#x27;, &#x27;</span>)[:-<span class="number">3</span>].decode())</span><br><span class="line">            randoms.append(num)</span><br><span class="line">        num = <span class="built_in">int</span>(r.recvuntil(<span class="string">b&#x27;]\n&#x27;</span>)[:-<span class="number">3</span>].decode())</span><br><span class="line">        randoms.append(num)</span><br><span class="line">        <span class="keyword">return</span> randoms</span><br><span class="line"></span><br><span class="line">r = remote(<span class="string">&#x27;node2.yuzhian.com.cn&#x27;</span>,<span class="number">39122</span>)</span><br><span class="line"><span class="comment"># r.recvuntil(b&#x27;Press Enter to start...&#x27;)</span></span><br><span class="line"><span class="comment"># r.sendline()</span></span><br><span class="line">context(log_level = <span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> tqdm(<span class="built_in">range</span>(<span class="number">1</span>,<span class="number">21</span>)):</span><br><span class="line">    r.recvuntil((<span class="string">&#x27;Round: &#x27;</span> + <span class="built_in">str</span>(i) + <span class="string">&#x27;\n&#x27;</span>).encode())</span><br><span class="line">    rec1 = r.recvuntil(<span class="string">b&#x27; = &#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(rec1)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">b&#x27;randoms = &#x27;</span> <span class="keyword">in</span> rec1:</span><br><span class="line">        randoms = recvrandoms()</span><br><span class="line">        cnt = r.recvuntil(<span class="string">b&#x27;number:&#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">b&#x27;after&#x27;</span> <span class="keyword">in</span> cnt:</span><br><span class="line">            ans = hacker1(randoms)</span><br><span class="line">            r.sendline(ans)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            ans = hacker2(randoms)</span><br><span class="line">            r.sendline(ans)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">b&#x27;extract&#x27;</span> <span class="keyword">in</span> rec1:</span><br><span class="line">        num = <span class="built_in">int</span>(r.recvline()[:-<span class="number">1</span>].decode())</span><br><span class="line">        ans = hacker4(num)</span><br><span class="line">        r.recvuntil(<span class="string">b&#x27;Guess be extracted number:&#x27;</span>)</span><br><span class="line">        r.sendline(ans)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">b&#x27;last&#x27;</span> <span class="keyword">in</span> rec1:</span><br><span class="line">        num = <span class="built_in">int</span>(r.recvline()[:-<span class="number">1</span>].decode())</span><br><span class="line">        ans = hacker3(num)</span><br><span class="line">        r.recvuntil(<span class="string">b&#x27;Guess seed number:&#x27;</span>)</span><br><span class="line">        r.sendline(ans)</span><br><span class="line"></span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure><h4 id="0x03-2022羊城杯-novelsystem2-323"><a class="markdownIt-Anchor" href="#0x03-2022羊城杯-novelsystem2-323"></a> 0x03 2022羊城杯 NovelSystem2 3.23</h4><p>附件</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> uuid <span class="keyword">import</span> uuid4</span><br><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">NovelSystem</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, delta</span>):</span><br><span class="line">        self.p = getPrime(delta &gt;&gt; <span class="number">1</span>)</span><br><span class="line">        self.q = getPrime(delta &gt;&gt; <span class="number">1</span>)</span><br><span class="line">        self.N = self.p * self.q</span><br><span class="line">        </span><br><span class="line">        self.beta = <span class="number">0.397</span></span><br><span class="line">        self.psi = (self.p ** <span class="number">2</span> + self.p + <span class="number">1</span>) * (self.q ** <span class="number">2</span> + self.q + <span class="number">1</span>)</span><br><span class="line">        self.e, self.d = self.generate_key(delta)</span><br><span class="line">        self.r = getPrime(delta % delta.bit_length())</span><br><span class="line">        </span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">generate_key</span>(<span class="params">self, delta</span>):</span><br><span class="line">        delta = <span class="built_in">int</span>(delta * self.beta)</span><br><span class="line">        d = getPrime(delta)</span><br><span class="line">        e = invert(d, self.psi)</span><br><span class="line">        <span class="keyword">return</span> (e, d)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">print_pk</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;pk:&quot;</span>, (self.N, <span class="built_in">int</span>(self.e), self.r))</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">print_sk</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;sk:&quot;</span>, (self.N, self.p, self.q, self.e, self.d))</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">add_</span>(<span class="params">self, a, b</span>):</span><br><span class="line">        m, n = a</span><br><span class="line">        k, l = b</span><br><span class="line">        <span class="keyword">if</span> a[<span class="number">1</span>] == <span class="number">0</span>:</span><br><span class="line">            a, b = b, a</span><br><span class="line">            m, n, k, l = k, l, m, n</span><br><span class="line">        <span class="keyword">if</span> l == <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">if</span> n == <span class="number">0</span>:</span><br><span class="line">                <span class="keyword">return</span> (m * k, m + k)</span><br><span class="line">            <span class="keyword">if</span> (n + k) % self.N == <span class="number">0</span>:</span><br><span class="line">                <span class="keyword">if</span> (m - n ** <span class="number">2</span>) % self.N == <span class="number">0</span>:</span><br><span class="line">                    <span class="keyword">return</span> (<span class="number">0</span>, <span class="number">0</span>)</span><br><span class="line">                <span class="keyword">return</span> ((m * k + self.r) * invert(m - n * n) % self.N, <span class="number">0</span>)</span><br><span class="line">            <span class="keyword">return</span> ((m * k + self.r) * invert(n + k, self.N) % self.N, (m + n * k) * invert(n + k,self.N) % self.N)</span><br><span class="line">        <span class="keyword">if</span> (m + k + n * l) % self.N != <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">return</span> ((m * k + (n + l) * self.r) * invert(m + k + n * l, self.N)%self.N,(n * k + m * l + self.r) * invert(m + k + n * l, self.N) % self.N)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (n * k + m * l + self.r) % self.N == <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">return</span> (<span class="number">0</span>, <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">return</span> ((m * k + (n + l) * self.r) * invert(n * k + m * l + self.r, self.N) % self.N, <span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">mul_</span>(<span class="params">self, a, n</span>):</span><br><span class="line">        ans = (<span class="number">0</span>, <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">while</span> n &gt; <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">if</span> n &amp; <span class="number">1</span> == <span class="number">1</span>:</span><br><span class="line">                ans = self.add_(ans, a)</span><br><span class="line">            a = self.add_(a, a)</span><br><span class="line">            n //= <span class="number">2</span></span><br><span class="line">        <span class="keyword">return</span> ans</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">self, m</span>):</span><br><span class="line">        <span class="keyword">return</span> self.mul_(m, self.e)</span><br><span class="line">        </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">self, c</span>):</span><br><span class="line">        <span class="keyword">return</span> self.mul_(c, self.d)</span><br><span class="line"></span><br><span class="line">delta = <span class="number">1024</span></span><br><span class="line">enc = NovelSystem(delta)</span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag[:<span class="built_in">len</span>(flag) // <span class="number">2</span>]), bytes_to_long(flag[<span class="built_in">len</span>(flag) // <span class="number">2</span>:])</span><br><span class="line">c = enc.encrypt(m)</span><br><span class="line">enc.print_pk()</span><br><span class="line"><span class="built_in">print</span>(c)</span><br><span class="line"><span class="keyword">assert</span> enc.decrypt(c) == m</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">pk: (69608791192421919283757675475568920773353852553984294535246714322217147926140334786382671447161809319059757926660104907264892471513691210713164936055575369238706600340586833164515933300246888063235136692968128246137215938114060492757345025435557818940819819146315427528432401269318798897677955790143951114837, 3569709831456961963983317856906282564247794656174883346551318455409781951821532194464316039706968856000098892463123452801581913760419867217744612993876726508565953876218527986879338419527071132882516845467078252901861510834762733680624403662683842157212966883670782784707420186939792539380416673702618954148609178781352393489552193742869735649479707631323667621294737562886946346783459713562739324444015141587968954791790724386091523034752910330271202144122827876441229219899077622471534860855412052877175120218922873300885113936346989198403927493848984768217738562507350427274074810257890679068944519650350540061773, 3)</span></span><br><span class="line"><span class="string">(mpz(25277872308079622747549210576460613586229133947234593535200353386990766871354231190884983744062724190757790170095336476433339679661865115249940491581950905446714526508336734968117122923367321009658430492676221613955154012709104353264746945809594342072744903918483080444098810305069478604650812993367066108686), mpz(23837611977059204694294310415628596206205358541193793076161113947121055317488611201828968875769165810136018932772918536959013421962176622562932517080185242296377551991015543007194938521921909070483342042300905806379510158998331097627686209024554054114596970966269941945120227200103961459438854583220408434182))</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><p>赛后才知道考点是二元cop，只能说当时被题目唬住了，看到类似于曲线里面的mul和add函数之后就直接放弃了。</p><p>其实这题主要在psi里面，<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mtext>psi</mtext><mo>=</mo><mo stretchy="false">(</mo><msup><mi>p</mi><mn>2</mn></msup><mo>+</mo><mi>p</mi><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo><mo stretchy="false">(</mo><msup><mi>q</mi><mn>2</mn></msup><mo>+</mo><mi>q</mi><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\text{psi}=(p^2+p+1)(q^2+q+1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8623000000000001em;vertical-align:-.19444em"></span><span class="mord text"><span class="mord">psi</span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">p</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.7777700000000001em;vertical-align:-.19444em"></span><span class="mord mathdefault">p</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-.25em"></span><span class="mord">1</span><span class="mclose">)</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">q</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.7777700000000001em;vertical-align:-.19444em"></span><span class="mord mathdefault" style="margin-right:.03588em">q</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span>，化简得到</p><p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mtext>psi</mtext><mo>=</mo><msup><mi>n</mi><mn>2</mn></msup><mo>+</mo><mi>n</mi><mo stretchy="false">(</mo><mi>p</mi><mo>+</mo><mi>q</mi><mo stretchy="false">)</mo><mo>−</mo><mi>n</mi><mo>+</mo><mo stretchy="false">(</mo><mi>p</mi><mo>+</mo><mi>q</mi><msup><mo stretchy="false">)</mo><mn>2</mn></msup><mo>+</mo><mi>p</mi><mo>+</mo><mi>q</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\text{psi}=n^2+n(p+q)-n+(p+q)^2+p+q+1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8623000000000001em;vertical-align:-.19444em"></span><span class="mord text"><span class="mord">psi</span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.897438em;vertical-align:-.08333em"></span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathdefault">n</span><span class="mopen">(</span><span class="mord mathdefault">p</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathdefault" style="margin-right:.03588em">q</span><span class="mclose">)</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.66666em;vertical-align:-.08333em"></span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord mathdefault">p</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-.25em"></span><span class="mord mathdefault" style="margin-right:.03588em">q</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.7777700000000001em;vertical-align:-.19444em"></span><span class="mord mathdefault">p</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.7777700000000001em;vertical-align:-.19444em"></span><span class="mord mathdefault" style="margin-right:.03588em">q</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">1</span></span></span></span>，再根据公私钥生成的式子得到</p><p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>e</mi><mi>d</mi><mo>≡</mo><mn>1</mn><mtext></mtext><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mtext></mtext><mtext>psi</mtext></mrow><annotation encoding="application/x-tex">ed \equiv 1 \bmod \text{psi}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.69444em;vertical-align:0"></span><span class="mord mathdefault">e</span><span class="mord mathdefault">d</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">≡</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.69444em;vertical-align:0"></span><span class="mord">1</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mspace" style="margin-right:.05555555555555555em"></span><span class="mbin"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mspace" style="margin-right:.05555555555555555em"></span></span><span class="base"><span class="strut" style="height:.8623000000000001em;vertical-align:-.19444em"></span><span class="mord text"><span class="mord">psi</span></span></span></span></span>，令<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>s</mi><mo>=</mo><mi>p</mi><mo>+</mo><mi>q</mi></mrow><annotation encoding="application/x-tex">s=p+q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord mathdefault">s</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.7777700000000001em;vertical-align:-.19444em"></span><span class="mord mathdefault">p</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.625em;vertical-align:-.19444em"></span><span class="mord mathdefault" style="margin-right:.03588em">q</span></span></span></span>写成等式就是<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>e</mi><mi>d</mi><mo>=</mo><mn>1</mn><mo>+</mo><mi>k</mi><mo stretchy="false">(</mo><msup><mi>n</mi><mn>2</mn></msup><mo>+</mo><mi>n</mi><mi>s</mi><mo>−</mo><mi>n</mi><mo>+</mo><msup><mi>s</mi><mn>2</mn></msup><mo>+</mo><mi>s</mi><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">ed=1+k(n^2+ns-n+s^2+s+1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.69444em;vertical-align:0"></span><span class="mord mathdefault">e</span><span class="mord mathdefault">d</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.72777em;vertical-align:-.08333em"></span><span class="mord">1</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-.25em"></span><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.66666em;vertical-align:-.08333em"></span><span class="mord mathdefault">n</span><span class="mord mathdefault">s</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.66666em;vertical-align:-.08333em"></span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.897438em;vertical-align:-.08333em"></span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.66666em;vertical-align:-.08333em"></span><span class="mord mathdefault">s</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span></p><p>观察一下数据量的大小，在模e的情况下可以用二元cop求出其中较小的k和s。其中一直不太了解二元cop的原理，一直把它当作普通的cop来做，就是比普通一元的cop的界更紧。以下是二元cop的过程</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> itertools</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">small_roots</span>(<span class="params">f, bounds, m=<span class="number">1</span>, d=<span class="literal">None</span></span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> d:</span><br><span class="line">        d = f.degree()</span><br><span class="line"></span><br><span class="line">    R = f.base_ring()</span><br><span class="line">    N = R.cardinality()</span><br><span class="line"></span><br><span class="line">    f /= f.coefficients().pop(<span class="number">0</span>)</span><br><span class="line">    f = f.change_ring(ZZ)</span><br><span class="line"></span><br><span class="line">    G = <span class="type">Sequence</span>([], f.parent())</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(m + <span class="number">1</span>):</span><br><span class="line">        base = N ^ (m - i) * f ^ i</span><br><span class="line">        <span class="keyword">for</span> shifts <span class="keyword">in</span> itertools.product(<span class="built_in">range</span>(d), repeat=f.nvariables()):</span><br><span class="line">            g = base * prod(<span class="built_in">map</span>(power, f.variables(), shifts))</span><br><span class="line">            G.append(g)</span><br><span class="line"></span><br><span class="line">    B, monomials = G.coefficient_matrix()</span><br><span class="line">    monomials = vector(monomials)</span><br><span class="line"></span><br><span class="line">    factors = [monomial(*bounds) <span class="keyword">for</span> monomial <span class="keyword">in</span> monomials]</span><br><span class="line">    <span class="keyword">for</span> i, factor <span class="keyword">in</span> <span class="built_in">enumerate</span>(factors):</span><br><span class="line">        B.rescale_col(i, factor)</span><br><span class="line"></span><br><span class="line">    B = B.dense_matrix().LLL()</span><br><span class="line"></span><br><span class="line">    B = B.change_ring(QQ)</span><br><span class="line">    <span class="keyword">for</span> i, factor <span class="keyword">in</span> <span class="built_in">enumerate</span>(factors):</span><br><span class="line">        B.rescale_col(i, <span class="number">1</span> / factor)</span><br><span class="line"></span><br><span class="line">    H = <span class="type">Sequence</span>([], f.parent().change_ring(QQ))</span><br><span class="line">    <span class="keyword">for</span> h <span class="keyword">in</span> <span class="built_in">filter</span>(<span class="literal">None</span>, B * monomials):</span><br><span class="line">        H.append(h)</span><br><span class="line">        I = H.ideal()</span><br><span class="line">        <span class="keyword">if</span> I.dimension() == -<span class="number">1</span>:</span><br><span class="line">            H.pop()</span><br><span class="line">        <span class="keyword">elif</span> I.dimension() == <span class="number">0</span>:</span><br><span class="line">            roots = []</span><br><span class="line">            <span class="keyword">for</span> root <span class="keyword">in</span> I.variety(ring=ZZ):</span><br><span class="line">                root = <span class="built_in">tuple</span>(R(root[var]) <span class="keyword">for</span> var <span class="keyword">in</span> f.variables())</span><br><span class="line">                roots.append(root)</span><br><span class="line">            <span class="keyword">return</span> roots</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> []</span><br><span class="line">n,e,r = (<span class="number">69608791192421919283757675475568920773353852553984294535246714322217147926140334786382671447161809319059757926660104907264892471513691210713164936055575369238706600340586833164515933300246888063235136692968128246137215938114060492757345025435557818940819819146315427528432401269318798897677955790143951114837</span>, <span class="number">3569709831456961963983317856906282564247794656174883346551318455409781951821532194464316039706968856000098892463123452801581913760419867217744612993876726508565953876218527986879338419527071132882516845467078252901861510834762733680624403662683842157212966883670782784707420186939792539380416673702618954148609178781352393489552193742869735649479707631323667621294737562886946346783459713562739324444015141587968954791790724386091523034752910330271202144122827876441229219899077622471534860855412052877175120218922873300885113936346989198403927493848984768217738562507350427274074810257890679068944519650350540061773</span>, <span class="number">3</span>)</span><br><span class="line">PR.&lt;s,k&gt; = PolynomialRing(Zmod(e))</span><br><span class="line">psi = n ** <span class="number">2</span> + n * s - n + s ** <span class="number">2</span> + s + <span class="number">1</span></span><br><span class="line">f = k * psi + <span class="number">1</span></span><br><span class="line"></span><br><span class="line">bounds = (<span class="number">2</span> ** <span class="number">513</span>,<span class="number">2</span> ** <span class="number">406</span>)</span><br><span class="line">root = small_roots(f,bounds,m=<span class="number">6</span>,d=<span class="number">4</span>)</span><br><span class="line"><span class="built_in">print</span>(root)</span><br><span class="line"><span class="comment">#[(16735107022622476383866840093901965222228713238108348681003452372987945455610490028938094968941275455301623881501712248119610615329278201446033374682492202, 109544961591167891450312756961715400985114370115235587811168068856002720019953678125934219464349698130680024301825175448812)]</span></span><br></pre></td></tr></table></figure><p>得到s之后后面的内容都很简单了，顺着原来类里面的函数逆回去就好了</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> sympy</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">NovelSystem</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, delta,p,q,n,e,d</span>):</span><br><span class="line">        self.p = p</span><br><span class="line">        self.q = q</span><br><span class="line">        self.N = n</span><br><span class="line">        self.e = e</span><br><span class="line">        self.d = d</span><br><span class="line">        self.beta = <span class="number">0.397</span></span><br><span class="line">        self.psi = (self.p ** <span class="number">2</span> + self.p + <span class="number">1</span>) * (self.q ** <span class="number">2</span> + self.q + <span class="number">1</span>)</span><br><span class="line">        <span class="comment"># self.e, self.d = self.generate_key(delta)</span></span><br><span class="line">        self.r = getPrime(delta % delta.bit_length())</span><br><span class="line"></span><br><span class="line">    <span class="comment"># def generate_key(self, delta):</span></span><br><span class="line">    <span class="comment">#     delta = int(delta * self.beta)</span></span><br><span class="line">    <span class="comment">#     d = getPrime(delta)</span></span><br><span class="line">    <span class="comment">#     e = invert(d, self.psi)</span></span><br><span class="line">    <span class="comment">#     return (e, d)</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">print_pk</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;pk:&quot;</span>, (self.N, <span class="built_in">int</span>(self.e), self.r))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">print_sk</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;sk:&quot;</span>, (self.N, self.p, self.q, self.e, self.d))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">add_</span>(<span class="params">self, a, b</span>):</span><br><span class="line">        m, n = a</span><br><span class="line">        k, l = b</span><br><span class="line">        <span class="keyword">if</span> a[<span class="number">1</span>] == <span class="number">0</span>:</span><br><span class="line">            a, b = b, a</span><br><span class="line">            m, n, k, l = k, l, m, n</span><br><span class="line">        <span class="keyword">if</span> l == <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">if</span> n == <span class="number">0</span>:</span><br><span class="line">                <span class="keyword">return</span> (m * k, m + k)</span><br><span class="line">            <span class="keyword">if</span> (n + k) % self.N == <span class="number">0</span>:</span><br><span class="line">                <span class="keyword">if</span> (m - n ** <span class="number">2</span>) % self.N == <span class="number">0</span>:</span><br><span class="line">                    <span class="keyword">return</span> (<span class="number">0</span>, <span class="number">0</span>)</span><br><span class="line">                <span class="keyword">return</span> ((m * k + self.r) * invert(m - n * n, self.N) % self.N, <span class="number">0</span>)</span><br><span class="line">            <span class="keyword">return</span> ((m * k + self.r) * invert(n + k, self.N) % self.N, (m + n * k) * invert(n + k, self.N) % self.N)</span><br><span class="line">        <span class="keyword">if</span> (m + k + n * l) % self.N != <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">return</span> ((m * k + (n + l) * self.r) * invert(m + k + n * l, self.N) % self.N,</span><br><span class="line">                    (n * k + m * l + self.r) * invert(m + k + n * l, self.N) % self.N)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (n * k + m * l + self.r) % self.N == <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">return</span> (<span class="number">0</span>, <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">return</span> ((m * k + (n + l) * self.r) * invert(n * k + m * l + self.r, self.N) % self.N, <span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">mul_</span>(<span class="params">self, a, n</span>):</span><br><span class="line">        ans = (<span class="number">0</span>, <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">while</span> n &gt; <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">if</span> n &amp; <span class="number">1</span> == <span class="number">1</span>:</span><br><span class="line">                ans = self.add_(ans, a)</span><br><span class="line">            a = self.add_(a, a)</span><br><span class="line">            n //= <span class="number">2</span></span><br><span class="line">        <span class="keyword">return</span> ans</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">self, m</span>):</span><br><span class="line">        <span class="keyword">return</span> self.mul_(m, self.e)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">self, c</span>):</span><br><span class="line">        <span class="keyword">return</span> self.mul_(c, self.d)</span><br><span class="line">s = <span class="number">16735107022622476383866840093901965222228713238108348681003452372987945455610490028938094968941275455301623881501712248119610615329278201446033374682492202</span></span><br><span class="line">n,e,r = (<span class="number">69608791192421919283757675475568920773353852553984294535246714322217147926140334786382671447161809319059757926660104907264892471513691210713164936055575369238706600340586833164515933300246888063235136692968128246137215938114060492757345025435557818940819819146315427528432401269318798897677955790143951114837</span>, <span class="number">3569709831456961963983317856906282564247794656174883346551318455409781951821532194464316039706968856000098892463123452801581913760419867217744612993876726508565953876218527986879338419527071132882516845467078252901861510834762733680624403662683842157212966883670782784707420186939792539380416673702618954148609178781352393489552193742869735649479707631323667621294737562886946346783459713562739324444015141587968954791790724386091523034752910330271202144122827876441229219899077622471534860855412052877175120218922873300885113936346989198403927493848984768217738562507350427274074810257890679068944519650350540061773</span>, <span class="number">3</span>)</span><br><span class="line"><span class="comment"># p,q = sympy.Symbol(&#x27;p&#x27;),sympy.Symbol(&#x27;q&#x27;)</span></span><br><span class="line"><span class="comment"># f1 = p * q - n</span></span><br><span class="line"><span class="comment"># f2 = p + q - s</span></span><br><span class="line"><span class="comment"># result = sympy.solve([f1,f2],[p,q])</span></span><br><span class="line"><span class="comment"># print(result)</span></span><br><span class="line">p,q = <span class="number">7729462160300184063354083506942486302239289283623335189017826590761497646527271658325039881984377424646284428281668979724518269305474372716053376048320159</span>, <span class="number">9005644862322292320512756586959478919989423954485013491985625782226447809083218370613055086956898030655339453220043268395092346023803828729979998634172043</span></span><br><span class="line">psi = (p ** <span class="number">2</span> + p + <span class="number">1</span>) * (q ** <span class="number">2</span> + q + <span class="number">1</span>)</span><br><span class="line">d = gmpy2.invert(e,psi)</span><br><span class="line">delta = <span class="number">1024</span></span><br><span class="line">dec = NovelSystem(delta,p,q,n,e,d)</span><br><span class="line">c = (<span class="number">25277872308079622747549210576460613586229133947234593535200353386990766871354231190884983744062724190757790170095336476433339679661865115249940491581950905446714526508336734968117122923367321009658430492676221613955154012709104353264746945809594342072744903918483080444098810305069478604650812993367066108686</span>, <span class="number">23837611977059204694294310415628596206205358541193793076161113947121055317488611201828968875769165810136018932772918536959013421962176622562932517080185242296377551991015543007194938521921909070483342042300905806379510158998331097627686209024554054114596970966269941945120227200103961459438854583220408434182</span>)</span><br><span class="line">m = dec.decrypt(c)</span><br><span class="line"><span class="built_in">print</span>(m)</span><br><span class="line">flag = long_to_bytes(m[<span class="number">0</span>]) + long_to_bytes(m[<span class="number">1</span>])</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="comment">#b&#x27;DASCTF&#123;a1a4a518320a469088c64aa4fbc22438&#125;&#x27;</span></span><br></pre></td></tr></table></figure><h4 id="0x02-2022羊城杯-linearalgebra-323"><a class="markdownIt-Anchor" href="#0x02-2022羊城杯-linearalgebra-323"></a> 0x02 2022羊城杯 linearAlgebra 3.23</h4><p>附件</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> flag[:<span class="number">7</span>] == <span class="string">b&#x27;DASCTF&#123;&#x27;</span> <span class="keyword">and</span> flag[-<span class="number">1</span>] == <span class="built_in">ord</span>(<span class="string">&#x27;&#125;&#x27;</span>)</span><br><span class="line"></span><br><span class="line">n = <span class="number">32</span></span><br><span class="line">asize = <span class="number">512</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">pad</span>(<span class="params">m, n</span>):</span><br><span class="line">  <span class="keyword">assert</span> <span class="built_in">len</span>(m) &lt; n*n</span><br><span class="line">  <span class="keyword">return</span> m + <span class="string">b&#x27;\x00&#x27;</span> + os.urandom(n*n - <span class="built_in">len</span>(m) - <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">bytes2Matrix</span>(<span class="params">m, n</span>):</span><br><span class="line">  <span class="keyword">assert</span> <span class="built_in">len</span>(m) == n*n</span><br><span class="line">  <span class="keyword">return</span> matrix(ZZ, [[m[r*n+c] <span class="keyword">for</span> c <span class="keyword">in</span> <span class="built_in">range</span>(n)] <span class="keyword">for</span> r <span class="keyword">in</span> <span class="built_in">range</span>(n)])</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">randMatrix</span>(<span class="params">s, n</span>):</span><br><span class="line">  <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    Mt = matrix(ZZ, [[random.randint(<span class="number">0</span>, <span class="number">2</span>^s) <span class="keyword">for</span> c <span class="keyword">in</span> <span class="built_in">range</span>(n)] <span class="keyword">for</span> r <span class="keyword">in</span> <span class="built_in">range</span>(n)])</span><br><span class="line">    <span class="keyword">if</span> Mt.det() != <span class="number">0</span>:</span><br><span class="line">      <span class="keyword">return</span> Mt</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">corrupt</span>(<span class="params">Mt, s, n</span>):</span><br><span class="line">  Mt_ = matrix(ZZ, Mt)</span><br><span class="line">  <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">    r_ = random.randint(<span class="number">0</span>, n-<span class="number">1</span>)</span><br><span class="line">    c_ = random.randint(<span class="number">0</span>, n-<span class="number">1</span>)</span><br><span class="line">    Mt_[r_, c_] = random.randint(<span class="number">0</span>, <span class="number">2</span>^s)</span><br><span class="line">  <span class="keyword">return</span> Mt_</span><br><span class="line"></span><br><span class="line">m = pad(flag[<span class="number">7</span>:-<span class="number">1</span>], n)</span><br><span class="line">M = bytes2Matrix(m, n)</span><br><span class="line">A = randMatrix(asize, n)</span><br><span class="line">C = A*M</span><br><span class="line">Ac = corrupt(A, asize, n)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;C:&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(C)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;Ac:&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(Ac)</span><br></pre></td></tr></table></figure><p>数据量太大就不放了，复现的话自己生成一个flag即可。参考<span class="exturl" data-url="aHR0cHM6Ly93d3cuemltYWJsdWUubGlmZS8yMDIyLzA5LzAyLyVFNyVCRSU4QSVFNSU5RiU4RSVFNiU5RCVBRi8jbW9yZQ==">zima👴的blog</span>，再膜一下膜一下</p><p>这题拿来练手LLL挺好的，当时比赛的时候不会格子呜呜呜，回来复现的时候发现挺好做的。</p><p>M是要求的矩阵，pad函数就是把flag数据pad成一个矩阵。给了C和Ac，Ac就是矩阵A混淆过后的矩阵。</p><p>混淆是用<code>corrupt</code>函数，其实就是在32*32的矩阵中随机选32个数据替换成一个大小差不多的数据。这个随机就很讲究，随机是纯随机，也就是说并不是这个矩阵中每一行都有数据被替换。写个循环找到某一行没有被替换的数据构造矩阵。</p><p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mo fence="true">[</mo><mtable rowspacing="0.15999999999999992em" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>m</mi><mn>1</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>m</mi><mn>2</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>m</mi><mn>3</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>−</mo><mn>1</mn></mrow></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mrow><mo fence="true">[</mo><mtable rowspacing="0.15999999999999992em" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>A</mi><msub><mi>c</mi><mn>0</mn></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>A</mi><msub><mi>c</mi><mn>1</mn></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>A</mi><msub><mi>c</mi><mn>2</mn></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi>C</mi></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mrow><mo fence="true">[</mo><mtable rowspacing="0.15999999999999992em" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>m</mi><mn>1</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>m</mi><mn>2</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>m</mi><mn>3</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex">\begin{bmatrix} {m_1}&amp;{m_2}&amp;{m_3}&amp;-1 \end{bmatrix} \begin{bmatrix} 1&amp;0&amp;0&amp;Ac_0\\ 0&amp;1&amp;0&amp;Ac_1\\ 0&amp;0&amp;1&amp;Ac_2\\ 0&amp;0&amp;0&amp;C \end{bmatrix} \begin{bmatrix} {m_1}&amp;{m_2}&amp;{m_3}&amp;0 \end{bmatrix}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:4.80204em;vertical-align:-2.15003em"></span><span class="minner"><span class="mopen delimcenter" style="top:0"><span class="delimsizing size1">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.8500000000000001em"><span style="top:-3.01em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathdefault">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.35000000000000003em"><span></span></span></span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.8500000000000001em"><span style="top:-3.01em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathdefault">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.35000000000000003em"><span></span></span></span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.8500000000000001em"><span style="top:-3.01em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathdefault">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.35000000000000003em"><span></span></span></span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.8500000000000001em"><span style="top:-3.01em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">−</span><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.35000000000000003em"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0"><span class="delimsizing size1">]</span></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.6520099999999998em"><span style="top:-1.6499900000000003em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎣</span></span></span><span style="top:-2.80499em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎢</span></span></span><span style="top:-3.40599em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎢</span></span></span><span style="top:-4.65201em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎡</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.15003em"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.6500000000000004em"><span style="top:-4.8100000000000005em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">1</span></span></span><span style="top:-3.61em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-2.4099999999999997em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-1.2099999999999997em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.1500000000000004em"><span></span></span></span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.6500000000000004em"><span style="top:-4.8100000000000005em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-3.61em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">1</span></span></span><span style="top:-2.4099999999999997em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-1.2099999999999997em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.1500000000000004em"><span></span></span></span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.6500000000000004em"><span style="top:-4.8100000000000005em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-3.61em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-2.4099999999999997em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">1</span></span></span><span style="top:-1.2099999999999997em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.1500000000000004em"><span></span></span></span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.6500000000000004em"><span style="top:-4.8100000000000005em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">A</span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span style="top:-3.61em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">A</span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span style="top:-2.4099999999999997em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">A</span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span style="top:-1.2099999999999997em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.07153em">C</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.1500000000000004em"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.6520099999999998em"><span style="top:-1.6499900000000003em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎦</span></span></span><span style="top:-2.80499em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎥</span></span></span><span style="top:-3.40599em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎥</span></span></span><span style="top:-4.65201em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎤</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.15003em"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="minner"><span class="mopen delimcenter" style="top:0"><span class="delimsizing size1">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.8500000000000001em"><span style="top:-3.01em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathdefault">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.35000000000000003em"><span></span></span></span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.8500000000000001em"><span style="top:-3.01em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathdefault">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.35000000000000003em"><span></span></span></span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.8500000000000001em"><span style="top:-3.01em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathdefault">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.35000000000000003em"><span></span></span></span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.8500000000000001em"><span style="top:-3.01em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.35000000000000003em"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0"><span class="delimsizing size1">]</span></span></span></span></span></span></span></p><p>其中m的数据是特别小的，矩阵中的数据Ac是特别大的，可以规约出m来。</p><p>首先读取矩阵，然后测试Ac中哪些行的数据是没有被改过的</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> tqdm</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">readmatrix</span>(<span class="params">data</span>):</span><br><span class="line">    out = [<span class="built_in">eval</span>(<span class="string">&#x27;[&#x27;</span> + re.sub(<span class="string">&#x27; +&#x27;</span>,<span class="string">&#x27;,&#x27;</span>,i[<span class="number">1</span>:-<span class="number">1</span>].strip()) + <span class="string">&#x27;]&#x27;</span>) <span class="keyword">for</span> i <span class="keyword">in</span> data]</span><br><span class="line">    <span class="keyword">return</span> out</span><br><span class="line"></span><br><span class="line">data = <span class="built_in">open</span>(<span class="string">&#x27;out&#x27;</span>,<span class="string">&#x27;r&#x27;</span>).read().splitlines()</span><br><span class="line"></span><br><span class="line">dataC = data[<span class="number">1</span>:<span class="number">33</span>]</span><br><span class="line">dataAc = data[<span class="number">34</span>:]</span><br><span class="line">C = readmatrix(dataC)</span><br><span class="line">Ac = readmatrix(dataAc)</span><br><span class="line"><span class="comment">#print(C)</span></span><br><span class="line">n = <span class="built_in">len</span>(C)</span><br><span class="line">ans = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> tqdm(<span class="built_in">range</span>(<span class="number">0</span>,n)):</span><br><span class="line">    aim = C[i][<span class="number">0</span>]</span><br><span class="line">    mat = [[<span class="number">0</span> <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(n + <span class="number">1</span>)] <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(n + <span class="number">1</span>)]</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,n):</span><br><span class="line">        mat[j][j] = <span class="number">1</span></span><br><span class="line">        mat[j][-<span class="number">1</span>] = Ac[i][j]</span><br><span class="line">    mat[-<span class="number">1</span>][-<span class="number">1</span>] = -aim</span><br><span class="line">    mat = matrix(ZZ,mat).LLL()</span><br><span class="line">    <span class="keyword">if</span> mat[<span class="number">0</span>][-<span class="number">1</span>] == <span class="number">0</span>:</span><br><span class="line">        ans.append(i)</span><br><span class="line"><span class="built_in">print</span>(ans)</span><br><span class="line"><span class="comment">#ans = [1, 3, 5, 9, 10, 20, 24, 25, 26, 27, 29, 31]</span></span><br></pre></td></tr></table></figure><p>之后再随便以某一行为基准再LLL出其他的数据即可</p><p>完整wp如下</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> tqdm</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">readmatrix</span>(<span class="params">data</span>):</span><br><span class="line">    out = [<span class="built_in">eval</span>(<span class="string">&#x27;[&#x27;</span> + re.sub(<span class="string">&#x27; +&#x27;</span>,<span class="string">&#x27;,&#x27;</span>,i[<span class="number">1</span>:-<span class="number">1</span>].strip()) + <span class="string">&#x27;]&#x27;</span>) <span class="keyword">for</span> i <span class="keyword">in</span> data]</span><br><span class="line">    <span class="keyword">return</span> out</span><br><span class="line"></span><br><span class="line">data = <span class="built_in">open</span>(<span class="string">&#x27;out&#x27;</span>,<span class="string">&#x27;r&#x27;</span>).read().splitlines()</span><br><span class="line"></span><br><span class="line">dataC = data[<span class="number">1</span>:<span class="number">33</span>]</span><br><span class="line">dataAc = data[<span class="number">34</span>:]</span><br><span class="line">C = readmatrix(dataC)</span><br><span class="line">Ac = readmatrix(dataAc)</span><br><span class="line"><span class="comment">#print(C)</span></span><br><span class="line">n = <span class="built_in">len</span>(C)</span><br><span class="line"><span class="comment"># ans = []</span></span><br><span class="line"><span class="comment"># for i in tqdm(range(0,n)):</span></span><br><span class="line"><span class="comment">#     aim = C[i][0]</span></span><br><span class="line"><span class="comment">#     mat = [[0 for _ in range(n + 1)] for _ in range(n + 1)]</span></span><br><span class="line"><span class="comment">#     for j in range(0,n):</span></span><br><span class="line"><span class="comment">#         mat[j][j] = 1</span></span><br><span class="line"><span class="comment">#         mat[j][-1] = Ac[i][j]</span></span><br><span class="line"><span class="comment">#     mat[-1][-1] = -aim</span></span><br><span class="line"><span class="comment">#     mat = matrix(ZZ,mat).LLL()</span></span><br><span class="line"><span class="comment">#     if mat[0][-1] == 0:</span></span><br><span class="line"><span class="comment">#         ans.append(i)</span></span><br><span class="line"><span class="comment"># print(ans)</span></span><br><span class="line">ans = [<span class="number">1</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">9</span>, <span class="number">10</span>, <span class="number">20</span>, <span class="number">24</span>, <span class="number">25</span>, <span class="number">26</span>, <span class="number">27</span>, <span class="number">29</span>, <span class="number">31</span>]</span><br><span class="line">M = [[<span class="number">0</span> <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(n)] <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(n)]</span><br><span class="line">mat = [[<span class="number">0</span> <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(n + <span class="number">1</span>)] <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(n + <span class="number">1</span>)]</span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">    mat[j][j] = <span class="number">1</span></span><br><span class="line">    mat[j][-<span class="number">1</span>] = Ac[<span class="number">1</span>][j]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> tqdm(<span class="built_in">range</span>(<span class="number">0</span>,n)):</span><br><span class="line">    mat[-<span class="number">1</span>][-<span class="number">1</span>] = -C[<span class="number">1</span>][i]</span><br><span class="line">    fleg = matrix(ZZ,mat).LLL()[<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">for</span> j,s <span class="keyword">in</span> <span class="built_in">enumerate</span>(fleg[:-<span class="number">1</span>]):</span><br><span class="line">        M[j][i] = <span class="built_in">int</span>(s)</span><br><span class="line">flag = <span class="built_in">bytes</span>(M[<span class="number">0</span>] + M[<span class="number">1</span>])</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure><h4 id="0x01-2022ichunqiu勇者山峰-bob_enc-33"><a class="markdownIt-Anchor" href="#0x01-2022ichunqiu勇者山峰-bob_enc-33"></a> 0x01 2022ichunqiu勇者山峰 bob_enc 3.3</h4><p>附件</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> * </span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line">prime =  <span class="number">2141</span></span><br><span class="line"><span class="built_in">print</span> <span class="built_in">len</span>(flag)</span><br><span class="line">flag = <span class="built_in">map</span>(<span class="built_in">ord</span>,flag)</span><br><span class="line">flag1 = flag[:<span class="number">21</span>]</span><br><span class="line">flag2 = flag[<span class="number">21</span>:]</span><br><span class="line">row = <span class="number">64</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">add</span>(<span class="params">msg1,msg2</span>):</span><br><span class="line">    <span class="keyword">return</span> [(x+y)%prime <span class="keyword">for</span> x,y <span class="keyword">in</span> <span class="built_in">zip</span>(msg1,msg2)]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">multi</span>(<span class="params">msg1,msg2</span>):</span><br><span class="line">    out = []</span><br><span class="line">    <span class="keyword">for</span> l <span class="keyword">in</span> msg1:</span><br><span class="line">        s = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> x,y <span class="keyword">in</span> <span class="built_in">zip</span>(l,msg2):</span><br><span class="line">            s += (x*y)%prime</span><br><span class="line">            s %= prime</span><br><span class="line">        out.append(s)</span><br><span class="line">    <span class="keyword">return</span> out</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">genkey</span>(<span class="params">leng</span>):</span><br><span class="line">    l = [[] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(row)]</span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(row):</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(leng):</span><br><span class="line">            l[x].append(random.randint(<span class="number">0</span>,<span class="number">511</span>))</span><br><span class="line">    <span class="keyword">return</span> l</span><br><span class="line"></span><br><span class="line">key = genkey(<span class="built_in">len</span>(flag1))</span><br><span class="line"><span class="built_in">print</span> key</span><br><span class="line"></span><br><span class="line">cipher1 = multi(key,flag1)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span> cipher1</span><br><span class="line"></span><br><span class="line">cipher2 = multi(key,flag2)</span><br><span class="line"></span><br><span class="line">noise = [random.randint(<span class="number">0</span>,<span class="number">6</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(row)]</span><br><span class="line"><span class="built_in">print</span> add(noise,cipher2)</span><br></pre></td></tr></table></figure><p>题目分为两部分，意思很好懂。</p><p>第一部分就是正常的矩阵求逆，取flag长度就可以</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">prime =  <span class="number">2141</span></span><br><span class="line">key = [[<span class="number">185</span>, <span class="number">96</span>, <span class="number">351</span>, <span class="number">118</span>, <span class="number">421</span>, <span class="number">449</span>, <span class="number">350</span>, <span class="number">349</span>, <span class="number">388</span>, <span class="number">95</span>, <span class="number">341</span>, <span class="number">327</span>, <span class="number">29</span>, <span class="number">156</span>, <span class="number">399</span>, <span class="number">283</span>, <span class="number">292</span>, <span class="number">461</span>, <span class="number">445</span>, <span class="number">120</span>, <span class="number">126</span>], [<span class="number">495</span>, <span class="number">358</span>, <span class="number">192</span>, <span class="number">300</span>, <span class="number">279</span>, <span class="number">277</span>, <span class="number">478</span>, <span class="number">335</span>, <span class="number">231</span>, <span class="number">241</span>, <span class="number">178</span>, <span class="number">314</span>, <span class="number">453</span>, <span class="number">251</span>, <span class="number">133</span>, <span class="number">391</span>, <span class="number">213</span>, <span class="number">132</span>, <span class="number">254</span>, <span class="number">388</span>, <span class="number">46</span>], [<span class="number">428</span>, <span class="number">44</span>, <span class="number">100</span>, <span class="number">483</span>, <span class="number">12</span>, <span class="number">311</span>, <span class="number">57</span>, <span class="number">443</span>, <span class="number">289</span>, <span class="number">90</span>, <span class="number">478</span>, <span class="number">495</span>, <span class="number">399</span>, <span class="number">89</span>, <span class="number">324</span>, <span class="number">275</span>, <span class="number">322</span>, <span class="number">99</span>, <span class="number">343</span>, <span class="number">489</span>, <span class="number">133</span>], [<span class="number">420</span>, <span class="number">358</span>, <span class="number">472</span>, <span class="number">260</span>, <span class="number">267</span>, <span class="number">136</span>, <span class="number">303</span>, <span class="number">491</span>, <span class="number">390</span>, <span class="number">248</span>, <span class="number">430</span>, <span class="number">117</span>, <span class="number">154</span>, <span class="number">244</span>, <span class="number">62</span>, <span class="number">217</span>, <span class="number">204</span>, <span class="number">334</span>, <span class="number">277</span>, <span class="number">231</span>, <span class="number">325</span>], [<span class="number">11</span>, <span class="number">96</span>, <span class="number">61</span>, <span class="number">67</span>, <span class="number">456</span>, <span class="number">361</span>, <span class="number">292</span>, <span class="number">278</span>, <span class="number">424</span>, <span class="number">237</span>, <span class="number">345</span>, <span class="number">109</span>, <span class="number">475</span>, <span class="number">473</span>, <span class="number">29</span>, <span class="number">250</span>, <span class="number">195</span>, <span class="number">430</span>, <span class="number">114</span>, <span class="number">13</span>, <span class="number">199</span>], [<span class="number">17</span>, <span class="number">91</span>, <span class="number">330</span>, <span class="number">73</span>, <span class="number">384</span>, <span class="number">134</span>, <span class="number">437</span>, <span class="number">161</span>, <span class="number">166</span>, <span class="number">185</span>, <span class="number">499</span>, <span class="number">491</span>, <span class="number">342</span>, <span class="number">129</span>, <span class="number">348</span>, <span class="number">162</span>, <span class="number">478</span>, <span class="number">216</span>, <span class="number">189</span>, <span class="number">311</span>, <span class="number">502</span>], [<span class="number">396</span>, <span class="number">437</span>, <span class="number">98</span>, <span class="number">421</span>, <span class="number">120</span>, <span class="number">443</span>, <span class="number">113</span>, <span class="number">432</span>, <span class="number">9</span>, <span class="number">476</span>, <span class="number">243</span>, <span class="number">122</span>, <span class="number">416</span>, <span class="number">508</span>, <span class="number">287</span>, <span class="number">45</span>, <span class="number">84</span>, <span class="number">322</span>, <span class="number">504</span>, <span class="number">287</span>, <span class="number">251</span>], [<span class="number">187</span>, <span class="number">489</span>, <span class="number">407</span>, <span class="number">204</span>, <span class="number">127</span>, <span class="number">10</span>, <span class="number">302</span>, <span class="number">101</span>, <span class="number">389</span>, <span class="number">113</span>, <span class="number">469</span>, <span class="number">184</span>, <span class="number">249</span>, <span class="number">131</span>, <span class="number">113</span>, <span class="number">18</span>, <span class="number">350</span>, <span class="number">106</span>, <span class="number">486</span>, <span class="number">406</span>, <span class="number">295</span>], [<span class="number">265</span>, <span class="number">425</span>, <span class="number">30</span>, <span class="number">478</span>, <span class="number">471</span>, <span class="number">211</span>, <span class="number">162</span>, <span class="number">323</span>, <span class="number">163</span>, <span class="number">205</span>, <span class="number">187</span>, <span class="number">422</span>, <span class="number">452</span>, <span class="number">226</span>, <span class="number">230</span>, <span class="number">367</span>, <span class="number">478</span>, <span class="number">229</span>, <span class="number">365</span>, <span class="number">395</span>, <span class="number">294</span>], [<span class="number">360</span>, <span class="number">193</span>, <span class="number">180</span>, <span class="number">253</span>, <span class="number">337</span>, <span class="number">453</span>, <span class="number">16</span>, <span class="number">352</span>, <span class="number">243</span>, <span class="number">107</span>, <span class="number">171</span>, <span class="number">46</span>, <span class="number">25</span>, <span class="number">234</span>, <span class="number">46</span>, <span class="number">479</span>, <span class="number">267</span>, <span class="number">267</span>, <span class="number">171</span>, <span class="number">188</span>, <span class="number">127</span>], [<span class="number">379</span>, <span class="number">360</span>, <span class="number">109</span>, <span class="number">360</span>, <span class="number">403</span>, <span class="number">343</span>, <span class="number">75</span>, <span class="number">306</span>, <span class="number">138</span>, <span class="number">40</span>, <span class="number">41</span>, <span class="number">253</span>, <span class="number">428</span>, <span class="number">401</span>, <span class="number">464</span>, <span class="number">495</span>, <span class="number">21</span>, <span class="number">296</span>, <span class="number">319</span>, <span class="number">410</span>, <span class="number">440</span>], [<span class="number">28</span>, <span class="number">209</span>, <span class="number">1</span>, <span class="number">233</span>, <span class="number">458</span>, <span class="number">266</span>, <span class="number">301</span>, <span class="number">359</span>, <span class="number">469</span>, <span class="number">304</span>, <span class="number">264</span>, <span class="number">368</span>, <span class="number">339</span>, <span class="number">25</span>, <span class="number">490</span>, <span class="number">343</span>, <span class="number">404</span>, <span class="number">488</span>, <span class="number">275</span>, <span class="number">262</span>, <span class="number">274</span>], [<span class="number">180</span>, <span class="number">372</span>, <span class="number">133</span>, <span class="number">341</span>, <span class="number">29</span>, <span class="number">352</span>, <span class="number">326</span>, <span class="number">89</span>, <span class="number">323</span>, <span class="number">479</span>, <span class="number">68</span>, <span class="number">76</span>, <span class="number">247</span>, <span class="number">225</span>, <span class="number">159</span>, <span class="number">163</span>, <span class="number">180</span>, <span class="number">160</span>, <span class="number">171</span>, <span class="number">7</span>, <span class="number">322</span>], [<span class="number">322</span>, <span class="number">295</span>, <span class="number">28</span>, <span class="number">467</span>, <span class="number">361</span>, <span class="number">169</span>, <span class="number">190</span>, <span class="number">71</span>, <span class="number">456</span>, <span class="number">140</span>, <span class="number">456</span>, <span class="number">202</span>, <span class="number">295</span>, <span class="number">424</span>, <span class="number">428</span>, <span class="number">18</span>, <span class="number">286</span>, <span class="number">233</span>, <span class="number">470</span>, <span class="number">303</span>, <span class="number">429</span>], [<span class="number">234</span>, <span class="number">37</span>, <span class="number">128</span>, <span class="number">175</span>, <span class="number">282</span>, <span class="number">509</span>, <span class="number">54</span>, <span class="number">186</span>, <span class="number">177</span>, <span class="number">23</span>, <span class="number">348</span>, <span class="number">487</span>, <span class="number">473</span>, <span class="number">377</span>, <span class="number">81</span>, <span class="number">225</span>, <span class="number">154</span>, <span class="number">511</span>, <span class="number">364</span>, <span class="number">120</span>, <span class="number">280</span>], [<span class="number">262</span>, <span class="number">82</span>, <span class="number">383</span>, <span class="number">490</span>, <span class="number">128</span>, <span class="number">448</span>, <span class="number">289</span>, <span class="number">420</span>, <span class="number">239</span>, <span class="number">374</span>, <span class="number">392</span>, <span class="number">149</span>, <span class="number">217</span>, <span class="number">398</span>, <span class="number">441</span>, <span class="number">480</span>, <span class="number">453</span>, <span class="number">503</span>, <span class="number">318</span>, <span class="number">285</span>, <span class="number">418</span>], [<span class="number">0</span>, <span class="number">347</span>, <span class="number">223</span>, <span class="number">381</span>, <span class="number">469</span>, <span class="number">208</span>, <span class="number">424</span>, <span class="number">435</span>, <span class="number">404</span>, <span class="number">64</span>, <span class="number">107</span>, <span class="number">73</span>, <span class="number">490</span>, <span class="number">116</span>, <span class="number">445</span>, <span class="number">392</span>, <span class="number">194</span>, <span class="number">287</span>, <span class="number">66</span>, <span class="number">325</span>, <span class="number">261</span>], [<span class="number">99</span>, <span class="number">26</span>, <span class="number">489</span>, <span class="number">114</span>, <span class="number">3</span>, <span class="number">351</span>, <span class="number">494</span>, <span class="number">174</span>, <span class="number">369</span>, <span class="number">354</span>, <span class="number">379</span>, <span class="number">187</span>, <span class="number">90</span>, <span class="number">202</span>, <span class="number">286</span>, <span class="number">37</span>, <span class="number">48</span>, <span class="number">397</span>, <span class="number">298</span>, <span class="number">65</span>, <span class="number">499</span>], [<span class="number">455</span>, <span class="number">114</span>, <span class="number">349</span>, <span class="number">401</span>, <span class="number">5</span>, <span class="number">139</span>, <span class="number">314</span>, <span class="number">227</span>, <span class="number">134</span>, <span class="number">258</span>, <span class="number">270</span>, <span class="number">135</span>, <span class="number">287</span>, <span class="number">332</span>, <span class="number">298</span>, <span class="number">272</span>, <span class="number">167</span>, <span class="number">43</span>, <span class="number">271</span>, <span class="number">484</span>, <span class="number">177</span>], [<span class="number">448</span>, <span class="number">78</span>, <span class="number">479</span>, <span class="number">324</span>, <span class="number">170</span>, <span class="number">7</span>, <span class="number">230</span>, <span class="number">173</span>, <span class="number">214</span>, <span class="number">65</span>, <span class="number">91</span>, <span class="number">497</span>, <span class="number">68</span>, <span class="number">391</span>, <span class="number">44</span>, <span class="number">205</span>, <span class="number">364</span>, <span class="number">471</span>, <span class="number">460</span>, <span class="number">312</span>, <span class="number">122</span>], [<span class="number">452</span>, <span class="number">360</span>, <span class="number">448</span>, <span class="number">169</span>, <span class="number">240</span>, <span class="number">496</span>, <span class="number">302</span>, <span class="number">3</span>, <span class="number">354</span>, <span class="number">266</span>, <span class="number">46</span>, <span class="number">22</span>, <span class="number">151</span>, <span class="number">498</span>, <span class="number">461</span>, <span class="number">314</span>, <span class="number">169</span>, <span class="number">88</span>, <span class="number">30</span>, <span class="number">487</span>, <span class="number">258</span>], [<span class="number">282</span>, <span class="number">222</span>, <span class="number">260</span>, <span class="number">503</span>, <span class="number">106</span>, <span class="number">420</span>, <span class="number">315</span>, <span class="number">307</span>, <span class="number">202</span>, <span class="number">238</span>, <span class="number">224</span>, <span class="number">329</span>, <span class="number">351</span>, <span class="number">190</span>, <span class="number">137</span>, <span class="number">294</span>, <span class="number">171</span>, <span class="number">309</span>, <span class="number">19</span>, <span class="number">186</span>, <span class="number">391</span>], [<span class="number">69</span>, <span class="number">501</span>, <span class="number">283</span>, <span class="number">96</span>, <span class="number">159</span>, <span class="number">459</span>, <span class="number">437</span>, <span class="number">192</span>, <span class="number">293</span>, <span class="number">479</span>, <span class="number">79</span>, <span class="number">49</span>, <span class="number">299</span>, <span class="number">205</span>, <span class="number">177</span>, <span class="number">360</span>, <span class="number">36</span>, <span class="number">414</span>, <span class="number">118</span>, <span class="number">194</span>, <span class="number">270</span>], [<span class="number">6</span>, <span class="number">419</span>, <span class="number">459</span>, <span class="number">254</span>, <span class="number">97</span>, <span class="number">455</span>, <span class="number">445</span>, <span class="number">239</span>, <span class="number">277</span>, <span class="number">278</span>, <span class="number">226</span>, <span class="number">23</span>, <span class="number">146</span>, <span class="number">151</span>, <span class="number">273</span>, <span class="number">378</span>, <span class="number">141</span>, <span class="number">281</span>, <span class="number">480</span>, <span class="number">388</span>, <span class="number">213</span>], [<span class="number">181</span>, <span class="number">508</span>, <span class="number">347</span>, <span class="number">447</span>, <span class="number">467</span>, <span class="number">351</span>, <span class="number">503</span>, <span class="number">262</span>, <span class="number">375</span>, <span class="number">74</span>, <span class="number">49</span>, <span class="number">48</span>, <span class="number">364</span>, <span class="number">492</span>, <span class="number">400</span>, <span class="number">305</span>, <span class="number">25</span>, <span class="number">207</span>, <span class="number">278</span>, <span class="number">163</span>, <span class="number">11</span>], [<span class="number">320</span>, <span class="number">94</span>, <span class="number">400</span>, <span class="number">15</span>, <span class="number">201</span>, <span class="number">53</span>, <span class="number">130</span>, <span class="number">137</span>, <span class="number">219</span>, <span class="number">57</span>, <span class="number">20</span>, <span class="number">239</span>, <span class="number">467</span>, <span class="number">352</span>, <span class="number">373</span>, <span class="number">395</span>, <span class="number">58</span>, <span class="number">4</span>, <span class="number">446</span>, <span class="number">332</span>, <span class="number">41</span>], [<span class="number">205</span>, <span class="number">385</span>, <span class="number">446</span>, <span class="number">185</span>, <span class="number">470</span>, <span class="number">268</span>, <span class="number">308</span>, <span class="number">461</span>, <span class="number">265</span>, <span class="number">75</span>, <span class="number">75</span>, <span class="number">104</span>, <span class="number">108</span>, <span class="number">14</span>, <span class="number">334</span>, <span class="number">499</span>, <span class="number">207</span>, <span class="number">363</span>, <span class="number">94</span>, <span class="number">505</span>, <span class="number">363</span>], [<span class="number">299</span>, <span class="number">292</span>, <span class="number">112</span>, <span class="number">203</span>, <span class="number">7</span>, <span class="number">240</span>, <span class="number">499</span>, <span class="number">343</span>, <span class="number">396</span>, <span class="number">482</span>, <span class="number">383</span>, <span class="number">61</span>, <span class="number">476</span>, <span class="number">101</span>, <span class="number">187</span>, <span class="number">265</span>, <span class="number">428</span>, <span class="number">53</span>, <span class="number">24</span>, <span class="number">342</span>, <span class="number">201</span>], [<span class="number">421</span>, <span class="number">286</span>, <span class="number">305</span>, <span class="number">79</span>, <span class="number">324</span>, <span class="number">216</span>, <span class="number">163</span>, <span class="number">193</span>, <span class="number">362</span>, <span class="number">57</span>, <span class="number">472</span>, <span class="number">449</span>, <span class="number">169</span>, <span class="number">33</span>, <span class="number">280</span>, <span class="number">202</span>, <span class="number">237</span>, <span class="number">376</span>, <span class="number">382</span>, <span class="number">2</span>, <span class="number">1</span>], [<span class="number">379</span>, <span class="number">33</span>, <span class="number">151</span>, <span class="number">51</span>, <span class="number">353</span>, <span class="number">295</span>, <span class="number">145</span>, <span class="number">220</span>, <span class="number">147</span>, <span class="number">251</span>, <span class="number">90</span>, <span class="number">344</span>, <span class="number">96</span>, <span class="number">31</span>, <span class="number">185</span>, <span class="number">250</span>, <span class="number">270</span>, <span class="number">420</span>, <span class="number">365</span>, <span class="number">373</span>, <span class="number">356</span>], [<span class="number">228</span>, <span class="number">299</span>, <span class="number">87</span>, <span class="number">113</span>, <span class="number">458</span>, <span class="number">52</span>, <span class="number">26</span>, <span class="number">228</span>, <span class="number">294</span>, <span class="number">97</span>, <span class="number">384</span>, <span class="number">493</span>, <span class="number">380</span>, <span class="number">209</span>, <span class="number">257</span>, <span class="number">20</span>, <span class="number">375</span>, <span class="number">2</span>, <span class="number">316</span>, <span class="number">129</span>, <span class="number">492</span>], [<span class="number">479</span>, <span class="number">346</span>, <span class="number">57</span>, <span class="number">488</span>, <span class="number">183</span>, <span class="number">185</span>, <span class="number">18</span>, <span class="number">422</span>, <span class="number">209</span>, <span class="number">318</span>, <span class="number">461</span>, <span class="number">159</span>, <span class="number">469</span>, <span class="number">145</span>, <span class="number">44</span>, <span class="number">58</span>, <span class="number">441</span>, <span class="number">490</span>, <span class="number">510</span>, <span class="number">194</span>, <span class="number">192</span>], [<span class="number">254</span>, <span class="number">398</span>, <span class="number">510</span>, <span class="number">159</span>, <span class="number">371</span>, <span class="number">280</span>, <span class="number">331</span>, <span class="number">23</span>, <span class="number">99</span>, <span class="number">150</span>, <span class="number">175</span>, <span class="number">151</span>, <span class="number">42</span>, <span class="number">473</span>, <span class="number">164</span>, <span class="number">35</span>, <span class="number">97</span>, <span class="number">174</span>, <span class="number">115</span>, <span class="number">24</span>, <span class="number">270</span>], [<span class="number">280</span>, <span class="number">76</span>, <span class="number">254</span>, <span class="number">293</span>, <span class="number">491</span>, <span class="number">76</span>, <span class="number">128</span>, <span class="number">301</span>, <span class="number">240</span>, <span class="number">357</span>, <span class="number">192</span>, <span class="number">372</span>, <span class="number">343</span>, <span class="number">34</span>, <span class="number">386</span>, <span class="number">468</span>, <span class="number">313</span>, <span class="number">41</span>, <span class="number">285</span>, <span class="number">507</span>, <span class="number">282</span>], [<span class="number">271</span>, <span class="number">91</span>, <span class="number">507</span>, <span class="number">16</span>, <span class="number">128</span>, <span class="number">8</span>, <span class="number">326</span>, <span class="number">102</span>, <span class="number">355</span>, <span class="number">371</span>, <span class="number">313</span>, <span class="number">292</span>, <span class="number">433</span>, <span class="number">2</span>, <span class="number">459</span>, <span class="number">14</span>, <span class="number">258</span>, <span class="number">498</span>, <span class="number">146</span>, <span class="number">446</span>, <span class="number">309</span>], [<span class="number">386</span>, <span class="number">88</span>, <span class="number">502</span>, <span class="number">4</span>, <span class="number">399</span>, <span class="number">272</span>, <span class="number">49</span>, <span class="number">69</span>, <span class="number">51</span>, <span class="number">465</span>, <span class="number">291</span>, <span class="number">289</span>, <span class="number">417</span>, <span class="number">271</span>, <span class="number">374</span>, <span class="number">337</span>, <span class="number">46</span>, <span class="number">393</span>, <span class="number">19</span>, <span class="number">429</span>, <span class="number">91</span>], [<span class="number">407</span>, <span class="number">35</span>, <span class="number">337</span>, <span class="number">51</span>, <span class="number">41</span>, <span class="number">460</span>, <span class="number">222</span>, <span class="number">448</span>, <span class="number">499</span>, <span class="number">381</span>, <span class="number">59</span>, <span class="number">468</span>, <span class="number">440</span>, <span class="number">216</span>, <span class="number">86</span>, <span class="number">236</span>, <span class="number">91</span>, <span class="number">18</span>, <span class="number">123</span>, <span class="number">68</span>, <span class="number">145</span>], [<span class="number">384</span>, <span class="number">30</span>, <span class="number">454</span>, <span class="number">419</span>, <span class="number">275</span>, <span class="number">164</span>, <span class="number">72</span>, <span class="number">195</span>, <span class="number">489</span>, <span class="number">458</span>, <span class="number">419</span>, <span class="number">148</span>, <span class="number">269</span>, <span class="number">150</span>, <span class="number">358</span>, <span class="number">188</span>, <span class="number">109</span>, <span class="number">27</span>, <span class="number">42</span>, <span class="number">34</span>, <span class="number">123</span>], [<span class="number">500</span>, <span class="number">184</span>, <span class="number">195</span>, <span class="number">193</span>, <span class="number">68</span>, <span class="number">19</span>, <span class="number">329</span>, <span class="number">511</span>, <span class="number">280</span>, <span class="number">69</span>, <span class="number">113</span>, <span class="number">124</span>, <span class="number">102</span>, <span class="number">274</span>, <span class="number">43</span>, <span class="number">374</span>, <span class="number">408</span>, <span class="number">64</span>, <span class="number">314</span>, <span class="number">309</span>, <span class="number">473</span>], [<span class="number">72</span>, <span class="number">145</span>, <span class="number">242</span>, <span class="number">2</span>, <span class="number">367</span>, <span class="number">371</span>, <span class="number">143</span>, <span class="number">166</span>, <span class="number">325</span>, <span class="number">74</span>, <span class="number">414</span>, <span class="number">94</span>, <span class="number">269</span>, <span class="number">196</span>, <span class="number">124</span>, <span class="number">94</span>, <span class="number">14</span>, <span class="number">351</span>, <span class="number">111</span>, <span class="number">465</span>, <span class="number">503</span>], [<span class="number">70</span>, <span class="number">47</span>, <span class="number">439</span>, <span class="number">170</span>, <span class="number">306</span>, <span class="number">82</span>, <span class="number">233</span>, <span class="number">36</span>, <span class="number">346</span>, <span class="number">234</span>, <span class="number">157</span>, <span class="number">468</span>, <span class="number">83</span>, <span class="number">85</span>, <span class="number">424</span>, <span class="number">157</span>, <span class="number">258</span>, <span class="number">120</span>, <span class="number">270</span>, <span class="number">136</span>, <span class="number">286</span>], [<span class="number">442</span>, <span class="number">173</span>, <span class="number">254</span>, <span class="number">271</span>, <span class="number">420</span>, <span class="number">507</span>, <span class="number">297</span>, <span class="number">473</span>, <span class="number">296</span>, <span class="number">511</span>, <span class="number">98</span>, <span class="number">133</span>, <span class="number">37</span>, <span class="number">498</span>, <span class="number">468</span>, <span class="number">17</span>, <span class="number">260</span>, <span class="number">318</span>, <span class="number">168</span>, <span class="number">490</span>, <span class="number">124</span>], [<span class="number">50</span>, <span class="number">35</span>, <span class="number">252</span>, <span class="number">472</span>, <span class="number">406</span>, <span class="number">400</span>, <span class="number">439</span>, <span class="number">89</span>, <span class="number">309</span>, <span class="number">393</span>, <span class="number">332</span>, <span class="number">324</span>, <span class="number">260</span>, <span class="number">215</span>, <span class="number">8</span>, <span class="number">322</span>, <span class="number">357</span>, <span class="number">252</span>, <span class="number">124</span>, <span class="number">358</span>, <span class="number">457</span>], [<span class="number">93</span>, <span class="number">102</span>, <span class="number">478</span>, <span class="number">224</span>, <span class="number">428</span>, <span class="number">10</span>, <span class="number">238</span>, <span class="number">368</span>, <span class="number">113</span>, <span class="number">502</span>, <span class="number">148</span>, <span class="number">7</span>, <span class="number">395</span>, <span class="number">97</span>, <span class="number">73</span>, <span class="number">306</span>, <span class="number">40</span>, <span class="number">395</span>, <span class="number">9</span>, <span class="number">254</span>, <span class="number">319</span>], [<span class="number">282</span>, <span class="number">277</span>, <span class="number">295</span>, <span class="number">425</span>, <span class="number">59</span>, <span class="number">21</span>, <span class="number">136</span>, <span class="number">230</span>, <span class="number">207</span>, <span class="number">1</span>, <span class="number">29</span>, <span class="number">170</span>, <span class="number">14</span>, <span class="number">337</span>, <span class="number">371</span>, <span class="number">437</span>, <span class="number">359</span>, <span class="number">10</span>, <span class="number">100</span>, <span class="number">374</span>, <span class="number">24</span>], [<span class="number">3</span>, <span class="number">270</span>, <span class="number">289</span>, <span class="number">179</span>, <span class="number">434</span>, <span class="number">489</span>, <span class="number">470</span>, <span class="number">343</span>, <span class="number">478</span>, <span class="number">156</span>, <span class="number">177</span>, <span class="number">72</span>, <span class="number">13</span>, <span class="number">266</span>, <span class="number">475</span>, <span class="number">23</span>, <span class="number">148</span>, <span class="number">102</span>, <span class="number">210</span>, <span class="number">270</span>, <span class="number">323</span>], [<span class="number">464</span>, <span class="number">466</span>, <span class="number">277</span>, <span class="number">191</span>, <span class="number">426</span>, <span class="number">20</span>, <span class="number">266</span>, <span class="number">33</span>, <span class="number">41</span>, <span class="number">249</span>, <span class="number">452</span>, <span class="number">475</span>, <span class="number">265</span>, <span class="number">421</span>, <span class="number">282</span>, <span class="number">250</span>, <span class="number">233</span>, <span class="number">287</span>, <span class="number">495</span>, <span class="number">170</span>, <span class="number">300</span>], [<span class="number">379</span>, <span class="number">35</span>, <span class="number">137</span>, <span class="number">106</span>, <span class="number">155</span>, <span class="number">81</span>, <span class="number">154</span>, <span class="number">382</span>, <span class="number">30</span>, <span class="number">237</span>, <span class="number">294</span>, <span class="number">478</span>, <span class="number">321</span>, <span class="number">384</span>, <span class="number">48</span>, <span class="number">111</span>, <span class="number">150</span>, <span class="number">4</span>, <span class="number">454</span>, <span class="number">446</span>, <span class="number">28</span>], [<span class="number">57</span>, <span class="number">355</span>, <span class="number">94</span>, <span class="number">253</span>, <span class="number">297</span>, <span class="number">424</span>, <span class="number">415</span>, <span class="number">480</span>, <span class="number">68</span>, <span class="number">356</span>, <span class="number">415</span>, <span class="number">73</span>, <span class="number">41</span>, <span class="number">171</span>, <span class="number">491</span>, <span class="number">130</span>, <span class="number">92</span>, <span class="number">180</span>, <span class="number">506</span>, <span class="number">326</span>, <span class="number">463</span>], [<span class="number">279</span>, <span class="number">43</span>, <span class="number">202</span>, <span class="number">35</span>, <span class="number">397</span>, <span class="number">257</span>, <span class="number">120</span>, <span class="number">11</span>, <span class="number">231</span>, <span class="number">369</span>, <span class="number">221</span>, <span class="number">332</span>, <span class="number">47</span>, <span class="number">236</span>, <span class="number">58</span>, <span class="number">278</span>, <span class="number">75</span>, <span class="number">117</span>, <span class="number">33</span>, <span class="number">130</span>, <span class="number">358</span>], [<span class="number">142</span>, <span class="number">335</span>, <span class="number">339</span>, <span class="number">112</span>, <span class="number">38</span>, <span class="number">82</span>, <span class="number">426</span>, <span class="number">211</span>, <span class="number">174</span>, <span class="number">389</span>, <span class="number">137</span>, <span class="number">96</span>, <span class="number">431</span>, <span class="number">113</span>, <span class="number">112</span>, <span class="number">500</span>, <span class="number">145</span>, <span class="number">44</span>, <span class="number">313</span>, <span class="number">96</span>, <span class="number">187</span>], [<span class="number">246</span>, <span class="number">211</span>, <span class="number">400</span>, <span class="number">415</span>, <span class="number">294</span>, <span class="number">234</span>, <span class="number">367</span>, <span class="number">46</span>, <span class="number">371</span>, <span class="number">479</span>, <span class="number">412</span>, <span class="number">197</span>, <span class="number">204</span>, <span class="number">498</span>, <span class="number">18</span>, <span class="number">140</span>, <span class="number">67</span>, <span class="number">237</span>, <span class="number">510</span>, <span class="number">457</span>, <span class="number">298</span>], [<span class="number">258</span>, <span class="number">3</span>, <span class="number">136</span>, <span class="number">284</span>, <span class="number">149</span>, <span class="number">161</span>, <span class="number">456</span>, <span class="number">122</span>, <span class="number">114</span>, <span class="number">383</span>, <span class="number">251</span>, <span class="number">240</span>, <span class="number">453</span>, <span class="number">227</span>, <span class="number">330</span>, <span class="number">33</span>, <span class="number">241</span>, <span class="number">160</span>, <span class="number">306</span>, <span class="number">254</span>, <span class="number">409</span>], [<span class="number">391</span>, <span class="number">115</span>, <span class="number">92</span>, <span class="number">102</span>, <span class="number">359</span>, <span class="number">182</span>, <span class="number">489</span>, <span class="number">313</span>, <span class="number">204</span>, <span class="number">275</span>, <span class="number">206</span>, <span class="number">447</span>, <span class="number">436</span>, <span class="number">286</span>, <span class="number">229</span>, <span class="number">377</span>, <span class="number">374</span>, <span class="number">162</span>, <span class="number">22</span>, <span class="number">384</span>, <span class="number">40</span>], [<span class="number">427</span>, <span class="number">491</span>, <span class="number">362</span>, <span class="number">240</span>, <span class="number">358</span>, <span class="number">296</span>, <span class="number">154</span>, <span class="number">178</span>, <span class="number">278</span>, <span class="number">284</span>, <span class="number">324</span>, <span class="number">422</span>, <span class="number">52</span>, <span class="number">295</span>, <span class="number">490</span>, <span class="number">56</span>, <span class="number">39</span>, <span class="number">378</span>, <span class="number">174</span>, <span class="number">202</span>, <span class="number">496</span>], [<span class="number">29</span>, <span class="number">454</span>, <span class="number">436</span>, <span class="number">6</span>, <span class="number">287</span>, <span class="number">82</span>, <span class="number">154</span>, <span class="number">474</span>, <span class="number">92</span>, <span class="number">272</span>, <span class="number">400</span>, <span class="number">238</span>, <span class="number">352</span>, <span class="number">140</span>, <span class="number">386</span>, <span class="number">504</span>, <span class="number">19</span>, <span class="number">32</span>, <span class="number">334</span>, <span class="number">30</span>, <span class="number">450</span>], [<span class="number">469</span>, <span class="number">123</span>, <span class="number">353</span>, <span class="number">422</span>, <span class="number">175</span>, <span class="number">260</span>, <span class="number">294</span>, <span class="number">18</span>, <span class="number">268</span>, <span class="number">479</span>, <span class="number">60</span>, <span class="number">114</span>, <span class="number">456</span>, <span class="number">55</span>, <span class="number">403</span>, <span class="number">446</span>, <span class="number">166</span>, <span class="number">259</span>, <span class="number">294</span>, <span class="number">215</span>, <span class="number">48</span>], [<span class="number">404</span>, <span class="number">187</span>, <span class="number">426</span>, <span class="number">362</span>, <span class="number">296</span>, <span class="number">239</span>, <span class="number">226</span>, <span class="number">416</span>, <span class="number">306</span>, <span class="number">336</span>, <span class="number">1</span>, <span class="number">448</span>, <span class="number">47</span>, <span class="number">403</span>, <span class="number">367</span>, <span class="number">357</span>, <span class="number">501</span>, <span class="number">425</span>, <span class="number">310</span>, <span class="number">41</span>, <span class="number">303</span>], [<span class="number">339</span>, <span class="number">115</span>, <span class="number">478</span>, <span class="number">416</span>, <span class="number">10</span>, <span class="number">90</span>, <span class="number">188</span>, <span class="number">229</span>, <span class="number">217</span>, <span class="number">441</span>, <span class="number">288</span>, <span class="number">152</span>, <span class="number">394</span>, <span class="number">219</span>, <span class="number">422</span>, <span class="number">376</span>, <span class="number">325</span>, <span class="number">375</span>, <span class="number">6</span>, <span class="number">454</span>, <span class="number">238</span>], [<span class="number">226</span>, <span class="number">226</span>, <span class="number">149</span>, <span class="number">107</span>, <span class="number">418</span>, <span class="number">419</span>, <span class="number">209</span>, <span class="number">108</span>, <span class="number">87</span>, <span class="number">127</span>, <span class="number">202</span>, <span class="number">320</span>, <span class="number">179</span>, <span class="number">234</span>, <span class="number">87</span>, <span class="number">335</span>, <span class="number">195</span>, <span class="number">5</span>, <span class="number">273</span>, <span class="number">142</span>, <span class="number">115</span>], [<span class="number">464</span>, <span class="number">177</span>, <span class="number">77</span>, <span class="number">101</span>, <span class="number">76</span>, <span class="number">19</span>, <span class="number">73</span>, <span class="number">397</span>, <span class="number">296</span>, <span class="number">34</span>, <span class="number">360</span>, <span class="number">107</span>, <span class="number">491</span>, <span class="number">460</span>, <span class="number">510</span>, <span class="number">342</span>, <span class="number">198</span>, <span class="number">118</span>, <span class="number">105</span>, <span class="number">337</span>, <span class="number">239</span>], [<span class="number">464</span>, <span class="number">25</span>, <span class="number">191</span>, <span class="number">113</span>, <span class="number">455</span>, <span class="number">129</span>, <span class="number">247</span>, <span class="number">488</span>, <span class="number">303</span>, <span class="number">27</span>, <span class="number">242</span>, <span class="number">423</span>, <span class="number">336</span>, <span class="number">125</span>, <span class="number">283</span>, <span class="number">332</span>, <span class="number">244</span>, <span class="number">372</span>, <span class="number">175</span>, <span class="number">276</span>, <span class="number">49</span>], [<span class="number">211</span>, <span class="number">367</span>, <span class="number">406</span>, <span class="number">314</span>, <span class="number">177</span>, <span class="number">496</span>, <span class="number">320</span>, <span class="number">385</span>, <span class="number">193</span>, <span class="number">51</span>, <span class="number">423</span>, <span class="number">80</span>, <span class="number">258</span>, <span class="number">44</span>, <span class="number">154</span>, <span class="number">362</span>, <span class="number">215</span>, <span class="number">296</span>, <span class="number">260</span>, <span class="number">424</span>, <span class="number">160</span>], [<span class="number">384</span>, <span class="number">161</span>, <span class="number">92</span>, <span class="number">402</span>, <span class="number">414</span>, <span class="number">443</span>, <span class="number">129</span>, <span class="number">279</span>, <span class="number">272</span>, <span class="number">224</span>, <span class="number">294</span>, <span class="number">319</span>, <span class="number">75</span>, <span class="number">169</span>, <span class="number">242</span>, <span class="number">85</span>, <span class="number">315</span>, <span class="number">402</span>, <span class="number">4</span>, <span class="number">268</span>, <span class="number">88</span>]]</span><br><span class="line">cipher1 = [<span class="number">1702</span>, <span class="number">795</span>, <span class="number">740</span>, <span class="number">373</span>, <span class="number">535</span>, <span class="number">1308</span>, <span class="number">1050</span>, <span class="number">502</span>, <span class="number">40</span>, <span class="number">672</span>, <span class="number">1354</span>, <span class="number">1843</span>, <span class="number">515</span>, <span class="number">231</span>, <span class="number">774</span>, <span class="number">65</span>, <span class="number">978</span>, <span class="number">1340</span>, <span class="number">455</span>, <span class="number">2137</span>, <span class="number">733</span>, <span class="number">307</span>, <span class="number">1604</span>, <span class="number">723</span>, <span class="number">1023</span>, <span class="number">1253</span>, <span class="number">275</span>, <span class="number">1817</span>, <span class="number">404</span>, <span class="number">2035</span>, <span class="number">267</span>, <span class="number">1475</span>, <span class="number">14</span>, <span class="number">2127</span>, <span class="number">15</span>, <span class="number">487</span>, <span class="number">317</span>, <span class="number">757</span>, <span class="number">290</span>, <span class="number">541</span>, <span class="number">100</span>, <span class="number">951</span>, <span class="number">2049</span>, <span class="number">1042</span>, <span class="number">1404</span>, <span class="number">1676</span>, <span class="number">655</span>, <span class="number">1460</span>, <span class="number">1532</span>, <span class="number">273</span>, <span class="number">916</span>, <span class="number">1454</span>, <span class="number">1690</span>, <span class="number">1628</span>, <span class="number">1751</span>, <span class="number">1656</span>, <span class="number">139</span>, <span class="number">156</span>, <span class="number">2102</span>, <span class="number">264</span>, <span class="number">243</span>, <span class="number">455</span>, <span class="number">1564</span>, <span class="number">2072</span>]</span><br><span class="line">key = matrix(Zmod(prime),key[:<span class="number">21</span>])</span><br><span class="line">cipher1 = vector(Zmod(prime),cipher1[:<span class="number">21</span>])</span><br><span class="line">flag1 = (key ** -<span class="number">1</span>) * cipher1</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>(flag1))</span><br></pre></td></tr></table></figure><p>第二部分是一个lwe问题，是在第一部分的基础上，在结果上加了噪声，也就是</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">noise = [random.randint(0,6) for i in range(row)]</span><br><span class="line">print add(noise,cipher2)</span><br></pre></td></tr></table></figure><p>lwe的原理也不懂，记个板子就好。板子来自<span class="exturl" data-url="aHR0cHM6Ly9sYXp6emFyby5naXRodWIuaW8vMjAyMC8xMS8wNy9jcnlwdG8tJUU2JUEwJUJDJUU1JUFGJTg2JUU3JUEwJTgxLw==">lazzaro</span></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sage.modules.free_module_integer <span class="keyword">import</span> IntegerLattice</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> randint</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> starmap</span><br><span class="line"><span class="keyword">from</span> operator <span class="keyword">import</span> mul</span><br><span class="line"><span class="comment"># Babai&#x27;s Nearest Plane algorithm</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Babai_closest_vector</span>(<span class="params">M, G, target</span>):</span><br><span class="line">    small = target</span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">reversed</span>(<span class="built_in">range</span>(M.nrows())):</span><br><span class="line">            c = ((small * G[i]) / (G[i] * G[i])).<span class="built_in">round</span>()</span><br><span class="line">            small -= M[i] * c</span><br><span class="line">    <span class="keyword">return</span> target - small</span><br><span class="line"></span><br><span class="line">key = [[<span class="number">185</span>, <span class="number">96</span>, <span class="number">351</span>, <span class="number">118</span>, <span class="number">421</span>, <span class="number">449</span>, <span class="number">350</span>, <span class="number">349</span>, <span class="number">388</span>, <span class="number">95</span>, <span class="number">341</span>, <span class="number">327</span>, <span class="number">29</span>, <span class="number">156</span>, <span class="number">399</span>, <span class="number">283</span>, <span class="number">292</span>, <span class="number">461</span>, <span class="number">445</span>, <span class="number">120</span>, <span class="number">126</span>], [<span class="number">495</span>, <span class="number">358</span>, <span class="number">192</span>, <span class="number">300</span>, <span class="number">279</span>, <span class="number">277</span>, <span class="number">478</span>, <span class="number">335</span>, <span class="number">231</span>, <span class="number">241</span>, <span class="number">178</span>, <span class="number">314</span>, <span class="number">453</span>, <span class="number">251</span>, <span class="number">133</span>, <span class="number">391</span>, <span class="number">213</span>, <span class="number">132</span>, <span class="number">254</span>, <span class="number">388</span>, <span class="number">46</span>], [<span class="number">428</span>, <span class="number">44</span>, <span class="number">100</span>, <span class="number">483</span>, <span class="number">12</span>, <span class="number">311</span>, <span class="number">57</span>, <span class="number">443</span>, <span class="number">289</span>, <span class="number">90</span>, <span class="number">478</span>, <span class="number">495</span>, <span class="number">399</span>, <span class="number">89</span>, <span class="number">324</span>, <span class="number">275</span>, <span class="number">322</span>, <span class="number">99</span>, <span class="number">343</span>, <span class="number">489</span>, <span class="number">133</span>], [<span class="number">420</span>, <span class="number">358</span>, <span class="number">472</span>, <span class="number">260</span>, <span class="number">267</span>, <span class="number">136</span>, <span class="number">303</span>, <span class="number">491</span>, <span class="number">390</span>, <span class="number">248</span>, <span class="number">430</span>, <span class="number">117</span>, <span class="number">154</span>, <span class="number">244</span>, <span class="number">62</span>, <span class="number">217</span>, <span class="number">204</span>, <span class="number">334</span>, <span class="number">277</span>, <span class="number">231</span>, <span class="number">325</span>], [<span class="number">11</span>, <span class="number">96</span>, <span class="number">61</span>, <span class="number">67</span>, <span class="number">456</span>, <span class="number">361</span>, <span class="number">292</span>, <span class="number">278</span>, <span class="number">424</span>, <span class="number">237</span>, <span class="number">345</span>, <span class="number">109</span>, <span class="number">475</span>, <span class="number">473</span>, <span class="number">29</span>, <span class="number">250</span>, <span class="number">195</span>, <span class="number">430</span>, <span class="number">114</span>, <span class="number">13</span>, <span class="number">199</span>], [<span class="number">17</span>, <span class="number">91</span>, <span class="number">330</span>, <span class="number">73</span>, <span class="number">384</span>, <span class="number">134</span>, <span class="number">437</span>, <span class="number">161</span>, <span class="number">166</span>, <span class="number">185</span>, <span class="number">499</span>, <span class="number">491</span>, <span class="number">342</span>, <span class="number">129</span>, <span class="number">348</span>, <span class="number">162</span>, <span class="number">478</span>, <span class="number">216</span>, <span class="number">189</span>, <span class="number">311</span>, <span class="number">502</span>], [<span class="number">396</span>, <span class="number">437</span>, <span class="number">98</span>, <span class="number">421</span>, <span class="number">120</span>, <span class="number">443</span>, <span class="number">113</span>, <span class="number">432</span>, <span class="number">9</span>, <span class="number">476</span>, <span class="number">243</span>, <span class="number">122</span>, <span class="number">416</span>, <span class="number">508</span>, <span class="number">287</span>, <span class="number">45</span>, <span class="number">84</span>, <span class="number">322</span>, <span class="number">504</span>, <span class="number">287</span>, <span class="number">251</span>], [<span class="number">187</span>, <span class="number">489</span>, <span class="number">407</span>, <span class="number">204</span>, <span class="number">127</span>, <span class="number">10</span>, <span class="number">302</span>, <span class="number">101</span>, <span class="number">389</span>, <span class="number">113</span>, <span class="number">469</span>, <span class="number">184</span>, <span class="number">249</span>, <span class="number">131</span>, <span class="number">113</span>, <span class="number">18</span>, <span class="number">350</span>, <span class="number">106</span>, <span class="number">486</span>, <span class="number">406</span>, <span class="number">295</span>], [<span class="number">265</span>, <span class="number">425</span>, <span class="number">30</span>, <span class="number">478</span>, <span class="number">471</span>, <span class="number">211</span>, <span class="number">162</span>, <span class="number">323</span>, <span class="number">163</span>, <span class="number">205</span>, <span class="number">187</span>, <span class="number">422</span>, <span class="number">452</span>, <span class="number">226</span>, <span class="number">230</span>, <span class="number">367</span>, <span class="number">478</span>, <span class="number">229</span>, <span class="number">365</span>, <span class="number">395</span>, <span class="number">294</span>], [<span class="number">360</span>, <span class="number">193</span>, <span class="number">180</span>, <span class="number">253</span>, <span class="number">337</span>, <span class="number">453</span>, <span class="number">16</span>, <span class="number">352</span>, <span class="number">243</span>, <span class="number">107</span>, <span class="number">171</span>, <span class="number">46</span>, <span class="number">25</span>, <span class="number">234</span>, <span class="number">46</span>, <span class="number">479</span>, <span class="number">267</span>, <span class="number">267</span>, <span class="number">171</span>, <span class="number">188</span>, <span class="number">127</span>], [<span class="number">379</span>, <span class="number">360</span>, <span class="number">109</span>, <span class="number">360</span>, <span class="number">403</span>, <span class="number">343</span>, <span class="number">75</span>, <span class="number">306</span>, <span class="number">138</span>, <span class="number">40</span>, <span class="number">41</span>, <span class="number">253</span>, <span class="number">428</span>, <span class="number">401</span>, <span class="number">464</span>, <span class="number">495</span>, <span class="number">21</span>, <span class="number">296</span>, <span class="number">319</span>, <span class="number">410</span>, <span class="number">440</span>], [<span class="number">28</span>, <span class="number">209</span>, <span class="number">1</span>, <span class="number">233</span>, <span class="number">458</span>, <span class="number">266</span>, <span class="number">301</span>, <span class="number">359</span>, <span class="number">469</span>, <span class="number">304</span>, <span class="number">264</span>, <span class="number">368</span>, <span class="number">339</span>, <span class="number">25</span>, <span class="number">490</span>, <span class="number">343</span>, <span class="number">404</span>, <span class="number">488</span>, <span class="number">275</span>, <span class="number">262</span>, <span class="number">274</span>], [<span class="number">180</span>, <span class="number">372</span>, <span class="number">133</span>, <span class="number">341</span>, <span class="number">29</span>, <span class="number">352</span>, <span class="number">326</span>, <span class="number">89</span>, <span class="number">323</span>, <span class="number">479</span>, <span class="number">68</span>, <span class="number">76</span>, <span class="number">247</span>, <span class="number">225</span>, <span class="number">159</span>, <span class="number">163</span>, <span class="number">180</span>, <span class="number">160</span>, <span class="number">171</span>, <span class="number">7</span>, <span class="number">322</span>], [<span class="number">322</span>, <span class="number">295</span>, <span class="number">28</span>, <span class="number">467</span>, <span class="number">361</span>, <span class="number">169</span>, <span class="number">190</span>, <span class="number">71</span>, <span class="number">456</span>, <span class="number">140</span>, <span class="number">456</span>, <span class="number">202</span>, <span class="number">295</span>, <span class="number">424</span>, <span class="number">428</span>, <span class="number">18</span>, <span class="number">286</span>, <span class="number">233</span>, <span class="number">470</span>, <span class="number">303</span>, <span class="number">429</span>], [<span class="number">234</span>, <span class="number">37</span>, <span class="number">128</span>, <span class="number">175</span>, <span class="number">282</span>, <span class="number">509</span>, <span class="number">54</span>, <span class="number">186</span>, <span class="number">177</span>, <span class="number">23</span>, <span class="number">348</span>, <span class="number">487</span>, <span class="number">473</span>, <span class="number">377</span>, <span class="number">81</span>, <span class="number">225</span>, <span class="number">154</span>, <span class="number">511</span>, <span class="number">364</span>, <span class="number">120</span>, <span class="number">280</span>], [<span class="number">262</span>, <span class="number">82</span>, <span class="number">383</span>, <span class="number">490</span>, <span class="number">128</span>, <span class="number">448</span>, <span class="number">289</span>, <span class="number">420</span>, <span class="number">239</span>, <span class="number">374</span>, <span class="number">392</span>, <span class="number">149</span>, <span class="number">217</span>, <span class="number">398</span>, <span class="number">441</span>, <span class="number">480</span>, <span class="number">453</span>, <span class="number">503</span>, <span class="number">318</span>, <span class="number">285</span>, <span class="number">418</span>], [<span class="number">0</span>, <span class="number">347</span>, <span class="number">223</span>, <span class="number">381</span>, <span class="number">469</span>, <span class="number">208</span>, <span class="number">424</span>, <span class="number">435</span>, <span class="number">404</span>, <span class="number">64</span>, <span class="number">107</span>, <span class="number">73</span>, <span class="number">490</span>, <span class="number">116</span>, <span class="number">445</span>, <span class="number">392</span>, <span class="number">194</span>, <span class="number">287</span>, <span class="number">66</span>, <span class="number">325</span>, <span class="number">261</span>], [<span class="number">99</span>, <span class="number">26</span>, <span class="number">489</span>, <span class="number">114</span>, <span class="number">3</span>, <span class="number">351</span>, <span class="number">494</span>, <span class="number">174</span>, <span class="number">369</span>, <span class="number">354</span>, <span class="number">379</span>, <span class="number">187</span>, <span class="number">90</span>, <span class="number">202</span>, <span class="number">286</span>, <span class="number">37</span>, <span class="number">48</span>, <span class="number">397</span>, <span class="number">298</span>, <span class="number">65</span>, <span class="number">499</span>], [<span class="number">455</span>, <span class="number">114</span>, <span class="number">349</span>, <span class="number">401</span>, <span class="number">5</span>, <span class="number">139</span>, <span class="number">314</span>, <span class="number">227</span>, <span class="number">134</span>, <span class="number">258</span>, <span class="number">270</span>, <span class="number">135</span>, <span class="number">287</span>, <span class="number">332</span>, <span class="number">298</span>, <span class="number">272</span>, <span class="number">167</span>, <span class="number">43</span>, <span class="number">271</span>, <span class="number">484</span>, <span class="number">177</span>], [<span class="number">448</span>, <span class="number">78</span>, <span class="number">479</span>, <span class="number">324</span>, <span class="number">170</span>, <span class="number">7</span>, <span class="number">230</span>, <span class="number">173</span>, <span class="number">214</span>, <span class="number">65</span>, <span class="number">91</span>, <span class="number">497</span>, <span class="number">68</span>, <span class="number">391</span>, <span class="number">44</span>, <span class="number">205</span>, <span class="number">364</span>, <span class="number">471</span>, <span class="number">460</span>, <span class="number">312</span>, <span class="number">122</span>], [<span class="number">452</span>, <span class="number">360</span>, <span class="number">448</span>, <span class="number">169</span>, <span class="number">240</span>, <span class="number">496</span>, <span class="number">302</span>, <span class="number">3</span>, <span class="number">354</span>, <span class="number">266</span>, <span class="number">46</span>, <span class="number">22</span>, <span class="number">151</span>, <span class="number">498</span>, <span class="number">461</span>, <span class="number">314</span>, <span class="number">169</span>, <span class="number">88</span>, <span class="number">30</span>, <span class="number">487</span>, <span class="number">258</span>], [<span class="number">282</span>, <span class="number">222</span>, <span class="number">260</span>, <span class="number">503</span>, <span class="number">106</span>, <span class="number">420</span>, <span class="number">315</span>, <span class="number">307</span>, <span class="number">202</span>, <span class="number">238</span>, <span class="number">224</span>, <span class="number">329</span>, <span class="number">351</span>, <span class="number">190</span>, <span class="number">137</span>, <span class="number">294</span>, <span class="number">171</span>, <span class="number">309</span>, <span class="number">19</span>, <span class="number">186</span>, <span class="number">391</span>], [<span class="number">69</span>, <span class="number">501</span>, <span class="number">283</span>, <span class="number">96</span>, <span class="number">159</span>, <span class="number">459</span>, <span class="number">437</span>, <span class="number">192</span>, <span class="number">293</span>, <span class="number">479</span>, <span class="number">79</span>, <span class="number">49</span>, <span class="number">299</span>, <span class="number">205</span>, <span class="number">177</span>, <span class="number">360</span>, <span class="number">36</span>, <span class="number">414</span>, <span class="number">118</span>, <span class="number">194</span>, <span class="number">270</span>], [<span class="number">6</span>, <span class="number">419</span>, <span class="number">459</span>, <span class="number">254</span>, <span class="number">97</span>, <span class="number">455</span>, <span class="number">445</span>, <span class="number">239</span>, <span class="number">277</span>, <span class="number">278</span>, <span class="number">226</span>, <span class="number">23</span>, <span class="number">146</span>, <span class="number">151</span>, <span class="number">273</span>, <span class="number">378</span>, <span class="number">141</span>, <span class="number">281</span>, <span class="number">480</span>, <span class="number">388</span>, <span class="number">213</span>], [<span class="number">181</span>, <span class="number">508</span>, <span class="number">347</span>, <span class="number">447</span>, <span class="number">467</span>, <span class="number">351</span>, <span class="number">503</span>, <span class="number">262</span>, <span class="number">375</span>, <span class="number">74</span>, <span class="number">49</span>, <span class="number">48</span>, <span class="number">364</span>, <span class="number">492</span>, <span class="number">400</span>, <span class="number">305</span>, <span class="number">25</span>, <span class="number">207</span>, <span class="number">278</span>, <span class="number">163</span>, <span class="number">11</span>], [<span class="number">320</span>, <span class="number">94</span>, <span class="number">400</span>, <span class="number">15</span>, <span class="number">201</span>, <span class="number">53</span>, <span class="number">130</span>, <span class="number">137</span>, <span class="number">219</span>, <span class="number">57</span>, <span class="number">20</span>, <span class="number">239</span>, <span class="number">467</span>, <span class="number">352</span>, <span class="number">373</span>, <span class="number">395</span>, <span class="number">58</span>, <span class="number">4</span>, <span class="number">446</span>, <span class="number">332</span>, <span class="number">41</span>], [<span class="number">205</span>, <span class="number">385</span>, <span class="number">446</span>, <span class="number">185</span>, <span class="number">470</span>, <span class="number">268</span>, <span class="number">308</span>, <span class="number">461</span>, <span class="number">265</span>, <span class="number">75</span>, <span class="number">75</span>, <span class="number">104</span>, <span class="number">108</span>, <span class="number">14</span>, <span class="number">334</span>, <span class="number">499</span>, <span class="number">207</span>, <span class="number">363</span>, <span class="number">94</span>, <span class="number">505</span>, <span class="number">363</span>], [<span class="number">299</span>, <span class="number">292</span>, <span class="number">112</span>, <span class="number">203</span>, <span class="number">7</span>, <span class="number">240</span>, <span class="number">499</span>, <span class="number">343</span>, <span class="number">396</span>, <span class="number">482</span>, <span class="number">383</span>, <span class="number">61</span>, <span class="number">476</span>, <span class="number">101</span>, <span class="number">187</span>, <span class="number">265</span>, <span class="number">428</span>, <span class="number">53</span>, <span class="number">24</span>, <span class="number">342</span>, <span class="number">201</span>], [<span class="number">421</span>, <span class="number">286</span>, <span class="number">305</span>, <span class="number">79</span>, <span class="number">324</span>, <span class="number">216</span>, <span class="number">163</span>, <span class="number">193</span>, <span class="number">362</span>, <span class="number">57</span>, <span class="number">472</span>, <span class="number">449</span>, <span class="number">169</span>, <span class="number">33</span>, <span class="number">280</span>, <span class="number">202</span>, <span class="number">237</span>, <span class="number">376</span>, <span class="number">382</span>, <span class="number">2</span>, <span class="number">1</span>], [<span class="number">379</span>, <span class="number">33</span>, <span class="number">151</span>, <span class="number">51</span>, <span class="number">353</span>, <span class="number">295</span>, <span class="number">145</span>, <span class="number">220</span>, <span class="number">147</span>, <span class="number">251</span>, <span class="number">90</span>, <span class="number">344</span>, <span class="number">96</span>, <span class="number">31</span>, <span class="number">185</span>, <span class="number">250</span>, <span class="number">270</span>, <span class="number">420</span>, <span class="number">365</span>, <span class="number">373</span>, <span class="number">356</span>], [<span class="number">228</span>, <span class="number">299</span>, <span class="number">87</span>, <span class="number">113</span>, <span class="number">458</span>, <span class="number">52</span>, <span class="number">26</span>, <span class="number">228</span>, <span class="number">294</span>, <span class="number">97</span>, <span class="number">384</span>, <span class="number">493</span>, <span class="number">380</span>, <span class="number">209</span>, <span class="number">257</span>, <span class="number">20</span>, <span class="number">375</span>, <span class="number">2</span>, <span class="number">316</span>, <span class="number">129</span>, <span class="number">492</span>], [<span class="number">479</span>, <span class="number">346</span>, <span class="number">57</span>, <span class="number">488</span>, <span class="number">183</span>, <span class="number">185</span>, <span class="number">18</span>, <span class="number">422</span>, <span class="number">209</span>, <span class="number">318</span>, <span class="number">461</span>, <span class="number">159</span>, <span class="number">469</span>, <span class="number">145</span>, <span class="number">44</span>, <span class="number">58</span>, <span class="number">441</span>, <span class="number">490</span>, <span class="number">510</span>, <span class="number">194</span>, <span class="number">192</span>], [<span class="number">254</span>, <span class="number">398</span>, <span class="number">510</span>, <span class="number">159</span>, <span class="number">371</span>, <span class="number">280</span>, <span class="number">331</span>, <span class="number">23</span>, <span class="number">99</span>, <span class="number">150</span>, <span class="number">175</span>, <span class="number">151</span>, <span class="number">42</span>, <span class="number">473</span>, <span class="number">164</span>, <span class="number">35</span>, <span class="number">97</span>, <span class="number">174</span>, <span class="number">115</span>, <span class="number">24</span>, <span class="number">270</span>], [<span class="number">280</span>, <span class="number">76</span>, <span class="number">254</span>, <span class="number">293</span>, <span class="number">491</span>, <span class="number">76</span>, <span class="number">128</span>, <span class="number">301</span>, <span class="number">240</span>, <span class="number">357</span>, <span class="number">192</span>, <span class="number">372</span>, <span class="number">343</span>, <span class="number">34</span>, <span class="number">386</span>, <span class="number">468</span>, <span class="number">313</span>, <span class="number">41</span>, <span class="number">285</span>, <span class="number">507</span>, <span class="number">282</span>], [<span class="number">271</span>, <span class="number">91</span>, <span class="number">507</span>, <span class="number">16</span>, <span class="number">128</span>, <span class="number">8</span>, <span class="number">326</span>, <span class="number">102</span>, <span class="number">355</span>, <span class="number">371</span>, <span class="number">313</span>, <span class="number">292</span>, <span class="number">433</span>, <span class="number">2</span>, <span class="number">459</span>, <span class="number">14</span>, <span class="number">258</span>, <span class="number">498</span>, <span class="number">146</span>, <span class="number">446</span>, <span class="number">309</span>], [<span class="number">386</span>, <span class="number">88</span>, <span class="number">502</span>, <span class="number">4</span>, <span class="number">399</span>, <span class="number">272</span>, <span class="number">49</span>, <span class="number">69</span>, <span class="number">51</span>, <span class="number">465</span>, <span class="number">291</span>, <span class="number">289</span>, <span class="number">417</span>, <span class="number">271</span>, <span class="number">374</span>, <span class="number">337</span>, <span class="number">46</span>, <span class="number">393</span>, <span class="number">19</span>, <span class="number">429</span>, <span class="number">91</span>], [<span class="number">407</span>, <span class="number">35</span>, <span class="number">337</span>, <span class="number">51</span>, <span class="number">41</span>, <span class="number">460</span>, <span class="number">222</span>, <span class="number">448</span>, <span class="number">499</span>, <span class="number">381</span>, <span class="number">59</span>, <span class="number">468</span>, <span class="number">440</span>, <span class="number">216</span>, <span class="number">86</span>, <span class="number">236</span>, <span class="number">91</span>, <span class="number">18</span>, <span class="number">123</span>, <span class="number">68</span>, <span class="number">145</span>], [<span class="number">384</span>, <span class="number">30</span>, <span class="number">454</span>, <span class="number">419</span>, <span class="number">275</span>, <span class="number">164</span>, <span class="number">72</span>, <span class="number">195</span>, <span class="number">489</span>, <span class="number">458</span>, <span class="number">419</span>, <span class="number">148</span>, <span class="number">269</span>, <span class="number">150</span>, <span class="number">358</span>, <span class="number">188</span>, <span class="number">109</span>, <span class="number">27</span>, <span class="number">42</span>, <span class="number">34</span>, <span class="number">123</span>], [<span class="number">500</span>, <span class="number">184</span>, <span class="number">195</span>, <span class="number">193</span>, <span class="number">68</span>, <span class="number">19</span>, <span class="number">329</span>, <span class="number">511</span>, <span class="number">280</span>, <span class="number">69</span>, <span class="number">113</span>, <span class="number">124</span>, <span class="number">102</span>, <span class="number">274</span>, <span class="number">43</span>, <span class="number">374</span>, <span class="number">408</span>, <span class="number">64</span>, <span class="number">314</span>, <span class="number">309</span>, <span class="number">473</span>], [<span class="number">72</span>, <span class="number">145</span>, <span class="number">242</span>, <span class="number">2</span>, <span class="number">367</span>, <span class="number">371</span>, <span class="number">143</span>, <span class="number">166</span>, <span class="number">325</span>, <span class="number">74</span>, <span class="number">414</span>, <span class="number">94</span>, <span class="number">269</span>, <span class="number">196</span>, <span class="number">124</span>, <span class="number">94</span>, <span class="number">14</span>, <span class="number">351</span>, <span class="number">111</span>, <span class="number">465</span>, <span class="number">503</span>], [<span class="number">70</span>, <span class="number">47</span>, <span class="number">439</span>, <span class="number">170</span>, <span class="number">306</span>, <span class="number">82</span>, <span class="number">233</span>, <span class="number">36</span>, <span class="number">346</span>, <span class="number">234</span>, <span class="number">157</span>, <span class="number">468</span>, <span class="number">83</span>, <span class="number">85</span>, <span class="number">424</span>, <span class="number">157</span>, <span class="number">258</span>, <span class="number">120</span>, <span class="number">270</span>, <span class="number">136</span>, <span class="number">286</span>], [<span class="number">442</span>, <span class="number">173</span>, <span class="number">254</span>, <span class="number">271</span>, <span class="number">420</span>, <span class="number">507</span>, <span class="number">297</span>, <span class="number">473</span>, <span class="number">296</span>, <span class="number">511</span>, <span class="number">98</span>, <span class="number">133</span>, <span class="number">37</span>, <span class="number">498</span>, <span class="number">468</span>, <span class="number">17</span>, <span class="number">260</span>, <span class="number">318</span>, <span class="number">168</span>, <span class="number">490</span>, <span class="number">124</span>], [<span class="number">50</span>, <span class="number">35</span>, <span class="number">252</span>, <span class="number">472</span>, <span class="number">406</span>, <span class="number">400</span>, <span class="number">439</span>, <span class="number">89</span>, <span class="number">309</span>, <span class="number">393</span>, <span class="number">332</span>, <span class="number">324</span>, <span class="number">260</span>, <span class="number">215</span>, <span class="number">8</span>, <span class="number">322</span>, <span class="number">357</span>, <span class="number">252</span>, <span class="number">124</span>, <span class="number">358</span>, <span class="number">457</span>], [<span class="number">93</span>, <span class="number">102</span>, <span class="number">478</span>, <span class="number">224</span>, <span class="number">428</span>, <span class="number">10</span>, <span class="number">238</span>, <span class="number">368</span>, <span class="number">113</span>, <span class="number">502</span>, <span class="number">148</span>, <span class="number">7</span>, <span class="number">395</span>, <span class="number">97</span>, <span class="number">73</span>, <span class="number">306</span>, <span class="number">40</span>, <span class="number">395</span>, <span class="number">9</span>, <span class="number">254</span>, <span class="number">319</span>], [<span class="number">282</span>, <span class="number">277</span>, <span class="number">295</span>, <span class="number">425</span>, <span class="number">59</span>, <span class="number">21</span>, <span class="number">136</span>, <span class="number">230</span>, <span class="number">207</span>, <span class="number">1</span>, <span class="number">29</span>, <span class="number">170</span>, <span class="number">14</span>, <span class="number">337</span>, <span class="number">371</span>, <span class="number">437</span>, <span class="number">359</span>, <span class="number">10</span>, <span class="number">100</span>, <span class="number">374</span>, <span class="number">24</span>], [<span class="number">3</span>, <span class="number">270</span>, <span class="number">289</span>, <span class="number">179</span>, <span class="number">434</span>, <span class="number">489</span>, <span class="number">470</span>, <span class="number">343</span>, <span class="number">478</span>, <span class="number">156</span>, <span class="number">177</span>, <span class="number">72</span>, <span class="number">13</span>, <span class="number">266</span>, <span class="number">475</span>, <span class="number">23</span>, <span class="number">148</span>, <span class="number">102</span>, <span class="number">210</span>, <span class="number">270</span>, <span class="number">323</span>], [<span class="number">464</span>, <span class="number">466</span>, <span class="number">277</span>, <span class="number">191</span>, <span class="number">426</span>, <span class="number">20</span>, <span class="number">266</span>, <span class="number">33</span>, <span class="number">41</span>, <span class="number">249</span>, <span class="number">452</span>, <span class="number">475</span>, <span class="number">265</span>, <span class="number">421</span>, <span class="number">282</span>, <span class="number">250</span>, <span class="number">233</span>, <span class="number">287</span>, <span class="number">495</span>, <span class="number">170</span>, <span class="number">300</span>], [<span class="number">379</span>, <span class="number">35</span>, <span class="number">137</span>, <span class="number">106</span>, <span class="number">155</span>, <span class="number">81</span>, <span class="number">154</span>, <span class="number">382</span>, <span class="number">30</span>, <span class="number">237</span>, <span class="number">294</span>, <span class="number">478</span>, <span class="number">321</span>, <span class="number">384</span>, <span class="number">48</span>, <span class="number">111</span>, <span class="number">150</span>, <span class="number">4</span>, <span class="number">454</span>, <span class="number">446</span>, <span class="number">28</span>], [<span class="number">57</span>, <span class="number">355</span>, <span class="number">94</span>, <span class="number">253</span>, <span class="number">297</span>, <span class="number">424</span>, <span class="number">415</span>, <span class="number">480</span>, <span class="number">68</span>, <span class="number">356</span>, <span class="number">415</span>, <span class="number">73</span>, <span class="number">41</span>, <span class="number">171</span>, <span class="number">491</span>, <span class="number">130</span>, <span class="number">92</span>, <span class="number">180</span>, <span class="number">506</span>, <span class="number">326</span>, <span class="number">463</span>], [<span class="number">279</span>, <span class="number">43</span>, <span class="number">202</span>, <span class="number">35</span>, <span class="number">397</span>, <span class="number">257</span>, <span class="number">120</span>, <span class="number">11</span>, <span class="number">231</span>, <span class="number">369</span>, <span class="number">221</span>, <span class="number">332</span>, <span class="number">47</span>, <span class="number">236</span>, <span class="number">58</span>, <span class="number">278</span>, <span class="number">75</span>, <span class="number">117</span>, <span class="number">33</span>, <span class="number">130</span>, <span class="number">358</span>], [<span class="number">142</span>, <span class="number">335</span>, <span class="number">339</span>, <span class="number">112</span>, <span class="number">38</span>, <span class="number">82</span>, <span class="number">426</span>, <span class="number">211</span>, <span class="number">174</span>, <span class="number">389</span>, <span class="number">137</span>, <span class="number">96</span>, <span class="number">431</span>, <span class="number">113</span>, <span class="number">112</span>, <span class="number">500</span>, <span class="number">145</span>, <span class="number">44</span>, <span class="number">313</span>, <span class="number">96</span>, <span class="number">187</span>], [<span class="number">246</span>, <span class="number">211</span>, <span class="number">400</span>, <span class="number">415</span>, <span class="number">294</span>, <span class="number">234</span>, <span class="number">367</span>, <span class="number">46</span>, <span class="number">371</span>, <span class="number">479</span>, <span class="number">412</span>, <span class="number">197</span>, <span class="number">204</span>, <span class="number">498</span>, <span class="number">18</span>, <span class="number">140</span>, <span class="number">67</span>, <span class="number">237</span>, <span class="number">510</span>, <span class="number">457</span>, <span class="number">298</span>], [<span class="number">258</span>, <span class="number">3</span>, <span class="number">136</span>, <span class="number">284</span>, <span class="number">149</span>, <span class="number">161</span>, <span class="number">456</span>, <span class="number">122</span>, <span class="number">114</span>, <span class="number">383</span>, <span class="number">251</span>, <span class="number">240</span>, <span class="number">453</span>, <span class="number">227</span>, <span class="number">330</span>, <span class="number">33</span>, <span class="number">241</span>, <span class="number">160</span>, <span class="number">306</span>, <span class="number">254</span>, <span class="number">409</span>], [<span class="number">391</span>, <span class="number">115</span>, <span class="number">92</span>, <span class="number">102</span>, <span class="number">359</span>, <span class="number">182</span>, <span class="number">489</span>, <span class="number">313</span>, <span class="number">204</span>, <span class="number">275</span>, <span class="number">206</span>, <span class="number">447</span>, <span class="number">436</span>, <span class="number">286</span>, <span class="number">229</span>, <span class="number">377</span>, <span class="number">374</span>, <span class="number">162</span>, <span class="number">22</span>, <span class="number">384</span>, <span class="number">40</span>], [<span class="number">427</span>, <span class="number">491</span>, <span class="number">362</span>, <span class="number">240</span>, <span class="number">358</span>, <span class="number">296</span>, <span class="number">154</span>, <span class="number">178</span>, <span class="number">278</span>, <span class="number">284</span>, <span class="number">324</span>, <span class="number">422</span>, <span class="number">52</span>, <span class="number">295</span>, <span class="number">490</span>, <span class="number">56</span>, <span class="number">39</span>, <span class="number">378</span>, <span class="number">174</span>, <span class="number">202</span>, <span class="number">496</span>], [<span class="number">29</span>, <span class="number">454</span>, <span class="number">436</span>, <span class="number">6</span>, <span class="number">287</span>, <span class="number">82</span>, <span class="number">154</span>, <span class="number">474</span>, <span class="number">92</span>, <span class="number">272</span>, <span class="number">400</span>, <span class="number">238</span>, <span class="number">352</span>, <span class="number">140</span>, <span class="number">386</span>, <span class="number">504</span>, <span class="number">19</span>, <span class="number">32</span>, <span class="number">334</span>, <span class="number">30</span>, <span class="number">450</span>], [<span class="number">469</span>, <span class="number">123</span>, <span class="number">353</span>, <span class="number">422</span>, <span class="number">175</span>, <span class="number">260</span>, <span class="number">294</span>, <span class="number">18</span>, <span class="number">268</span>, <span class="number">479</span>, <span class="number">60</span>, <span class="number">114</span>, <span class="number">456</span>, <span class="number">55</span>, <span class="number">403</span>, <span class="number">446</span>, <span class="number">166</span>, <span class="number">259</span>, <span class="number">294</span>, <span class="number">215</span>, <span class="number">48</span>], [<span class="number">404</span>, <span class="number">187</span>, <span class="number">426</span>, <span class="number">362</span>, <span class="number">296</span>, <span class="number">239</span>, <span class="number">226</span>, <span class="number">416</span>, <span class="number">306</span>, <span class="number">336</span>, <span class="number">1</span>, <span class="number">448</span>, <span class="number">47</span>, <span class="number">403</span>, <span class="number">367</span>, <span class="number">357</span>, <span class="number">501</span>, <span class="number">425</span>, <span class="number">310</span>, <span class="number">41</span>, <span class="number">303</span>], [<span class="number">339</span>, <span class="number">115</span>, <span class="number">478</span>, <span class="number">416</span>, <span class="number">10</span>, <span class="number">90</span>, <span class="number">188</span>, <span class="number">229</span>, <span class="number">217</span>, <span class="number">441</span>, <span class="number">288</span>, <span class="number">152</span>, <span class="number">394</span>, <span class="number">219</span>, <span class="number">422</span>, <span class="number">376</span>, <span class="number">325</span>, <span class="number">375</span>, <span class="number">6</span>, <span class="number">454</span>, <span class="number">238</span>], [<span class="number">226</span>, <span class="number">226</span>, <span class="number">149</span>, <span class="number">107</span>, <span class="number">418</span>, <span class="number">419</span>, <span class="number">209</span>, <span class="number">108</span>, <span class="number">87</span>, <span class="number">127</span>, <span class="number">202</span>, <span class="number">320</span>, <span class="number">179</span>, <span class="number">234</span>, <span class="number">87</span>, <span class="number">335</span>, <span class="number">195</span>, <span class="number">5</span>, <span class="number">273</span>, <span class="number">142</span>, <span class="number">115</span>], [<span class="number">464</span>, <span class="number">177</span>, <span class="number">77</span>, <span class="number">101</span>, <span class="number">76</span>, <span class="number">19</span>, <span class="number">73</span>, <span class="number">397</span>, <span class="number">296</span>, <span class="number">34</span>, <span class="number">360</span>, <span class="number">107</span>, <span class="number">491</span>, <span class="number">460</span>, <span class="number">510</span>, <span class="number">342</span>, <span class="number">198</span>, <span class="number">118</span>, <span class="number">105</span>, <span class="number">337</span>, <span class="number">239</span>], [<span class="number">464</span>, <span class="number">25</span>, <span class="number">191</span>, <span class="number">113</span>, <span class="number">455</span>, <span class="number">129</span>, <span class="number">247</span>, <span class="number">488</span>, <span class="number">303</span>, <span class="number">27</span>, <span class="number">242</span>, <span class="number">423</span>, <span class="number">336</span>, <span class="number">125</span>, <span class="number">283</span>, <span class="number">332</span>, <span class="number">244</span>, <span class="number">372</span>, <span class="number">175</span>, <span class="number">276</span>, <span class="number">49</span>], [<span class="number">211</span>, <span class="number">367</span>, <span class="number">406</span>, <span class="number">314</span>, <span class="number">177</span>, <span class="number">496</span>, <span class="number">320</span>, <span class="number">385</span>, <span class="number">193</span>, <span class="number">51</span>, <span class="number">423</span>, <span class="number">80</span>, <span class="number">258</span>, <span class="number">44</span>, <span class="number">154</span>, <span class="number">362</span>, <span class="number">215</span>, <span class="number">296</span>, <span class="number">260</span>, <span class="number">424</span>, <span class="number">160</span>], [<span class="number">384</span>, <span class="number">161</span>, <span class="number">92</span>, <span class="number">402</span>, <span class="number">414</span>, <span class="number">443</span>, <span class="number">129</span>, <span class="number">279</span>, <span class="number">272</span>, <span class="number">224</span>, <span class="number">294</span>, <span class="number">319</span>, <span class="number">75</span>, <span class="number">169</span>, <span class="number">242</span>, <span class="number">85</span>, <span class="number">315</span>, <span class="number">402</span>, <span class="number">4</span>, <span class="number">268</span>, <span class="number">88</span>]]</span><br><span class="line">cipher2 = [<span class="number">884</span>, <span class="number">1584</span>, <span class="number">681</span>, <span class="number">1713</span>, <span class="number">1916</span>, <span class="number">609</span>, <span class="number">1840</span>, <span class="number">177</span>, <span class="number">1723</span>, <span class="number">1049</span>, <span class="number">254</span>, <span class="number">864</span>, <span class="number">1671</span>, <span class="number">121</span>, <span class="number">2021</span>, <span class="number">1353</span>, <span class="number">1290</span>, <span class="number">1891</span>, <span class="number">556</span>, <span class="number">1786</span>, <span class="number">1553</span>, <span class="number">1548</span>, <span class="number">727</span>, <span class="number">1967</span>, <span class="number">1800</span>, <span class="number">422</span>, <span class="number">1559</span>, <span class="number">1290</span>, <span class="number">642</span>, <span class="number">1406</span>, <span class="number">441</span>, <span class="number">1928</span>, <span class="number">395</span>, <span class="number">279</span>, <span class="number">1125</span>, <span class="number">1273</span>, <span class="number">99</span>, <span class="number">1131</span>, <span class="number">395</span>, <span class="number">76</span>, <span class="number">733</span>, <span class="number">416</span>, <span class="number">924</span>, <span class="number">571</span>, <span class="number">506</span>, <span class="number">822</span>, <span class="number">877</span>, <span class="number">887</span>, <span class="number">860</span>, <span class="number">1755</span>, <span class="number">1385</span>, <span class="number">1861</span>, <span class="number">1754</span>, <span class="number">1851</span>, <span class="number">1046</span>, <span class="number">1724</span>, <span class="number">1866</span>, <span class="number">1427</span>, <span class="number">378</span>, <span class="number">351</span>, <span class="number">146</span>, <span class="number">1367</span>, <span class="number">756</span>, <span class="number">505</span>]</span><br><span class="line"></span><br><span class="line">m = <span class="number">64</span></span><br><span class="line">n = <span class="number">21</span></span><br><span class="line">q = prime</span><br><span class="line"></span><br><span class="line">A_values = key</span><br><span class="line">b_values = cipher2</span><br><span class="line"></span><br><span class="line">A = matrix(ZZ, m + n, m)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(m):</span><br><span class="line">    A[i, i] = q</span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(m):</span><br><span class="line">    <span class="keyword">for</span> y <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">        A[m + y, x] = A_values[x][y]</span><br><span class="line">lattice = IntegerLattice(A, lll_reduce=<span class="literal">True</span>)</span><br><span class="line"><span class="comment"># print(&quot;LLL done&quot;)</span></span><br><span class="line">gram = lattice.reduced_basis.gram_schmidt()[<span class="number">0</span>]</span><br><span class="line">target = vector(ZZ, b_values)</span><br><span class="line">res = Babai_closest_vector(lattice.reduced_basis, gram, target)</span><br><span class="line"><span class="comment"># print(&quot;Closest Vector: &#123;&#125;&quot;.format(res))</span></span><br><span class="line"></span><br><span class="line">R = IntegerModRing(q)</span><br><span class="line">M = Matrix(R, A_values)</span><br><span class="line">ingredients = M.solve_right(res)</span><br><span class="line"></span><br><span class="line"><span class="comment"># print(&quot;Ingredients: &#123;&#125;&quot;.format(ingredients))</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>(ingredients))</span><br></pre></td></tr></table></figure><h4 id="0x00-2022赣网杯-lattice-130"><a class="markdownIt-Anchor" href="#0x00-2022赣网杯-lattice-130"></a> 0x00 2022赣网杯 lattice 1.30</h4><p>附件</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> FLAG</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gen</span>(<span class="params">E</span>):</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        K=getPrime(<span class="number">400</span>)</span><br><span class="line">        g,a,b=gmpy2.gcdext(E,K)</span><br><span class="line">        <span class="keyword">if</span> a&lt;<span class="number">0</span>:</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        t=-b+E+<span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> isPrime(t):</span><br><span class="line">            <span class="keyword">return</span> t</span><br><span class="line"></span><br><span class="line">E=getPrime(<span class="number">1024</span>)</span><br><span class="line">p,q=gen(E),gen(E)</span><br><span class="line">n=p*q</span><br><span class="line">e=<span class="number">0x10001</span></span><br><span class="line">m=bytes_to_long(FLAG)</span><br><span class="line">c=<span class="built_in">pow</span>(m,e,n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;E=&#x27;</span>,E)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;n=&#x27;</span>,n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;c=&#x27;</span>,c)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># E= 145106294105031284362950025863529581747975861699820575710872716519879803001392108419450056017622997630126276746554771656122532972639414248565300835010881208733690317975825283717056444554763316279849402612931689513790553913814829224657863376765661796202264396345600888403461230631203348607241016471422573987581</span></span><br><span class="line"><span class="comment"># n= 44146216754179716722914989774179545609003622919133954513612183365882143185648106448428976865616794364028711539848793072635268083809473736628189721636749099362357309849620541871571763282347330516151877113940331967499040686592378429548637013317457534594446645795078740141793093671629367727580553491215650337659527664705853572883730490883606327292351189552684783556726745519069083076011853815506574017326892680398272431716287020908845624185560350752642219469508595239978684428357590946555321280480160960814914981382127666519241796268901712746927364456562374629908387801426574825886691891613827829901620362221716562729181</span></span><br><span class="line"><span class="comment"># c= 42849954097468071726084946569343866748913580243693005484016477540655859876131867406160328063659045626546696925974783645320154966183202087150055162449812095144585221589345118079815257465944358288811363045125860701872706943518864751664960009957542024032708923424342364685385744625812611804391908032187252468394391715156637995783612091781280489452909027099099798074134765334858069523070373919122908726611177406605539137633787078228935029969970499482879713485023528914042281734061900906000317898016866589414229957899882390267865157996173644571590488588106926533461407231265146431839909395332178222814838553730197295527269</span></span><br></pre></td></tr></table></figure><p>给了生成公钥的函数，其中变量的比特大小需要特别注意。首先是用扩展欧几里得生成了<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>a</mi></mrow><annotation encoding="application/x-tex">a</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord mathdefault">a</span></span></span></span>和<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>b</mi></mrow><annotation encoding="application/x-tex">b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.69444em;vertical-align:0"></span><span class="mord mathdefault">b</span></span></span></span>，等式为<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>a</mi><mi>E</mi><mo>+</mo><mi>b</mi><mi>K</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">aE+bK=1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.76666em;vertical-align:-.08333em"></span><span class="mord mathdefault">a</span><span class="mord mathdefault" style="margin-right:.05764em">E</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.69444em;vertical-align:0"></span><span class="mord mathdefault">b</span><span class="mord mathdefault" style="margin-right:.07153em">K</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">1</span></span></span></span>。给了两组，其中E是固定的，然后再分别得到p和q，总结已知量如下</p><p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>a</mi><mn>1</mn></msub><mi>E</mi><mo>+</mo><msub><mi>b</mi><mn>1</mn></msub><msub><mi>K</mi><mn>1</mn></msub><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">{a_1}E+{b_1}{K_1}=1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.83333em;vertical-align:-.15em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span><span class="mord mathdefault" style="margin-right:.05764em">E</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.84444em;vertical-align:-.15em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.07153em">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">1</span></span></span></span> <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>p</mi><mo>=</mo><mo>−</mo><msub><mi>b</mi><mn>1</mn></msub><mo>+</mo><mi>E</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">p=-{b_1}+E+1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.625em;vertical-align:-.19444em"></span><span class="mord mathdefault">p</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.84444em;vertical-align:-.15em"></span><span class="mord">−</span><span class="mord"><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.76666em;vertical-align:-.08333em"></span><span class="mord mathdefault" style="margin-right:.05764em">E</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">1</span></span></span></span></p><p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>a</mi><mn>2</mn></msub><mi>E</mi><mo>+</mo><msub><mi>b</mi><mn>2</mn></msub><msub><mi>K</mi><mn>2</mn></msub><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">{a_2}E+{b_2}{K_2}=1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.83333em;vertical-align:-.15em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span><span class="mord mathdefault" style="margin-right:.05764em">E</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.84444em;vertical-align:-.15em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.07153em">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">1</span></span></span></span> <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>q</mi><mo>=</mo><mo>−</mo><msub><mi>b</mi><mn>2</mn></msub><mo>+</mo><mi>E</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">q=-{b_2}+E+1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.625em;vertical-align:-.19444em"></span><span class="mord mathdefault" style="margin-right:.03588em">q</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.84444em;vertical-align:-.15em"></span><span class="mord">−</span><span class="mord"><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.76666em;vertical-align:-.08333em"></span><span class="mord mathdefault" style="margin-right:.05764em">E</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">1</span></span></span></span></p><p>其中E已知，要求得到b。注意各个量的大小分别为</p><table><thead><tr><th style="text-align:center">a</th><th style="text-align:center">E</th><th style="text-align:center">b</th><th style="text-align:center">k</th></tr></thead><tbody><tr><td style="text-align:center">400</td><td style="text-align:center">1024</td><td style="text-align:center">1024</td><td style="text-align:center">400</td></tr></tbody></table><p>参考<span class="exturl" data-url="aHR0cHM6Ly93d3cuY25ibG9ncy5jb20vWmltYUJsdWUvYXJ0aWNsZXMvMTY5NzQ0MjYuaHRtbA==">zima👴的blog</span>，化简相当麻烦</p><p>首先令<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>d</mi><mo>=</mo><mi>a</mi><mo>+</mo><mi>k</mi></mrow><annotation encoding="application/x-tex">d=a+k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.69444em;vertical-align:0"></span><span class="mord mathdefault">d</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.66666em;vertical-align:-.08333em"></span><span class="mord mathdefault">a</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.69444em;vertical-align:0"></span><span class="mord mathdefault" style="margin-right:.03148em">k</span></span></span></span>，原式变为<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>E</mi><mi>d</mi><mo>=</mo><mi>k</mi><mo stretchy="false">(</mo><mi>p</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">Ed=k(p-1)+1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.69444em;vertical-align:0"></span><span class="mord mathdefault" style="margin-right:.05764em">E</span><span class="mord mathdefault">d</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="mopen">(</span><span class="mord mathdefault">p</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">1</span></span></span></span></p><p>代入相乘得到<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>E</mi><mn>2</mn></msup><msub><mi>d</mi><mn>1</mn></msub><msub><mi>d</mi><mn>2</mn></msub><mo>=</mo><msub><mi>k</mi><mn>1</mn></msub><mo stretchy="false">(</mo><mi>p</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mo>+</mo><msub><mi>k</mi><mn>2</mn></msub><mo stretchy="false">(</mo><mi>q</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mo>+</mo><msub><mi>k</mi><mn>1</mn></msub><msub><mi>k</mi><mn>2</mn></msub><mo stretchy="false">(</mo><mi>p</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mo stretchy="false">(</mo><mi>q</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">E^2{d_1}{d_2}={k_1}(p-1)+{k_2}(q-1)+{k_1}{k_2}(p-1)(q-1)+1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.964108em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.05764em">E</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mord"><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span><span class="mord"><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">p</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:.03588em">q</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">p</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord">1</span><span class="mclose">)</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:.03588em">q</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">1</span></span></span></span></p><p>不做代入化简得到<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>E</mi><mn>2</mn></msup><msub><mi>d</mi><mn>1</mn></msub><msub><mi>d</mi><mn>2</mn></msub><mo>−</mo><msub><mi>k</mi><mn>1</mn></msub><msub><mi>k</mi><mn>2</mn></msub><mo stretchy="false">(</mo><mi>n</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mo>=</mo><msub><mi>k</mi><mn>1</mn></msub><msub><mi>k</mi><mn>2</mn></msub><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>p</mi><mo stretchy="false">)</mo><mo>+</mo><msub><mi>k</mi><mn>1</mn></msub><msub><mi>k</mi><mn>2</mn></msub><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>q</mi><mo stretchy="false">)</mo><mo>+</mo><msub><mi>k</mi><mn>1</mn></msub><mo stretchy="false">(</mo><mi>p</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mo>+</mo><msub><mi>k</mi><mn>2</mn></msub><mo stretchy="false">(</mo><mi>q</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">E^2{d_1}{d_2}-{k_1}{k_2}(n-1)={k_1}{k_2}(1-p)+{k_1}{k_2}(1-q)+{k_1}(p-1)+{k_2}(q-1)+1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.964108em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.05764em">E</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mord"><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span><span class="mord"><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathdefault">p</span><span class="mclose">)</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathdefault" style="margin-right:.03588em">q</span><span class="mclose">)</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">p</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:.03588em">q</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">1</span></span></span></span></p><p>代入<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>E</mi><mi>d</mi><mo>=</mo><mi>k</mi><mo stretchy="false">(</mo><mi>p</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">Ed=k(p-1)+1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.69444em;vertical-align:0"></span><span class="mord mathdefault" style="margin-right:.05764em">E</span><span class="mord mathdefault">d</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="mopen">(</span><span class="mord mathdefault">p</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">1</span></span></span></span>得到</p><p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>E</mi><mn>2</mn></msup><msub><mi>d</mi><mn>1</mn></msub><msub><mi>d</mi><mn>2</mn></msub><mo>−</mo><msub><mi>k</mi><mn>1</mn></msub><msub><mi>k</mi><mn>2</mn></msub><mo stretchy="false">(</mo><mi>n</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mo>=</mo><mo>−</mo><msub><mi>k</mi><mn>2</mn></msub><mo stretchy="false">(</mo><mi>E</mi><msub><mi>d</mi><mn>1</mn></msub><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mo>−</mo><msub><mi>k</mi><mn>1</mn></msub><mo stretchy="false">(</mo><mi>E</mi><msub><mi>d</mi><mn>2</mn></msub><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mo>+</mo><mi>E</mi><msub><mi>d</mi><mn>1</mn></msub><mo>−</mo><mn>1</mn><mo>+</mo><mi>E</mi><msub><mi>d</mi><mn>2</mn></msub><mo>−</mo><mn>1</mn><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">E^2{d_1}{d_2}-{k_1}{k_2}(n-1)=-{k_2}(E{d_1}-1)-{k_1}(E{d_2}-1)+E{d_1}-1+E{d_2}-1+1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.964108em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.05764em">E</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mord"><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span><span class="mord"><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord">−</span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:.05764em">E</span><span class="mord"><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:.05764em">E</span><span class="mord"><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.84444em;vertical-align:-.15em"></span><span class="mord mathdefault" style="margin-right:.05764em">E</span><span class="mord"><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.72777em;vertical-align:-.08333em"></span><span class="mord">1</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.84444em;vertical-align:-.15em"></span><span class="mord mathdefault" style="margin-right:.05764em">E</span><span class="mord"><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.72777em;vertical-align:-.08333em"></span><span class="mord">1</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">1</span></span></span></span></p><p>最后得到式子</p><p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>E</mi><mn>2</mn></msup><msub><mi>d</mi><mn>1</mn></msub><msub><mi>d</mi><mn>2</mn></msub><mo>−</mo><msub><mi>k</mi><mn>1</mn></msub><msub><mi>k</mi><mn>2</mn></msub><mo stretchy="false">(</mo><mi>n</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mo>=</mo><mi>E</mi><mo stretchy="false">(</mo><msub><mi>d</mi><mn>1</mn></msub><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><msub><mi>k</mi><mn>2</mn></msub><mo stretchy="false">)</mo><mo>+</mo><msub><mi>d</mi><mn>2</mn></msub><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><msub><mi>k</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo>+</mo><msub><mi>k</mi><mn>1</mn></msub><mo>+</mo><msub><mi>k</mi><mn>2</mn></msub><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">E^2{d_1}{d_2}-{k_1}{k_2}(n-1)=E({d_1}(1-{k_2})+{d_2}(1-{k_1}))+{k_1}+{k_2}-1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.964108em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.05764em">E</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mord"><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span><span class="mord"><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathdefault" style="margin-right:.05764em">E</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mclose">)</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.84444em;vertical-align:-.15em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.84444em;vertical-align:-.15em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">1</span></span></span></span></p><p>之后可以构造格子</p><p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mo fence="true">[</mo><mtable rowspacing="0.15999999999999992em" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>d</mi><mn>1</mn></msub><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><msub><mi>k</mi><mn>2</mn></msub><mo stretchy="false">)</mo><mo>+</mo><msub><mi>d</mi><mn>2</mn></msub><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><msub><mi>k</mi><mn>1</mn></msub><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>k</mi><mn>1</mn></msub><msub><mi>k</mi><mn>2</mn></msub></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>d</mi><mn>1</mn></msub><msub><mi>d</mi><mn>2</mn></msub></mrow></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mrow><mo fence="true">[</mo><mtable rowspacing="0.15999999999999992em" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mi>E</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msup><mi>E</mi><mn>2</mn></msup></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mrow><mo fence="true">[</mo><mtable rowspacing="0.15999999999999992em" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo stretchy="false">(</mo><msub><mi>k</mi><mn>1</mn></msub><mo>+</mo><msub><mi>k</mi><mn>2</mn></msub><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>d</mi><mn>1</mn></msub><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><msub><mi>k</mi><mn>2</mn></msub><mo stretchy="false">)</mo><mo>+</mo><msub><mi>d</mi><mn>2</mn></msub><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><msub><mi>k</mi><mn>1</mn></msub><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>k</mi><mn>1</mn></msub><msub><mi>k</mi><mn>2</mn></msub></mrow></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex">\begin{bmatrix} {d_1}(1-{k_2})+{d_2}(1-{k_1})&amp;{k_1}{k_2}&amp;{d_1}{d_2} \end{bmatrix} \begin{bmatrix} E&amp;1&amp;0\\ n-1&amp;0&amp;1\\ {E^2}&amp;0&amp;0 \end{bmatrix} \begin{bmatrix} ({k_1}+{k_2}-1)&amp;{d_1}(1-{k_2})+{d_2}(1-{k_1})&amp;{k_1}{k_2} \end{bmatrix}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:3.60004em;vertical-align:-1.55002em"></span><span class="minner"><span class="mopen delimcenter" style="top:0"><span class="delimsizing size1">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.8500000000000001em"><span style="top:-3.01em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.35000000000000003em"><span></span></span></span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.8500000000000001em"><span style="top:-3.01em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.35000000000000003em"><span></span></span></span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.8500000000000001em"><span style="top:-3.01em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span><span class="mord"><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.35000000000000003em"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0"><span class="delimsizing size1">]</span></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05002em"><span style="top:-2.2500000000000004em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎣</span></span></span><span style="top:-4.05002em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎡</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.55002em"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em"><span style="top:-4.21em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.05764em">E</span></span></span><span style="top:-3.0099999999999993em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord">1</span></span></span><span style="top:-1.8099999999999994em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.05764em">E</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.5500000000000007em"><span></span></span></span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em"><span style="top:-4.21em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">1</span></span></span><span style="top:-3.0099999999999993em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-1.8099999999999994em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.5500000000000007em"><span></span></span></span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em"><span style="top:-4.21em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-3.0099999999999993em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">1</span></span></span><span style="top:-1.8099999999999994em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.5500000000000007em"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05002em"><span style="top:-2.2500000000000004em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎦</span></span></span><span style="top:-4.05002em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎤</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.55002em"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="minner"><span class="mopen delimcenter" style="top:0"><span class="delimsizing size1">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.8500000000000001em"><span style="top:-3.01em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.35000000000000003em"><span></span></span></span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.8500000000000001em"><span style="top:-3.01em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.35000000000000003em"><span></span></span></span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.8500000000000001em"><span style="top:-3.01em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.35000000000000003em"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0"><span class="delimsizing size1">]</span></span></span></span></span></span></span></p><p>观察我们预期规约出的向量，大小分别为</p><table><thead><tr><th style="text-align:center"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>k</mi><mn>1</mn></msub><mo>+</mo><msub><mi>k</mi><mn>2</mn></msub><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">{k_1}+{k_2}-1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.84444em;vertical-align:-.15em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.84444em;vertical-align:-.15em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">1</span></span></span></span></th><th style="text-align:center"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>d</mi><mn>1</mn></msub><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><msub><mi>k</mi><mn>2</mn></msub><mo stretchy="false">)</mo><mo>+</mo><msub><mi>d</mi><mn>2</mn></msub><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><msub><mi>k</mi><mn>1</mn></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">{d_1}(1-{k_2})+{d_2}(1-{k_1})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></th><th style="text-align:center"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>k</mi><mn>1</mn></msub><msub><mi>k</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">{k_1}{k_2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.84444em;vertical-align:-.15em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span></span></th></tr></thead><tbody><tr><td style="text-align:center">400</td><td style="text-align:center">800</td><td style="text-align:center">800</td></tr></tbody></table><p>显然这不应该是格中最短向量，我们需要适当增大格中最短向量的界即可，格中第一列中每一个数乘上<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mn>2</mn><mn>400</mn></msup></mrow><annotation encoding="application/x-tex">2^{400}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8141079999999999em;vertical-align:0"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">4</span><span class="mord mtight">0</span><span class="mord mtight">0</span></span></span></span></span></span></span></span></span></span></span></span>即可(不唯一，只要能规约出向量即可)。之后可以利用已知的<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>k</mi><mn>1</mn></msub><mo>+</mo><msub><mi>k</mi><mn>2</mn></msub><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">{k_1}+{k_2}-1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.84444em;vertical-align:-.15em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.84444em;vertical-align:-.15em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">1</span></span></span></span>和<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>k</mi><mn>1</mn></msub><msub><mi>k</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">{k_1}{k_2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.84444em;vertical-align:-.15em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span></span>求得<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.69444em;vertical-align:0"></span><span class="mord mathdefault" style="margin-right:.03148em">k</span></span></span></span>，后续也就分别得到了n的分解，完整exp为</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#sage</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> sympy</span><br><span class="line">E= <span class="number">145106294105031284362950025863529581747975861699820575710872716519879803001392108419450056017622997630126276746554771656122532972639414248565300835010881208733690317975825283717056444554763316279849402612931689513790553913814829224657863376765661796202264396345600888403461230631203348607241016471422573987581</span></span><br><span class="line">n= <span class="number">44146216754179716722914989774179545609003622919133954513612183365882143185648106448428976865616794364028711539848793072635268083809473736628189721636749099362357309849620541871571763282347330516151877113940331967499040686592378429548637013317457534594446645795078740141793093671629367727580553491215650337659527664705853572883730490883606327292351189552684783556726745519069083076011853815506574017326892680398272431716287020908845624185560350752642219469508595239978684428357590946555321280480160960814914981382127666519241796268901712746927364456562374629908387801426574825886691891613827829901620362221716562729181</span></span><br><span class="line">c= <span class="number">42849954097468071726084946569343866748913580243693005484016477540655859876131867406160328063659045626546696925974783645320154966183202087150055162449812095144585221589345118079815257465944358288811363045125860701872706943518864751664960009957542024032708923424342364685385744625812611804391908032187252468394391715156637995783612091781280489452909027099099798074134765334858069523070373919122908726611177406605539137633787078228935029969970499482879713485023528914042281734061900906000317898016866589414229957899882390267865157996173644571590488588106926533461407231265146431839909395332178222814838553730197295527269</span></span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line">pad = <span class="number">2</span> ** <span class="number">400</span></span><br><span class="line">mat = [</span><br><span class="line">    [pad * E,<span class="number">1</span>,<span class="number">0</span>],</span><br><span class="line">    [pad * (n - <span class="number">1</span>),<span class="number">0</span>,<span class="number">1</span>],</span><br><span class="line">    [pad * (E ** <span class="number">2</span>),<span class="number">0</span>,<span class="number">0</span>]</span><br><span class="line">]</span><br><span class="line">mat = matrix(ZZ,mat)</span><br><span class="line">ans = <span class="built_in">list</span>(mat.LLL()[<span class="number">0</span>])</span><br><span class="line">k1k2 = <span class="built_in">abs</span>(ans[-<span class="number">1</span>])</span><br><span class="line">k1_k2 = <span class="built_in">abs</span>((ans[<span class="number">0</span>] // pad) + <span class="number">1</span>)</span><br><span class="line"><span class="built_in">print</span>(k1k2)</span><br><span class="line"><span class="built_in">print</span>(k1_k2)</span><br><span class="line"><span class="comment">#懒人专用</span></span><br><span class="line">k1,k2 = sympy.Symbol(<span class="string">&#x27;k1&#x27;</span>),sympy.Symbol(<span class="string">&#x27;k2&#x27;</span>)</span><br><span class="line">f1 = k1 * k2 - k1k2</span><br><span class="line">f2 = k1 + k2 - k1_k2</span><br><span class="line">root = sympy.solve([f1,f2],[k1,k2])</span><br><span class="line"><span class="built_in">print</span>(root)</span><br><span class="line">k1,k2 = <span class="built_in">list</span>(<span class="built_in">map</span>(<span class="built_in">int</span>,root[<span class="number">0</span>]))</span><br><span class="line"><span class="built_in">print</span>(k1)</span><br><span class="line"><span class="built_in">print</span>(k2)</span><br><span class="line">_,a1,b1 = gmpy2.gcdext(E,k1)</span><br><span class="line">_,a2,b2 = gmpy2.gcdext(E,k2)</span><br><span class="line">p = -b1 + E + <span class="number">1</span></span><br><span class="line">q = -b2 + E + <span class="number">1</span></span><br><span class="line"><span class="built_in">print</span>(n == p * q)</span><br><span class="line">phi = (p - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line">d = inverse_mod(e,phi)</span><br><span class="line">m = power_mod(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(m)))</span><br></pre></td></tr></table></figure><div class="tags"><a href="/tags/%E5%AD%A6%E4%B9%A0/" rel="tag"><i class="ic i-tag"></i> 学习</a> <a href="/tags/crypto/" rel="tag"><i class="ic i-tag"></i> crypto</a></div></div><footer><div class="meta"><span class="item"><span class="icon"><i class="ic i-calendar-check"></i> </span><span class="text">Edited on</span> <time title="Modified: 2023-09-14 16:56:04" itemprop="dateModified" datetime="2023-09-14T16:56:04+08:00">2023-09-14</time> </span><span id="2299/01/30/crypto的挨打之路(退役版)/" class="item leancloud_visitors" data-flag-title="crypto的挨打之路（退役版）" title="Views"><span class="icon"><i class="ic i-eye"></i> </span><span class="text">Views</span> <span class="leancloud-visitors-count"></span> <span class="text">times</span></span></div><div class="reward"><button><i class="ic i-heartbeat"></i> Donate</button><p>Give me a cup of [coffee]~(￣▽￣)~*</p><div id="qr"><div><img data-src="/images/Alipay.jpg" alt="tsuppari Alipay"><p>Alipay</p></div><div><img data-src="/images/WeChatpay.jpg" alt="tsuppari PayPal"><p>PayPal</p></div></div></div><div id="copyright"><ul><li class="author"><strong>Post author: </strong>tsuppari <i class="ic i-at"><em>@</em></i>蒟蒻的入土史</li><li class="link"><strong>Post link: </strong><a href="https://tsuppari404.github.io/2299/01/30/crypto%E7%9A%84%E6%8C%A8%E6%89%93%E4%B9%8B%E8%B7%AF(%E9%80%80%E5%BD%B9%E7%89%88)/" title="crypto的挨打之路（退役版）">https://tsuppari404.github.io/2299/01/30/crypto的挨打之路(退役版)/</a></li><li class="license"><strong>Copyright Notice: </strong>All articles in this blog are licensed under <span class="exturl" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9kZWVkLnpoLUNOLnltbA=="><i class="ic i-creative-commons"><em>(CC)</em></i>BY-NC-SA</span> unless stating additionally.</li></ul></div></footer></article></div><div class="post-nav"><div class="item left"><a href="/2199/04/13/crypto%E7%9A%84%E6%8C%A8%E6%89%93%E4%B9%8B%E8%B7%AF(%E4%BA%8C)/" itemprop="url" rel="prev" data-background-image="https:&#x2F;&#x2F;i.loli.net&#x2F;2020&#x2F;10&#x2F;30&#x2F;rjdhcSgEN8COBPA.jpg" title="crypto的挨打之路（二）"><span class="type">Previous Post</span> <span class="category"><i class="ic i-flag"></i></span><h3>crypto的挨打之路（二）</h3></a></div><div class="item right"></div></div><div class="wrap" id="comments"></div></div><div id="sidebar"><div class="inner"><div class="panels"><div class="inner"><div class="contents panel pjax" data-title="Contents"><ol class="toc"><li class="toc-item toc-level-4"><a class="toc-link" href="#0x0b-from-rec-matrix_e-913"><span class="toc-number">1.</span> <span class="toc-text">0x0B from rec matrix_e 9.13</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#0x0a-2023bluehat-dhrsa-827"><span class="toc-number">2.</span> <span class="toc-text">0x0A 2023bluehat DHRSA 8.27</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#0x09-2023hws-random-715"><span class="toc-number">3.</span> <span class="toc-text">0x09 2023HWS Random 7.15</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#0x08-2023ichunqiu-cisticola-522"><span class="toc-number">4.</span> <span class="toc-text">0x08 2023ichunqiu cisticola 5.22</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#0x07-2023ichunqiu-ecdsa-522"><span class="toc-number">5.</span> <span class="toc-text">0x07 2023ichunqiu ecdsa 5.22</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#0x06-2023minil-curvesignin-511"><span class="toc-number">6.</span> <span class="toc-text">0x06 2023miniL curvesignin 5.11</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#0x05-2023nkctf-raven-328"><span class="toc-number">7.</span> <span class="toc-text">0x05 2023nkctf raven 3.28</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#0x04-2023nkctf-fake_mt-328"><span class="toc-number">8.</span> <span class="toc-text">0x04 2023nkctf fake_MT 3.28</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#0x03-2022%E7%BE%8A%E5%9F%8E%E6%9D%AF-novelsystem2-323"><span class="toc-number">9.</span> <span class="toc-text">0x03 2022羊城杯 NovelSystem2 3.23</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#0x02-2022%E7%BE%8A%E5%9F%8E%E6%9D%AF-linearalgebra-323"><span class="toc-number">10.</span> <span class="toc-text">0x02 2022羊城杯 linearAlgebra 3.23</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#0x01-2022ichunqiu%E5%8B%87%E8%80%85%E5%B1%B1%E5%B3%B0-bob_enc-33"><span class="toc-number">11.</span> <span class="toc-text">0x01 2022ichunqiu勇者山峰 bob_enc 3.3</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#0x00-2022%E8%B5%A3%E7%BD%91%E6%9D%AF-lattice-130"><span class="toc-number">12.</span> <span class="toc-text">0x00 2022赣网杯 lattice 1.30</span></a></li></ol></div><div class="related panel pjax" data-title="Related"></div><div class="overview panel" data-title="Overview"><div class="author" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="image" itemprop="image" alt="tsuppari" data-src="/images/head.jpg"><p class="name" itemprop="name">tsuppari</p><div class="description" itemprop="description"></div></div><nav class="state"><div class="item posts"><a href="/archives/"><span class="count">20</span> <span class="name">posts</span></a></div><div class="item tags"><a href="/tags/"><span class="count">8</span> <span class="name">tags</span></a></div></nav><div class="social"><span class="exturl item email" data-url="bWFpbHRvOjE2MjcxMDA3NDEwQHFxLmNvbQ==" title="mailto:16271007410@qq.com"><i class="ic i-envelope"></i></span> <span class="exturl item QQ" data-url="dGVuY2VudDovL01lc3NhZ2UvP1Vpbj0xNjI3MTAwNDEwJndlYnNpdGVOYW1lPXEtem9uZS5xcS5jb20mTWVudT15ZXM=" title="tencent:&#x2F;&#x2F;Message&#x2F;?Uin&#x3D;1627100410&amp;websiteName&#x3D;q-zone.qq.com&amp;Menu&#x3D;yes"><i class="ic i-qq"></i></span></div><ul class="menu"><li class="item"><a href="/" rel="section"><i class="ic i-home"></i>Home</a></li><li class="item"><a href="/about/" rel="section"><i class="ic i-user"></i>About</a></li><li class="item"><a href="/friends/" rel="section"><i class="ic i-heart"></i>friends</a></li></ul></div></div></div><ul id="quick"><li class="prev pjax"></li><li class="up"><i class="ic i-arrow-up"></i></li><li class="down"><i class="ic i-arrow-down"></i></li><li class="next pjax"></li><li class="percent"></li></ul></div></div><div class="dimmer"></div></div></main><footer id="footer"><div class="inner"><div class="widgets"><div class="rpost pjax"><h2>Random Posts</h2><ul><li class="item"><div class="breadcrumb"></div><span><a href="/2022/02/28/Gauss/" title="Gauss">Gauss</a></span></li><li class="item"><div class="breadcrumb"></div><span><a href="/2021/05/19/RSA/" title="RSA!!">RSA!!</a></span></li><li class="item"><div class="breadcrumb"></div><span><a href="/2022/03/16/%E9%92%88%E5%AF%B9CTFer%E7%9A%84e%E4%B8%8Ephi%E4%B8%8D%E4%BA%92%E7%B4%A0%E7%9A%84%E9%97%AE%E9%A2%98/" title="针对CTFer的e与phi不互素的问题">针对CTFer的e与phi不互素的问题</a></span></li><li class="item"><div class="breadcrumb"></div><span><a href="/2022/11/28/2022%E5%AE%89%E6%B4%B5%E6%9D%AFcrypto%E6%96%B9%E5%90%91writeup/" title="2022安洵杯crypto方向writeup">2022安洵杯crypto方向writeup</a></span></li><li class="item"><div class="breadcrumb"></div><span><a href="/2022/11/26/docker%E6%98%AF%E4%B8%AA%E8%82%BE%E4%B9%88%E7%8E%A9%E6%84%8F/" title="docker是个肾么玩意">docker是个肾么玩意</a></span></li><li class="item"><div class="breadcrumb"></div><span><a href="/2021/08/02/%E8%92%9F%E8%92%BB%E7%9A%84%E6%8C%A8%E6%89%93%E4%B9%8B%E8%B7%AF/" title="蒟蒻的挨打之路">蒟蒻的挨打之路</a></span></li><li class="item"><div class="breadcrumb"></div><span><a href="/2099/09/12/crypto%E7%9A%84%E6%8C%A8%E6%89%93%E4%B9%8B%E8%B7%AF(%E4%B8%80)/" title="crypto的挨打之路（一）">crypto的挨打之路（一）</a></span></li><li class="item"><div class="breadcrumb"></div><span><a href="/2023/09/19/%E4%B8%80%E7%82%B9%E7%82%B9%E7%AC%94%E8%AE%B0/" title="一点点笔记">一点点笔记</a></span></li><li class="item"><div class="breadcrumb"></div><span><a href="/2021/01/25/%E8%92%9F%E8%92%BB%E7%9A%84python%E7%AC%94%E8%AE%B0/" title="蒟蒻的python笔记（随缘更新版）">蒟蒻的python笔记（随缘更新版）</a></span></li><li class="item"><div class="breadcrumb"></div><span><a href="/2021/02/27/%E4%BA%8C%E7%BA%A7%E7%82%AE%E7%81%B0%E8%B7%AF/" title="二级炮灰路">二级炮灰路</a></span></li></ul></div><div><h2>Recent Comments</h2><ul class="leancloud-recent-comment"></ul></div></div><div class="status"><div class="copyright">&copy; 2020 – <span itemprop="copyrightYear">2023</span> <span class="with-love"><i class="ic i-sakura rotate"></i> </span><span class="author" itemprop="copyrightHolder">tsuppari @ T5uppari</span></div><div class="powered-by">Powered by <span class="exturl" data-url="aHR0cHM6Ly9oZXhvLmlv">Hexo</span> & Theme.<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2FtZWhpbWUvaGV4by10aGVtZS1zaG9rYQ==">Shoka</span></div></div></div></footer></div><script data-config type="text/javascript">var LOCAL={path:"2299/01/30/crypto的挨打之路(退役版)/",favicon:{show:"（●´3｀●）Goooood",hide:"(´Д｀)Booooom"},search:{placeholder:"Search for Posts",empty:"We didn't find any results for the search: ${query}",stats:"${hits} results found in ${time} ms"},valine:!0,fancybox:!0,copyright:'Copied to clipboard successfully! <br> All articles in this blog are licensed under <i class="ic i-creative-commons"></i>BY-NC-SA.',ignores:[function(e){return e.includes("#")},function(e){return new RegExp(LOCAL.path+"$").test(e)}]}</script><script src="https://cdn.polyfill.io/v2/polyfill.js"></script><script src="//cdn.jsdelivr.net/combine/npm/pace-js@1.0.2/pace.min.js,npm/pjax@0.2.8/pjax.min.js,npm/whatwg-fetch@3.4.0/dist/fetch.umd.min.js,npm/animejs@3.2.0/lib/anime.min.js,npm/algoliasearch@4/dist/algoliasearch-lite.umd.js,npm/instantsearch.js@4/dist/instantsearch.production.min.js,npm/lozad@1/dist/lozad.min.js,npm/quicklink@2/dist/quicklink.umd.js"></script><script src="/js/app.js?v=0.2.5"></script></body></html><!-- rebuild by hrmmi -->